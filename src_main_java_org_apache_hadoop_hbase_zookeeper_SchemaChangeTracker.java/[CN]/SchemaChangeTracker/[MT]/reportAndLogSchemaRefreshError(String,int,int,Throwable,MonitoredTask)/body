{
  try {
    String errmsg=" Region Server " + regionServer.getServerName().getServerName() + " failed during schema change process. Cause = "+ exception.getCause()+ " Number of onlineRegions = "+ onlineRegionsCount+ " Processed regions = "+ refreshedRegionsCount;
    SchemaAlterStatus alterStatus=getSchemaAlterStatus(tableName);
    alterStatus.update(SchemaAlterStatus.AlterState.FAILURE,refreshedRegionsCount,errmsg);
    String nodePath=getSchemaChangeNodePathForTableAndServer(tableName,regionServer.getServerName().getServerName());
    ZKUtil.updateExistingNodeData(this.watcher,nodePath,Writables.getBytes(alterStatus),getZKNodeVersion(nodePath));
    LOG.info("reportAndLogSchemaRefreshError() " + " Updated child ZKNode with SchemaAlterStatus = " + alterStatus + " for table = "+ tableName);
    if (status == null) {
      status=TaskMonitor.get().createStatus(errmsg);
    }
 else {
      status.setStatus(errmsg);
    }
  }
 catch (  KeeperException e) {
    String errmsg="KeeperException while updating the schema change node with " + "error status for table = " + tableName + " server = "+ regionServer.getServerName().getServerName()+ " Cause = "+ e.getCause();
    LOG.error(errmsg,e);
    TaskMonitor.get().createStatus(errmsg);
  }
catch (  IOException ioe) {
    String errmsg="IOException while updating the schema change node with " + "server name for table = " + tableName + " server = "+ regionServer.getServerName().getServerName()+ " Cause = "+ ioe.getCause();
    TaskMonitor.get().createStatus(errmsg);
    LOG.error(errmsg,ioe);
  }
}
