{
  HTableDescriptor htd=new HTableDescriptor(Bytes.toBytes(atd.name));
  if (atd.families != null && atd.families.size() > 0) {
    for (    AFamilyDescriptor afd : atd.families) {
      htd.addFamily(afdToHCD(afd));
    }
  }
  if (atd.maxFileSize != null) {
    htd.setMaxFileSize(atd.maxFileSize);
  }
  if (atd.memStoreFlushSize != null) {
    htd.setMemStoreFlushSize(atd.memStoreFlushSize);
  }
  if (atd.readOnly != null) {
    htd.setReadOnly(atd.readOnly);
  }
  if (atd.deferredLogFlush != null) {
    htd.setDeferredLogFlush(atd.deferredLogFlush);
  }
  if (atd.rootRegion != null || atd.metaRegion != null || atd.metaTable != null) {
    AIllegalArgument aie=new AIllegalArgument();
    aie.message=new Utf8("Can't set root or meta flag on create table.");
    throw aie;
  }
  return htd;
}
