{
  this.tableName=tableName;
  this.cleanupPoolOnClose=this.cleanupConnectionOnClose=true;
  if (conf == null) {
    this.connection=null;
    return;
  }
  this.connection=HConnectionManager.getConnection(conf);
  this.configuration=conf;
  int maxThreads=conf.getInt("hbase.htable.threads.max",Integer.MAX_VALUE);
  if (maxThreads == 0) {
    maxThreads=1;
  }
  long keepAliveTime=conf.getLong("hbase.htable.threads.keepalivetime",60);
  this.pool=new ThreadPoolExecutor(1,maxThreads,keepAliveTime,TimeUnit.SECONDS,new SynchronousQueue<Runnable>(),new DaemonThreadFactory());
  ((ThreadPoolExecutor)this.pool).allowCoreThreadTimeOut(true);
  this.finishSetup();
}
