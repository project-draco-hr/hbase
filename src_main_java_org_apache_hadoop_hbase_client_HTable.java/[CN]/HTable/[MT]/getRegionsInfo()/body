{
  final Map<HRegionInfo,HServerAddress> regionMap=new TreeMap<HRegionInfo,HServerAddress>();
  MetaScannerVisitor visitor=new MetaScannerVisitor(){
    public boolean processRow(    Result rowResult) throws IOException {
      HRegionInfo info=Writables.getHRegionInfo(rowResult.getValue(HConstants.CATALOG_FAMILY,HConstants.REGIONINFO_QUALIFIER));
      if (!(Bytes.equals(info.getTableName(),getTableName()))) {
        return false;
      }
      HServerAddress server=new HServerAddress();
      byte[] value=rowResult.getValue(HConstants.CATALOG_FAMILY,HConstants.SERVER_QUALIFIER);
      if (value != null && value.length > 0) {
        String hostAndPort=Bytes.toString(value);
        server=new HServerAddress(Addressing.createInetSocketAddressFromHostAndPortStr(hostAndPort));
      }
      if (!(info.isOffline() || info.isSplit())) {
        regionMap.put(new UnmodifyableHRegionInfo(info),server);
      }
      return true;
    }
  }
;
  MetaScanner.metaScan(configuration,visitor,tableName);
  return regionMap;
}
