{
  try {
    this.connection.processBatchOfPuts(writeBuffer,tableName,pool);
  }
  finally {
    if (clearBufferOnFail) {
      writeBuffer.clear();
      currentWriteBufferSize=0;
    }
 else {
      currentWriteBufferSize=0;
      for (      Put aPut : writeBuffer) {
        currentWriteBufferSize+=aPut.heapSize();
      }
    }
  }
}
