{
  final List<byte[]> startKeyList=new ArrayList<byte[]>();
  final List<byte[]> endKeyList=new ArrayList<byte[]>();
  MetaScannerVisitor visitor=new MetaScannerVisitor(){
    public boolean processRow(    Result rowResult) throws IOException {
      byte[] bytes=rowResult.getValue(HConstants.CATALOG_FAMILY,HConstants.REGIONINFO_QUALIFIER);
      if (bytes == null) {
        LOG.warn("Null " + HConstants.REGIONINFO_QUALIFIER + " cell in "+ rowResult);
        return true;
      }
      HRegionInfo info=Writables.getHRegionInfo(bytes);
      if (Bytes.equals(info.getTableDesc().getName(),getTableName())) {
        if (!(info.isOffline() || info.isSplit())) {
          startKeyList.add(info.getStartKey());
          endKeyList.add(info.getEndKey());
        }
      }
      return true;
    }
  }
;
  MetaScanner.metaScan(configuration,visitor,this.tableName);
  return new Pair(startKeyList.toArray(new byte[startKeyList.size()][]),endKeyList.toArray(new byte[endKeyList.size()][]));
}
