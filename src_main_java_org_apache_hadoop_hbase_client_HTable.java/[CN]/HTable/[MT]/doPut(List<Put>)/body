{
  if (autoFlush && puts.size() == 1) {
    final Put put=puts.get(0);
    validatePut(put);
    new ServerCallable<Void>(connection,tableName,put.getRow(),operationTimeout){
      public Void call() throws IOException {
        try {
          MutateRequest request=RequestConverter.buildMutateRequest(location.getRegionInfo().getRegionName(),put);
          server.mutate(null,request);
        }
 catch (        ServiceException se) {
          throw ProtobufUtil.getRemoteException(se);
        }
        return null;
      }
    }
.withRetries();
  }
 else {
    int n=0;
    for (    Put put : puts) {
      validatePut(put);
      writeBuffer.add(put);
      currentWriteBufferSize+=put.heapSize();
      n++;
      if (n % DOPUT_WB_CHECK == 0 && currentWriteBufferSize > writeBufferSize) {
        flushCommits();
      }
    }
    if (autoFlush || currentWriteBufferSize > writeBufferSize) {
      flushCommits();
    }
  }
}
