{
  int n=0;
  for (  Put put : puts) {
    validatePut(put);
    writeBuffer.add(put);
    currentWriteBufferSize+=put.heapSize();
    n++;
    if (n % DOPUT_WB_CHECK == 0 && currentWriteBufferSize > writeBufferSize) {
      flushCommits();
    }
  }
  if (autoFlush || currentWriteBufferSize > writeBufferSize) {
    flushCommits();
  }
}
