{
  int n=0;
  for (  Put put : puts) {
    validatePut(put);
    writeBuffer.add(put);
    currentWriteBufferSize+=put.heapSize();
    n++;
    if (n == DOPUT_WB_CHECK) {
      if (autoFlush || currentWriteBufferSize > writeBufferSize) {
        flushCommits();
        n=0;
      }
    }
  }
  if (autoFlush || currentWriteBufferSize > writeBufferSize) {
    flushCommits();
  }
}
