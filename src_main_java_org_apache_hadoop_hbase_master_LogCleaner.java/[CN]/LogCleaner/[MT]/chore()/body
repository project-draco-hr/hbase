{
  try {
    FileStatus[] files=FSUtils.listStatus(this.fs,this.oldLogDir,null);
    if (files == null)     return;
    FILE:     for (    FileStatus file : files) {
      Path filePath=file.getPath();
      if (HLog.validateHLogFilename(filePath.getName())) {
        for (        LogCleanerDelegate logCleaner : logCleanersChain) {
          if (logCleaner.isStopped()) {
            LOG.warn("A log cleaner is stopped, won't delete any log.");
            return;
          }
          if (!logCleaner.isLogDeletable(filePath)) {
            continue FILE;
          }
        }
        this.fs.delete(filePath,true);
      }
 else {
        LOG.warn("Found a wrongly formated file: " + file.getPath().getName());
        this.fs.delete(filePath,true);
      }
    }
  }
 catch (  IOException e) {
    e=RemoteExceptionHandler.checkIOException(e);
    LOG.warn("Error while cleaning the logs",e);
  }
}
