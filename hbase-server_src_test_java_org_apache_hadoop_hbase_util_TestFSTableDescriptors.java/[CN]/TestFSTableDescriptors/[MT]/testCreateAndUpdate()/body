{
  Path testdir=UTIL.getDataTestDir("testCreateAndUpdate");
  HTableDescriptor htd=new HTableDescriptor("testCreate");
  FileSystem fs=FileSystem.get(UTIL.getConfiguration());
  assertTrue(FSTableDescriptors.createTableDescriptor(fs,testdir,htd));
  assertFalse(FSTableDescriptors.createTableDescriptor(fs,testdir,htd));
  FileStatus[] statuses=fs.listStatus(testdir);
  assertTrue("statuses.length=" + statuses.length,statuses.length == 1);
  for (int i=0; i < 10; i++) {
    FSTableDescriptors.updateHTableDescriptor(fs,testdir,htd);
  }
  statuses=fs.listStatus(testdir);
  assertTrue(statuses.length == 1);
  Path tmpTableDir=new Path(FSUtils.getTablePath(testdir,htd.getName()),".tmp");
  statuses=fs.listStatus(tmpTableDir);
  assertTrue(statuses.length == 0);
}
