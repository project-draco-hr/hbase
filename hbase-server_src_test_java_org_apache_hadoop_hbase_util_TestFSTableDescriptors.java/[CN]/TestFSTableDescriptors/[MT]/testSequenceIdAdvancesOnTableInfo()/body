{
  Path testdir=UTIL.getDataTestDir("testSequenceidAdvancesOnTableInfo");
  HTableDescriptor htd=new HTableDescriptor(TableName.valueOf("testSequenceidAdvancesOnTableInfo"));
  TableDescriptor td=new TableDescriptor(htd);
  FileSystem fs=FileSystem.get(UTIL.getConfiguration());
  FSTableDescriptors fstd=new FSTableDescriptors(UTIL.getConfiguration(),fs,testdir);
  Path p0=fstd.updateTableDescriptor(td);
  int i0=FSTableDescriptors.getTableInfoSequenceId(p0);
  Path p1=fstd.updateTableDescriptor(td);
  assertTrue(!fs.exists(p0));
  int i1=FSTableDescriptors.getTableInfoSequenceId(p1);
  assertTrue(i1 == i0 + 1);
  Path p2=fstd.updateTableDescriptor(td);
  assertTrue(!fs.exists(p1));
  int i2=FSTableDescriptors.getTableInfoSequenceId(p2);
  assertTrue(i2 == i1 + 1);
  td=new TableDescriptor(htd,TableState.State.DISABLED);
  Path p3=fstd.updateTableDescriptor(td);
  assertTrue(!fs.exists(p2));
  int i3=FSTableDescriptors.getTableInfoSequenceId(p3);
  assertTrue(i3 == i2 + 1);
  TableDescriptor descriptor=fstd.getDescriptor(htd.getTableName());
  assertEquals(descriptor,td);
}
