{
  Path testdir=UTIL.getDataTestDir("testCreateTableDescriptorUpdatesIfThereExistsAlready");
  HTableDescriptor htd=new HTableDescriptor("testCreateTableDescriptorUpdatesIfThereExistsAlready");
  FileSystem fs=FileSystem.get(UTIL.getConfiguration());
  assertTrue(FSTableDescriptors.createTableDescriptor(fs,testdir,htd));
  assertFalse(FSTableDescriptors.createTableDescriptor(fs,testdir,htd));
  htd.setValue(Bytes.toBytes("mykey"),Bytes.toBytes("myValue"));
  assertTrue(FSTableDescriptors.createTableDescriptor(fs,testdir,htd));
  Path tableDir=FSUtils.getTablePath(testdir,htd.getName());
  Path tmpTableDir=new Path(tableDir,".tmp");
  FileStatus[] statuses=fs.listStatus(tmpTableDir);
  assertTrue(statuses.length == 0);
  assertEquals(htd,FSTableDescriptors.getTableDescriptor(fs,tableDir));
}
