{
  HTableDescriptor htd=createTableDescriptor(getName(),0,1,HConstants.FOREVER,true);
  HRegion region=createNewHRegion(htd,null,null);
  long ts=System.currentTimeMillis();
  Delete d=new Delete(T1,ts,null);
  d.deleteColumns(c0,c0,ts);
  region.delete(d,null,true);
  d=new Delete(T1,ts,null);
  d.deleteFamily(c0);
  region.delete(d,null,true);
  d=new Delete(T1,ts,null);
  d.deleteColumn(c0,c0,ts + 1);
  region.delete(d,null,true);
  d=new Delete(T1,ts,null);
  d.deleteColumn(c0,c0,ts + 2);
  region.delete(d,null,true);
  assertEquals(4,countDeleteMarkers(region));
  region.flushcache();
  assertEquals(4,countDeleteMarkers(region));
  region.compactStores(false);
  assertEquals(4,countDeleteMarkers(region));
  region.compactStores(true);
  assertEquals(0,countDeleteMarkers(region));
  region.close();
  region.getLog().closeAndDelete();
}
