{
  if (proc == null) {
    return false;
  }
  String procName=proc.getName();
synchronized (procedures) {
    Procedure oldProc=procedures.get(procName);
    if (oldProc != null) {
      try {
        if (!oldProc.isCompleted()) {
          LOG.warn("Procedure " + procName + " currently running.  Rejecting new request");
          return false;
        }
 else {
          LOG.debug("Procedure " + procName + " was in running list but was completed.  Accepting new attempt.");
          procedures.remove(procName);
        }
      }
 catch (      ForeignException e) {
        LOG.debug("Procedure " + procName + " was in running list but has exception.  Accepting new attempt.");
        procedures.remove(procName);
      }
    }
  }
  Future<Void> f=null;
  try {
synchronized (procedures) {
      this.procedures.put(procName,proc);
      f=this.pool.submit(proc);
    }
    return true;
  }
 catch (  RejectedExecutionException e) {
    LOG.warn("Procedure " + procName + " rejected by execution pool.  Propagating error and "+ "cancelling operation.",e);
    this.procedures.remove(procName);
    proc.receive(new ForeignException(procName,e));
    if (f != null) {
      f.cancel(true);
    }
  }
  return false;
}
