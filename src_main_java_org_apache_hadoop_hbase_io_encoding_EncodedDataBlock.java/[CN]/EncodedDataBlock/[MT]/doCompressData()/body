{
  compressedStream.reset();
  DataOutputStream dataOut=new DataOutputStream(compressedStream);
  try {
    this.dataBlockEncoder.compressKeyValues(dataOut,getUncompressedBuffer(),includesMemstoreTS);
  }
 catch (  IOException e) {
    throw new RuntimeException(String.format("Bug in decoding part of algorithm %s. " + "Probably it requested more bytes than are available.",toString()),e);
  }
  return compressedStream.toByteArray();
}
