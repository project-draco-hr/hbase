{
  try {
    if (this.closed) {
      return;
    }
synchronized (updateLock) {
      long now=System.currentTimeMillis();
      WALEdit edit=completeCacheFlushLogEdit();
      HLogKey key=makeKey(encodedRegionName,tableName,logSeqId,System.currentTimeMillis());
      this.writer.append(new Entry(key,edit));
      writeTime+=System.currentTimeMillis() - now;
      writeOps++;
      this.numEntries.incrementAndGet();
      Long seq=this.lastSeqWritten.get(encodedRegionName);
      if (seq != null && logSeqId >= seq.longValue()) {
        this.lastSeqWritten.remove(encodedRegionName);
      }
    }
    this.sync();
  }
  finally {
    this.cacheFlushLock.unlock();
  }
}
