{
  FileSystem fs=FileSystem.get(conf);
  if (!fs.exists(p)) {
    throw new FileNotFoundException(p.toString());
  }
  final Path baseDir=new Path(conf.get(HConstants.HBASE_DIR));
  final Path oldLogDir=new Path(baseDir,HConstants.HREGION_OLDLOGDIR_NAME);
  if (!fs.getFileStatus(p).isDir()) {
    throw new IOException(p + " is not a directory");
  }
  HLogSplitter logSplitter=HLogSplitter.createLogSplitter(conf,baseDir,p,oldLogDir,fs);
  logSplitter.splitLog();
}
