{
  long millis=System.currentTimeMillis();
  List<Path> splits=null;
  if (!fs.exists(srcDir)) {
    return splits;
  }
  FileStatus[] logfiles=fs.listStatus(srcDir);
  if (logfiles == null || logfiles.length == 0) {
    return splits;
  }
  LOG.info("Splitting " + logfiles.length + " hlog(s) in "+ srcDir.toString());
  splits=splitLog(rootDir,srcDir,oldLogDir,logfiles,fs,conf);
  try {
    LOG.info("Spliting is done. Removing old log dir " + srcDir);
    fs.delete(srcDir,false);
  }
 catch (  IOException e) {
    e=RemoteExceptionHandler.checkIOException(e);
    IOException io=new IOException("Cannot delete: " + srcDir);
    io.initCause(e);
    throw io;
  }
  long endMillis=System.currentTimeMillis();
  LOG.info("hlog file splitting completed in " + (endMillis - millis) + " millis for "+ srcDir.toString());
  return splits;
}
