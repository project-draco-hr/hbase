{
  FileSystem fs=FileSystem.get(conf);
  if (!fs.exists(p)) {
    throw new FileNotFoundException(p.toString());
  }
  if (!fs.isFile(p)) {
    throw new IOException(p + " is not a file");
  }
  Reader log=getReader(fs,p,conf);
  try {
    int count=0;
    HLog.Entry entry;
    while ((entry=log.next()) != null) {
      System.out.println("#" + count + ", pos="+ log.getPosition()+ " "+ entry.toString());
      count++;
    }
  }
  finally {
    log.close();
  }
}
