{
  close();
  FileStatus[] files=fs.listStatus(this.dir);
  for (  FileStatus file : files) {
    Path p=getHLogArchivePath(this.oldLogDir,file.getPath());
    if (!fs.rename(file.getPath(),p)) {
      throw new IOException("Unable to rename " + file.getPath() + " to "+ p);
    }
  }
  LOG.debug("Moved " + files.length + " log files to "+ FSUtils.getPath(this.oldLogDir));
  if (!fs.delete(dir,true)) {
    LOG.info("Unable to delete " + dir);
  }
}
