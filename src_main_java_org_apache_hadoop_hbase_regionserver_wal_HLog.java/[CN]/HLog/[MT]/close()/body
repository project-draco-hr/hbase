{
  try {
    logSyncerThread.interrupt();
    logSyncerThread.close();
    logSyncerThread.join(this.optionalFlushInterval * 2);
  }
 catch (  InterruptedException e) {
    LOG.error("Exception while waiting for syncer thread to die",e);
  }
  cacheFlushLock.lock();
  try {
    if (!this.listeners.isEmpty()) {
      for (      WALActionsListener i : this.listeners) {
        i.logCloseRequested();
      }
    }
synchronized (updateLock) {
      this.closed=true;
      if (LOG.isDebugEnabled()) {
        LOG.debug("closing hlog writer in " + this.dir.toString());
      }
      if (this.writer != null) {
        this.writer.close();
      }
    }
  }
  finally {
    cacheFlushLock.unlock();
  }
}
