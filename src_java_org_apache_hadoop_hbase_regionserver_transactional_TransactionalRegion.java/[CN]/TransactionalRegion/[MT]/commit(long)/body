{
  TransactionState state;
  try {
    state=getTransactionState(transactionId);
  }
 catch (  UnknownTransactionException e) {
    LOG.fatal("Asked to commit unknown transaction: " + transactionId + " in region "+ super.getRegionInfo().getRegionNameAsString());
    throw e;
  }
  if (!state.getStatus().equals(Status.COMMIT_PENDING)) {
    LOG.fatal("Asked to commit a non pending transaction");
    throw new IOException("commit failure");
  }
  commit(state);
}
