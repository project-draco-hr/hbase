{
  HRegionInterface server=getHRegionConnection(t.serverAddress);
  long scannerId=-1L;
  try {
    scannerId=server.openScanner(t.regionInfo.regionName,metaColumns,tableName);
    DataInputBuffer inbuf=new DataInputBuffer();
    while (true) {
      HStoreKey key=new HStoreKey();
      LabelledData[] values=server.next(scannerId,key);
      if (values.length == 0) {
        break;
      }
      TreeMap<Text,byte[]> results=new TreeMap<Text,byte[]>();
      for (int i=0; i < values.length; i++) {
        results.put(values[i].getLabel(),values[i].getData().get());
      }
      HRegionInfo regionInfo=new HRegionInfo();
      byte[] bytes=results.get(META_COL_REGIONINFO);
      inbuf.reset(bytes,bytes.length);
      regionInfo.readFields(inbuf);
      if (!regionInfo.tableDesc.getName().equals(tableName)) {
        break;
      }
      bytes=results.get(META_COL_SERVER);
      String serverName=new String(bytes,UTF8_ENCODING);
      tableServers.put(regionInfo.startKey,new TableInfo(regionInfo,new HServerAddress(serverName)));
    }
  }
  finally {
    if (scannerId != -1L) {
      server.close(scannerId);
    }
  }
}
