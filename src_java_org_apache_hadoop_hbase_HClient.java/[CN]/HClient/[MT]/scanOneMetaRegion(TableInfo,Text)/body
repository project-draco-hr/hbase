{
  HRegionInterface server=getHRegionConnection(t.serverAddress);
  HScannerInterface scanner=null;
  try {
    scanner=server.openScanner(t.regionInfo.regionName,metaColumns,tableName);
    HStoreKey key=new HStoreKey();
    TreeMap<Text,byte[]> results=new TreeMap<Text,byte[]>();
    DataInputBuffer inbuf=new DataInputBuffer();
    while (scanner.next(key,results)) {
      byte hRegionInfoBytes[]=results.get(META_COL_REGIONINFO);
      inbuf.reset(hRegionInfoBytes,hRegionInfoBytes.length);
      HRegionInfo regionInfo=new HRegionInfo();
      regionInfo.readFields(inbuf);
      if (!regionInfo.tableDesc.getName().equals(tableName)) {
        break;
      }
      byte serverBytes[]=results.get(META_COL_SERVER);
      String serverName=new String(serverBytes,UTF8_ENCODING);
      tableServers.put(regionInfo.startKey,new TableInfo(regionInfo,new HServerAddress(serverName)));
      results.clear();
    }
  }
  finally {
    scanner.close();
  }
}
