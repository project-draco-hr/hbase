{
  SortedMap<Text,RegionLocation> servers=null;
  if (tableName.equals(ROOT_TABLE_NAME)) {
    servers=locateRootRegion();
  }
 else   if (tableName.equals(META_TABLE_NAME)) {
    servers=loadMetaFromRoot();
  }
 else {
    servers=new TreeMap<Text,RegionLocation>();
    for (    RegionLocation t : findMetaServersForTable(tableName).values()) {
      servers.putAll(scanOneMetaRegion(t,tableName));
    }
    this.tablesToServers.put(tableName,servers);
  }
  if (LOG.isDebugEnabled()) {
    for (    Map.Entry<Text,RegionLocation> e : servers.entrySet()) {
      LOG.debug("Server " + e.getKey() + " is serving: "+ e.getValue());
    }
  }
  return servers;
}
