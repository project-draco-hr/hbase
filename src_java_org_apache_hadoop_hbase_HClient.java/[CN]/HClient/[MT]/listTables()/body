{
  TreeSet<HTableDescriptor> uniqueTables=new TreeSet<HTableDescriptor>();
  SortedMap<Text,RegionLocation> metaTables=this.tablesToServers.get(META_TABLE_NAME);
  if (metaTables == null) {
    metaTables=loadMetaFromRoot();
  }
  for (  RegionLocation t : metaTables.values()) {
    HRegionInterface server=getHRegionConnection(t.serverAddress);
    long scannerId=-1L;
    try {
      scannerId=server.openScanner(t.regionInfo.regionName,META_COLUMNS,EMPTY_START_ROW,System.currentTimeMillis(),null);
      DataInputBuffer inbuf=new DataInputBuffer();
      while (true) {
        KeyedData[] values=server.next(scannerId);
        if (values.length == 0) {
          break;
        }
        for (int i=0; i < values.length; i++) {
          if (values[i].getKey().getColumn().equals(COL_REGIONINFO)) {
            inbuf.reset(values[i].getData(),values[i].getData().length);
            HRegionInfo info=new HRegionInfo();
            info.readFields(inbuf);
            if (info.startKey.getLength() == 0) {
              uniqueTables.add(info.tableDesc);
            }
          }
        }
      }
    }
 catch (    RemoteException ex) {
      throw RemoteExceptionHandler.decodeRemoteException(ex);
    }
 finally {
      if (scannerId != -1L) {
        server.close(scannerId);
      }
    }
  }
  return uniqueTables.toArray(new HTableDescriptor[uniqueTables.size()]);
}
