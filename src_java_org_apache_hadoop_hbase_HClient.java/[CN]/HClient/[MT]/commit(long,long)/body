{
  if (batch.get() != null) {
    commitBatch(lockid,timestamp);
    return;
  }
  if (lockid != this.currentLockId.get()) {
    throw new IllegalArgumentException("invalid lockid");
  }
  try {
    this.currentServer.commit(this.currentRegion,this.clientid,lockid,timestamp);
  }
 catch (  IOException e) {
    this.currentServer=null;
    this.currentRegion=null;
    if (e instanceof RemoteException) {
      e=RemoteExceptionHandler.decodeRemoteException((RemoteException)e);
    }
    throw e;
  }
 finally {
    this.currentLockId.set(-1L);
  }
}
