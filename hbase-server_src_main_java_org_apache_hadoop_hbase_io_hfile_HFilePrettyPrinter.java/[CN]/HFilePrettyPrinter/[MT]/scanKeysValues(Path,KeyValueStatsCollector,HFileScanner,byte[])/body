{
  Cell pCell=null;
  do {
    Cell cell=scanner.getKeyValue();
    if (row != null && row.length != 0) {
      int result=CellComparator.compareRows(cell.getRowArray(),cell.getRowOffset(),cell.getRowLength(),row,0,row.length);
      if (result > 0) {
        break;
      }
 else       if (result < 0) {
        continue;
      }
    }
    if (printStats) {
      fileStats.collect(cell);
    }
    if (printKey) {
      System.out.print("K: " + cell);
      if (printValue) {
        System.out.print(" V: " + Bytes.toStringBinary(cell.getValueArray(),cell.getValueOffset(),cell.getValueLength()));
        int i=0;
        List<Tag> tags=Tag.asList(cell.getTagsArray(),cell.getTagsOffset(),cell.getTagsLength());
        for (        Tag tag : tags) {
          System.out.print(String.format(" T[%d]: %s",i++,Bytes.toStringBinary(tag.getBuffer(),tag.getTagOffset(),tag.getTagLength())));
        }
      }
      System.out.println();
    }
    if (checkRow && pCell != null) {
      if (CellComparator.compareRows(pCell,cell) > 0) {
        System.err.println("WARNING, previous row is greater then" + " current row\n\tfilename -> " + file + "\n\tprevious -> "+ CellUtil.getCellKey(pCell)+ "\n\tcurrent  -> "+ CellUtil.getCellKey(cell));
      }
    }
    if (checkFamily) {
      String fam=Bytes.toString(cell.getFamilyArray(),cell.getFamilyOffset(),cell.getFamilyLength());
      if (!file.toString().contains(fam)) {
        System.err.println("WARNING, filename does not match kv family," + "\n\tfilename -> " + file + "\n\tkeyvalue -> "+ CellUtil.getCellKey(cell));
      }
      if (pCell != null && CellComparator.compareFamilies(pCell,cell) != 0) {
        System.err.println("WARNING, previous kv has different family" + " compared to current key\n\tfilename -> " + file + "\n\tprevious -> "+ CellUtil.getCellKey(pCell)+ "\n\tcurrent  -> "+ CellUtil.getCellKey(cell));
      }
    }
    pCell=cell;
    ++count;
  }
 while (scanner.next());
}
