{
synchronized (this) {
    if (wlock || rlock > 0) {
      return false;
    }
    tableLock=lockManager.writeLock(tableName,purpose);
    try {
      tableLock.acquire();
    }
 catch (    IOException e) {
      LOG.error("failed acquire write lock on " + tableName,e);
      tableLock=null;
      return false;
    }
    wlock=true;
  }
  return true;
}
