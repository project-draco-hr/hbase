{
  if (rss.isStopping() || rss.isStopped()) {
    throw new IllegalStateException("Can't start backup procedure on RS: " + rss.getServerName() + ", because stopping/stopped!");
  }
  LOG.info("Attempting to run a roll log procedure for backup.");
  ForeignExceptionDispatcher errorDispatcher=new ForeignExceptionDispatcher();
  Configuration conf=rss.getConfiguration();
  long timeoutMillis=conf.getLong(BACKUP_TIMEOUT_MILLIS_KEY,BACKUP_TIMEOUT_MILLIS_DEFAULT);
  long wakeMillis=conf.getLong(BACKUP_REQUEST_WAKE_MILLIS_KEY,BACKUP_REQUEST_WAKE_MILLIS_DEFAULT);
  LogRollBackupSubprocedurePool taskManager=new LogRollBackupSubprocedurePool(rss.getServerName().toString(),conf);
  return new LogRollBackupSubprocedure(rss,member,errorDispatcher,wakeMillis,timeoutMillis,taskManager);
}
