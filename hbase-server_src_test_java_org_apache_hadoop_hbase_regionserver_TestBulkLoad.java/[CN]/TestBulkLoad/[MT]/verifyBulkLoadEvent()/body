{
  TableName tableName=TableName.valueOf("test","test");
  List<Pair<byte[],String>> familyPaths=withFamilyPathsFor(family1);
  byte[] familyName=familyPaths.get(0).getFirst();
  String storeFileName=familyPaths.get(0).getSecond();
  storeFileName=(new Path(storeFileName)).getName();
  List<String> storeFileNames=new ArrayList<String>();
  storeFileNames.add(storeFileName);
  final Matcher<WALEdit> bulkEventMatcher=bulkLogWalEdit(WALEdit.BULK_LOAD,tableName.toBytes(),familyName,storeFileNames);
  Expectations expection=new Expectations(){
{
      oneOf(log).append(with(any(HTableDescriptor.class)),with(any(HRegionInfo.class)),with(any(WALKey.class)),with(bulkEventMatcher),with(any(boolean.class)));
      will(returnValue(0l));
      oneOf(log).sync(with(any(long.class)));
    }
  }
;
  context.checking(expection);
  testRegionWithFamiliesAndSpecifiedTableName(tableName,family1).bulkLoadHFiles(familyPaths,false,null);
}
