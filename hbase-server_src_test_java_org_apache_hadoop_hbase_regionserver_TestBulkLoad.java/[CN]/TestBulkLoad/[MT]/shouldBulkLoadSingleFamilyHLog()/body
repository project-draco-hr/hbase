{
  when(log.append(any(HTableDescriptor.class),any(HRegionInfo.class),any(WALKey.class),argThat(bulkLogWalEditType(WALEdit.BULK_LOAD)),any(boolean.class))).thenAnswer(new Answer(){
    public Object answer(    InvocationOnMock invocation){
      WALKey walKey=invocation.getArgumentAt(2,WALKey.class);
      MultiVersionConcurrencyControl mvcc=walKey.getMvcc();
      if (mvcc != null) {
        MultiVersionConcurrencyControl.WriteEntry we=mvcc.begin();
        walKey.setWriteEntry(we);
      }
      return 01L;
    }
  }
);
  testRegionWithFamilies(family1).bulkLoadHFiles(withFamilyPathsFor(family1),false,null);
  verify(log).sync(anyLong());
}
