{
  HealthCheckerExitStatus status=HealthCheckerExitStatus.SUCCESS;
  try {
    shexec.execute();
  }
 catch (  ExitCodeException e) {
    LOG.warn("Caught exception : " + e);
    status=HealthCheckerExitStatus.FAILED_WITH_EXIT_CODE;
  }
catch (  IOException e) {
    LOG.warn("Caught exception : " + e);
    if (!shexec.isTimedOut()) {
      status=HealthCheckerExitStatus.FAILED_WITH_EXCEPTION;
      exceptionStackTrace=org.apache.hadoop.util.StringUtils.stringifyException(e);
    }
 else {
      status=HealthCheckerExitStatus.TIMED_OUT;
    }
  }
 finally {
    if (status == HealthCheckerExitStatus.SUCCESS) {
      if (hasErrors(shexec.getOutput())) {
        status=HealthCheckerExitStatus.FAILED;
      }
    }
  }
  return new HealthReport(status,getHealthReport(status));
}
