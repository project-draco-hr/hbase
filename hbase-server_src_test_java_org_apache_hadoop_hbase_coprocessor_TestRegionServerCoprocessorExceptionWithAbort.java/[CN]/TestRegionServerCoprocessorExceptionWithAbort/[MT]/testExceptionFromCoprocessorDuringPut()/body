{
  byte[] TEST_TABLE=Bytes.toBytes(TABLE_NAME);
  byte[] TEST_FAMILY=Bytes.toBytes("aaa");
  HTable table=TEST_UTIL.createTable(TEST_TABLE,TEST_FAMILY);
  TEST_UTIL.waitUntilAllRegionsAssigned(TEST_TABLE,TEST_UTIL.createMultiRegions(table,TEST_FAMILY));
  final HRegionServer regionServer=TEST_UTIL.getRSForFirstRegionInTable(TEST_TABLE);
  final byte[] ROW=Bytes.toBytes("aaa");
  Put put=new Put(ROW);
  put.add(TEST_FAMILY,ROW,ROW);
  Assert.assertFalse("The region server should be available",regionServer.isAborted());
  try {
    table.put(put);
    fail("The put should have failed, as the coprocessor is buggy");
  }
 catch (  IOException ignored) {
  }
  Assert.assertTrue("The region server should have aborted",regionServer.isAborted());
  table.close();
}
