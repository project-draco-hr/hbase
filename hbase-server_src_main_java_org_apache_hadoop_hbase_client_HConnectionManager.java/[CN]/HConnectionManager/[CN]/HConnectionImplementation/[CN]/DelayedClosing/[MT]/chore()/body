{
synchronized (hci.masterAndZKLock) {
    if (hci.canCloseZKW) {
      if (System.currentTimeMillis() > hci.keepZooKeeperWatcherAliveUntil) {
        hci.closeZooKeeperWatcher();
        hci.keepZooKeeperWatcherAliveUntil=Long.MAX_VALUE;
      }
    }
    if (hci.canCloseMaster) {
      if (System.currentTimeMillis() > hci.keepMasterAliveUntil) {
        hci.closeMaster();
        hci.keepMasterAliveUntil=Long.MAX_VALUE;
      }
    }
  }
}
