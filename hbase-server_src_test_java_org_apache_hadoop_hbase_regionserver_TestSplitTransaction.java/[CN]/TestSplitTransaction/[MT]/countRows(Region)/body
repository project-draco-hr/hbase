{
  int rowcount=0;
  InternalScanner scanner=r.getScanner(new Scan());
  try {
    List<Cell> kvs=new ArrayList<Cell>();
    boolean hasNext=true;
    while (hasNext) {
      hasNext=scanner.next(kvs);
      if (!kvs.isEmpty())       rowcount++;
    }
  }
  finally {
    scanner.close();
  }
  return rowcount;
}
