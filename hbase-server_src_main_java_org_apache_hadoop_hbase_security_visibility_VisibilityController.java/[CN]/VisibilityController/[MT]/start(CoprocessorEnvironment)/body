{
  this.conf=env.getConfiguration();
  ZooKeeperWatcher zk=null;
  if (env instanceof MasterCoprocessorEnvironment) {
    MasterCoprocessorEnvironment mEnv=(MasterCoprocessorEnvironment)env;
    zk=mEnv.getMasterServices().getZooKeeper();
  }
 else   if (env instanceof RegionCoprocessorEnvironment) {
    regionEnv=(RegionCoprocessorEnvironment)env;
    zk=regionEnv.getRegionServerServices().getZooKeeper();
  }
  if (zk == null) {
    throw new RuntimeException("Error obtaining VisibilityLabelsManager, zk found null.");
  }
  try {
    this.visibilityManager=VisibilityLabelsManager.get(zk,this.conf);
  }
 catch (  IOException ioe) {
    throw new RuntimeException("Error obtaining VisibilityLabelsManager",ioe);
  }
  if (env instanceof RegionCoprocessorEnvironment) {
    scanLabelGenerator=VisibilityUtils.getScanLabelGenerator(this.conf);
  }
}
