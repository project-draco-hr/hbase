{
  if (!this.acOn) {
    User user=getActiveUser();
    if (user == null) {
      throw new IOException("Unable to retrieve calling user");
    }
    List<String> auths=this.visibilityManager.getAuths(user.getShortName());
    if (LOG.isTraceEnabled()) {
      LOG.trace("The list of auths are " + auths);
    }
    if (!auths.contains(SYSTEM_LABEL)) {
      throw new AccessDeniedException("User '" + user.getShortName() + "' is not authorized to perform this action.");
    }
  }
}
