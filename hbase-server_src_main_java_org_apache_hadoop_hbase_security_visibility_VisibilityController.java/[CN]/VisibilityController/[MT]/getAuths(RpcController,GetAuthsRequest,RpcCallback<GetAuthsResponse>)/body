{
  byte[] user=request.getUser().toByteArray();
  GetAuthsResponse.Builder response=GetAuthsResponse.newBuilder();
  response.setUser(request.getUser());
  Scan s=new Scan();
  s.addColumn(LABELS_TABLE_FAMILY,user);
  Filter filter=createVisibilityLabelFilter(this.regionEnv.getRegion(),new Authorizations(SYSTEM_LABEL));
  s.setFilter(filter);
  try {
    performACLCheck();
    RegionScanner scanner=this.regionEnv.getRegion().getScanner(s);
    List<Cell> results=new ArrayList<Cell>(1);
    while (true) {
      scanner.next(results);
      if (results.isEmpty())       break;
      Cell cell=results.get(0);
      int ordinal=Bytes.toInt(cell.getRowArray(),cell.getRowOffset(),cell.getRowLength());
      String label=this.visibilityManager.getLabel(ordinal);
      if (label != null) {
        response.addAuth(ZeroCopyLiteralByteString.wrap(Bytes.toBytes(label)));
      }
      results.clear();
    }
  }
 catch (  IOException e) {
    ResponseConverter.setControllerException(controller,e);
  }
  done.run(response.build());
}
