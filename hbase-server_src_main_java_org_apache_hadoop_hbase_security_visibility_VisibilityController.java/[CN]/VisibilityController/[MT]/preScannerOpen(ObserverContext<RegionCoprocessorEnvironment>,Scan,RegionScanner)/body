{
  HRegion region=e.getEnvironment().getRegion();
  Authorizations authorizations=null;
  try {
    authorizations=scan.getAuthorizations();
  }
 catch (  DeserializationException de) {
    throw new IOException(de);
  }
  Filter visibilityLabelFilter=createVisibilityLabelFilter(region,authorizations);
  if (visibilityLabelFilter != null) {
    Filter filter=scan.getFilter();
    if (filter != null) {
      scan.setFilter(new FilterList(filter,visibilityLabelFilter));
    }
 else {
      scan.setFilter(visibilityLabelFilter);
    }
  }
  return s;
}
