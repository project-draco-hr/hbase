{
  ScannerModel model=new ScannerModel();
  model.setStartRow(scan.getStartRow());
  model.setEndRow(scan.getStopRow());
  Map<byte[],NavigableSet<byte[]>> families=scan.getFamilyMap();
  if (families != null) {
    for (    Map.Entry<byte[],NavigableSet<byte[]>> entry : families.entrySet()) {
      for (      byte[] qualifier : entry.getValue()) {
        model.addColumn(Bytes.add(entry.getKey(),COLUMN_DIVIDER,qualifier));
      }
    }
  }
  model.setStartTime(scan.getTimeRange().getMin());
  model.setEndTime(scan.getTimeRange().getMax());
  int caching=scan.getCaching();
  if (caching > 0) {
    model.setBatch(caching);
  }
  int maxVersions=scan.getMaxVersions();
  if (maxVersions > 0) {
    model.setMaxVersions(maxVersions);
  }
  Filter filter=scan.getFilter();
  if (filter != null) {
    model.setFilter(stringifyFilter(filter));
  }
  return model;
}
