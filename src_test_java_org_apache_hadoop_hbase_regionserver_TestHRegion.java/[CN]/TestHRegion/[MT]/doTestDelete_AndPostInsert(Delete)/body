{
  this.region=initHRegion(tableName,getName(),fam1);
  try {
    EnvironmentEdgeManagerTestHelper.injectEdge(new IncrementingEnvironmentEdge());
    Put put=new Put(row);
    put.add(fam1,qual1,value1);
    region.put(put);
    region.delete(delete,null,true);
    put=new Put(row);
    put.add(fam1,qual1,value2);
    region.put(put);
    Get get=new Get(row);
    get.addColumn(fam1,qual1);
    Result r=region.get(get,null);
    assertEquals(1,r.size());
    assertByteEquals(value2,r.getValue(fam1,qual1));
    Scan scan=new Scan(row);
    scan.addColumn(fam1,qual1);
    InternalScanner s=region.getScanner(scan);
    List<KeyValue> results=new ArrayList<KeyValue>();
    assertEquals(false,s.next(results));
    assertEquals(1,results.size());
    KeyValue kv=results.get(0);
    assertByteEquals(value2,kv.getValue());
    assertByteEquals(fam1,kv.getFamily());
    assertByteEquals(qual1,kv.getQualifier());
    assertByteEquals(row,kv.getRow());
  }
  finally {
    HRegion.closeHRegion(this.region);
    this.region=null;
  }
}
