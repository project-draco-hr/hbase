{
  byte[] tableName=Bytes.toBytes("testtable");
  byte[] row1=Bytes.toBytes("row1");
  byte[] fam1=Bytes.toBytes("fam1");
  byte[] qf1=Bytes.toBytes("qualifier");
  byte[] emptyVal=new byte[]{};
  byte[] val1=Bytes.toBytes("value1");
  byte[] val2=Bytes.toBytes("value2");
  Integer lockId=null;
  String method=this.getName();
  initHRegion(tableName,method,fam1);
  Put put=new Put(row1);
  put.add(fam1,qf1,val1);
  boolean res=region.checkAndMutate(row1,fam1,qf1,emptyVal,put,lockId,true);
  assertTrue(res);
  res=region.checkAndMutate(row1,fam1,qf1,emptyVal,put,lockId,true);
  assertFalse(res);
  Delete delete=new Delete(row1);
  delete.deleteColumn(fam1,qf1);
  res=region.checkAndMutate(row1,fam1,qf1,emptyVal,delete,lockId,true);
  assertFalse(res);
  put=new Put(row1);
  put.add(fam1,qf1,val2);
  res=region.checkAndMutate(row1,fam1,qf1,val1,put,lockId,true);
  assertTrue(res);
  delete=new Delete(row1);
  delete.deleteColumn(fam1,qf1);
  delete.deleteColumn(fam1,qf1);
  res=region.checkAndMutate(row1,fam1,qf1,val2,delete,lockId,true);
  assertTrue(res);
  delete=new Delete(row1);
  res=region.checkAndMutate(row1,fam1,qf1,emptyVal,delete,lockId,true);
  assertTrue(res);
  put=new Put(row1);
  put.add(fam1,qf1,val1);
  res=region.checkAndMutate(row1,fam1,qf1,null,put,lockId,true);
  assertTrue(res);
}
