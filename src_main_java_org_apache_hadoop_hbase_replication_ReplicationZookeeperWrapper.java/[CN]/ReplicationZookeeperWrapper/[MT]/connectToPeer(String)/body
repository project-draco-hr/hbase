{
  String[] ensemble=Bytes.toString(this.zookeeperWrapper.getData(this.peersZNode,peerId)).split(":");
  if (ensemble.length != 3) {
    throw new IllegalArgumentException("Wrong format of cluster address: " + this.zookeeperWrapper.getData(this.peersZNode,peerId));
  }
  Configuration otherConf=new Configuration(this.conf);
  otherConf.set(HConstants.ZOOKEEPER_QUORUM,ensemble[0]);
  otherConf.set("hbase.zookeeper.property.clientPort",ensemble[1]);
  otherConf.set(HConstants.ZOOKEEPER_ZNODE_PARENT,ensemble[2]);
  ZooKeeperWrapper zkw=ZooKeeperWrapper.createInstance(otherConf,"connection to cluster: " + peerId);
  zkw.registerListener(new ReplicationStatusWatcher());
  this.peerClusters.put(peerId,zkw);
  this.zookeeperWrapper.ensureExists(this.zookeeperWrapper.getZNode(this.rsServerNameZnode,peerId));
  LOG.info("Added new peer cluster " + StringUtils.arrayToString(ensemble));
}
