{
  if (!fs.exists(dir)) {
    fs.mkdirs(dir);
  }
  Path path=getUniqueFile(fs,dir);
  return new HFile.Writer(fs,path,blocksize,algorithm == null ? HFile.DEFAULT_COMPRESSION : algorithm,c == null ? HStoreKey.BYTECOMPARATOR : c);
}
