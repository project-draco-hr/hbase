{
  if (!fs.exists(dir)) {
    fs.mkdirs(dir);
  }
  Path path=getUniqueFile(fs,dir);
  return new HFile.Writer(fs,path,blocksize,algorithm == null ? HFile.DEFAULT_COMPRESSION_ALGORITHM : algorithm,c == null ? new HStoreKey.StoreKeyComparator() : c,bloomfilter);
}
