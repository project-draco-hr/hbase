{
  if (this.reader != null) {
    throw new IllegalAccessError("Already open");
  }
  if (isReference()) {
    this.reader=new HalfHFileReader(this.fs,this.referencePath,getBlockCache(),this.reference);
  }
 else {
    this.reader=new StoreFileReader(this.fs,this.path,getBlockCache());
  }
  Map<byte[],byte[]> map=this.reader.loadFileInfo();
  byte[] b=map.get(MAX_SEQ_ID_KEY);
  if (b != null) {
    this.sequenceid=Bytes.toLong(b);
    if (isReference()) {
      if (Reference.isTopFileRegion(this.reference.getFileRegion())) {
        this.sequenceid+=1;
      }
    }
  }
  b=map.get(MAJOR_COMPACTION_KEY);
  if (b != null) {
    boolean mc=Bytes.toBoolean(b);
    if (this.majorCompaction == null) {
      this.majorCompaction=new AtomicBoolean(mc);
    }
 else {
      this.majorCompaction.set(mc);
    }
  }
  return this.reader;
}
