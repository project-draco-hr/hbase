{
  MobFileName mobFileName=MobFileName.create(startKey,date,UUID.randomUUID().toString().replaceAll("-",""));
  final CacheConfig writerCacheConf=mobCacheConfig;
  HFileContext hFileContext=new HFileContextBuilder().withCompression(compression).withIncludesMvcc(false).withIncludesTags(true).withChecksumType(HFile.DEFAULT_CHECKSUM_TYPE).withBytesPerCheckSum(HFile.DEFAULT_BYTES_PER_CHECKSUM).withBlockSize(getFamily().getBlocksize()).withHBaseCheckSum(true).withDataBlockEncoding(getFamily().getDataBlockEncoding()).build();
  StoreFile.Writer w=new StoreFile.WriterBuilder(conf,writerCacheConf,region.getFilesystem()).withFilePath(new Path(basePath,mobFileName.getFileName())).withComparator(KeyValue.COMPARATOR).withBloomType(BloomType.NONE).withMaxKeyCount(maxKeyCount).withFileContext(hFileContext).build();
  return w;
}
