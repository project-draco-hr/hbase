{
  UserProvider userProvider=UserProvider.instantiate(job.getConfiguration());
  if (userProvider.isHBaseSecurityEnabled()) {
    try {
      Configuration peerConf=HBaseConfiguration.create(job.getConfiguration());
      ZKUtil.applyClusterKeyToConf(peerConf,quorumAddress);
      obtainAuthTokenForJob(job,peerConf,userProvider.getCurrent());
    }
 catch (    InterruptedException e) {
      LOG.info("Interrupted obtaining user authentication token");
      Thread.interrupted();
    }
  }
}
