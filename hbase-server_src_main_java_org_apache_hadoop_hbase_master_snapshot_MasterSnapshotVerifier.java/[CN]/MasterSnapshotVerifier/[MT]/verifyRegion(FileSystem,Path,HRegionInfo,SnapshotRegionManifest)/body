{
  HRegionInfo manifestRegionInfo=HRegionInfo.convert(manifest.getRegionInfo());
  if (!region.equals(manifestRegionInfo)) {
    String msg="Manifest region info " + manifestRegionInfo + "doesn't match expected region:"+ region;
    throw new CorruptedSnapshotException(msg,snapshot);
  }
  SnapshotReferenceUtil.visitRegionStoreFiles(manifest,new SnapshotReferenceUtil.StoreFileVisitor(){
    @Override public void storeFile(    final HRegionInfo regionInfo,    final String family,    final SnapshotRegionManifest.StoreFile storeFile) throws IOException {
      SnapshotReferenceUtil.verifyStoreFile(services.getConfiguration(),fs,snapshotDir,snapshot,region,family,storeFile);
    }
  }
);
}
