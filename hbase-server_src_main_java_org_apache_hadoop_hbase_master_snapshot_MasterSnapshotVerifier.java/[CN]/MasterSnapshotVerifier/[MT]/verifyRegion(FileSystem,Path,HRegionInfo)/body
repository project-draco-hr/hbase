{
  Path regionDir=new Path(snapshotDir,region.getEncodedName());
  Path regionInfo=new Path(regionDir,HRegionFileSystem.REGION_INFO_FILE);
  if (!fs.exists(regionInfo)) {
    throw new CorruptedSnapshotException("No region info found for region:" + region,snapshot);
  }
  HRegionInfo found=HRegionFileSystem.loadRegionInfoFileContent(fs,regionDir);
  if (!region.equals(found)) {
    throw new CorruptedSnapshotException("Found region info (" + found + ") doesn't match expected region:"+ region,snapshot);
  }
  TakeSnapshotUtils.verifyRecoveredEdits(fs,snapshotDir,found,snapshot);
  SnapshotReferenceUtil.visitRegionStoreFiles(fs,regionDir,new FSVisitor.StoreFileVisitor(){
    public void storeFile(    final String regionNameSuffix,    final String family,    final String hfileName) throws IOException {
      verifyStoreFile(snapshotDir,region,family,hfileName);
    }
  }
);
}
