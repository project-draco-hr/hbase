{
  lock.readLock().lock();
  try {
    this.result.clear();
    this.idx=0;
    KeyValue kvsetNextRow=cacheNextRow(kvset);
    KeyValue snapshotNextRow=cacheNextRow(snapshot);
    if (kvsetNextRow == null && snapshotNextRow == null) {
      this.firstOnNextRow.set(null);
      return !this.result.isEmpty();
    }
 else     if (kvsetNextRow != null && snapshotNextRow != null) {
      int compare=comparator.compare(kvsetNextRow,snapshotNextRow);
      this.firstOnNextRow.set(compare <= 0 ? kvsetNextRow : snapshotNextRow);
    }
 else {
      this.firstOnNextRow.set(kvsetNextRow != null ? kvsetNextRow : snapshotNextRow);
    }
    return true;
  }
  finally {
    lock.readLock().unlock();
  }
}
