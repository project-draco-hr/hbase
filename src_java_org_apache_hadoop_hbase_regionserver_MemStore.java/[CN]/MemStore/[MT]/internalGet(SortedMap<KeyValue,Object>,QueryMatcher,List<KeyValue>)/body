{
  if (map.isEmpty())   return false;
  SortedMap<KeyValue,Object> tail=map.tailMap(matcher.getStartKey());
  for (  Map.Entry<KeyValue,Object> entry : tail.entrySet()) {
    QueryMatcher.MatchCode res=matcher.match(entry.getKey());
switch (res) {
case INCLUDE:
      result.add(entry.getKey());
    break;
case SKIP:
  break;
case NEXT:
return false;
case DONE:
return true;
default :
throw new RuntimeException("Unexpected " + res);
}
}
return false;
}
