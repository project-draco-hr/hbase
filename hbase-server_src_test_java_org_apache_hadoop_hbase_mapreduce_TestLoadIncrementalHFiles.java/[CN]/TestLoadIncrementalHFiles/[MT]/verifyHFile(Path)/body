{
  Configuration configuration=util.getConfiguration();
  HFile.Reader reader=HFile.createReader(p.getFileSystem(configuration),p,new CacheConfig(configuration));
  reader.loadFileInfo();
  HFileScanner scanner=reader.getScanner(false,false);
  scanner.seekTo();
  int count=0;
  do {
    count++;
  }
 while (scanner.next());
  assertTrue(count > 0);
  reader.close();
  return count;
}
