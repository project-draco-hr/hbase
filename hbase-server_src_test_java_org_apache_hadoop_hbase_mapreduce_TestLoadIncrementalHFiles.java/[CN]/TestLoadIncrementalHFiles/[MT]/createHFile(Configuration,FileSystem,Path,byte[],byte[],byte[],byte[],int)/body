{
  HFile.Writer writer=HFile.getWriterFactory(configuration,new CacheConfig(configuration)).withPath(fs,path).withBlockSize(BLOCKSIZE).withCompression(COMPRESSION).withComparator(KeyValue.KEY_COMPARATOR).create();
  long now=System.currentTimeMillis();
  try {
    for (    byte[] key : Bytes.iterateOnSplits(startKey,endKey,numRows - 2)) {
      KeyValue kv=new KeyValue(key,family,qualifier,now,key);
      writer.append(kv);
    }
  }
  finally {
    writer.appendFileInfo(StoreFile.BULKLOAD_TIME_KEY,Bytes.toBytes(System.currentTimeMillis()));
    writer.close();
  }
}
