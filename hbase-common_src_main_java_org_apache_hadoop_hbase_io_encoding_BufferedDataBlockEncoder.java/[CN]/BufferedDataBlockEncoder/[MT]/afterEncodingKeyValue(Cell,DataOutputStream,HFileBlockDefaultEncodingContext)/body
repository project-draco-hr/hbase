{
  int size=0;
  if (encodingCtx.getHFileContext().isIncludesTags()) {
    int tagsLength=cell.getTagsLength();
    ByteBufferUtils.putCompressedInt(out,tagsLength);
    if (tagsLength > 0) {
      TagCompressionContext tagCompressionContext=encodingCtx.getTagCompressionContext();
      if (tagCompressionContext != null) {
        tagCompressionContext.compressTags(out,cell.getTagsArray(),cell.getTagsOffset(),tagsLength);
      }
 else {
        out.write(cell.getTagsArray(),cell.getTagsOffset(),tagsLength);
      }
    }
    size+=tagsLength + KeyValue.TAGS_LENGTH_SIZE;
  }
  if (encodingCtx.getHFileContext().isIncludesMvcc()) {
    long memstoreTS=cell.getSequenceId();
    WritableUtils.writeVLong(out,memstoreTS);
    size+=WritableUtils.getVIntSize(memstoreTS);
  }
  return size;
}
