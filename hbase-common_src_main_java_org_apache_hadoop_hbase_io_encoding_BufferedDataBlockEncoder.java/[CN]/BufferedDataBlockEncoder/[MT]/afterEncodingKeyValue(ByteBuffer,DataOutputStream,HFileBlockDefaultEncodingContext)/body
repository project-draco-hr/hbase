{
  if (encodingCtx.getHFileContext().shouldIncludeTags()) {
    short tagsLength=in.getShort();
    ByteBufferUtils.putCompressedInt(out,tagsLength);
    if (tagsLength > 0) {
      TagCompressionContext tagCompressionContext=encodingCtx.getTagCompressionContext();
      if (tagCompressionContext != null) {
        tagCompressionContext.compressTags(out,in,tagsLength);
      }
 else {
        ByteBufferUtils.moveBufferToStream(out,in,tagsLength);
      }
    }
  }
  if (encodingCtx.getHFileContext().shouldIncludeMvcc()) {
    long memstoreTS=-1;
    try {
      memstoreTS=ByteBufferUtils.readVLong(in);
      WritableUtils.writeVLong(out,memstoreTS);
    }
 catch (    IOException ex) {
      throw new RuntimeException("Unable to copy memstore timestamp " + memstoreTS + " after encoding a key/value");
    }
  }
}
