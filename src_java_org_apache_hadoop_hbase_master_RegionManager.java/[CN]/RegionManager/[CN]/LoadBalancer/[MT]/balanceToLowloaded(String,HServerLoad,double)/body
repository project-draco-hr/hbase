{
  SortedMap<HServerLoad,Set<String>> loadToServers=master.serverManager.getLoadToServers();
  if (!loadToServers.get(loadToServers.lastKey()).contains(srvName))   return 0;
  int avgLoadMinusSlop=(int)Math.floor(avgLoad * (1 - this.slop)) - 1;
  int lowestLoad=loadToServers.firstKey().getNumberOfRegions();
  if (lowestLoad >= avgLoadMinusSlop)   return 0;
  int lowSrvCount=loadToServers.get(loadToServers.firstKey()).size();
  int numRegionsToClose=0;
  int numSrvRegs=srvLoad.getNumberOfRegions();
  int numMoveToLowLoaded=(avgLoadMinusSlop - lowestLoad) * lowSrvCount;
  numRegionsToClose=numSrvRegs - (int)Math.ceil(avgLoad);
  numRegionsToClose=Math.min(numRegionsToClose,numMoveToLowLoaded);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Server " + srvName + " will be unloaded for "+ "balance. Server load: "+ numSrvRegs+ " avg: "+ avgLoad+ ", regions can be moved: "+ numMoveToLowLoaded+ ". Regions to close: "+ numRegionsToClose);
  }
  return numRegionsToClose;
}
