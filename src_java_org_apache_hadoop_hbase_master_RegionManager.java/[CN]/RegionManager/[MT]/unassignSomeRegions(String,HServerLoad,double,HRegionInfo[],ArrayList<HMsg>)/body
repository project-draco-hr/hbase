{
  int numRegionsToClose=load.getNumberOfRegions() - (int)Math.ceil(avgLoad);
  LOG.debug("Choosing to reassign " + numRegionsToClose + " regions. mostLoadedRegions has "+ mostLoadedRegions.length+ " regions in it.");
  int regionIdx=0;
  int regionsClosed=0;
  int skipped=0;
  while (regionsClosed < numRegionsToClose && regionIdx < mostLoadedRegions.length) {
    HRegionInfo currentRegion=mostLoadedRegions[regionIdx];
    regionIdx++;
    if (currentRegion.isRootRegion() || currentRegion.isMetaTable()) {
      continue;
    }
    byte[] regionName=currentRegion.getRegionName();
    if (regionIsInTransition(regionName)) {
      skipped++;
      continue;
    }
    LOG.debug("Going to close region " + currentRegion.getRegionNameAsString());
    returnMsgs.add(new HMsg(HMsg.Type.MSG_REGION_CLOSE,currentRegion,OVERLOADED));
    setClosing(serverName,currentRegion,false);
    setPendingClose(currentRegion.getRegionName());
    regionsClosed++;
  }
  LOG.info("Skipped " + skipped + " region(s) that are in transition states");
}
