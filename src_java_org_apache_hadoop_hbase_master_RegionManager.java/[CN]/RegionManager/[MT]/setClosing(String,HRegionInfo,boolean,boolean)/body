{
synchronized (this.regionsInTransition) {
    RegionState s=this.regionsInTransition.get(regionInfo.getRegionName());
    if (check && s != null) {
      if (!s.isClosing()) {
        throw new IllegalStateException("Cannot transition to closing from any other state. Region: " + Bytes.toString(regionInfo.getRegionName()));
      }
      return;
    }
    s=new RegionState(regionInfo);
    s.setClosing(serverName,setOffline);
    this.regionsInTransition.put(regionInfo.getRegionName(),s);
  }
}
