{
  String regionName=rs.getRegionInfo().getRegionNameAsString();
  LOG.info("Assigning region " + regionName + " to "+ sinfo.getServerName());
  rs.setPendingOpen(sinfo.getServerName());
  this.regionsInTransition.put(regionName,rs);
  try {
    master.toDoQueue.put(new RegionServerOperation(master){
      protected boolean process() throws IOException {
        if (!rootAvailable() || !metaTableAvailable()) {
          return true;
        }
        historian.addRegionAssignment(rs.getRegionInfo(),sinfo.getServerName());
        return true;
      }
      public String toString(){
        return "RegionAssignmentHistorian from " + sinfo.getServerName();
      }
    }
);
  }
 catch (  InterruptedException e) {
    LOG.info("doRegionAssignment: Couldn't queue the region historian due to exception: " + e);
  }
  returnMsgs.add(new HMsg(HMsg.Type.MSG_REGION_OPEN,rs.getRegionInfo()));
}
