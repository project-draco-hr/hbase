{
  HServerLoad thisServersLoad=info.getLoad();
  boolean isSingleServer=this.master.numServers() == 1;
  Set<RegionState> regionsToAssign=regionsAwaitingAssignment(info.getServerAddress(),isSingleServer);
  if (regionsToAssign.size() == 0) {
    if (!inSafeMode()) {
      loadBalancer.loadBalancing(info,mostLoadedRegions,returnMsgs);
    }
  }
 else {
    if (isSingleServer) {
      assignRegionsToOneServer(regionsToAssign,info,returnMsgs);
    }
 else {
      assignRegionsToMultipleServers(thisServersLoad,regionsToAssign,info,returnMsgs);
    }
  }
}
