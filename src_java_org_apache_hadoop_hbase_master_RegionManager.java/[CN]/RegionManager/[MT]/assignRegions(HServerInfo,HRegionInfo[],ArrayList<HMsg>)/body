{
  HServerLoad thisServersLoad=info.getLoad();
  Set<RegionState> regionsToAssign=regionsAwaitingAssignment();
  if (regionsToAssign.size() == 0) {
    if (!inSafeMode()) {
      double avgLoad=master.serverManager.getAverageLoad();
      double avgLoadWithSlop=avgLoad + ((this.slop != 0) ? avgLoad * this.slop : avgLoad);
      if (avgLoad > 2.0 && thisServersLoad.getNumberOfRegions() > avgLoadWithSlop) {
        if (LOG.isDebugEnabled()) {
          LOG.debug("Server " + info.getServerName() + " is overloaded. Server load: "+ thisServersLoad.getNumberOfRegions()+ " avg: "+ avgLoad+ ", slop: "+ this.slop);
        }
        unassignSomeRegions(info,thisServersLoad,avgLoad,mostLoadedRegions,returnMsgs);
      }
    }
  }
 else {
    if (master.serverManager.numServers() == 1) {
      assignRegionsToOneServer(regionsToAssign,info,returnMsgs);
    }
 else {
      assignRegionsToMultipleServers(thisServersLoad,regionsToAssign,info,returnMsgs);
    }
  }
}
