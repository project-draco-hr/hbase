{
  byte[] firstMetaRegion=null;
  Set<MetaRegion> metaRegions=new HashSet<MetaRegion>();
  if (Bytes.equals(tableName,HConstants.META_TABLE_NAME)) {
    if (rootRegionLocation.get() == null) {
      throw new NotAllMetaRegionsOnlineException(Bytes.toString(HConstants.ROOT_TABLE_NAME));
    }
    metaRegions.add(new MetaRegion(rootRegionLocation.get(),HRegionInfo.ROOT_REGIONINFO.getRegionName()));
  }
 else {
    if (!areAllMetaRegionsOnline()) {
      throw new NotAllMetaRegionsOnlineException();
    }
synchronized (onlineMetaRegions) {
      if (onlineMetaRegions.size() == 1) {
        firstMetaRegion=onlineMetaRegions.firstKey();
      }
 else       if (onlineMetaRegions.containsKey(tableName)) {
        firstMetaRegion=tableName;
      }
 else {
        firstMetaRegion=onlineMetaRegions.headMap(tableName).lastKey();
      }
      metaRegions.addAll(onlineMetaRegions.tailMap(firstMetaRegion).values());
    }
  }
  return metaRegions;
}
