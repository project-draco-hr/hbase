{
  int numRegionsToClose=load.getNumberOfRegions() - (int)Math.ceil(avgLoad);
  LOG.debug("Choosing to reassign " + numRegionsToClose + " regions. mostLoadedRegions has "+ mostLoadedRegions.length+ " regions in it.");
  int regionIdx=0;
  int regionsClosed=0;
  while (regionsClosed < numRegionsToClose && regionIdx < mostLoadedRegions.length) {
    HRegionInfo currentRegion=mostLoadedRegions[regionIdx];
    regionIdx++;
    if (currentRegion.isRootRegion() || currentRegion.isMetaTable()) {
      continue;
    }
    if (isClosing(currentRegion.getRegionName())) {
      LOG.info("Skipping region " + currentRegion.getRegionName() + " because it is already closing.");
      continue;
    }
    LOG.debug("Going to close region " + currentRegion.getRegionName());
    returnMsgs.add(new HMsg(HMsg.MSG_REGION_CLOSE,currentRegion));
    setClosing(currentRegion.getRegionName());
    regionsClosed++;
  }
}
