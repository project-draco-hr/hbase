{
  int numRegionsToClose=load.getNumberOfRegions() - (int)Math.ceil(avgLoad);
  LOG.debug("Choosing to reassign " + numRegionsToClose + " regions. mostLoadedRegions has "+ mostLoadedRegions.length+ " regions in it.");
  int regionIdx=0;
  int regionsClosed=0;
  int skippedClosing=0;
  while (regionsClosed < numRegionsToClose && regionIdx < mostLoadedRegions.length) {
    HRegionInfo currentRegion=mostLoadedRegions[regionIdx];
    regionIdx++;
    if (currentRegion.isRootRegion() || currentRegion.isMetaTable()) {
      continue;
    }
    if (isClosing(currentRegion.getRegionName())) {
      skippedClosing++;
      continue;
    }
    LOG.debug("Going to close region " + currentRegion.getRegionNameAsString());
    returnMsgs.add(new HMsg(HMsg.Type.MSG_REGION_CLOSE,currentRegion,OVERLOADED));
    setClosing(currentRegion.getRegionName());
    regionsClosed++;
  }
  LOG.info("Skipped " + skippedClosing + " region(s) as already closing");
}
