{
  long now=System.currentTimeMillis();
  Set<HRegionInfo> regionsToAssign=new HashSet<HRegionInfo>();
  for (  Map.Entry<HRegionInfo,Long> e : unassignedRegions.entrySet()) {
    HRegionInfo i=e.getKey();
    if (numberOfMetaRegions.get() != onlineMetaRegions.size() && !i.isMetaRegion()) {
      continue;
    }
    long diff=now - e.getValue().longValue();
    if (diff > master.maxRegionOpenTime) {
      regionsToAssign.add(e.getKey());
    }
  }
  return regionsToAssign;
}
