{
  Set<RegionState> regionsToAssign=new HashSet<RegionState>();
  for (  RegionState s : regionsInTransition.values()) {
    HRegionInfo i=s.getRegionInfo();
    if (i == null) {
      continue;
    }
    if (numberOfMetaRegions.get() != onlineMetaRegions.size() && !i.isMetaRegion()) {
      continue;
    }
    if (!s.isAssigned() && !s.isClosing() && !s.isPending()) {
      s.setUnassigned();
      regionsToAssign.add(s);
    }
  }
  return regionsToAssign;
}
