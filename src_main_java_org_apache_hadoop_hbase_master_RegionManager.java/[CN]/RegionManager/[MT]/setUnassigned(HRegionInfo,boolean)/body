{
  RegionState s=null;
synchronized (this.regionsInTransition) {
    s=regionsInTransition.get(info.getRegionNameAsString());
    if (s == null) {
      byte[] data=null;
      try {
        data=Writables.getBytes(new RegionTransitionEventData(HBaseEventType.M2ZK_REGION_OFFLINE,HMaster.MASTER));
      }
 catch (      IOException e) {
        LOG.error("Error creating event data for " + HBaseEventType.M2ZK_REGION_OFFLINE,e);
      }
      zkWrapper.createOrUpdateUnassignedRegion(info.getEncodedName(),data);
      LOG.debug("Created/updated UNASSIGNED zNode " + info.getRegionNameAsString() + " in state "+ HBaseEventType.M2ZK_REGION_OFFLINE);
      s=new RegionState(info,RegionState.State.UNASSIGNED);
      regionsInTransition.put(info.getRegionNameAsString(),s);
    }
  }
  if (force || (!s.isPendingOpen() && !s.isOpen())) {
    s.setUnassigned();
  }
}
