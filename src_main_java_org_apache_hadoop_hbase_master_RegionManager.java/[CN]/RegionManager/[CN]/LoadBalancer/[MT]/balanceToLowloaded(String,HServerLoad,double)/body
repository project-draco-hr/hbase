{
  SortedMap<HServerLoad,Set<String>> loadToServers=master.getLoadToServers();
  if (!loadToServers.get(loadToServers.lastKey()).contains(srvName))   return 0;
  int avgLoadMinusSlop=(int)Math.floor(avgLoad * (1 - this.slop)) - 1;
  int lowestLoad=loadToServers.firstKey().getNumberOfRegions();
  if (lowestLoad >= avgLoadMinusSlop)   return 0;
  int lowSrvCount=loadToServers.get(loadToServers.firstKey()).size();
  int numRegionsToClose=0;
  int numSrvRegs=srvLoad.getNumberOfRegions();
  int numMoveToLowLoaded=(avgLoadMinusSlop - lowestLoad) * lowSrvCount;
  numRegionsToClose=numSrvRegs - (int)Math.ceil(avgLoad);
  numRegionsToClose=Math.min(numRegionsToClose,numMoveToLowLoaded);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Server(s) are carrying only " + lowestLoad + " regions. "+ "Server "+ srvName+ " is most loaded ("+ numSrvRegs+ "). Shedding "+ numRegionsToClose+ " regions to pass to "+ " least loaded (numMoveToLowLoaded="+ numMoveToLowLoaded+ ")");
  }
  return numRegionsToClose;
}
