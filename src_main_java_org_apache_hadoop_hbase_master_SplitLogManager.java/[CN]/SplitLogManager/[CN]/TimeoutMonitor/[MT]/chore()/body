{
  int resubmitted=0;
  int unassigned=0;
  int tot=0;
  boolean found_assigned_task=false;
  for (  Map.Entry<String,Task> e : tasks.entrySet()) {
    String path=e.getKey();
    Task task=e.getValue();
    tot++;
    if (task.isUnassigned()) {
      unassigned++;
      continue;
    }
    found_assigned_task=true;
    if (resubmit(path,task,false)) {
      resubmitted++;
    }
  }
  if (tot > 0) {
    LOG.debug("total tasks = " + tot + " unassigned = "+ unassigned);
  }
  if (resubmitted > 0) {
    LOG.info("resubmitted " + resubmitted + " out of "+ tot+ " tasks");
  }
  if (tot > 0 && !found_assigned_task && ((EnvironmentEdgeManager.currentTimeMillis() - lastNodeCreateTime) > unassignedTimeout)) {
    createRescanNode(Long.MAX_VALUE);
    tot_mgr_resubmit_unassigned.incrementAndGet();
    LOG.debug("resubmitting unassigned task(s) after timeout");
  }
}
