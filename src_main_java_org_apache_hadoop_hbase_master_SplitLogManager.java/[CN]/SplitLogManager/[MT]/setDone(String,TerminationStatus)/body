{
  if (!ZKSplitLog.isRescanNode(watcher,path)) {
    if (status == SUCCESS) {
      tot_mgr_log_split_success.incrementAndGet();
      LOG.info("Done splitting " + path);
    }
 else {
      tot_mgr_log_split_err.incrementAndGet();
      LOG.warn("Error splitting " + path);
    }
  }
  boolean safeToDeleteNodeAsync=true;
  Task task=tasks.get(path);
  if (task == null) {
    if (!ZKSplitLog.isRescanNode(watcher,path)) {
      tot_mgr_unacquired_orphan_done.incrementAndGet();
      LOG.debug("unacquired orphan task is done " + path);
    }
  }
 else {
synchronized (task) {
      task.deleted=true;
      if (!task.isOrphan()) {
        if (status != SUCCESS) {
          safeToDeleteNodeAsync=false;
          deleteNodeNow(path);
        }
synchronized (task.batch) {
          if (status == SUCCESS) {
            task.batch.done++;
          }
 else {
            task.batch.error++;
          }
          task.batch.notify();
        }
      }
    }
  }
  if (safeToDeleteNodeAsync) {
    deleteNode(path,Long.MAX_VALUE);
  }
  return;
}
