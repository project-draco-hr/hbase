{
  Task oldtask;
  oldtask=tasks.putIfAbsent(path,new Task(batch));
  if (oldtask != null) {
synchronized (oldtask) {
      batch.installed--;
      if (oldtask.isOrphan()) {
        if (oldtask.deleted) {
          return (null);
        }
        LOG.info("Previously orphan task " + path + " is now being waited upon");
        oldtask.setBatch(batch);
        return (null);
      }
    }
  }
  return oldtask;
}
