{
  for (  String peer : peers) {
    String peerZnode=ZKUtil.joinZNode(znode,peer);
    byte[] data=ZKUtil.getData(zkw,peerZnode);
    if (!ProtobufUtil.isPBMagicPrefix(data)) {
      migrateClusterKeyToPB(zkw,peerZnode,data);
    }
    String peerStatePath=ZKUtil.joinZNode(peerZnode,getConf().get("zookeeper.znode.replication.peers.state","peer-state"));
    if (ZKUtil.checkExists(zkw,peerStatePath) != -1) {
      data=ZKUtil.getData(zkw,peerStatePath);
      if (ProtobufUtil.isPBMagicPrefix(data))       continue;
      migratePeerStateToPB(zkw,data,peerStatePath);
    }
  }
}
