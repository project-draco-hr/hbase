{
  if (currentWriter != null && !isKvAfterCurrentWriter(kv))   return;
  stopUsingCurrentWriter();
  while (isKvAfterCurrentWriter(kv)) {
    checkCanCreateWriter();
    createEmptyWriter();
  }
  checkCanCreateWriter();
  hasAnyWriter=true;
  currentWriter=writerFactory.createWriter();
  existingWriters.add(currentWriter);
}
