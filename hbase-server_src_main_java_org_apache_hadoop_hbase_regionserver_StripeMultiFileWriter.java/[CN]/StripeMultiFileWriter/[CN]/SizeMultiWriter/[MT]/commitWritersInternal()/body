{
  if (LOG.isDebugEnabled()) {
    LOG.debug("Stopping with " + kvsInCurrentWriter + " kvs in last writer"+ ((this.sourceScanner == null) ? "" : ("; observed estimated " + this.sourceScanner.getEstimatedNumberOfKvsScanned() + " KVs total")));
  }
  if (lastKv != null) {
    sanityCheckRight(right,lastKv.getRowArray(),lastKv.getRowOffset(),lastKv.getRowLength());
  }
  if (existingWriters.isEmpty() && 1 == targetCount) {
    if (LOG.isDebugEnabled()) {
      LOG.debug("Merge expired stripes into one, create an empty file to preserve metadata.");
    }
    boundaries.add(left);
    existingWriters.add(writerFactory.createWriter());
  }
  this.boundaries.add(right);
}
