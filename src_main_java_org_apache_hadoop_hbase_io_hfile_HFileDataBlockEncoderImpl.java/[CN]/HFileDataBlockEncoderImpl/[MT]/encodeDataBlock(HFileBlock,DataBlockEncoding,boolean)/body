{
  ByteBuffer compressedBuffer=encodeBufferToHFileBlockBuffer(block.getBufferWithoutHeader(),algo,includesMemstoreTS);
  int sizeWithoutHeader=compressedBuffer.limit() - HFileBlock.HEADER_SIZE;
  HFileBlock encodedBlock=new HFileBlock(BlockType.ENCODED_DATA,block.getOnDiskSizeWithoutHeader(),sizeWithoutHeader,block.getPrevBlockOffset(),compressedBuffer,HFileBlock.FILL_HEADER,block.getOffset(),includesMemstoreTS);
  block.passSchemaMetricsTo(encodedBlock);
  return encodedBlock;
}
