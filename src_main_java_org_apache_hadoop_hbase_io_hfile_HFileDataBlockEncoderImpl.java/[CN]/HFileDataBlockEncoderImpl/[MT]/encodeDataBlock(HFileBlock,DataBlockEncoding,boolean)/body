{
  ByteBuffer compressedBuffer=encodeBufferToHFileBlockBuffer(block.getBufferWithoutHeader(),algo,includesMemstoreTS,HFileBlock.DUMMY_HEADER);
  int sizeWithoutHeader=compressedBuffer.limit() - block.headerSize();
  HFileBlock encodedBlock=new HFileBlock(BlockType.ENCODED_DATA,block.getOnDiskSizeWithoutHeader(),sizeWithoutHeader,block.getPrevBlockOffset(),compressedBuffer,HFileBlock.FILL_HEADER,block.getOffset(),includesMemstoreTS,block.getMinorVersion(),block.getBytesPerChecksum(),block.getChecksumType(),block.getOnDiskDataSizeWithHeader());
  block.passSchemaMetricsTo(encodedBlock);
  return encodedBlock;
}
