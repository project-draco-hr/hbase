{
  this.uncompressedBytesWithHeader=uncompressedBytesWithHeader;
  if (compressionAlgorithm != NONE) {
    compressedByteStream.reset();
    compressedByteStream.write(headerBytes);
    compressionStream.resetState();
    compressionStream.write(uncompressedBytesWithHeader,headerBytes.length,uncompressedBytesWithHeader.length - headerBytes.length);
    compressionStream.flush();
    compressionStream.finish();
    onDiskBytesWithHeader=compressedByteStream.toByteArray();
  }
 else {
    onDiskBytesWithHeader=uncompressedBytesWithHeader;
  }
  this.blockType=blockType;
}
