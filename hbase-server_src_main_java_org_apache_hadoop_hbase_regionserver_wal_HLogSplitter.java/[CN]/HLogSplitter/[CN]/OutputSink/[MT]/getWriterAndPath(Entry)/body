{
  byte region[]=entry.getKey().getEncodedRegionName();
  WriterAndPath ret=logWriters.get(region);
  if (ret != null) {
    return ret;
  }
  if (blacklistedRegions.contains(region)) {
    return null;
  }
  String tmpName=distributedLogSplittingHelper == null ? null : distributedLogSplittingHelper.getTmpDirName();
  ret=createWAP(region,entry,rootDir,tmpName,fs,conf);
  if (ret == null) {
    blacklistedRegions.add(region);
    return null;
  }
  logWriters.put(region,ret);
  return ret;
}
