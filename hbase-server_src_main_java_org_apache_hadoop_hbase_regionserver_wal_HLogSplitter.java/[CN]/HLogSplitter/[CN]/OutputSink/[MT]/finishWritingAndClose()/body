{
  LOG.info("Waiting for split writer threads to finish");
  try {
    for (    WriterThread t : writerThreads) {
      t.finish();
    }
    for (    WriterThread t : writerThreads) {
      try {
        t.join();
      }
 catch (      InterruptedException ie) {
        throw new IOException(ie);
      }
      checkForErrors();
    }
    LOG.info("Split writers finished");
    return closeStreams();
  }
  finally {
    List<IOException> thrown=closeLogWriters(null);
    if (thrown != null && !thrown.isEmpty()) {
      throw MultipleIOException.createIOException(thrown);
    }
  }
}
