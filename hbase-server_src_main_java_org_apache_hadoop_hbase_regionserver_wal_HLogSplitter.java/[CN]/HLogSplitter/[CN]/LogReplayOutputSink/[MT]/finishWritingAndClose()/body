{
  List<Path> result=new ArrayList<Path>();
  try {
    if (!finishWriting()) {
      return null;
    }
    if (hasEditsInDisablingOrDisabledTables) {
      result=logRecoveredEditsOutputSink.finishWritingAndClose();
    }
    return result;
  }
  finally {
    List<IOException> thrown=closeRegionServerWriters();
    if (thrown != null && !thrown.isEmpty()) {
      throw MultipleIOException.createIOException(thrown);
    }
  }
}
