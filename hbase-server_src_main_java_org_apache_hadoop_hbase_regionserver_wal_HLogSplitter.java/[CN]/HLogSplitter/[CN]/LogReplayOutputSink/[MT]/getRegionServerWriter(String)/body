{
  RegionServerWriter ret=writers.get(loc);
  if (ret != null) {
    return ret;
  }
  String tableName=getTableFromLocationStr(loc);
  if (tableName.isEmpty()) {
    LOG.warn("Invalid location string:" + loc + " found.");
  }
  HConnection hconn=getConnectionByTableName(Bytes.toBytes(tableName));
synchronized (writers) {
    ret=writers.get(loc);
    if (ret == null) {
      ret=new RegionServerWriter(conf,Bytes.toBytes(tableName),hconn);
      writers.put(loc,ret);
    }
  }
  return ret;
}
