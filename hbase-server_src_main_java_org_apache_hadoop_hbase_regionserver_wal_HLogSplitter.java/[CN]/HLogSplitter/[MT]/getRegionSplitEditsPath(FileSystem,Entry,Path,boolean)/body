{
  Path tableDir=HTableDescriptor.getTableDir(rootDir,logEntry.getKey().getTablename());
  Path regiondir=HRegion.getRegionDir(tableDir,Bytes.toString(logEntry.getKey().getEncodedRegionName()));
  Path dir=HLog.getRegionDirRecoveredEditsDir(regiondir);
  if (!fs.exists(regiondir)) {
    LOG.info("This region's directory doesn't exist: " + regiondir.toString() + ". It is very likely that it was"+ " already split so it's safe to discard those edits.");
    return null;
  }
  if (isCreate && !fs.exists(dir)) {
    if (!fs.mkdirs(dir))     LOG.warn("mkdir failed on " + dir);
  }
  String fileName=formatRecoveredEditsFileName(logEntry.getKey().getLogSeqNum());
  fileName=getTmpRecoveredEditsFileName(fileName);
  return new Path(dir,fileName);
}
