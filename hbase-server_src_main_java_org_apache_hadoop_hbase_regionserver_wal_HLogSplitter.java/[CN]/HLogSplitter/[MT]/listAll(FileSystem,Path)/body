{
  List<FileStatus> fset=new ArrayList<FileStatus>(100);
  FileStatus[] files=fs.exists(dir) ? fs.listStatus(dir) : null;
  if (files != null) {
    for (    FileStatus f : files) {
      if (f.isDir()) {
        fset.addAll(listAll(fs,f.getPath()));
      }
 else {
        fset.add(f);
      }
    }
  }
  return fset;
}
