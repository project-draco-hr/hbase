{
  boolean needAddRecoveryTag=true;
  if (cell.getTagsLength() > 0) {
    Tag tmpTag=Tag.getTag(cell.getTagsArray(),cell.getTagsOffset(),cell.getTagsLength(),TagType.LOG_REPLAY_TAG_TYPE);
    if (tmpTag != null) {
      needAddRecoveryTag=false;
    }
  }
  if (needAddRecoveryTag) {
    List<Tag> newTags=new ArrayList<Tag>();
    Tag replayTag=new Tag(TagType.LOG_REPLAY_TAG_TYPE,Bytes.toBytes(seqId));
    newTags.add(replayTag);
    if (cell.getTagsLength() > 0) {
      newTags.addAll(Tag.asList(cell.getTagsArray(),cell.getTagsOffset(),cell.getTagsLength()));
    }
    return new TagRewriteCell(cell,Tag.fromList(newTags));
  }
  return cell;
}
