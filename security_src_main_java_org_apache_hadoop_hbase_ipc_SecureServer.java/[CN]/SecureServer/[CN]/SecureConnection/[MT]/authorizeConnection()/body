{
  try {
    if (user != null && user.getUGI().getRealUser() != null && (authMethod != AuthMethod.DIGEST)) {
      ProxyUsers.authorize(user.getUGI(),this.getHostAddress(),conf);
    }
    authorize(user,header,getHostInetAddress());
    if (LOG.isDebugEnabled()) {
      LOG.debug("Successfully authorized " + header);
    }
    rpcMetrics.authorizationSuccesses.inc();
  }
 catch (  AuthorizationException ae) {
    LOG.debug("Connection authorization failed: " + ae.getMessage(),ae);
    rpcMetrics.authorizationFailures.inc();
    SecureCall failedCall=new SecureCall(AUTHORIZATION_FAILED_CALLID,null,this,null,0);
    failedCall.setResponse(null,Status.FATAL,ae.getClass().getName(),ae.getMessage());
    responder.doRespond(failedCall);
    return false;
  }
  return true;
}
