{
  Region region=env.getRegion();
  Configuration conf=HBaseConfiguration.create(env.getConfiguration());
  conf.setStrings("io.serializations",conf.get("io.serializations"),ResultSerialization.class.getName());
  try {
    Scan scan=validateKey(region.getRegionInfo(),ProtobufUtil.toScan(request.getScan()));
    ExportProtos.ExportResponse response=processData(conf,region,scan,getWriterOptions(conf,region.getRegionInfo(),request));
    done.run(response);
  }
 catch (  IOException e) {
    ResponseConverter.setControllerException(controller,e);
    LOG.error(e);
  }
}
