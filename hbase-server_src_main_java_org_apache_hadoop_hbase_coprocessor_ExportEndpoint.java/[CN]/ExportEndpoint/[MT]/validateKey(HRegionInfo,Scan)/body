{
  byte[] regionStartKey=region.getStartKey();
  byte[] originStartKey=scan.getStartRow();
  if (originStartKey == null || Bytes.compareTo(originStartKey,regionStartKey) < 0) {
    scan.setStartRow(regionStartKey);
  }
  byte[] regionEndKey=region.getEndKey();
  byte[] originEndKey=scan.getStopRow();
  if (originEndKey == null || Bytes.compareTo(originEndKey,regionEndKey) > 0) {
    scan.setStartRow(regionEndKey);
  }
  return scan;
}
