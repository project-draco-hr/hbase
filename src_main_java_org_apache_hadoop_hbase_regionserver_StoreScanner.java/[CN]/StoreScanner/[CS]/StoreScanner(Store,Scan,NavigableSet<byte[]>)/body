{
  this.store=store;
  this.cacheBlocks=scan.getCacheBlocks();
  matcher=new ScanQueryMatcher(scan,store.getFamily().getName(),columns,store.ttl,store.comparator.getRawComparator(),store.minVersions,store.versionsToReturn(scan.getMaxVersions()),false);
  this.isGet=scan.isGetScan();
  List<KeyValueScanner> scanners=getScanners(scan,columns);
  if (matcher.isExactColumnQuery()) {
    for (    KeyValueScanner scanner : scanners)     scanner.seekExactly(matcher.getStartKey(),false);
  }
 else {
    for (    KeyValueScanner scanner : scanners)     scanner.seek(matcher.getStartKey());
  }
  heap=new KeyValueHeap(scanners,store.comparator);
  this.store.addChangedReaderObserver(this);
}
