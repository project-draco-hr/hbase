{
  boolean memOnly;
  boolean filesOnly;
  if (scan instanceof InternalScan) {
    InternalScan iscan=(InternalScan)scan;
    memOnly=iscan.isCheckOnlyMemStore();
    filesOnly=iscan.isCheckOnlyStoreFiles();
  }
 else {
    memOnly=false;
    filesOnly=false;
  }
  List<KeyValueScanner> allStoreScanners=this.store.getScanners(cacheBlocks,isGet,false,this.matcher);
  List<KeyValueScanner> scanners=new ArrayList<KeyValueScanner>(allStoreScanners.size());
  for (  KeyValueScanner kvs : allStoreScanners) {
    if (kvs instanceof StoreFileScanner) {
      if (memOnly == false && ((StoreFileScanner)kvs).shouldSeek(scan,columns))       scanners.add(kvs);
    }
 else {
      if (filesOnly == false && this.store.memstore.shouldSeek(scan))       scanners.add(kvs);
    }
  }
  return scanners;
}
