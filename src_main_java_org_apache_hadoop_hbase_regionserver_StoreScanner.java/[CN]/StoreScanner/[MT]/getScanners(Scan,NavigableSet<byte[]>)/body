{
  boolean memOnly;
  boolean filesOnly;
  if (scan instanceof InternalScan) {
    InternalScan iscan=(InternalScan)scan;
    memOnly=iscan.isCheckOnlyMemStore();
    filesOnly=iscan.isCheckOnlyStoreFiles();
  }
 else {
    memOnly=false;
    filesOnly=false;
  }
  List<KeyValueScanner> scanners=new LinkedList<KeyValueScanner>();
  if (memOnly == false) {
    List<StoreFileScanner> sfScanners=StoreFileScanner.getScannersForStoreFiles(store.getStorefiles(),cacheBlocks,isGet);
    for (    StoreFileScanner sfs : sfScanners) {
      if (sfs.shouldSeek(scan,columns)) {
        scanners.add(sfs);
      }
    }
  }
  if ((filesOnly == false) && (this.store.memstore.shouldSeek(scan))) {
    scanners.addAll(this.store.memstore.getScanners());
  }
  return scanners;
}
