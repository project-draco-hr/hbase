{
  List<Pair<Path,Long>> files=new ArrayList<Pair<Path,Long>>();
  for (long i=0; i <= 20; i++) {
    files.add(new Pair<Path,Long>(new Path("file-" + i),i));
  }
  List<List<Path>> splits=ExportSnapshot.getBalancedSplits(files,5);
  assertEquals(5,splits.size());
  assertEquals(Arrays.asList(new Path("file-20"),new Path("file-11"),new Path("file-10"),new Path("file-1"),new Path("file-0")),splits.get(0));
  assertEquals(Arrays.asList(new Path("file-19"),new Path("file-12"),new Path("file-9"),new Path("file-2")),splits.get(1));
  assertEquals(Arrays.asList(new Path("file-18"),new Path("file-13"),new Path("file-8"),new Path("file-3")),splits.get(2));
  assertEquals(Arrays.asList(new Path("file-17"),new Path("file-14"),new Path("file-7"),new Path("file-4")),splits.get(3));
  assertEquals(Arrays.asList(new Path("file-16"),new Path("file-15"),new Path("file-6"),new Path("file-5")),splits.get(4));
}
