{
  System.out.println("Print table contents before map/reduce");
  scanTable(conf);
  @SuppressWarnings("deprecation") MiniMRCluster mrCluster=new MiniMRCluster(2,fs.getName(),1);
  try {
    JobConf jobConf=new JobConf(conf,TestTableMapReduce.class);
    jobConf.setJobName("process column contents");
    jobConf.setNumMapTasks(1);
    jobConf.setNumReduceTasks(1);
    ProcessContentsMapper.initJob(TABLE_NAME,INPUT_COLUMN,ProcessContentsMapper.class,jobConf);
    IdentityTableReduce.initJob(TABLE_NAME,IdentityTableReduce.class,jobConf);
    JobClient.runJob(jobConf);
  }
  finally {
    mrCluster.shutdown();
  }
  System.out.println("Print table contents after map/reduce");
  scanTable(conf);
}
