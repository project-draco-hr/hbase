{
  Stat stat=new Stat();
  byte[] data=zkWrapper.readZNode(regionZNode,stat);
  if (data == null) {
    String msg="ZNode " + regionZNode + " does not exist in ZooKeeper, will NOT open region.";
    LOG.error(msg);
    throw new IOException(msg);
  }
  HBaseEventType rsEvent=HBaseEventType.fromByte(data[0]);
  if (rsEvent != HBaseEventType.RS2ZK_REGION_CLOSED && rsEvent != HBaseEventType.M2ZK_REGION_OFFLINE) {
    String msg="ZNode " + regionZNode + " is not in CLOSED/OFFLINE state (state = "+ rsEvent+ "), will NOT open region.";
    LOG.error(msg);
    throw new IOException(msg);
  }
  zkVersion=stat.getVersion();
  updateZKWithEventData(HBaseEventType.RS2ZK_REGION_OPENING,hmsg);
}
