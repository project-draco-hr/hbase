{
  long maxSize=0L;
  if (this.mapFiles.size() <= 0) {
    return maxSize;
  }
  this.lock.obtainReadLock();
  try {
    long mapIndex=0L;
    for (Iterator<Map.Entry<Long,HStoreFile>> it=mapFiles.entrySet().iterator(); it.hasNext(); ) {
      Map.Entry<Long,HStoreFile> e=it.next();
      HStoreFile curHSF=e.getValue();
      long size=fs.getLength(new Path(curHSF.getMapFilePath(),MapFile.DATA_FILE_NAME));
      if (size > maxSize) {
        maxSize=size;
        mapIndex=e.getKey();
      }
    }
    MapFile.Reader r=maps.get(mapIndex);
    midKey.set(((HStoreKey)r.midKey()).getRow());
  }
 catch (  IOException e) {
    LOG.warn(e);
  }
 finally {
    this.lock.releaseReadLock();
  }
  return maxSize;
}
