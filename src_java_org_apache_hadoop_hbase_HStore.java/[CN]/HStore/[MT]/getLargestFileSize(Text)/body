{
  long maxSize=0L;
  long mapIndex=0L;
  for (Iterator<Map.Entry<Long,HStoreFile>> it=mapFiles.entrySet().iterator(); it.hasNext(); ) {
    Map.Entry<Long,HStoreFile> e=it.next();
    HStoreFile curHSF=e.getValue();
    long size=fs.getLength(new Path(curHSF.getMapFilePath(),MapFile.DATA_FILE_NAME));
    if (size > maxSize) {
      maxSize=size;
      mapIndex=e.getKey();
    }
  }
  MapFile.Reader r=maps.get(mapIndex);
synchronized (r) {
    midKey.set(((HStoreKey)r.midKey()).getRow());
  }
  return maxSize;
}
