{
  List<HStoreFile> filesToCompact=null;
  this.lock.obtainWriteLock();
  try {
    filesToCompact=new ArrayList<HStoreFile>(this.storefiles.values());
    Collections.reverse(filesToCompact);
  }
  finally {
    this.lock.releaseWriteLock();
  }
  return filesToCompact;
}
