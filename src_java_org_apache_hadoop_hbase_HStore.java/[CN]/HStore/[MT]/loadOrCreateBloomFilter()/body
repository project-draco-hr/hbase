{
  Path filterFile=new Path(filterDir,BLOOMFILTER_FILE_NAME);
  if (fs.exists(filterFile)) {
    if (LOG.isDebugEnabled()) {
      LOG.debug("loading bloom filter for " + family.getName());
    }
switch (family.bloomFilter.filterType) {
case BloomFilterDescriptor.BLOOMFILTER:
      bloomFilter=new BloomFilter();
    break;
case BloomFilterDescriptor.COUNTING_BLOOMFILTER:
  bloomFilter=new CountingBloomFilter();
break;
case BloomFilterDescriptor.RETOUCHED_BLOOMFILTER:
bloomFilter=new RetouchedBloomFilter();
}
FSDataInputStream in=fs.open(filterFile);
bloomFilter.readFields(in);
fs.close();
}
 else {
if (LOG.isDebugEnabled()) {
LOG.debug("creating bloom filter for " + family.getName());
}
switch (family.bloomFilter.filterType) {
case BloomFilterDescriptor.BLOOMFILTER:
bloomFilter=new BloomFilter(family.bloomFilter.vectorSize,family.bloomFilter.nbHash);
break;
case BloomFilterDescriptor.COUNTING_BLOOMFILTER:
bloomFilter=new CountingBloomFilter(family.bloomFilter.vectorSize,family.bloomFilter.nbHash);
break;
case BloomFilterDescriptor.RETOUCHED_BLOOMFILTER:
bloomFilter=new RetouchedBloomFilter(family.bloomFilter.vectorSize,family.bloomFilter.nbHash);
}
}
}
