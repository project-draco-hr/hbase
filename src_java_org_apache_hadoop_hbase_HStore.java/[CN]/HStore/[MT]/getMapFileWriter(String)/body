{
  if (bloomFilter != null) {
    return new BloomFilterWriter(conf,fs,dirName,HStoreKey.class,ImmutableBytesWritable.class,compression);
  }
  return new MapFile.Writer(conf,fs,dirName,HStoreKey.class,ImmutableBytesWritable.class,compression);
}
