{
  Text foundKey=memcache.getRowKeyAtOrBefore(row,timestamp);
  if (foundKey != null) {
    return foundKey;
  }
  this.lock.readLock().lock();
  try {
    MapFile.Reader[] maparray=getReaders();
    Text bestSoFar=null;
    HStoreKey rowKey=new HStoreKey(row,timestamp);
    for (int i=maparray.length - 1; i >= 0; i--) {
      Text row_from_mapfile=rowAtOrBeforeFromMapFile(maparray[i],row,timestamp);
      if (row.equals(row_from_mapfile)) {
        return row;
      }
      if (bestSoFar == null || bestSoFar.compareTo(row_from_mapfile) < 0) {
        bestSoFar=row_from_mapfile;
      }
    }
    return bestSoFar;
  }
  finally {
    this.lock.readLock().unlock();
  }
}
