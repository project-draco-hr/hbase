{
  super(timestamp,targetCols);
  lock.obtainReadLock();
  try {
    this.readers=new MapFile.Reader[mapFiles.size()];
    int i=readers.length - 1;
    for (Iterator<HStoreFile> it=mapFiles.values().iterator(); it.hasNext(); ) {
      HStoreFile curHSF=it.next();
      readers[i--]=getMapFileReader(curHSF.getMapFilePath().toString());
    }
    this.keys=new HStoreKey[readers.length];
    this.vals=new BytesWritable[readers.length];
    for (i=0; i < readers.length; i++) {
      keys[i]=new HStoreKey();
      vals[i]=new BytesWritable();
      if (firstRow.getLength() != 0) {
        if (findFirstRow(i,firstRow)) {
          continue;
        }
      }
      while (getNext(i)) {
        if (columnMatch(i)) {
          break;
        }
      }
    }
  }
 catch (  Exception ex) {
    LOG.error(ex);
    close();
  }
}
