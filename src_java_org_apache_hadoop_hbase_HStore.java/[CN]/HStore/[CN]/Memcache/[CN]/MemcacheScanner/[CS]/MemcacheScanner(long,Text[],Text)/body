{
  super(timestamp,targetCols);
  try {
    this.backingMap=new TreeMap<HStoreKey,byte[]>();
    this.backingMap.putAll(snapshot);
    this.keys=new HStoreKey[1];
    this.vals=new byte[1][];
    HStoreKey firstKey=new HStoreKey(firstRow);
    if (firstRow != null && firstRow.getLength() != 0) {
      keyIterator=backingMap.tailMap(firstKey).keySet().iterator();
    }
 else {
      keyIterator=backingMap.keySet().iterator();
    }
    while (getNext(0)) {
      if (!findFirstRow(0,firstRow)) {
        continue;
      }
      if (columnMatch(0)) {
        break;
      }
    }
  }
 catch (  RuntimeException ex) {
    LOG.error("error initializing Memcache scanner: ",ex);
    close();
    IOException e=new IOException("error initializing Memcache scanner");
    e.initCause(ex);
    throw e;
  }
catch (  IOException ex) {
    LOG.error("error initializing Memcache scanner: ",ex);
    close();
    throw ex;
  }
}
