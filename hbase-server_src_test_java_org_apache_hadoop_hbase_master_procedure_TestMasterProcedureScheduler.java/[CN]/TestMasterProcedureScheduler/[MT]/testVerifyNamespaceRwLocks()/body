{
  String nsName1="ns1";
  String nsName2="ns2";
  TableName tableName1=TableName.valueOf(nsName1,"testtb");
  TableName tableName2=TableName.valueOf(nsName2,"testtb");
  queue.addBack(new TestNamespaceProcedure(1,nsName1,TableProcedureInterface.TableOperationType.EDIT));
  queue.addBack(new TestTableProcedure(2,tableName1,TableProcedureInterface.TableOperationType.EDIT));
  queue.addBack(new TestTableProcedure(3,tableName2,TableProcedureInterface.TableOperationType.EDIT));
  queue.addBack(new TestNamespaceProcedure(4,nsName2,TableProcedureInterface.TableOperationType.EDIT));
  Procedure procNs1=queue.poll();
  assertEquals(1,procNs1.getProcId());
  assertEquals(true,queue.tryAcquireNamespaceExclusiveLock(procNs1,nsName1));
  Procedure procNs2=queue.poll();
  assertEquals(4,procNs2.getProcId());
  assertEquals(true,queue.tryAcquireNamespaceExclusiveLock(procNs2,nsName2));
  queue.releaseNamespaceExclusiveLock(procNs2,nsName2);
  queue.yield(procNs2);
  procNs2=queue.poll();
  assertEquals(3,procNs2.getProcId());
  assertEquals(true,queue.tryAcquireTableExclusiveLock(procNs2,tableName2));
  Procedure procNs2b=queue.poll();
  assertEquals(4,procNs2b.getProcId());
  assertEquals(false,queue.tryAcquireNamespaceExclusiveLock(procNs2b,nsName2));
  queue.yield(procNs2b);
  queue.releaseNamespaceExclusiveLock(procNs1,nsName1);
  long procId=queue.poll().getProcId();
  assertEquals(2,procId);
  queue.releaseTableExclusiveLock(procNs2,tableName2);
  procId=queue.poll().getProcId();
  assertEquals(4,procId);
}
