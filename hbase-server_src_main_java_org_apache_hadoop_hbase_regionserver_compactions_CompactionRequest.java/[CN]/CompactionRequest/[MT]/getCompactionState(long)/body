{
  Long key=Long.valueOf(regionId);
  AtomicInteger major=majorCompactions.get(key);
  AtomicInteger minor=minorCompactions.get(key);
  int state=0;
  if (minor != null && minor.get() > 0) {
    state+=1;
  }
  if (major != null && major.get() > 0) {
    state+=2;
  }
switch (state) {
case 3:
    return CompactionState.MAJOR_AND_MINOR;
case 2:
  return CompactionState.MAJOR;
case 1:
return CompactionState.MINOR;
default :
return CompactionState.NONE;
}
}
