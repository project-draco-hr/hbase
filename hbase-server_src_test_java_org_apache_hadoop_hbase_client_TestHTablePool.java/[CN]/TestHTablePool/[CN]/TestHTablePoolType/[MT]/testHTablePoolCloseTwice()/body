{
  HTablePool pool=new HTablePool(TEST_UTIL.getConfiguration(),Integer.MAX_VALUE,getPoolType());
  String tableName=Bytes.toString(TABLENAME);
  HTableInterface table=pool.getTable(tableName);
  Assert.assertNotNull(table);
  Assert.assertTrue(((HTablePool.PooledHTable)table).isOpen());
  table.close();
  Assert.assertFalse(((HTablePool.PooledHTable)table).isOpen());
  try {
    table.close();
    Assert.fail("Should not allow table to be closed twice");
  }
 catch (  IllegalStateException ex) {
    Assert.assertTrue("table cannot be closed twice",true);
  }
 finally {
    pool.close();
  }
}
