{
  try {
    util.deleteTable(tableName);
  }
 catch (  Exception ex) {
  }
  if (numRegions > 1) {
    util.createTable(tableName,FAMILIES,1,bbb,yyy,numRegions);
  }
 else {
    util.createTable(tableName,FAMILIES);
  }
  HBaseAdmin admin=util.getHBaseAdmin();
  HTable table=new HTable(util.getConfiguration(),tableName);
  util.loadTable(table,FAMILIES);
  Path rootDir=new Path(util.getConfiguration().get(HConstants.HBASE_DIR));
  FileSystem fs=rootDir.getFileSystem(util.getConfiguration());
  SnapshotTestingUtils.createSnapshotAndValidate(admin,tableName,Arrays.asList(FAMILIES),null,snapshotName,rootDir,fs,true);
  byte[] value=Bytes.toBytes("after_snapshot_value");
  util.loadTable(table,FAMILIES,value);
  admin.flush(tableName.toString());
  table.close();
}
