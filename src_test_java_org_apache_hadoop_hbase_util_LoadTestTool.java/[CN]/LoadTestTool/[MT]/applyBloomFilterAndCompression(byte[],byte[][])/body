{
  String bloomStr=cmd.getOptionValue(OPT_BLOOM);
  StoreFile.BloomType bloomType=bloomStr == null ? null : StoreFile.BloomType.valueOf(bloomStr);
  String compressStr=cmd.getOptionValue(OPT_COMPRESSION);
  Compression.Algorithm compressAlgo=compressStr == null ? null : Compression.Algorithm.valueOf(compressStr);
  if (bloomStr == null && compressStr == null)   return;
  HBaseAdmin admin=new HBaseAdmin(conf);
  HTableDescriptor tableDesc=admin.getTableDescriptor(tableName);
  LOG.info("Disabling table " + Bytes.toString(tableName));
  admin.disableTable(tableName);
  for (  byte[] cf : columnFamilies) {
    HColumnDescriptor columnDesc=tableDesc.getFamily(cf);
    if (bloomStr != null)     columnDesc.setBloomFilterType(bloomType);
    if (compressStr != null)     columnDesc.setCompressionType(compressAlgo);
    admin.modifyColumn(tableName,columnDesc);
  }
  LOG.info("Enabling table " + Bytes.toString(tableName));
  admin.enableTable(tableName);
}
