{
  int numEntries=nonRootIndex.getInt(0);
  int low=0;
  int high=numEntries - 1;
  int mid=0;
  int entriesOffset=Bytes.SIZEOF_INT * (numEntries + 2);
  KeyValue.KeyOnlyKeyValue nonRootIndexKV=new KeyValue.KeyOnlyKeyValue();
  while (low <= high) {
    mid=(low + high) >>> 1;
    int midKeyRelOffset=nonRootIndex.getInt(Bytes.SIZEOF_INT * (mid + 1));
    int midKeyOffset=entriesOffset + midKeyRelOffset + SECONDARY_INDEX_ENTRY_OVERHEAD;
    int midLength=nonRootIndex.getInt(Bytes.SIZEOF_INT * (mid + 2)) - midKeyRelOffset - SECONDARY_INDEX_ENTRY_OVERHEAD;
    nonRootIndexKV.setKey(nonRootIndex.array(),nonRootIndex.arrayOffset() + midKeyOffset,midLength);
    int cmp=comparator.compareOnlyKeyPortion(key,nonRootIndexKV);
    if (cmp > 0)     low=mid + 1;
 else     if (cmp < 0)     high=mid - 1;
 else     return mid;
  }
  if (low != high + 1) {
    throw new IllegalStateException("Binary search broken: low=" + low + " "+ "instead of "+ (high + 1));
  }
  int i=low - 1;
  if (i < -1 || i >= numEntries) {
    throw new IllegalStateException("Binary search broken: result is " + i + " but expected to be between -1 and (numEntries - 1) = "+ (numEntries - 1));
  }
  return i;
}
