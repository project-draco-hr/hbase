{
  if (isMetaHRIUpdated(services.getCatalogTracker())) {
    LOG.info("ROOT/META already up-to date with PB serialization");
    return 0;
  }
  LOG.info("ROOT/META has Writable serializations, migrating ROOT and META to PB serialization");
  try {
    long rows=updateRootAndMeta(services);
    LOG.info("ROOT and META updated with PB serialization. Total rows updated: " + rows);
    return rows;
  }
 catch (  IOException e) {
    LOG.warn("Update ROOT/META with PB serialization failed." + "Master startup aborted.");
    throw e;
  }
}
