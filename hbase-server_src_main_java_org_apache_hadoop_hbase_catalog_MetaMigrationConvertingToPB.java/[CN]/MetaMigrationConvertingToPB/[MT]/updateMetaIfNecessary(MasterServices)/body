{
  if (isMetaTableUpdated(services.getCatalogTracker())) {
    LOG.info("META already up-to date with PB serialization");
    return 0;
  }
  LOG.info("META has Writable serializations, migrating hbase:meta to PB serialization");
  try {
    long rows=updateMeta(services);
    LOG.info("META updated with PB serialization. Total rows updated: " + rows);
    return rows;
  }
 catch (  IOException e) {
    LOG.warn("Update hbase:meta with PB serialization failed." + "Master startup aborted.");
    throw e;
  }
}
