{
  long stop=System.currentTimeMillis() + timeout;
synchronized (metaAvailable) {
    while (!stopped && !metaAvailable.get() && (timeout == 0 || System.currentTimeMillis() < stop)) {
      if (getMetaServerConnection(true) != null) {
        return metaLocation;
      }
      metaAvailable.wait(timeout == 0 ? 50 : timeout);
    }
    if (getMetaServerConnection(true) == null) {
      throw new NotAllMetaRegionsOnlineException("Timed out (" + timeout + "ms)");
    }
    return metaLocation;
  }
}
