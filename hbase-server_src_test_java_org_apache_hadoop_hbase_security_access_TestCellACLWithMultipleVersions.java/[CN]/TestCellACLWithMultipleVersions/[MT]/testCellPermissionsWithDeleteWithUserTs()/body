{
  USER_OWNER.runAs(new AccessTestAction(){
    @Override public Object run() throws Exception {
      try (Connection connection=ConnectionFactory.createConnection(conf)){
        try (Table t=connection.getTable(TEST_TABLE.getTableName())){
          Put p=new Put(TEST_ROW);
          p.add(TEST_FAMILY1,TEST_Q1,123L,ZERO);
          p.add(TEST_FAMILY1,TEST_Q2,123L,ZERO);
          Map<String,Permission> perms=new HashMap<String,Permission>();
          perms.put(USER_OTHER.getShortName(),new Permission(Permission.Action.READ,Permission.Action.WRITE));
          perms.put(USER_OTHER2.getShortName(),new Permission(Permission.Action.READ,Permission.Action.WRITE));
          p.setACL(perms);
          t.put(p);
          p=new Put(TEST_ROW);
          p.add(TEST_FAMILY1,TEST_Q1,125L,ONE);
          p.add(TEST_FAMILY1,TEST_Q2,125L,ONE);
          perms=new HashMap<String,Permission>();
          perms.put(USER_OTHER.getShortName(),new Permission(Permission.Action.READ,Permission.Action.WRITE));
          p.setACL(perms);
          t.put(p);
          p=new Put(TEST_ROW);
          p.add(TEST_FAMILY1,TEST_Q1,127L,TWO);
          p.add(TEST_FAMILY1,TEST_Q2,127L,TWO);
          perms=new HashMap<String,Permission>();
          perms.put(USER_OTHER.getShortName(),new Permission(Permission.Action.READ,Permission.Action.WRITE));
          p.setACL(perms);
          t.put(p);
          return null;
        }
       }
     }
  }
);
  USER_OTHER2.runAs(new AccessTestAction(){
    @Override public Object run() throws Exception {
      try (Connection connection=ConnectionFactory.createConnection(conf)){
        try (Table t=connection.getTable(TEST_TABLE.getTableName())){
          Delete d=new Delete(TEST_ROW,124L);
          d.deleteColumns(TEST_FAMILY1,TEST_Q1);
          t.delete(d);
        }
       }
       return null;
    }
  }
);
  USER_OTHER2.runAs(new AccessTestAction(){
    @Override public Object run() throws Exception {
      try (Connection connection=ConnectionFactory.createConnection(conf)){
        try (Table t=connection.getTable(TEST_TABLE.getTableName())){
          Delete d=new Delete(TEST_ROW);
          d.deleteColumns(TEST_FAMILY1,TEST_Q2,124L);
          t.delete(d);
        }
       }
       return null;
    }
  }
);
}
