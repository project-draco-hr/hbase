{
  conf=TEST_UTIL.getConfiguration();
  enableSecurity(conf);
  verifyConfiguration(conf);
  conf.setBoolean(AccessControlConstants.CF_ATTRIBUTE_EARLY_OUT,false);
  TEST_UTIL.startMiniCluster();
  MasterCoprocessorHost cpHost=TEST_UTIL.getMiniHBaseCluster().getMaster().getMasterCoprocessorHost();
  cpHost.load(AccessController.class,Coprocessor.PRIORITY_HIGHEST,conf);
  AccessController ac=(AccessController)cpHost.findCoprocessor(AccessController.class.getName());
  cpHost.createEnvironment(AccessController.class,ac,Coprocessor.PRIORITY_HIGHEST,1,conf);
  RegionServerCoprocessorHost rsHost=TEST_UTIL.getMiniHBaseCluster().getRegionServer(0).getRegionServerCoprocessorHost();
  rsHost.createEnvironment(AccessController.class,ac,Coprocessor.PRIORITY_HIGHEST,1,conf);
  TEST_UTIL.waitTableEnabled(AccessControlLists.ACL_TABLE_NAME);
  USER_OWNER=User.createUserForTesting(conf,"owner",new String[0]);
  USER_OTHER=User.createUserForTesting(conf,"other",new String[0]);
  USER_OTHER2=User.createUserForTesting(conf,"other2",new String[0]);
  GROUP_USER=User.createUserForTesting(conf,"group_user",new String[]{GROUP});
  usersAndGroups=new String[]{USER_OTHER.getShortName(),AuthUtil.toGroupEntry(GROUP)};
}
