{
  HTableDescriptor.isLegalTableName(tableName);
  HRegionLocation firstMetaServer=getFirstMetaServerForTable(tableName);
  execute(new MasterCallable<Void>(){
    @Override public Void call() throws IOException {
      master.deleteTable(tableName);
      return null;
    }
  }
);
  HRegionInterface server=connection.getHRegionConnection(firstMetaServer.getHostname(),firstMetaServer.getPort());
  for (int tries=0; tries < (this.numRetries * this.retryLongerMultiplier); tries++) {
    long scannerId=-1L;
    try {
      Scan scan=MetaReader.getScanForTableName(tableName);
      scan.addColumn(HConstants.CATALOG_FAMILY,HConstants.REGIONINFO_QUALIFIER);
      scannerId=server.openScanner(firstMetaServer.getRegionInfo().getRegionName(),scan);
      Result values=server.next(scannerId);
      if (values == null) {
        boolean tableExists=false;
        HTableDescriptor[] htds;
        MasterKeepAliveConnection master=connection.getKeepAliveMaster();
        try {
          htds=master.getHTableDescriptors();
        }
  finally {
          master.close();
        }
        if (htds != null && htds.length > 0) {
          for (          HTableDescriptor htd : htds) {
            if (Bytes.equals(tableName,htd.getName())) {
              tableExists=true;
              break;
            }
          }
        }
        if (!tableExists) {
          break;
        }
      }
    }
 catch (    IOException ex) {
      if (tries == numRetries - 1) {
        if (ex instanceof RemoteException) {
          throw ((RemoteException)ex).unwrapRemoteException();
        }
 else {
          throw ex;
        }
      }
    }
 finally {
      if (scannerId != -1L) {
        try {
          server.close(scannerId);
        }
 catch (        IOException ex) {
          LOG.warn(ex);
        }
      }
    }
    try {
      Thread.sleep(getPauseTime(tries));
    }
 catch (    InterruptedException e) {
    }
  }
  this.connection.clearRegionCache(tableName);
  LOG.info("Deleted " + Bytes.toString(tableName));
}
