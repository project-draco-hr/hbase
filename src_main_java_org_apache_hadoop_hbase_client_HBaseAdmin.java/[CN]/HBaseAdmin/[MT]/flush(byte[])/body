{
  boolean isRegionName=isRegionName(tableNameOrRegionName);
  CatalogTracker ct=getCatalogTracker();
  try {
    if (isRegionName) {
      Pair<HRegionInfo,HServerAddress> pair=MetaReader.getRegion(getCatalogTracker(),tableNameOrRegionName);
      flush(pair.getSecond(),pair.getFirst());
    }
 else {
      List<Pair<HRegionInfo,HServerAddress>> pairs=MetaReader.getTableRegionsAndLocations(getCatalogTracker(),Bytes.toString(tableNameOrRegionName));
      for (      Pair<HRegionInfo,HServerAddress> pair : pairs) {
        flush(pair.getSecond(),pair.getFirst());
      }
    }
  }
  finally {
    cleanupCatalogTracker(ct);
  }
}
