{
  byte[] key=new byte[keySize];
  byte[] value=new byte[valueSize];
  Random rand=new Random(Thread.currentThread().getId());
  HLog hlog=region.getLog();
  ArrayList<UUID> clusters=new ArrayList<UUID>();
  long nonce=HConstants.NO_NONCE;
  try {
    long startTime=System.currentTimeMillis();
    int lastSync=0;
    for (int i=0; i < numIterations; ++i) {
      long now=System.nanoTime();
      Put put=setupPut(rand,key,value,numFamilies);
      WALEdit walEdit=new WALEdit();
      addFamilyMapToWALEdit(put.getFamilyCellMap(),walEdit);
      HRegionInfo hri=region.getRegionInfo();
      hlog.appendNoSync(hri,hri.getTable(),walEdit,clusters,now,htd,region.getSequenceId(),true,nonce,nonce);
      if (!this.noSync) {
        if (++lastSync >= this.syncInterval) {
          hlog.sync();
          lastSync=0;
        }
      }
      latencyHistogram.update(System.nanoTime() - now);
    }
    long totalTime=(System.currentTimeMillis() - startTime);
    logBenchmarkResult(Thread.currentThread().getName(),numIterations,totalTime);
  }
 catch (  Exception e) {
    LOG.error(getClass().getSimpleName() + " Thread failed",e);
  }
}
