{
  HLog.Reader reader=HLogFactory.createReader(wal.getFileSystem(getConf()),wal,getConf());
  long previousSeqid=-1;
  long count=0;
  try {
    while (true) {
      Entry e=reader.next();
      if (e == null)       break;
      count++;
      long seqid=e.getKey().getLogSeqNum();
      if (verbose)       LOG.info("seqid=" + seqid);
      if (previousSeqid >= seqid) {
        throw new IllegalStateException("wal=" + wal.getName() + ", previousSeqid="+ previousSeqid+ ", seqid="+ seqid);
      }
      previousSeqid=seqid;
    }
  }
  finally {
    reader.close();
  }
  return count;
}
