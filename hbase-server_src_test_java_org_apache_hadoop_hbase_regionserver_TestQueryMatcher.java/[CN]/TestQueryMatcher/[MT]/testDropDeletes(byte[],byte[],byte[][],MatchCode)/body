{
  long now=EnvironmentEdgeManager.currentTime();
  ScanInfo scanInfo=new ScanInfo(fam2,0,1,ttl,KeepDeletedCells.FALSE,-1L,rowComparator);
  NavigableSet<byte[]> cols=get.getFamilyMap().get(fam2);
  ScanQueryMatcher qm=new ScanQueryMatcher(scan,scanInfo,cols,Long.MAX_VALUE,HConstants.OLDEST_TIMESTAMP,HConstants.OLDEST_TIMESTAMP,from,to,null);
  List<ScanQueryMatcher.MatchCode> actual=new ArrayList<ScanQueryMatcher.MatchCode>(rows.length);
  byte[] prevRow=null;
  for (  byte[] row : rows) {
    if (prevRow == null || !Bytes.equals(prevRow,row)) {
      qm.setRow(row,0,(short)row.length);
      prevRow=row;
    }
    actual.add(qm.match(new KeyValue(row,fam2,null,now,Type.Delete)));
  }
  assertEquals(expected.length,actual.size());
  for (int i=0; i < expected.length; i++) {
    if (PRINT)     System.out.println("expected " + expected[i] + ", actual "+ actual.get(i));
    assertEquals(expected[i],actual.get(i));
  }
}
