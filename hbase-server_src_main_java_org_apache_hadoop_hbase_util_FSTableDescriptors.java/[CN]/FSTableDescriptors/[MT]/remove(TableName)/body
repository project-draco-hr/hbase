{
  if (fsreadonly) {
    throw new NotImplementedException("Cannot remove a table descriptor - in read only mode");
  }
  Path tabledir=getTableDir(tablename);
  if (this.fs.exists(tabledir)) {
    if (!this.fs.delete(tabledir,true)) {
      throw new IOException("Failed delete of " + tabledir.toString());
    }
  }
  TableDescriptor descriptor=this.cache.remove(tablename);
  if (descriptor == null) {
    return null;
  }
 else {
    return descriptor.getHTableDescriptor();
  }
}
