{
  if (fsreadonly) {
    throw new NotImplementedException("Cannot update a table descriptor - in read only mode");
  }
  TableName tableName=td.getHTableDescriptor().getTableName();
  Path tableDir=getTableDir(tableName);
  Path p=writeTableDescriptor(fs,td,tableDir,getTableInfoPath(tableDir));
  if (p == null)   throw new IOException("Failed update");
  LOG.info("Updated tableinfo=" + p);
  long modtime=getTableInfoModtime(tableName);
  this.cache.put(tableName,new TableDescriptorAndModtime(modtime,td));
  return p;
}
