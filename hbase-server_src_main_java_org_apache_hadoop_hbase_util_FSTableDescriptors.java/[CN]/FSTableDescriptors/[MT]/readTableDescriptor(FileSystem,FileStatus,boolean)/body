{
  int len=Ints.checkedCast(status.getLen());
  byte[] content=new byte[len];
  FSDataInputStream fsDataInputStream=fs.open(status.getPath());
  try {
    fsDataInputStream.readFully(content);
  }
  finally {
    fsDataInputStream.close();
  }
  TableDescriptor td=null;
  try {
    td=TableDescriptor.parseFrom(content);
  }
 catch (  DeserializationException e) {
    throw new IOException("content=" + Bytes.toShort(content),e);
  }
  if (rewritePb && !ProtobufUtil.isPBMagicPrefix(content)) {
    Path tableInfoDir=status.getPath().getParent();
    Path tableDir=tableInfoDir.getParent();
    writeTableDescriptor(fs,td,tableDir,status);
  }
  return td;
}
