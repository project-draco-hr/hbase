{
  String tableName="table1";
  int numCF=3;
  StringBuilder expected=new StringBuilder();
  if (useTableName) {
    expected.append("tbl.");
    expected.append(tableName);
    expected.append(".");
  }
  expected.append("cf.");
  Set<byte[]> families=new HashSet<byte[]>();
  for (int i=1; i <= numCF; i++) {
    String cf="cf" + i;
    families.add(Bytes.toBytes(cf));
    expected.append(cf);
    if (i == numCF) {
      expected.append(".");
    }
 else {
      expected.append("~");
    }
  }
  String result=SchemaMetrics.generateSchemaMetricsPrefix(tableName,families);
  assertEquals(expected.toString(),result);
}
