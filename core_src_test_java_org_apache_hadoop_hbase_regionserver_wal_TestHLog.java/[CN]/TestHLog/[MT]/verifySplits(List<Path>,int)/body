{
  assertEquals(howmany,splits.size());
  for (int i=0; i < splits.size(); i++) {
    HLog.Reader reader=HLog.getReader(this.fs,splits.get(i),conf);
    try {
      int count=0;
      String previousRegion=null;
      long seqno=-1;
      HLog.Entry entry=new HLog.Entry();
      while ((entry=reader.next(entry)) != null) {
        HLogKey key=entry.getKey();
        WALEdit kv=entry.getEdit();
        String region=Bytes.toString(key.getRegionName());
        if (previousRegion != null) {
          assertEquals(previousRegion,region);
        }
        assertTrue(seqno < key.getLogSeqNum());
        seqno=key.getLogSeqNum();
        previousRegion=region;
        count++;
      }
      assertEquals(howmany * howmany,count);
    }
  finally {
      reader.close();
    }
  }
}
