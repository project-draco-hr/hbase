{
  int prevTotalSize=previousTotalSize;
  int totalSize=0;
  List<Long> durations=new ArrayList<Long>();
  for (int itTime=0; itTime < BENCHMARK_N_TIMES; ++itTime) {
    totalSize=0;
    Iterator<KeyValue> it;
    it=codec.getIterator();
    final long startTime=System.nanoTime();
    while (it.hasNext()) {
      totalSize+=it.next().getLength();
    }
    final long finishTime=System.nanoTime();
    if (itTime >= BENCHMARK_N_OMIT) {
      durations.add(finishTime - startTime);
    }
    if (prevTotalSize != -1 && prevTotalSize != totalSize) {
      throw new IllegalStateException(String.format("Algorithm '%s' decoded data to different size",codec.toString()));
    }
    prevTotalSize=totalSize;
  }
  List<Long> compressDurations=new ArrayList<Long>();
  for (int itTime=0; itTime < BENCHMARK_N_TIMES; ++itTime) {
    final long startTime=System.nanoTime();
    codec.doCompressData();
    final long finishTime=System.nanoTime();
    if (itTime >= BENCHMARK_N_OMIT) {
      compressDurations.add(finishTime - startTime);
    }
  }
  System.out.println(codec.toString() + ":");
  printBenchmarkResult(totalSize,compressDurations,false);
  printBenchmarkResult(totalSize,durations,true);
  return prevTotalSize;
}
