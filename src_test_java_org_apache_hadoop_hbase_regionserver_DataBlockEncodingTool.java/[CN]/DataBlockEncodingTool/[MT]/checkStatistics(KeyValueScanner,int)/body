{
  scanner.seek(KeyValue.LOWESTKEY);
  KeyValue currentKv;
  byte[] previousKey=null;
  byte[] currentKey;
  List<DataBlockEncoder> dataBlockEncoders=DataBlockEncoding.getAllEncoders();
  for (  DataBlockEncoder d : dataBlockEncoders) {
    codecs.add(new EncodedDataBlock(d,includesMemstoreTS));
  }
  int j=0;
  while ((currentKv=scanner.next()) != null && j < kvLimit) {
    j++;
    currentKey=currentKv.getKey();
    if (previousKey != null) {
      for (int i=0; i < previousKey.length && i < currentKey.length && previousKey[i] == currentKey[i]; ++i) {
        totalKeyRedundancyLength++;
      }
    }
    for (    EncodedDataBlock codec : codecs) {
      codec.addKv(currentKv);
    }
    previousKey=currentKey;
    totalPrefixLength+=currentKv.getLength() - currentKv.getKeyLength() - currentKv.getValueLength();
    totalKeyLength+=currentKv.getKeyLength();
    totalValueLength+=currentKv.getValueLength();
  }
}
