{
  FileSystem fs=TEST_UTIL.getTestFileSystem();
  final Path dir=TEST_UTIL.getDataTestDir("testBulkLoad");
  fs.mkdirs(dir);
  fs.setPermission(dir,FsPermission.valueOf("-rwxrwxrwx"));
  PrivilegedExceptionAction bulkLoadAction=new PrivilegedExceptionAction(){
    public Object run() throws Exception {
      int numRows=3;
      byte[][][] hfileRanges={{{(byte)0},{(byte)9}}};
      Path bulkLoadBasePath=new Path(dir,new Path(User.getCurrent().getName()));
      new BulkLoadHelper(bulkLoadBasePath).bulkLoadHFile(TEST_TABLE.getTableName(),TEST_FAMILY,Bytes.toBytes("q"),hfileRanges,numRows);
      return null;
    }
  }
;
  verifyAllowed(bulkLoadAction,SUPERUSER,USER_ADMIN,USER_OWNER,USER_CREATE);
  verifyDenied(bulkLoadAction,USER_RW,USER_NONE,USER_RO);
  TEST_UTIL.getHBaseAdmin().disableTable(TEST_TABLE.getTableName());
  TEST_UTIL.getHBaseAdmin().enableTable(TEST_TABLE.getTableName());
}
