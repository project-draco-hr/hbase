{
  HBaseAdmin admin=TEST_UTIL.getHBaseAdmin();
  HTableDescriptor htd=new HTableDescriptor(TEST_TABLE.getTableName());
  htd.addFamily(new HColumnDescriptor(TEST_FAMILY));
  htd.setOwner(USER_OWNER);
  admin.createTable(htd,new byte[][]{Bytes.toBytes("s")});
  TEST_UTIL.waitTableEnabled(TEST_TABLE.getTableName().getName());
  HRegion region=TEST_UTIL.getHBaseCluster().getRegions(TEST_TABLE.getTableName()).get(0);
  RegionCoprocessorHost rcpHost=region.getCoprocessorHost();
  RCP_ENV=rcpHost.createEnvironment(AccessController.class,ACCESS_CONTROLLER,Coprocessor.PRIORITY_HIGHEST,1,conf);
  SecureTestUtil.grantGlobal(TEST_UTIL,USER_ADMIN.getShortName(),Permission.Action.ADMIN,Permission.Action.CREATE,Permission.Action.READ,Permission.Action.WRITE);
  SecureTestUtil.grantOnTable(TEST_UTIL,USER_RW.getShortName(),TEST_TABLE.getTableName(),TEST_FAMILY,null,Permission.Action.READ,Permission.Action.WRITE);
  SecureTestUtil.grantOnTable(TEST_UTIL,USER_CREATE.getShortName(),TEST_TABLE.getTableName(),null,null,Permission.Action.CREATE,Permission.Action.READ,Permission.Action.WRITE);
  SecureTestUtil.grantOnTable(TEST_UTIL,USER_RO.getShortName(),TEST_TABLE.getTableName(),TEST_FAMILY,null,Permission.Action.READ);
  assertEquals(4,AccessControlLists.getTablePermissions(conf,TEST_TABLE.getTableName()).size());
}
