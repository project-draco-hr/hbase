{
  HTable table=new HTable(TEST_UTIL.getConfiguration(),TEST_TABLE);
  Map<HRegionInfo,HServerAddress> regions=table.getRegionsInfo();
  final Map.Entry<HRegionInfo,HServerAddress> firstRegion=regions.entrySet().iterator().next();
  final ServerName server=TEST_UTIL.getHBaseCluster().getRegionServer(0).getServerName();
  PrivilegedExceptionAction action=new PrivilegedExceptionAction(){
    public Object run() throws Exception {
      ACCESS_CONTROLLER.preMove(ObserverContext.createAndPrepare(CP_ENV,null),firstRegion.getKey(),server,server);
      return null;
    }
  }
;
  verifyDenied(USER_OWNER,action);
  verifyDenied(USER_RW,action);
  verifyDenied(USER_RO,action);
  verifyDenied(USER_NONE,action);
  verifyAllowed(SUPERUSER,action);
  verifyAllowed(USER_ADMIN,action);
}
