{
  for (  PrivilegedExceptionAction action : actions) {
    try {
      user.runAs(action);
      fail("Expected AccessDeniedException for user '" + user.getShortName() + "'");
    }
 catch (    RetriesExhaustedWithDetailsException e) {
      boolean isAccessDeniedException=false;
      for (      Throwable ex : e.getCauses()) {
        if (ex instanceof ServiceException) {
          ServiceException se=(ServiceException)ex;
          if (se.getCause() != null && se.getCause() instanceof AccessDeniedException) {
            isAccessDeniedException=true;
            break;
          }
        }
 else         if (ex instanceof AccessDeniedException) {
          isAccessDeniedException=true;
          break;
        }
      }
      if (!isAccessDeniedException) {
        fail("Not receiving AccessDeniedException for user '" + user.getShortName() + "'");
      }
    }
catch (    AccessDeniedException ade) {
    }
  }
}
