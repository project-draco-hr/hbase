{
  PrivilegedExceptionAction checkAndDeleteAction=new PrivilegedExceptionAction(){
    @Override public Object run() throws Exception {
      Delete d=new Delete(Bytes.toBytes("random_row"));
      d.deleteFamily(TEST_FAMILY);
      HTable t=new HTable(conf,TEST_TABLE.getTableName());
      try {
        t.checkAndDelete(Bytes.toBytes("random_row"),TEST_FAMILY,Bytes.toBytes("q"),Bytes.toBytes("test_value"),d);
      }
  finally {
        t.close();
      }
      return null;
    }
  }
;
  verifyReadWrite(checkAndDeleteAction);
  PrivilegedExceptionAction checkAndPut=new PrivilegedExceptionAction(){
    @Override public Object run() throws Exception {
      Put p=new Put(Bytes.toBytes("random_row"));
      p.add(TEST_FAMILY,Bytes.toBytes("Qualifier"),Bytes.toBytes(1));
      HTable t=new HTable(conf,TEST_TABLE.getTableName());
      try {
        t.checkAndPut(Bytes.toBytes("random_row"),TEST_FAMILY,Bytes.toBytes("q"),Bytes.toBytes("test_value"),p);
      }
  finally {
        t.close();
      }
      return null;
    }
  }
;
  verifyReadWrite(checkAndPut);
}
