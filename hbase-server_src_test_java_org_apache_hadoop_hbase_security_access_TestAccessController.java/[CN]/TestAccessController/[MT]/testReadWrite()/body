{
  AccessTestAction checkAndDeleteAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      Delete d=new Delete(TEST_ROW);
      d.deleteFamily(TEST_FAMILY);
      Table t=TEST_UTIL.getConnection().getTable(TEST_TABLE.getTableName());
      try {
        t.checkAndDelete(TEST_ROW,TEST_FAMILY,TEST_QUALIFIER,Bytes.toBytes("test_value"),d);
      }
  finally {
        t.close();
      }
      return null;
    }
  }
;
  verifyReadWrite(checkAndDeleteAction);
  AccessTestAction checkAndPut=new AccessTestAction(){
    @Override public Object run() throws Exception {
      Put p=new Put(TEST_ROW);
      p.add(TEST_FAMILY,TEST_QUALIFIER,Bytes.toBytes(1));
      Table t=TEST_UTIL.getConnection().getTable(TEST_TABLE.getTableName());
      try {
        t.checkAndPut(TEST_ROW,TEST_FAMILY,TEST_QUALIFIER,Bytes.toBytes("test_value"),p);
      }
  finally {
        t.close();
      }
      return null;
    }
  }
;
  verifyReadWrite(checkAndPut);
}
