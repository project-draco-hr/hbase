{
  Path familyDir=new Path(loadPath,Bytes.toString(family));
  fs.mkdirs(familyDir);
  int hfileIdx=0;
  for (  byte[][] range : hfileRanges) {
    byte[] from=range[0];
    byte[] to=range[1];
    createHFile(new Path(familyDir,"hfile_" + (hfileIdx++)),family,qualifier,from,to,numRowsPerRange);
  }
  setPermission(loadPath,FsPermission.valueOf("-rwxrwxrwx"));
  HTable table=new HTable(conf,tableName);
  try {
    HBaseAdmin admin=new HBaseAdmin(TEST_UTIL.getConfiguration());
    TEST_UTIL.waitTableEnabled(admin,tableName);
    LoadIncrementalHFiles loader=new LoadIncrementalHFiles(conf);
    loader.doBulkLoad(loadPath,table);
  }
  finally {
    table.close();
  }
}
