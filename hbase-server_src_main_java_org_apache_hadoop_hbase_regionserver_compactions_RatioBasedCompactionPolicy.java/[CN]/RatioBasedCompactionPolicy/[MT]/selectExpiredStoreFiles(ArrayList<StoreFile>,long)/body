{
  if (candidates == null || candidates.size() == 0)   return null;
  ArrayList<StoreFile> expiredStoreFiles=null;
  for (  StoreFile storeFile : candidates) {
    if (storeFile.getReader().getMaxTimestamp() < maxExpiredTimeStamp) {
      LOG.info("Deleting the expired store file by compaction: " + storeFile.getPath() + " whose maxTimeStamp is "+ storeFile.getReader().getMaxTimestamp()+ " while the max expired timestamp is "+ maxExpiredTimeStamp);
      if (expiredStoreFiles == null) {
        expiredStoreFiles=new ArrayList<StoreFile>();
      }
      expiredStoreFiles.add(storeFile);
    }
  }
  if (expiredStoreFiles != null && expiredStoreFiles.size() == 1 && expiredStoreFiles.get(0).getReader().getEntries() == 0) {
    return null;
  }
  return expiredStoreFiles;
}
