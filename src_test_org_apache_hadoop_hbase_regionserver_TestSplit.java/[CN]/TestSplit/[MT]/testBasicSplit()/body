{
  MiniDFSCluster cluster=null;
  HRegion region=null;
  try {
    cluster=new MiniDFSCluster(conf,2,true,(String[])null);
    this.conf.set(HConstants.HBASE_DIR,cluster.getFileSystem().getHomeDirectory().toString());
    HTableDescriptor htd=createTableDescriptor(getName());
    region=createNewHRegion(htd,null,null);
    basicSplit(region);
  }
  finally {
    if (region != null) {
      region.close();
      region.getLog().closeAndDelete();
    }
    if (cluster != null) {
      StaticTestEnvironment.shutdownDfs(cluster);
    }
  }
}
