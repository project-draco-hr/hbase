{
  this.tr=scan.getTimeRange();
  this.oldestStamp=System.currentTimeMillis() - ttl;
  this.rowComparator=rowComparator;
  this.deletes=new ScanDeleteTracker();
  this.startKey=KeyValue.createFirstOnRow(scan.getStartRow());
  this.stopKey=KeyValue.createFirstOnRow(scan.getStopRow());
  this.filter=scan.getFilter();
  this.oldFilter=scan.getOldFilter();
  if (columns == null || columns.size() == 0) {
    this.columns=new ScanWildcardColumnTracker(maxVersions);
  }
 else {
    this.columns=new ExplicitColumnTracker(columns,maxVersions);
  }
}
