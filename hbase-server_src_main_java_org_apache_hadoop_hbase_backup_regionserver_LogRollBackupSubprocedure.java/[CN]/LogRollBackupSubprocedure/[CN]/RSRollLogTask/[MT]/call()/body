{
  if (LOG.isDebugEnabled()) {
    LOG.debug("++ DRPC started: " + rss.getServerName());
  }
  hlog=(FSHLog)rss.getWAL(null);
  long filenum=hlog.getFilenum();
  LOG.info("Trying to roll log in backup subprocedure, current log number: " + filenum);
  hlog.rollWriter(true);
  LOG.info("After roll log in backup subprocedure, current log number: " + hlog.getFilenum());
  BackupSystemTable table=BackupSystemTable.getTable(rss.getConfiguration());
  HashMap<String,String> serverTimestampMap=table.readRegionServerLastLogRollResult();
  String host=rss.getServerName().getHostname();
  String sts=serverTimestampMap.get(host);
  if (sts != null && Long.parseLong(sts) > filenum) {
    LOG.warn("Won't update server's last roll log result: current=" + sts + " new="+ filenum);
    return null;
  }
  table.writeRegionServerLastLogRollResult(host,Long.toString(filenum));
  return null;
}
