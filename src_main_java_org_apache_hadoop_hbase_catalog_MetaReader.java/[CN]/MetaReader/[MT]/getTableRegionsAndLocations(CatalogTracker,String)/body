{
  byte[] tableNameBytes=Bytes.toBytes(tableName);
  if (Bytes.equals(tableNameBytes,HConstants.ROOT_TABLE_NAME)) {
    ServerName serverName=catalogTracker.getRootLocation();
    List<Pair<HRegionInfo,ServerName>> list=new ArrayList<Pair<HRegionInfo,ServerName>>();
    list.add(new Pair<HRegionInfo,ServerName>(HRegionInfo.ROOT_REGIONINFO,serverName));
    return list;
  }
  HRegionInterface metaServer=getCatalogRegionInterface(catalogTracker,tableNameBytes);
  List<Pair<HRegionInfo,ServerName>> regions=new ArrayList<Pair<HRegionInfo,ServerName>>();
  Scan scan=getScanForTableName(tableNameBytes);
  scan.addFamily(HConstants.CATALOG_FAMILY);
  long scannerid=metaServer.openScanner(getCatalogRegionNameForTable(tableNameBytes),scan);
  try {
    Result data;
    while ((data=metaServer.next(scannerid)) != null) {
      if (data != null && data.size() > 0) {
        Pair<HRegionInfo,ServerName> region=metaRowToRegionPair(data);
        if (region == null)         continue;
        regions.add(region);
      }
    }
    return regions;
  }
  finally {
    metaServer.close(scannerid);
  }
}
