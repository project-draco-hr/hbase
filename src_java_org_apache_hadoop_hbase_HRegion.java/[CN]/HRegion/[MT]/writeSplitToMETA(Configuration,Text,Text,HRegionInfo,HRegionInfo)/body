{
  HTable t=new HTable(conf,table);
  try {
    HRegionInfo hri=getRegionInfo(t.get(regionName,COL_REGIONINFO));
    hri.offLine=true;
    hri.split=true;
    ByteArrayOutputStream bytes=new ByteArrayOutputStream();
    DataOutputStream dos=new DataOutputStream(bytes);
    hri.write(dos);
    dos.close();
    long lockid=t.startBatchUpdate(regionName);
    t.put(lockid,COL_REGIONINFO,bytes.toByteArray());
    t.put(lockid,COL_SPLITA,Writables.getBytes(splitA));
    t.put(lockid,COL_SPLITB,Writables.getBytes(splitB));
    t.commitBatch(lockid);
    if (LOG.isDebugEnabled()) {
      LOG.debug("Updated " + regionName + " in table "+ table+ " on its being split");
    }
  }
  finally {
    t.close();
  }
}
