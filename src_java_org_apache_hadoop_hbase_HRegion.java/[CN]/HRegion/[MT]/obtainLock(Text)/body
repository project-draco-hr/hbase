{
synchronized (rowsToLocks) {
    while (rowsToLocks.get(row) != null) {
      try {
        rowsToLocks.wait();
      }
 catch (      InterruptedException ie) {
      }
    }
    long lockid=Math.abs(rand.nextLong());
    rowsToLocks.put(row,lockid);
    locksToRows.put(lockid,row);
    rowsToLocks.notifyAll();
    return lockid;
  }
}
