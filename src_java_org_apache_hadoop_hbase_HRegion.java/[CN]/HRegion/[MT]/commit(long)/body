{
  Text row=getRowFromLock(lockid);
  if (row == null) {
    throw new LockException("No write lock for lockid " + lockid);
  }
synchronized (row) {
    long commitTimestamp=System.currentTimeMillis();
    TreeMap<Text,BytesWritable> columns=this.targetColumns.get(lockid);
    if (columns != null && columns.size() > 0) {
      log.append(regionInfo.regionName,regionInfo.tableDesc.getName(),row,columns,commitTimestamp);
      memcache.add(row,columns,commitTimestamp);
    }
    targetColumns.remove(lockid);
    releaseRowLock(row);
  }
  recentCommits++;
  this.commitsSinceFlush++;
}
