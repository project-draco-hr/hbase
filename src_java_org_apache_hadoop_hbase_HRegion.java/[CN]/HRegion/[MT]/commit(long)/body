{
  Text row=getRowFromLock(lockid);
  if (row == null) {
    throw new LockException("No write lock for lockid " + lockid);
  }
synchronized (row) {
    long commitTimestamp=System.currentTimeMillis();
    log.append(regionInfo.regionName,regionInfo.tableDesc.getName(),row,targetColumns.get(Long.valueOf(lockid)),commitTimestamp);
    memcache.add(row,targetColumns.get(Long.valueOf(lockid)),commitTimestamp);
    targetColumns.remove(Long.valueOf(lockid));
    releaseRowLock(row);
  }
  recentCommits++;
  this.commitsSinceFlush++;
}
