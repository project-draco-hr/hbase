{
  Text row=getRowFromLock(lockid);
  if (row == null) {
    throw new LockException("No write lock for lockid " + lockid);
  }
synchronized (row) {
    long commitTimestamp=System.currentTimeMillis();
    log.append(regionInfo.regionName,regionInfo.tableDesc.getName(),row,targetColumns.get(lockid),commitTimestamp);
    memcache.add(row,targetColumns.get(lockid),commitTimestamp);
    targetColumns.remove(lockid);
    releaseLock(row);
  }
  recentCommits++;
  this.commitsSinceFlush++;
}
