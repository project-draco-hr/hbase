{
  Text row=getRowFromLock(lockid);
  if (row == null) {
    throw new LockException("No write lock for lockid " + lockid);
  }
synchronized (row) {
    Long lid=Long.valueOf(lockid);
    update(row,timestamp,this.targetColumns.get(lid));
    targetColumns.remove(lid);
    releaseRowLock(row);
  }
}
