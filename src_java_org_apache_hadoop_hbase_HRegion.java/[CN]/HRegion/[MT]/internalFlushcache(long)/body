{
  if (startTime == -1) {
    if (LOG.isDebugEnabled()) {
      LOG.debug("Not flushing cache: snapshotMemcaches() determined that " + "there was nothing to do");
    }
    return;
  }
  long sequenceId=log.startCacheFlush();
  long logCacheFlushId=sequenceId;
  try {
    for (    HStore hstore : stores.values()) {
      hstore.flushCache(sequenceId);
    }
  }
 catch (  IOException e) {
    this.log.abortCacheFlush();
    throw new DroppedSnapshotException(e.getMessage());
  }
  this.log.completeCacheFlush(this.regionInfo.getRegionName(),regionInfo.getTableDesc().getName(),logCacheFlushId);
synchronized (this) {
    notifyAll();
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("Finished memcache flush for region " + this.regionInfo.getRegionName() + " in "+ (System.currentTimeMillis() - startTime)+ "ms");
  }
}
