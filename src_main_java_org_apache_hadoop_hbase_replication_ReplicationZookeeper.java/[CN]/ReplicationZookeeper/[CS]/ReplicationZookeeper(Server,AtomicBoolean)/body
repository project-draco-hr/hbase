{
  this.abortable=server;
  this.zookeeper=server.getZooKeeper();
  this.conf=server.getConfiguration();
  setZNodes();
  this.peerClusters=new HashMap<String,ZooKeeperWatcher>();
  this.replicating=replicating;
  setReplicating();
  this.rsServerNameZnode=ZKUtil.joinZNode(rsZNode,server.getServerName());
  ZKUtil.createWithParents(this.zookeeper,this.rsServerNameZnode);
  ReplicationStatusTracker tracker=new ReplicationStatusTracker(this.zookeeper,server);
  tracker.start();
  List<String> znodes=ZKUtil.listChildrenNoWatch(this.zookeeper,this.peersZNode);
  if (znodes != null) {
    for (    String z : znodes) {
      connectToPeer(z);
    }
  }
}
