{
  this.abortable=server;
  this.zookeeper=server.getZooKeeper();
  this.conf=server.getConfiguration();
  setZNodes();
  this.peerClusters=new HashMap<String,ReplicationPeer>();
  this.replicating=replicating;
  ZKUtil.createWithParents(this.zookeeper,ZKUtil.joinZNode(this.replicationZNode,this.replicationStateNodeName));
  readReplicationStateZnode();
  this.rsServerNameZnode=ZKUtil.joinZNode(rsZNode,server.getServerName());
  ZKUtil.createWithParents(this.zookeeper,this.rsServerNameZnode);
  ReplicationStatusTracker tracker=new ReplicationStatusTracker(this.zookeeper,server);
  tracker.start();
  connectExistingPeers();
}
