{
  String replicationZNodeName=conf.get("zookeeper.znode.replication","replication");
  String peersZNodeName=conf.get("zookeeper.znode.replication.peers","peers");
  this.peerStateNodeName=conf.get("zookeeper.znode.replication.peers.state","peer-state");
  this.replicationStateNodeName=conf.get("zookeeper.znode.replication.state","state");
  String rsZNodeName=conf.get("zookeeper.znode.replication.rs","rs");
  this.ourClusterKey=ZKUtil.getZooKeeperClusterKey(this.conf);
  this.replicationZNode=ZKUtil.joinZNode(this.zookeeper.baseZNode,replicationZNodeName);
  this.peersZNode=ZKUtil.joinZNode(replicationZNode,peersZNodeName);
  ZKUtil.createWithParents(this.zookeeper,this.peersZNode);
  this.rsZNode=ZKUtil.joinZNode(replicationZNode,rsZNodeName);
  ZKUtil.createWithParents(this.zookeeper,this.rsZNode);
  this.statusTracker=new ReplicationStatusTracker(this.zookeeper,abortable);
  statusTracker.start();
  readReplicationStateZnode();
}
