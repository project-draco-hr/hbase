{
  String replicationZNodeName=conf.get("zookeeper.znode.replication","replication");
  String peersZNodeName=conf.get("zookeeper.znode.replication.peers","peers");
  String repMasterZNodeName=conf.get("zookeeper.znode.replication.master","master");
  this.replicationStateNodeName=conf.get("zookeeper.znode.replication.state","state");
  String clusterIdZNodeName=conf.get("zookeeper.znode.replication.clusterId","clusterId");
  String rsZNodeName=conf.get("zookeeper.znode.replication.rs","rs");
  String thisCluster=this.conf.get(HConstants.ZOOKEEPER_QUORUM) + ":" + this.conf.get("hbase.zookeeper.property.clientPort")+ ":"+ this.conf.get(HConstants.ZOOKEEPER_ZNODE_PARENT);
  this.replicationZNode=ZKUtil.joinZNode(this.zookeeper.baseZNode,replicationZNodeName);
  this.peersZNode=ZKUtil.joinZNode(replicationZNode,peersZNodeName);
  this.rsZNode=ZKUtil.joinZNode(replicationZNode,rsZNodeName);
  String znode=ZKUtil.joinZNode(this.replicationZNode,clusterIdZNodeName);
  byte[] data=ZKUtil.getData(this.zookeeper,znode);
  String idResult=Bytes.toString(data);
  this.clusterId=idResult == null ? Byte.toString(HConstants.DEFAULT_CLUSTER_ID) : idResult;
  znode=ZKUtil.joinZNode(this.replicationZNode,repMasterZNodeName);
  data=ZKUtil.getData(this.zookeeper,znode);
  String address=Bytes.toString(data);
  this.replicationMaster=thisCluster.equals(address);
  LOG.info("This cluster (" + thisCluster + ") is a "+ (this.replicationMaster ? "master" : "slave")+ " for replication"+ ", compared with ("+ address+ ")");
}
