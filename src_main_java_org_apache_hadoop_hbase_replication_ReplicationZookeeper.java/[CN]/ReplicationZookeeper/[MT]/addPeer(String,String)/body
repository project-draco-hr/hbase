{
  try {
    if (peerExists(id)) {
      throw new IllegalArgumentException("Cannot add existing peer");
    }
    ZKUtil.createWithParents(this.zookeeper,this.peersZNode);
    ZKUtil.createAndWatch(this.zookeeper,ZKUtil.joinZNode(this.peersZNode,id),Bytes.toBytes(clusterKey));
    ZKUtil.createAndWatch(this.zookeeper,getPeerStateNode(id),Bytes.toBytes(PeerState.ENABLED.name()));
  }
 catch (  KeeperException e) {
    throw new IOException("Unable to add peer",e);
  }
}
