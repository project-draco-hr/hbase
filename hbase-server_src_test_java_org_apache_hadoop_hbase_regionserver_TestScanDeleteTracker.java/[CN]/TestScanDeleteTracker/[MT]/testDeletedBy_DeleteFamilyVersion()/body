{
  byte[] qualifier1=Bytes.toBytes("qualifier1");
  byte[] qualifier2=Bytes.toBytes("qualifier2");
  byte[] qualifier3=Bytes.toBytes("qualifier3");
  byte[] qualifier4=Bytes.toBytes("qualifier4");
  deleteType=KeyValue.Type.DeleteFamilyVersion.getCode();
  KeyValue kv=new KeyValue(Bytes.toBytes("row"),Bytes.toBytes("f"),null,timestamp,KeyValue.Type.DeleteFamilyVersion);
  sdt.add(kv);
  kv=new KeyValue(Bytes.toBytes("row"),Bytes.toBytes("f"),qualifier1,timestamp,KeyValue.Type.DeleteFamilyVersion);
  DeleteResult ret=sdt.isDeleted(kv);
  assertEquals(DeleteResult.FAMILY_VERSION_DELETED,ret);
  kv=new KeyValue(Bytes.toBytes("row"),Bytes.toBytes("f"),qualifier2,timestamp,KeyValue.Type.DeleteFamilyVersion);
  ret=sdt.isDeleted(kv);
  assertEquals(DeleteResult.FAMILY_VERSION_DELETED,ret);
  kv=new KeyValue(Bytes.toBytes("row"),Bytes.toBytes("f"),qualifier3,timestamp,KeyValue.Type.DeleteFamilyVersion);
  ret=sdt.isDeleted(kv);
  assertEquals(DeleteResult.FAMILY_VERSION_DELETED,ret);
  kv=new KeyValue(Bytes.toBytes("row"),Bytes.toBytes("f"),qualifier4,timestamp,KeyValue.Type.DeleteFamilyVersion);
  ret=sdt.isDeleted(kv);
  assertEquals(DeleteResult.FAMILY_VERSION_DELETED,ret);
  kv=new KeyValue(Bytes.toBytes("row"),Bytes.toBytes("f"),qualifier1,timestamp + 3,KeyValue.Type.DeleteFamilyVersion);
  ret=sdt.isDeleted(kv);
  assertEquals(DeleteResult.NOT_DELETED,ret);
  kv=new KeyValue(Bytes.toBytes("row"),Bytes.toBytes("f"),qualifier2,timestamp - 2,KeyValue.Type.DeleteFamilyVersion);
  ret=sdt.isDeleted(kv);
  assertEquals(DeleteResult.NOT_DELETED,ret);
  kv=new KeyValue(Bytes.toBytes("row"),Bytes.toBytes("f"),qualifier3,timestamp - 5,KeyValue.Type.DeleteFamilyVersion);
  ret=sdt.isDeleted(kv);
  assertEquals(DeleteResult.NOT_DELETED,ret);
  kv=new KeyValue(Bytes.toBytes("row"),Bytes.toBytes("f"),qualifier4,timestamp + 8,KeyValue.Type.DeleteFamilyVersion);
  ret=sdt.isDeleted(kv);
  assertEquals(DeleteResult.NOT_DELETED,ret);
}
