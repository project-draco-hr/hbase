{
  Configuration conf=UTIL.getConfiguration();
  ThriftMetrics metrics=getMetrics(conf);
  THBaseService.Iface handler=ThriftHBaseServiceHandler.newInstance(conf,metrics);
  byte[] rowName="testMetrics".getBytes();
  ByteBuffer table=ByteBuffer.wrap(tableAname);
  TGet get=new TGet(ByteBuffer.wrap(rowName));
  assertFalse(handler.exists(table,get));
  List<TColumnValue> columnValues=new ArrayList<TColumnValue>();
  columnValues.add(new TColumnValue(ByteBuffer.wrap(familyAname),ByteBuffer.wrap(qualifierAname),ByteBuffer.wrap(valueAname)));
  columnValues.add(new TColumnValue(ByteBuffer.wrap(familyBname),ByteBuffer.wrap(qualifierBname),ByteBuffer.wrap(valueBname)));
  TPut put=new TPut(ByteBuffer.wrap(rowName),columnValues);
  put.setColumnValues(columnValues);
  handler.put(table,put);
  assertTrue(handler.exists(table,get));
  logMetrics(metrics);
  verifyMetrics(metrics,"put_num_ops",1);
  verifyMetrics(metrics,"exists_num_ops",2);
}
