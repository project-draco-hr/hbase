{
  Configuration conf=new Configuration(context.getConfiguration());
  String tableName=conf.get(OUTPUT_TABLE);
  String address=conf.get(QUORUM_ADDRESS);
  String serverClass=conf.get(REGION_SERVER_CLASS);
  String serverImpl=conf.get(REGION_SERVER_IMPL);
  HTable table=null;
  try {
    HBaseConfiguration.addHbaseResources(conf);
    if (address != null) {
      String[] parts=address.split(":");
      conf.set(HConstants.ZOOKEEPER_QUORUM,parts[0]);
      conf.set(HConstants.ZOOKEEPER_ZNODE_PARENT,parts[1]);
    }
    if (serverClass != null) {
      conf.set(HConstants.REGION_SERVER_CLASS,serverClass);
      conf.set(HConstants.REGION_SERVER_IMPL,serverImpl);
    }
    table=new HTable(conf,tableName);
  }
 catch (  IOException e) {
    LOG.error(e);
    throw e;
  }
  table.setAutoFlush(false);
  return new TableRecordWriter<KEY>(table);
}
