{
  MiniHBaseCluster cluster=TEST_UTIL.getHBaseCluster();
  try (Connection connection=ConnectionFactory.createConnection(TEST_UTIL.getConfiguration())){
    try (Admin admin=connection.getAdmin()){
      admin.closeRegion(cluster.getServerHoldingMeta(),HRegionInfo.FIRST_META_REGIONINFO);
    }
   }
   regionStates.regionOffline(HRegionInfo.FIRST_META_REGIONINFO);
  new MetaTableLocator().deleteMetaLocation(cluster.getMaster().getZooKeeper());
  assertFalse(regionStates.isRegionOnline(HRegionInfo.FIRST_META_REGIONINFO));
  HBaseFsck hbck=doFsck(conf,true);
  assertErrors(hbck,new ERROR_CODE[]{ERROR_CODE.UNKNOWN,ERROR_CODE.NO_META_REGION,ERROR_CODE.NULL_META_REGION});
  assertNoErrors(doFsck(conf,false));
}
