{
  MiniHBaseCluster cluster=TEST_UTIL.getHBaseCluster();
  HBaseAdmin admin=null;
  try {
    admin=new HBaseAdmin(TEST_UTIL.getConfiguration());
    admin.closeRegion(cluster.getServerHoldingMeta(),HRegionInfo.FIRST_META_REGIONINFO);
  }
  finally {
    if (admin != null) {
      admin.close();
    }
  }
  regionStates.regionOffline(HRegionInfo.FIRST_META_REGIONINFO);
  MetaRegionTracker.deleteMetaLocation(cluster.getMaster().getZooKeeper());
  assertFalse(regionStates.isRegionOnline(HRegionInfo.FIRST_META_REGIONINFO));
  HBaseFsck hbck=doFsck(conf,true);
  assertErrors(hbck,new ERROR_CODE[]{ERROR_CODE.UNKNOWN,ERROR_CODE.NO_META_REGION,ERROR_CODE.NULL_META_REGION});
  assertNoErrors(doFsck(conf,false));
}
