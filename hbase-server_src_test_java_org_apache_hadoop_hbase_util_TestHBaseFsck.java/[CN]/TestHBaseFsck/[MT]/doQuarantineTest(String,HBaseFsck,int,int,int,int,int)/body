{
  try {
    setupTable(table);
    assertEquals(ROWKEYS.length,countRows());
    TEST_UTIL.getHBaseAdmin().flush(table);
    TEST_UTIL.getHBaseAdmin().disableTable(table);
    String[] args={"-sidelineCorruptHFiles","-repairHoles","-ignorePreCheckPermission",table};
    ExecutorService exec=new ScheduledThreadPoolExecutor(10);
    HBaseFsck res=hbck.exec(exec,args);
    HFileCorruptionChecker hfcc=res.getHFilecorruptionChecker();
    assertEquals(hfcc.getHFilesChecked(),check);
    assertEquals(hfcc.getCorrupted().size(),corrupt);
    assertEquals(hfcc.getFailures().size(),fail);
    assertEquals(hfcc.getQuarantined().size(),quar);
    assertEquals(hfcc.getMissing().size(),missing);
    TEST_UTIL.getHBaseAdmin().enableTable(table);
  }
  finally {
    deleteTable(table);
  }
}
