{
  conf.setInt("hbase.regionserver.handler.count",2);
  conf.setInt("hbase.regionserver.metahandler.count",2);
  final int poolSize=7;
  conf.setInt("hbase.htable.threads.max",poolSize);
  conf.setInt("hbase.hconnection.threads.max",2 * poolSize);
  conf.setInt("hbase.hconnection.threads.core",poolSize);
  TEST_UTIL.startMiniCluster(3);
  tableExecutorService=new ThreadPoolExecutor(1,poolSize,60,TimeUnit.SECONDS,new SynchronousQueue<Runnable>(),Threads.newDaemonThreadFactory("testhbck"));
  hbfsckExecutorService=new ScheduledThreadPoolExecutor(poolSize);
  AssignmentManager assignmentManager=TEST_UTIL.getHBaseCluster().getMaster().getAssignmentManager();
  regionStates=assignmentManager.getRegionStates();
  connection=(ClusterConnection)TEST_UTIL.getConnection();
  admin=connection.getAdmin();
  admin.setBalancerRunning(false,true);
}
