{
  TableName table=TableName.valueOf(name.getMethodName());
  ExecutorService exec=new ScheduledThreadPoolExecutor(10);
  final FileSystem fs=FileSystem.get(conf);
  HBaseFsck hbck=new HBaseFsck(conf,exec){
    @Override public HFileCorruptionChecker createHFileCorruptionChecker(    boolean sidelineCorruptHFiles) throws IOException {
      return new HFileCorruptionChecker(conf,executor,sidelineCorruptHFiles){
        boolean attemptedFirstHFile=false;
        @Override protected void checkHFile(        Path p) throws IOException {
          if (!attemptedFirstHFile) {
            attemptedFirstHFile=true;
            assertTrue(fs.delete(p,true));
          }
          super.checkHFile(p);
        }
      }
;
    }
  }
;
  doQuarantineTest(table,hbck,4,0,0,0,1);
}
