{
  HTableDescriptor desc=new HTableDescriptor(tablename);
  HColumnDescriptor hcd=new HColumnDescriptor(Bytes.toString(FAM));
  desc.addFamily(hcd);
  TEST_UTIL.getHBaseAdmin().createTable(desc,SPLITS);
  tbl=new HTable(TEST_UTIL.getConfiguration(),tablename);
  List<Put> puts=new ArrayList<Put>();
  for (  byte[] row : ROWKEYS) {
    Put p=new Put(row);
    p.add(FAM,Bytes.toBytes("val"),row);
    puts.add(p);
  }
  tbl.put(puts);
  tbl.flushCommits();
  long endTime=System.currentTimeMillis() + 60000;
  while (!TEST_UTIL.getHBaseAdmin().isTableEnabled(tablename)) {
    try {
      if (System.currentTimeMillis() > endTime) {
        fail("Failed to enable table " + tablename + " after waiting for 60 sec");
      }
      Thread.sleep(100);
    }
 catch (    InterruptedException e) {
      e.printStackTrace();
      fail("Interrupted when waiting table " + tablename + " to be enabled");
    }
  }
  return tbl;
}
