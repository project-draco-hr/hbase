{
  ClusterStatus status=admin.getMaster().getClusterStatus();
  Collection<ServerName> regionServers=status.getServers();
  Map<ServerName,List<String>> mm=new HashMap<ServerName,List<String>>();
  HConnection connection=admin.getConnection();
  for (  ServerName hsi : regionServers) {
    AdminProtocol server=connection.getAdmin(hsi.getHostname(),hsi.getPort());
    List<HRegionInfo> regions=ProtobufUtil.getOnlineRegions(server);
    List<String> regionNames=new ArrayList<String>();
    for (    HRegionInfo hri : regions) {
      regionNames.add(hri.getRegionNameAsString());
    }
    mm.put(hsi,regionNames);
  }
  return mm;
}
