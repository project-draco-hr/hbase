{
  TableName table=TableName.valueOf(name.getMethodName());
  ExecutorService exec=new ScheduledThreadPoolExecutor(10);
  final FileSystem fs=FileSystem.get(conf);
  HBaseFsck hbck=new HBaseFsck(conf,exec){
    @Override public HFileCorruptionChecker createHFileCorruptionChecker(    boolean sidelineCorruptHFiles) throws IOException {
      return new HFileCorruptionChecker(conf,executor,sidelineCorruptHFiles){
        boolean attemptedFirstRegionDir=false;
        @Override protected void checkRegionDir(        Path p) throws IOException {
          if (!attemptedFirstRegionDir) {
            attemptedFirstRegionDir=true;
            assertTrue(fs.delete(p,true));
          }
          super.checkRegionDir(p);
        }
      }
;
    }
  }
;
  doQuarantineTest(table,hbck,3,0,0,0,1);
}
