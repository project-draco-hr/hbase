{
  String snapshots[][]={snapshot1Keys,snapshot2Keys};
  for (int i=1; i <= snapshots.length; i++) {
    for (    String table : tables) {
      TEST_UTIL.getHBaseAdmin().cloneSnapshot(table + "_snapshot" + i,table + "_clone" + i);
      FSUtils.logFileSystemState(FileSystem.get(TEST_UTIL.getConfiguration()),FSUtils.getRootDir(TEST_UTIL.getConfiguration()),LOG);
      int count=0;
      for (      Result res : new HTable(TEST_UTIL.getConfiguration(),table + "_clone" + i).getScanner(new Scan())) {
        assertEquals(snapshots[i - 1][count++],Bytes.toString(res.getRow()));
      }
      Assert.assertEquals(table + "_snapshot" + i,snapshots[i - 1].length,count);
    }
  }
}
