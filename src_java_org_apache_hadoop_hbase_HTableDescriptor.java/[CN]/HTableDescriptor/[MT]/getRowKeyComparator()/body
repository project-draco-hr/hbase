{
  if (comparator != null) {
    return comparator;
  }
  byte[] bytes=getValue(ROW_KEY_COMPARATOR.getBytes());
  if (bytes == null) {
    return null;
  }
  ByteArrayInputStream bis=new ByteArrayInputStream(bytes);
  DataInputStream in=new DataInputStream(bis);
  HBaseConfiguration conf=new HBaseConfiguration();
  try {
    comparator=(WritableComparator<byte[]>)ObjectWritable.readObject(in,conf);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
  return comparator;
}
