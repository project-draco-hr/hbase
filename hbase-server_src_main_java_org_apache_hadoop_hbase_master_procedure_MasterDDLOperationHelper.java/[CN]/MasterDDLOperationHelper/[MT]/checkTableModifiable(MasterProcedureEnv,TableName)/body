{
  if (!MetaTableAccessor.tableExists(env.getMasterServices().getConnection(),tableName)) {
    throw new TableNotFoundException(tableName);
  }
  if (!env.getMasterServices().getTableStateManager().isTableState(tableName,TableState.State.DISABLED) && !MasterDDLOperationHelper.isOnlineSchemaChangeAllowed(env)) {
    throw new TableNotDisabledException(tableName);
  }
}
