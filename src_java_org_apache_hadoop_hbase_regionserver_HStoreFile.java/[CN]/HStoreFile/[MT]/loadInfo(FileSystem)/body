{
  Path p=null;
  if (isReference()) {
    p=getInfoFilePath(reference.getEncodedRegionName(),this.reference.getFileId());
  }
 else {
    p=getInfoFilePath();
  }
  DataInputStream in=new DataInputStream(fs.open(p));
  try {
    byte flag=in.readByte();
    if (flag == INFO_SEQ_NUM) {
      return in.readLong();
    }
    throw new IOException("Cannot process log file: " + p);
  }
  finally {
    in.close();
  }
}
