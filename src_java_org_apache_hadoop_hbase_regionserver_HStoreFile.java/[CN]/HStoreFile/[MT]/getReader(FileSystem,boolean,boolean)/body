{
  if (isReference()) {
    return new HStoreFile.HalfMapFileReader(fs,getMapFilePath(reference).toString(),conf,reference.getFileRegion(),reference.getMidkey(),bloomFilter,blockCacheEnabled);
  }
  return new BloomFilterMapFile.Reader(fs,getMapFilePath().toString(),conf,bloomFilter,blockCacheEnabled);
}
