{
  this.conf=conf;
  this.fs=fs;
  this.basedir=basedir;
  this.encodedRegionName=encodedRegionName;
  this.colFamily=new Text(colFamily);
  long id=fileId;
  if (id == -1) {
    Path mapdir=HStoreFile.getMapDir(basedir,encodedRegionName,colFamily);
    Path testpath=null;
    do {
      id=Math.abs(rand.nextLong());
      testpath=new Path(mapdir,createHStoreFilename(id,null));
    }
 while (fs.exists(testpath));
  }
  this.fileId=id;
  this.reference=ref;
}
