{
  int version=in.readInt();
  if (version < 3)   throw new IOException("versions < 3 are not supported (and never existed!?)");
  name=TableName.valueOf(Bytes.readByteArray(in));
  setRootRegion(in.readBoolean());
  setMetaRegion(in.readBoolean());
  values.clear();
  configuration.clear();
  int numVals=in.readInt();
  for (int i=0; i < numVals; i++) {
    ImmutableBytesWritable key=new ImmutableBytesWritable();
    ImmutableBytesWritable value=new ImmutableBytesWritable();
    key.readFields(in);
    value.readFields(in);
    setValue(key,value);
  }
  families.clear();
  int numFamilies=in.readInt();
  for (int i=0; i < numFamilies; i++) {
    HColumnDescriptor c=new HColumnDescriptor();
    c.readFields(in);
    families.put(c.getName(),c);
  }
  if (version >= 7) {
    int numConfigs=in.readInt();
    for (int i=0; i < numConfigs; i++) {
      ImmutableBytesWritable key=new ImmutableBytesWritable();
      ImmutableBytesWritable value=new ImmutableBytesWritable();
      key.readFields(in);
      value.readFields(in);
      configuration.put(Bytes.toString(key.get(),key.getOffset(),key.getLength()),Bytes.toString(value.get(),value.getOffset(),value.getLength()));
    }
  }
}
