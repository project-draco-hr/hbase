{
  if (this.rootRegion != null) {
    try {
      this.rootRegion.close();
    }
 catch (    IOException e) {
      LOG.error("closing root region",e);
    }
 finally {
      this.rootRegion=null;
    }
  }
  try {
    for (    HRegion r : metaRegions.values()) {
      r.close();
    }
  }
 catch (  IOException e) {
    LOG.error("closing meta region",e);
  }
 finally {
    metaRegions.clear();
  }
  try {
    if (this.log != null) {
      this.log.rollWriter();
      this.log.closeAndDelete();
    }
  }
 catch (  IOException e) {
    LOG.error("closing HLog",e);
  }
 finally {
    this.log=null;
  }
}
