{
  InternalScanner metaScanner=m.getScanner(HConstants.COL_REGIONINFO_ARRAY,HConstants.EMPTY_START_ROW,HConstants.LATEST_TIMESTAMP,null);
  try {
    List<KeyValue> results=new ArrayList<KeyValue>();
    while (metaScanner.next(results)) {
      HRegionInfo info=null;
      for (      KeyValue kv : results) {
        if (KeyValue.META_COMPARATOR.compareColumns(kv,HConstants.COL_REGIONINFO,0,HConstants.COL_REGIONINFO.length) == 0) {
          info=Writables.getHRegionInfoOrNull(kv.getValue());
          if (info == null) {
            LOG.warn("region info is null for row " + Bytes.toString(kv.getRow()) + " in table "+ HConstants.META_TABLE_NAME);
          }
          break;
        }
      }
      if (!listener.processRow(info)) {
        break;
      }
      results.clear();
    }
  }
  finally {
    metaScanner.close();
  }
}
