{
  if (!initialized) {
    this.fs=FileSystem.get(this.conf);
    this.rootdir=fs.makeQualified(new Path(this.conf.get(HConstants.HBASE_DIR)));
    if (!fs.exists(rootdir)) {
      String message="HBase root directory " + rootdir.toString() + " does not exist.";
      LOG.error(message);
      throw new FileNotFoundException(message);
    }
    this.log=new HLog(this.fs,new Path(this.fs.getHomeDirectory(),HConstants.HREGION_LOGDIR_NAME + "_" + System.currentTimeMillis()),this.conf,null);
    this.initialized=true;
  }
  return this.rootdir;
}
