{
  Map<String,String> peers=new TreeMap<String,String>();
  List<String> ids=null;
  try {
    ids=ZKUtil.listChildrenNoWatch(this.zookeeper,this.peersZNode);
    for (    String id : ids) {
      byte[] bytes=ZKUtil.getData(this.zookeeper,ZKUtil.joinZNode(this.peersZNode,id));
      String clusterKey=null;
      try {
        clusterKey=parsePeerFrom(bytes);
      }
 catch (      DeserializationException de) {
        LOG.warn("Failed parse of clusterid=" + id + " znode content, continuing.");
        continue;
      }
      peers.put(id,clusterKey);
    }
  }
 catch (  KeeperException e) {
    this.abortable.abort("Cannot get the list of peers ",e);
  }
  return peers;
}
