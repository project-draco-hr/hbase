{
  super(server.getZooKeeper(),server.getConfiguration(),server);
  this.abortable=server;
  this.zookeeper=server.getZooKeeper();
  this.conf=server.getConfiguration();
  setZNodes(server);
  this.replicationState=new ReplicationStateImpl(this.zookeeper,conf,server,replicating);
  this.replicationState.init();
  this.replicationQueues=new ReplicationQueuesZKImpl(this.zookeeper,this.conf,server);
  this.replicationQueues.init(server.getServerName().toString());
  this.replicationPeers=new ReplicationPeersZKImpl(this.zookeeper,this.conf,server);
  this.replicationPeers.init();
}
