{
  this.abortable=server;
  this.zookeeper=server.getZooKeeper();
  this.conf=server.getConfiguration();
  setZNodes(server);
  this.replicationState=new ReplicationStateImpl(this.zookeeper,conf,server,replicating);
  this.peerClusters=new HashMap<String,ReplicationPeer>();
  ZKUtil.createWithParents(this.zookeeper,ZKUtil.joinZNode(this.replicationZNode,this.replicationStateNodeName));
  this.rsServerNameZnode=ZKUtil.joinZNode(rsZNode,server.getServerName().toString());
  ZKUtil.createWithParents(this.zookeeper,this.rsServerNameZnode);
  this.replicationQueues=new ReplicationQueuesZKImpl(this.zookeeper,this.conf,server);
  this.replicationQueues.init(server.getServerName().toString());
  connectExistingPeers();
}
