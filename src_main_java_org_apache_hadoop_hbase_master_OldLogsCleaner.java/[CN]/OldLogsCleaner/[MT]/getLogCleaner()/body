{
  try {
    Class c=Class.forName(conf.get("hbase.master.logcleanerplugin.impl",TimeToLiveLogCleaner.class.getCanonicalName()));
    LogCleanerDelegate cleaner=(LogCleanerDelegate)c.newInstance();
    cleaner.setConf(conf);
    return cleaner;
  }
 catch (  Exception e) {
    LOG.warn("Passed log cleaner implementation throws errors, " + "defaulting to TimeToLiveLogCleaner",e);
    return new TimeToLiveLogCleaner();
  }
}
