{
  Map<ServerName,List<HRegionInfo>> assignmentMap;
  try {
    FavoredNodeAssignmentHelper assignmentHelper=new FavoredNodeAssignmentHelper(servers,configuration);
    assignmentHelper.initialize();
    if (!assignmentHelper.canPlaceFavoredNodes()) {
      return super.roundRobinAssignment(regions,servers);
    }
    assignmentMap=new HashMap<ServerName,List<HRegionInfo>>();
    roundRobinAssignmentImpl(assignmentHelper,assignmentMap,regions,servers);
  }
 catch (  Exception ex) {
    LOG.warn("Encountered exception while doing favored-nodes assignment " + ex + " Falling back to regular assignment");
    assignmentMap=super.roundRobinAssignment(regions,servers);
  }
  return assignmentMap;
}
