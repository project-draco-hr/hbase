{
  if (firstNextCall) {
    firstNextCall=false;
    if (this.top) {
      WritableComparable nearest=getClosest(this.midkey,val);
      if (nearest != null) {
        Writables.copyWritable(nearest,key);
        return true;
      }
      return false;
    }
  }
  boolean result=super.next(key,val);
  int cmpresult=key.compareTo(midkey);
  if (top && cmpresult < 0) {
    LOG.error("BUG BUG BUG. HalfMapFileReader wanted to return key out of range. DANGER");
    throw new IOException("BUG BUG BUG. HalfMapFileReader wanted to return key out of range. DANGER");
  }
 else   if (!top && cmpresult >= 0) {
    result=false;
  }
  return result;
}
