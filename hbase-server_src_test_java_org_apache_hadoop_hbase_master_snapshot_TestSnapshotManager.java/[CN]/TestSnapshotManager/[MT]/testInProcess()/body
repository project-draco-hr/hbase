{
  SnapshotManager manager=getNewManager();
  TakeSnapshotHandler handler=Mockito.mock(TakeSnapshotHandler.class);
  assertFalse("Manager is in process when there is no current handler",manager.isTakingSnapshot());
  manager.setSnapshotHandlerForTesting(handler);
  Mockito.when(handler.isFinished()).thenReturn(false);
  assertTrue("Manager isn't in process when handler is running",manager.isTakingSnapshot());
  Mockito.when(handler.isFinished()).thenReturn(true);
  assertFalse("Manager is process when handler isn't running",manager.isTakingSnapshot());
}
