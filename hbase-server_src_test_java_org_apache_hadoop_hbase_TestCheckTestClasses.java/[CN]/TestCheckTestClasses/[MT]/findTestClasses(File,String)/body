{
  List<Class<?>> classes=new ArrayList<Class<?>>();
  if (!baseDirectory.exists()) {
    return classes;
  }
  File[] files=baseDirectory.listFiles(TEST_CLASS_FILE_FILTER);
  assertNotNull(files);
  Pattern p=Pattern.compile("hbase-hadoop\\d?-compat");
  for (  File file : files) {
    final String fileName=file.getName();
    if (p.matcher(file.getAbsolutePath()).find()) {
      continue;
    }
    if (file.isDirectory()) {
      classes.addAll(findTestClasses(file,packageName + "." + fileName));
    }
 else {
      Class<?> c=Class.forName(packageName + '.' + fileName.substring(0,fileName.length() - 6),false,this.getClass().getClassLoader());
      if (isTestClass(c)) {
        classes.add(c);
      }
    }
  }
  return classes;
}
