{
  schedLock.lock();
  TableQueue queue=getTableQueue(table);
  boolean hasXLock=queue.tryExclusiveLock();
  if (!hasXLock) {
    schedLock.unlock();
    return false;
  }
  removeFromRunQueue(tableRunQueue,queue);
  schedLock.unlock();
  hasXLock=queue.tryZkExclusiveLock(lockManager,purpose);
  if (!hasXLock) {
    schedLock.lock();
    queue.releaseExclusiveLock();
    addToRunQueue(tableRunQueue,queue);
    schedLock.unlock();
  }
  return hasXLock;
}
