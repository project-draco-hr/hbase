{
  HBaseRpcController pcrc;
  if (controller != null && controller instanceof HBaseRpcController) {
    pcrc=(HBaseRpcController)controller;
    if (!pcrc.hasCallTimeout()) {
      pcrc.setCallTimeout(channelOperationTimeout);
    }
  }
 else {
    pcrc=new HBaseRpcControllerImpl();
    pcrc.setCallTimeout(channelOperationTimeout);
  }
  return pcrc;
}
