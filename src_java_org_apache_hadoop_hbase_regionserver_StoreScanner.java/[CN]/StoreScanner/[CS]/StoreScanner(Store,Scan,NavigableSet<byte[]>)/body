{
  this.store=store;
  matcher=new ScanQueryMatcher(scan,store.getFamily().getName(),columns,store.ttl,store.comparator.getRawComparator(),store.versionsToReturn(scan.getMaxVersions()));
  List<KeyValueScanner> scanners=getStoreFileScanners();
  scanners.add(store.memcache.getScanner());
  for (  KeyValueScanner scanner : scanners) {
    scanner.seek(matcher.getStartKey());
  }
  heap=new KeyValueHeap(scanners.toArray(new KeyValueScanner[scanners.size()]),store.comparator);
  this.store.addChangedReaderObserver(this);
}
