{
  KeyValue peeked=this.heap.peek();
  if (peeked == null) {
    close();
    return false;
  }
  matcher.setRow(peeked.getRow());
  KeyValue kv;
  while ((kv=this.heap.peek()) != null) {
    QueryMatcher.MatchCode mc=matcher.match(kv);
switch (mc) {
case INCLUDE:
      KeyValue next=this.heap.next();
    result.add(next);
  continue;
case DONE:
if (result.isEmpty()) {
  matcher.setRow(this.heap.peek().getRow());
  continue;
}
if (matcher.filterEntireRow()) {
result.clear();
matcher.setRow(heap.peek().getRow());
continue;
}
return true;
case DONE_SCAN:
close();
return false;
case SEEK_NEXT_ROW:
heap.next();
break;
case SEEK_NEXT_COL:
heap.next();
break;
case SKIP:
this.heap.next();
break;
}
}
if (result.size() > 0) {
return true;
}
close();
return false;
}
