{
  UserGroupInformation previous=(UserGroupInformation)callStatic("getCurrentUGI");
  if (ugi != null) {
    callStatic("setCurrentUGI",new Class[]{UserGroupInformation.class},new Object[]{ugi});
  }
  T result=null;
  try {
    result=action.run();
  }
 catch (  Exception e) {
    if (e instanceof IOException) {
      throw (IOException)e;
    }
 else     if (e instanceof InterruptedException) {
      throw (InterruptedException)e;
    }
 else     if (e instanceof RuntimeException) {
      throw (RuntimeException)e;
    }
 else {
      throw new UndeclaredThrowableException(e,"Unknown exception in runAs()");
    }
  }
 finally {
    callStatic("setCurrentUGI",new Class[]{UserGroupInformation.class},new Object[]{previous});
  }
  return result;
}
