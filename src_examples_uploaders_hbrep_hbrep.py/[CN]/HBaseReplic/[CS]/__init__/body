def __init__(self, service_name, args):
    try:
        self.run_script = 0
        skytools.DBScript.__init__(self, service_name, args)
        self.config_file = self.args[0]
        if (len(self.args) < 2):
            self.print_usage()
            print 'need command'
            sys.exit(0)
        cmd = self.args[1]
        if (not (cmd in ['play', 'bootstrap', 'install', 'uninstall'])):
            self.print_usage()
            print 'unknown command'
            sys.exit(0)
        if (len(self.args) < 3):
            self.print_usage()
            print 'need table names'
            sys.exit(0)
        else:
            self.table_names = self.args[2:]
        if (cmd == 'play'):
            self.run_script = HBaseConsumer(service_name, ([self.config_file] + self.table_names))
        elif (cmd == 'bootstrap'):
            self.run_script = HBaseBootstrap(service_name, ([self.config_file] + self.table_names))
        elif (cmd == 'install'):
            self.work = self.do_install
        elif (cmd == 'uninstall'):
            self.work = self.do_uninstall
    except Exception as e:
        sys.exit(e)
