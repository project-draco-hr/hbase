{
  this.indexInterval=conf.getInt(INDEX_INTERVAL,this.indexInterval);
  this.comparator=comparator;
  this.lastKey=comparator.newKey();
  Path dir=new Path(dirName);
  if (!fs.mkdirs(dir)) {
    throw new IOException("Mkdirs failed to create directory " + dir.toString());
  }
  Path dataFile=new Path(dir,DATA_FILE_NAME);
  Path indexFile=new Path(dir,INDEX_FILE_NAME);
  Class keyClass=comparator.getKeyClass();
  this.data=SequenceFile.createWriter(fs,conf,dataFile,keyClass,valClass,compress,codec,progress);
  this.index=SequenceFile.createWriter(fs,conf,indexFile,keyClass,LongWritable.class,CompressionType.BLOCK,progress);
}
