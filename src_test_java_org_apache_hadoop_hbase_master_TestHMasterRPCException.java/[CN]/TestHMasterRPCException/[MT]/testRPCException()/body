{
  HBaseTestingUtility TEST_UTIL=new HBaseTestingUtility();
  TEST_UTIL.startMiniZKCluster();
  Configuration conf=TEST_UTIL.getConfiguration();
  conf.set(HConstants.MASTER_PORT,"0");
  HMaster hm=new HMaster(conf);
  ServerName sm=hm.getServerName();
  InetSocketAddress isa=new InetSocketAddress(sm.getHostname(),sm.getPort());
  try {
    HMasterInterface inf=(HMasterInterface)HBaseRPC.getProxy(HMasterInterface.class,HMasterInterface.VERSION,isa,conf,100);
    inf.isMasterRunning(null,RequestConverter.buildIsMasterRunningRequest());
    fail();
  }
 catch (  RemoteException ex) {
    assertTrue(ex.getMessage().startsWith("org.apache.hadoop.hbase.ipc.ServerNotRunningYetException: Server is not running yet"));
  }
catch (  Throwable t) {
    fail("Unexpected throwable: " + t);
  }
}
