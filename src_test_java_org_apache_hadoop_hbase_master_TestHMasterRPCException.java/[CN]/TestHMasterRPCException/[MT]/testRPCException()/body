{
  HBaseTestingUtility TEST_UTIL=new HBaseTestingUtility();
  TEST_UTIL.startMiniZKCluster();
  Configuration conf=TEST_UTIL.getConfiguration();
  conf.set(HConstants.MASTER_PORT,"0");
  HMaster hm=new HMaster(conf);
  HServerAddress hma=hm.getMasterAddress();
  try {
    HMasterInterface inf=(HMasterInterface)HBaseRPC.getProxy(HMasterInterface.class,HBaseRPCProtocolVersion.versionID,hma.getInetSocketAddress(),conf,100);
    inf.isMasterRunning();
    fail();
  }
 catch (  RemoteException ex) {
    assertTrue(ex.getMessage().startsWith("org.apache.hadoop.hbase.ipc.ServerNotRunningException: Server is not running yet"));
  }
catch (  Throwable t) {
    fail("Unexpected throwable: " + t);
  }
}
