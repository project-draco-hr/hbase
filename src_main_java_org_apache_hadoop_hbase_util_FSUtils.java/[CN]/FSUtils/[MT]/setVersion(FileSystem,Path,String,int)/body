{
  while (true)   try {
    FSDataOutputStream s=fs.create(new Path(rootdir,HConstants.VERSION_FILE_NAME));
    s.writeUTF(version);
    s.close();
    LOG.debug("Created version file at " + rootdir.toString() + " set its version at:"+ version);
    return;
  }
 catch (  IOException e) {
    if (wait > 0) {
      LOG.warn("Unable to create version file at " + rootdir.toString() + ", retrying: "+ StringUtils.stringifyException(e));
      try {
        Thread.sleep(wait);
      }
 catch (      InterruptedException ex) {
      }
    }
 else {
      throw e;
    }
  }
}
