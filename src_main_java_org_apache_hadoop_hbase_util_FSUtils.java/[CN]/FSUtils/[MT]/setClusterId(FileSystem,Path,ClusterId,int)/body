{
  while (true) {
    try {
      Path filePath=new Path(rootdir,HConstants.CLUSTER_ID_FILE_NAME);
      FSDataOutputStream s=fs.create(filePath);
      try {
        s.write(clusterId.toByteArray());
      }
  finally {
        s.close();
      }
      if (LOG.isDebugEnabled()) {
        LOG.debug("Created cluster ID file at " + filePath.toString() + " with ID: "+ clusterId);
      }
      return;
    }
 catch (    IOException ioe) {
      if (wait > 0) {
        LOG.warn("Unable to create cluster ID file in " + rootdir.toString() + ", retrying in "+ wait+ "msec: "+ StringUtils.stringifyException(ioe));
        try {
          Thread.sleep(wait);
        }
 catch (        InterruptedException ie) {
          Thread.interrupted();
          break;
        }
      }
 else {
        throw ioe;
      }
    }
  }
}
