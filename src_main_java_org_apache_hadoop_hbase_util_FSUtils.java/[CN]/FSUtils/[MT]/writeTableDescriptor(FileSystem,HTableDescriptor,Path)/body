{
  Path tableInfoPath=new Path(tableDir,HConstants.TABLEINFO_NAME);
  Path tmpPath=new Path(new Path(tableDir,".tmp"),HConstants.TABLEINFO_NAME);
  LOG.info("TableInfoPath = " + tableInfoPath + " tmpPath = "+ tmpPath);
  FSDataOutputStream out=fs.create(tmpPath,true);
  try {
    hTableDescriptor.write(out);
    out.write('\n');
    out.write('\n');
    out.write(Bytes.toBytes(hTableDescriptor.toString()));
  }
  finally {
    out.close();
  }
  if (!fs.rename(tmpPath,tableInfoPath)) {
    throw new IOException("Unable to rename " + tmpPath + " to "+ tableInfoPath);
  }
 else {
    LOG.info("TableDescriptor stored. TableInfoPath = " + tableInfoPath);
  }
}
