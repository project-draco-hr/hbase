{
  Map<String,HTableDescriptor> desc=new HashMap<String,HTableDescriptor>();
  DirFilter df=new DirFilter(fs);
  FileStatus[] tableDirs=fs.listStatus(hbaseRootDir,df);
  for (  FileStatus tableDir : tableDirs) {
    Path d=tableDir.getPath();
    String tableName=d.getName();
    if (tableName.equals(HConstants.HREGION_LOGDIR_NAME) || tableName.equals(Bytes.toString(HConstants.ROOT_TABLE_NAME)) || tableName.equals(Bytes.toString(HConstants.META_TABLE_NAME))|| tableName.equals(HConstants.HREGION_OLDLOGDIR_NAME)) {
      continue;
    }
    LOG.info("Adding tabledescriptor for table = " + tableName);
    HTableDescriptor htd=readTableDescriptor(fs,hbaseRootDir,tableName);
    if (htd != null) {
      if (!desc.containsKey(tableName)) {
        desc.put(tableName,htd);
      }
    }
  }
  return desc;
}
