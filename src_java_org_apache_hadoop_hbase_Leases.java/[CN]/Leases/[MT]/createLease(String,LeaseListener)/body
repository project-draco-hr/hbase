{
  if (stopRequested) {
    return;
  }
  Lease lease=new Lease(leaseName,System.currentTimeMillis() + leasePeriod);
synchronized (leaseQueue) {
    if (leases.containsKey(leaseName)) {
      throw new IllegalStateException("lease '" + leaseName + "' already exists");
    }
    leases.put(leaseName,lease);
    listeners.put(leaseName,listener);
    leaseQueue.add(lease);
  }
}
