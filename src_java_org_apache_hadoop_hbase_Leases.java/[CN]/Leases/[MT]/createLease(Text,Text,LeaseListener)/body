{
synchronized (leases) {
synchronized (sortedLeases) {
      Lease lease=new Lease(holderId,resourceId,listener);
      Text leaseId=lease.getLeaseId();
      if (leases.get(leaseId) != null) {
        throw new IOException("Impossible state for createLease(): Lease for holderId " + holderId + " and resourceId "+ resourceId+ " is still held.");
      }
      leases.put(leaseId,lease);
      sortedLeases.add(lease);
    }
  }
}
