{
  LOG.info("testPerTableCFReplication");
  ReplicationAdmin admin1=new ReplicationAdmin(conf1);
  new HBaseAdmin(conf1).createTable(tabA);
  new HBaseAdmin(conf1).createTable(tabB);
  new HBaseAdmin(conf1).createTable(tabC);
  new HBaseAdmin(conf2).createTable(tabA);
  new HBaseAdmin(conf2).createTable(tabB);
  new HBaseAdmin(conf2).createTable(tabC);
  new HBaseAdmin(conf3).createTable(tabA);
  new HBaseAdmin(conf3).createTable(tabB);
  new HBaseAdmin(conf3).createTable(tabC);
  HTable htab1A=new HTable(conf1,tabAName);
  HTable htab2A=new HTable(conf2,tabAName);
  HTable htab3A=new HTable(conf3,tabAName);
  HTable htab1B=new HTable(conf1,tabBName);
  HTable htab2B=new HTable(conf2,tabBName);
  HTable htab3B=new HTable(conf3,tabBName);
  HTable htab1C=new HTable(conf1,tabCName);
  HTable htab2C=new HTable(conf2,tabCName);
  HTable htab3C=new HTable(conf3,tabCName);
  admin1.addPeer("2",utility2.getClusterKey(),"TC;TB:f1,f3");
  admin1.addPeer("3",utility3.getClusterKey(),"TA;TB:f1,f2");
  putAndWaitWithFamily(row1,f1Name,htab1A,htab3A);
  ensureRowNotReplicated(row1,f1Name,htab2A);
  deleteAndWaitWithFamily(row1,f1Name,htab1A,htab3A);
  putAndWaitWithFamily(row1,f2Name,htab1A,htab3A);
  ensureRowNotReplicated(row1,f2Name,htab2A);
  deleteAndWaitWithFamily(row1,f2Name,htab1A,htab3A);
  putAndWaitWithFamily(row1,f3Name,htab1A,htab3A);
  ensureRowNotReplicated(row1,f3Name,htab2A);
  deleteAndWaitWithFamily(row1,f3Name,htab1A,htab3A);
  putAndWaitWithFamily(row1,f1Name,htab1B,htab2B,htab3B);
  deleteAndWaitWithFamily(row1,f1Name,htab1B,htab2B,htab3B);
  putAndWaitWithFamily(row1,f2Name,htab1B,htab3B);
  ensureRowNotReplicated(row1,f2Name,htab2B);
  deleteAndWaitWithFamily(row1,f2Name,htab1B,htab3B);
  putAndWaitWithFamily(row1,f3Name,htab1B,htab2B);
  ensureRowNotReplicated(row1,f3Name,htab3B);
  deleteAndWaitWithFamily(row1,f3Name,htab1B,htab2B);
  putAndWaitWithFamily(row1,f1Name,htab1C,htab2C);
  ensureRowNotReplicated(row1,f1Name,htab3C);
  deleteAndWaitWithFamily(row1,f1Name,htab1C,htab2C);
  putAndWaitWithFamily(row1,f2Name,htab1C,htab2C);
  ensureRowNotReplicated(row1,f2Name,htab3C);
  deleteAndWaitWithFamily(row1,f2Name,htab1C,htab2C);
  putAndWaitWithFamily(row1,f3Name,htab1C,htab2C);
  ensureRowNotReplicated(row1,f3Name,htab3C);
  deleteAndWaitWithFamily(row1,f3Name,htab1C,htab2C);
  admin1.setPeerTableCFs("2","TA:f1,f2; TC:f2,f3");
  admin1.setPeerTableCFs("3","TB; TC:f3");
  putAndWaitWithFamily(row2,f1Name,htab1A,htab2A);
  ensureRowNotReplicated(row2,f1Name,htab3A);
  deleteAndWaitWithFamily(row2,f1Name,htab1A,htab2A);
  putAndWaitWithFamily(row2,f2Name,htab1A,htab2A);
  ensureRowNotReplicated(row2,f2Name,htab3A);
  deleteAndWaitWithFamily(row2,f2Name,htab1A,htab2A);
  putAndWaitWithFamily(row2,f3Name,htab1A);
  ensureRowNotReplicated(row2,f3Name,htab2A,htab3A);
  deleteAndWaitWithFamily(row2,f3Name,htab1A);
  putAndWaitWithFamily(row2,f1Name,htab1B,htab3B);
  ensureRowNotReplicated(row2,f1Name,htab2B);
  deleteAndWaitWithFamily(row2,f1Name,htab1B,htab3B);
  putAndWaitWithFamily(row2,f2Name,htab1B,htab3B);
  ensureRowNotReplicated(row2,f2Name,htab2B);
  deleteAndWaitWithFamily(row2,f2Name,htab1B,htab3B);
  putAndWaitWithFamily(row2,f3Name,htab1B,htab3B);
  ensureRowNotReplicated(row2,f3Name,htab2B);
  deleteAndWaitWithFamily(row2,f3Name,htab1B,htab3B);
  putAndWaitWithFamily(row2,f1Name,htab1C);
  ensureRowNotReplicated(row2,f1Name,htab2C,htab3C);
  deleteAndWaitWithFamily(row2,f1Name,htab1C);
  putAndWaitWithFamily(row2,f2Name,htab1C,htab2C);
  ensureRowNotReplicated(row2,f2Name,htab3C);
  deleteAndWaitWithFamily(row2,f2Name,htab1C,htab2C);
  putAndWaitWithFamily(row2,f3Name,htab1C,htab2C,htab3C);
  deleteAndWaitWithFamily(row2,f3Name,htab1C,htab2C,htab3C);
}
