{
  Map<TableName,List<String>> tabCFsMap=null;
  tabCFsMap=ReplicationAdmin.parseTableCFsFromConfig(null);
  assertEquals(null,tabCFsMap);
  tabCFsMap=ReplicationAdmin.parseTableCFsFromConfig("");
  assertEquals(null,tabCFsMap);
  tabCFsMap=ReplicationAdmin.parseTableCFsFromConfig("   ");
  assertEquals(null,tabCFsMap);
  TableName tab1=TableName.valueOf("tab1");
  TableName tab2=TableName.valueOf("tab2");
  TableName tab3=TableName.valueOf("tab3");
  tabCFsMap=ReplicationAdmin.parseTableCFsFromConfig("tab1");
  assertEquals(1,tabCFsMap.size());
  assertTrue(tabCFsMap.containsKey(tab1));
  assertFalse(tabCFsMap.containsKey(tab2));
  assertEquals(null,tabCFsMap.get(tab1));
  tabCFsMap=ReplicationAdmin.parseTableCFsFromConfig("tab2:cf1");
  assertEquals(1,tabCFsMap.size());
  assertTrue(tabCFsMap.containsKey(tab2));
  assertFalse(tabCFsMap.containsKey(tab1));
  assertEquals(1,tabCFsMap.get(tab2).size());
  assertEquals("cf1",tabCFsMap.get(tab2).get(0));
  tabCFsMap=ReplicationAdmin.parseTableCFsFromConfig("tab3 : cf1 , cf3");
  assertEquals(1,tabCFsMap.size());
  assertTrue(tabCFsMap.containsKey(tab3));
  assertFalse(tabCFsMap.containsKey(tab1));
  assertEquals(2,tabCFsMap.get(tab3).size());
  assertTrue(tabCFsMap.get(tab3).contains("cf1"));
  assertTrue(tabCFsMap.get(tab3).contains("cf3"));
  tabCFsMap=ReplicationAdmin.parseTableCFsFromConfig("tab1 ; tab2:cf1 ; tab3:cf1,cf3");
  assertEquals(3,tabCFsMap.size());
  assertTrue(tabCFsMap.containsKey(tab1));
  assertTrue(tabCFsMap.containsKey(tab2));
  assertTrue(tabCFsMap.containsKey(tab3));
  assertEquals(null,tabCFsMap.get(tab1));
  assertEquals(1,tabCFsMap.get(tab2).size());
  assertEquals("cf1",tabCFsMap.get(tab2).get(0));
  assertEquals(2,tabCFsMap.get(tab3).size());
  assertTrue(tabCFsMap.get(tab3).contains("cf1"));
  assertTrue(tabCFsMap.get(tab3).contains("cf3"));
  tabCFsMap=ReplicationAdmin.parseTableCFsFromConfig("tab1 ; ; tab2:cf1 ; tab3:cf1,,cf3 ;");
  assertEquals(3,tabCFsMap.size());
  assertTrue(tabCFsMap.containsKey(tab1));
  assertTrue(tabCFsMap.containsKey(tab2));
  assertTrue(tabCFsMap.containsKey(tab3));
  assertEquals(null,tabCFsMap.get(tab1));
  assertEquals(1,tabCFsMap.get(tab2).size());
  assertEquals("cf1",tabCFsMap.get(tab2).get(0));
  assertEquals(2,tabCFsMap.get(tab3).size());
  assertTrue(tabCFsMap.get(tab3).contains("cf1"));
  assertTrue(tabCFsMap.get(tab3).contains("cf3"));
  tabCFsMap=ReplicationAdmin.parseTableCFsFromConfig("tab1:tt:cf1 ; tab2::cf1 ; tab3:cf1,cf3");
  assertEquals(1,tabCFsMap.size());
  assertFalse(tabCFsMap.containsKey(tab1));
  assertFalse(tabCFsMap.containsKey(tab2));
  assertTrue(tabCFsMap.containsKey(tab3));
  assertEquals(2,tabCFsMap.get(tab3).size());
  assertTrue(tabCFsMap.get(tab3).contains("cf1"));
  assertTrue(tabCFsMap.get(tab3).contains("cf3"));
}
