{
  Map<String,List<String>> tabCFsMap=null;
  tabCFsMap=ReplicationPeerZKImpl.parseTableCFsFromConfig(null);
  assertEquals(null,tabCFsMap);
  tabCFsMap=ReplicationPeerZKImpl.parseTableCFsFromConfig("");
  assertEquals(null,tabCFsMap);
  tabCFsMap=ReplicationPeerZKImpl.parseTableCFsFromConfig("   ");
  assertEquals(null,tabCFsMap);
  tabCFsMap=ReplicationPeerZKImpl.parseTableCFsFromConfig("tab1");
  assertEquals(1,tabCFsMap.size());
  assertTrue(tabCFsMap.containsKey("tab1"));
  assertFalse(tabCFsMap.containsKey("tab2"));
  assertEquals(null,tabCFsMap.get("tab1"));
  tabCFsMap=ReplicationPeerZKImpl.parseTableCFsFromConfig("tab2:cf1");
  assertEquals(1,tabCFsMap.size());
  assertTrue(tabCFsMap.containsKey("tab2"));
  assertFalse(tabCFsMap.containsKey("tab1"));
  assertEquals(1,tabCFsMap.get("tab2").size());
  assertEquals("cf1",tabCFsMap.get("tab2").get(0));
  tabCFsMap=ReplicationPeerZKImpl.parseTableCFsFromConfig("tab3 : cf1 , cf3");
  assertEquals(1,tabCFsMap.size());
  assertTrue(tabCFsMap.containsKey("tab3"));
  assertFalse(tabCFsMap.containsKey("tab1"));
  assertEquals(2,tabCFsMap.get("tab3").size());
  assertTrue(tabCFsMap.get("tab3").contains("cf1"));
  assertTrue(tabCFsMap.get("tab3").contains("cf3"));
  tabCFsMap=ReplicationPeerZKImpl.parseTableCFsFromConfig("tab1 ; tab2:cf1 ; tab3:cf1,cf3");
  assertEquals(3,tabCFsMap.size());
  assertTrue(tabCFsMap.containsKey("tab1"));
  assertTrue(tabCFsMap.containsKey("tab2"));
  assertTrue(tabCFsMap.containsKey("tab3"));
  assertEquals(null,tabCFsMap.get("tab1"));
  assertEquals(1,tabCFsMap.get("tab2").size());
  assertEquals("cf1",tabCFsMap.get("tab2").get(0));
  assertEquals(2,tabCFsMap.get("tab3").size());
  assertTrue(tabCFsMap.get("tab3").contains("cf1"));
  assertTrue(tabCFsMap.get("tab3").contains("cf3"));
  tabCFsMap=ReplicationPeerZKImpl.parseTableCFsFromConfig("tab1 ; ; tab2:cf1 ; tab3:cf1,,cf3 ;");
  assertEquals(3,tabCFsMap.size());
  assertTrue(tabCFsMap.containsKey("tab1"));
  assertTrue(tabCFsMap.containsKey("tab2"));
  assertTrue(tabCFsMap.containsKey("tab3"));
  assertEquals(null,tabCFsMap.get("tab1"));
  assertEquals(1,tabCFsMap.get("tab2").size());
  assertEquals("cf1",tabCFsMap.get("tab2").get(0));
  assertEquals(2,tabCFsMap.get("tab3").size());
  assertTrue(tabCFsMap.get("tab3").contains("cf1"));
  assertTrue(tabCFsMap.get("tab3").contains("cf3"));
  tabCFsMap=ReplicationPeerZKImpl.parseTableCFsFromConfig("tab1:tt:cf1 ; tab2::cf1 ; tab3:cf1,cf3");
  assertEquals(1,tabCFsMap.size());
  assertFalse(tabCFsMap.containsKey("tab1"));
  assertFalse(tabCFsMap.containsKey("tab2"));
  assertTrue(tabCFsMap.containsKey("tab3"));
  assertEquals(2,tabCFsMap.get("tab3").size());
  assertTrue(tabCFsMap.get("tab3").contains("cf1"));
  assertTrue(tabCFsMap.get("tab3").contains("cf3"));
}
