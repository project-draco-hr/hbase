{
  int regions=0;
  FileStatus[] tableDirs=this.master.getFileSystem().listStatus(this.master.getRootDir(),new TableDirFilter());
  FileStatus[] regionDirs;
  RegionDirFilter rdf=new RegionDirFilter();
  for (  FileStatus tabledir : tableDirs) {
    if (tabledir.isDir()) {
      regionDirs=this.master.getFileSystem().listStatus(tabledir.getPath(),rdf);
      regions+=regionDirs.length;
    }
  }
  return regions;
}
