{
  Delete indexDelete=makeDeleteToRemoveOldIndexEntry(indexSpec,put.getRow(),oldColumnValues);
  Put indexPut=makeIndexUpdate(indexSpec,put.getRow(),newColumnValues);
  HTable indexTable=getIndexTable(indexSpec);
  if (indexDelete != null && !Bytes.equals(indexDelete.getRow(),indexPut.getRow())) {
    LOG.debug("Deleting old index row [" + Bytes.toString(indexDelete.getRow()) + "]. New row is ["+ Bytes.toString(indexPut.getRow())+ "].");
    indexTable.delete(indexDelete);
  }
 else   if (indexDelete != null) {
    LOG.debug("Skipping deleting index row [" + Bytes.toString(indexDelete.getRow()) + "] because it has not changed.");
  }
  indexTable.put(indexPut);
}
