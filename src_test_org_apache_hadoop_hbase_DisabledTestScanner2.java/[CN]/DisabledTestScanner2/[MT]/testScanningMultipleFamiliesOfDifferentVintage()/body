{
  final byte[][] families=createTable(new HBaseAdmin(this.conf),getName());
  HTable table=new HTable(this.conf,getName());
  Scanner scanner=null;
  try {
    long time=System.currentTimeMillis();
    LOG.info("Current time " + time);
    for (int i=0; i < families.length; i++) {
      final byte[] lastKey=new byte[]{'a','a',(byte)('b' + i)};
      Incommon inc=new HTableIncommon(table);
      addContent(inc,families[i].toString(),START_KEY_BYTES,lastKey,time + (1000 * i));
      if (i == 0) {
        BatchUpdate batchUpdate=new BatchUpdate(Bytes.toBytes("bbb"));
        batchUpdate.put(families[0],"bbb".getBytes());
        inc.commit(batchUpdate);
      }
    }
    RowFilterInterface f=new WhileMatchRowFilter(new StopRowFilter(Bytes.toBytes("aad")));
    scanner=table.getScanner(families,HConstants.EMPTY_START_ROW,HConstants.LATEST_TIMESTAMP,f);
    int count=0;
    for (    RowResult e : scanner) {
      count++;
    }
    assertEquals(count,3);
  }
  finally {
    scanner.close();
  }
}
