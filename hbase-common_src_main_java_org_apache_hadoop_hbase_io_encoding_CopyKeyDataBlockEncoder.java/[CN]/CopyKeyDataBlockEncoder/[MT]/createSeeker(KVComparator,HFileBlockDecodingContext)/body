{
  return new BufferedEncodedSeeker<SeekerState>(comparator,decodingCtx){
    @Override protected void decodeNext(){
      current.keyLength=currentBuffer.getInt();
      current.valueLength=currentBuffer.getInt();
      current.ensureSpaceForKey();
      currentBuffer.get(current.keyBuffer,0,current.keyLength);
      current.valueOffset=currentBuffer.position();
      ByteBufferUtils.skip(currentBuffer,current.valueLength);
      if (includesTags()) {
        current.tagLength=currentBuffer.getShort();
        ByteBufferUtils.skip(currentBuffer,current.tagLength);
      }
      if (includesMvcc()) {
        current.memstoreTS=ByteBufferUtils.readVLong(currentBuffer);
      }
 else {
        current.memstoreTS=0;
      }
      current.nextKvOffset=currentBuffer.position();
    }
    @Override protected void decodeFirst(){
      ByteBufferUtils.skip(currentBuffer,Bytes.SIZEOF_INT);
      current.lastCommonPrefix=0;
      decodeNext();
    }
  }
;
}
