{
  this.serverName=master.getHServerAddress().toString();
  this.serverManager=master.getServerManager();
  zkWrapper=ZooKeeperWrapper.getInstance(conf,HMaster.class.getName());
  String unassignedZNode=zkWrapper.getRegionInTransitionZNode();
  if (master.isClusterStartup() && zkWrapper.exists(unassignedZNode,false)) {
    LOG.info("Cluster start, but found " + unassignedZNode + ", deleting it.");
    try {
      zkWrapper.deleteZNode(unassignedZNode,true);
    }
 catch (    KeeperException e) {
      LOG.error("Could not delete znode " + unassignedZNode,e);
      throw new IOException(e);
    }
catch (    InterruptedException e) {
      LOG.error("Could not delete znode " + unassignedZNode,e);
      throw new IOException(e);
    }
  }
  zkWrapper.createZNodeIfNotExists(unassignedZNode);
  zkWrapper.registerListener(this);
}
