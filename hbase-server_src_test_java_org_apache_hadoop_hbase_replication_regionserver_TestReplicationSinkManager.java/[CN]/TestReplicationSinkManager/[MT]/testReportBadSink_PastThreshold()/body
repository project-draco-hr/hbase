{
  List<ServerName> serverNames=Lists.newArrayList();
  for (int i=0; i < 20; i++) {
    serverNames.add(mock(ServerName.class));
  }
  when(replicationEndpoint.getRegionServers()).thenReturn(serverNames);
  sinkManager.chooseSinks();
  assertEquals(2,sinkManager.getSinks().size());
  ServerName serverName=sinkManager.getSinks().get(0);
  SinkPeer sinkPeer=new SinkPeer(serverName,mock(AdminService.BlockingInterface.class));
  for (int i=0; i <= ReplicationSinkManager.DEFAULT_BAD_SINK_THRESHOLD; i++) {
    sinkManager.reportBadSink(sinkPeer);
  }
  assertEquals(1,sinkManager.getSinks().size());
}
