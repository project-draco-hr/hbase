{
  try {
    LOG.info("Handling table operation " + eventType + " on table "+ Bytes.toString(tableName));
    List<HRegionInfo> hris=MetaReader.getTableRegions(this.server.getCatalogTracker(),tableName);
    handleTableOperation(hris);
    if (eventType.isOnlineSchemaChangeSupported() && this.masterServices.getAssignmentManager().getZKTable().isEnabledTable(Bytes.toString(tableName))) {
      if (reOpenAllRegions(hris)) {
        LOG.info("Completed table operation " + eventType + " on table "+ Bytes.toString(tableName));
      }
 else {
        LOG.warn("Error on reopening the regions");
      }
    }
    completed(null);
  }
 catch (  IOException e) {
    LOG.error("Error manipulating table " + Bytes.toString(tableName),e);
    completed(e);
  }
catch (  KeeperException e) {
    LOG.error("Error manipulating table " + Bytes.toString(tableName),e);
    completed(e);
  }
 finally {
    releaseTableLock();
  }
}
