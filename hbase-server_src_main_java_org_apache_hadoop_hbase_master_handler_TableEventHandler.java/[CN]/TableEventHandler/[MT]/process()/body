{
  if (!isPrepareCalled) {
    throw new RuntimeException("Implementation should have called prepare() first");
  }
  try {
    LOG.info("Handling table operation " + eventType + " on table "+ tableName);
    List<HRegionInfo> hris=MetaReader.getTableRegions(this.server.getCatalogTracker(),tableName);
    handleTableOperation(hris);
    if (eventType.isOnlineSchemaChangeSupported() && this.masterServices.getAssignmentManager().getTableStateManager().isTableState(tableName,ZooKeeperProtos.Table.State.ENABLED)) {
      if (reOpenAllRegions(hris)) {
        LOG.info("Completed table operation " + eventType + " on table "+ tableName);
      }
 else {
        LOG.warn("Error on reopening the regions");
      }
    }
    completed(null);
  }
 catch (  IOException e) {
    LOG.error("Error manipulating table " + tableName,e);
    completed(e);
  }
catch (  CoordinatedStateException e) {
    LOG.error("Error manipulating table " + tableName,e);
    completed(e);
  }
 finally {
    releaseTableLock();
  }
}
