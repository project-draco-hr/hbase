{
  byte[] indexRow=indexSpec.getKeyGenerator().createIndexKey(row,columnValues);
  BatchUpdate update=new BatchUpdate(indexRow);
  update.put(IndexedTable.INDEX_BASE_ROW_COLUMN,row);
  for (  byte[] col : indexSpec.getIndexedColumns()) {
    byte[] val=columnValues.get(col);
    if (val == null) {
      throw new RuntimeException("Unexpected missing column value. [" + Bytes.toString(col) + "]");
    }
    update.put(col,val);
  }
  for (  byte[] col : indexSpec.getAdditionalColumns()) {
    byte[] val=columnValues.get(col);
    if (val != null) {
      update.put(col,val);
    }
  }
  return update;
}
