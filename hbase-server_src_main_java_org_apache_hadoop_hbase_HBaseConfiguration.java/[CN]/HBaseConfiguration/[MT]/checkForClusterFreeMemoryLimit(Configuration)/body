{
  float globalMemstoreLimit=conf.getFloat("hbase.regionserver.global.memstore.upperLimit",0.4f);
  int gml=(int)(globalMemstoreLimit * CONVERT_TO_PERCENTAGE);
  float blockCacheUpperLimit=conf.getFloat(HConstants.HFILE_BLOCK_CACHE_SIZE_KEY,HConstants.HFILE_BLOCK_CACHE_SIZE_DEFAULT);
  int bcul=(int)(blockCacheUpperLimit * CONVERT_TO_PERCENTAGE);
  if (CONVERT_TO_PERCENTAGE - (gml + bcul) < (int)(CONVERT_TO_PERCENTAGE * HConstants.HBASE_CLUSTER_MINIMUM_MEMORY_THRESHOLD)) {
    throw new RuntimeException("Current heap configuration for MemStore and BlockCache exceeds " + "the threshold required for successful cluster operation. " + "The combined value cannot exceed 0.8. Please check "+ "the settings for hbase.regionserver.global.memstore.upperLimit and "+ "hfile.block.cache.size in your configuration. "+ "hbase.regionserver.global.memstore.upperLimit is " + globalMemstoreLimit + " hfile.block.cache.size is "+ blockCacheUpperLimit);
  }
}
