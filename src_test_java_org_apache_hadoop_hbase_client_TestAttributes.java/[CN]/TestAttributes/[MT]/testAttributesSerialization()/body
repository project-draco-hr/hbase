{
  Put put=new Put();
  put.setAttribute("attribute1",Bytes.toBytes("value1"));
  put.setAttribute("attribute2",Bytes.toBytes("value2"));
  put.setAttribute("attribute3",Bytes.toBytes("value3"));
  ByteArrayOutputStream byteArrayOutputStream=new ByteArrayOutputStream();
  DataOutput out=new DataOutputStream(byteArrayOutputStream);
  put.write(out);
  Put put2=new Put();
  Assert.assertTrue(put2.getAttributesMap().isEmpty());
  put2.readFields(new DataInputStream(new ByteArrayInputStream(byteArrayOutputStream.toByteArray())));
  Assert.assertNull(put2.getAttribute("absent"));
  Assert.assertTrue(Arrays.equals(Bytes.toBytes("value1"),put2.getAttribute("attribute1")));
  Assert.assertTrue(Arrays.equals(Bytes.toBytes("value2"),put2.getAttribute("attribute2")));
  Assert.assertTrue(Arrays.equals(Bytes.toBytes("value3"),put2.getAttribute("attribute3")));
  Assert.assertEquals(3,put2.getAttributesMap().size());
}
