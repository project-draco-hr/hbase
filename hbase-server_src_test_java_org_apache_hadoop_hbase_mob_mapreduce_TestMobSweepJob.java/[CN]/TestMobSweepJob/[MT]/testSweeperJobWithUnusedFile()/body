{
  FileSystem fs=TEST_UTIL.getTestFileSystem();
  Configuration configuration=new Configuration(TEST_UTIL.getConfiguration());
  Path vistiedFileNamesPath=new Path(MobUtils.getMobHome(configuration),"/hbase/mobcompaction/SweepJob/working/names/1/visited");
  Path allFileNamesPath=new Path(MobUtils.getMobHome(configuration),"/hbase/mobcompaction/SweepJob/working/names/1/all");
  configuration.set(SweepJob.WORKING_VISITED_DIR_KEY,vistiedFileNamesPath.toString());
  configuration.set(SweepJob.WORKING_ALLNAMES_FILE_KEY,allFileNamesPath.toString());
  writeFileNames(fs,configuration,allFileNamesPath,new String[]{"1","2","3","4","5","6"});
  Path r0=new Path(vistiedFileNamesPath,"r0");
  writeFileNames(fs,configuration,r0,new String[]{"1","2","3"});
  Path r1=new Path(vistiedFileNamesPath,"r1");
  writeFileNames(fs,configuration,r1,new String[]{"1","5"});
  Path r2=new Path(vistiedFileNamesPath,"r2");
  writeFileNames(fs,configuration,r2,new String[]{"2","3"});
  SweepJob sweepJob=new SweepJob(configuration,fs);
  List<String> toBeArchived=sweepJob.getUnusedFiles(configuration);
  assertEquals(2,toBeArchived.size());
  assertEquals(new String[]{"4","6"},toBeArchived.toArray(new String[0]));
}
