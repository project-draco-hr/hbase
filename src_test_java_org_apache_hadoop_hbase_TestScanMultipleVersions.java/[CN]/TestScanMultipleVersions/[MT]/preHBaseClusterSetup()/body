{
  testDir=new Path(conf.get(HConstants.HBASE_DIR));
  this.desc=new HTableDescriptor(TABLE_NAME);
  this.desc.addFamily(new HColumnDescriptor(HConstants.CATALOG_FAMILY));
  FSUtils.createTableDescriptor(FileSystem.get(this.conf),this.testDir,this.desc);
  INFOS[0]=new HRegionInfo(desc.getName(),HConstants.EMPTY_START_ROW,Bytes.toBytes("row_0500"));
  INFOS[1]=new HRegionInfo(desc.getName(),Bytes.toBytes("row_0500"),HConstants.EMPTY_END_ROW);
  createRootAndMetaRegions();
  for (int i=0; i < REGIONS.length; i++) {
    REGIONS[i]=HRegion.createHRegion(this.INFOS[i],this.testDir,this.conf,this.desc);
    for (int j=0; j < TIMESTAMPS.length; j++) {
      Put put=new Put(ROWS[i],TIMESTAMPS[j],null);
      put.add(HConstants.CATALOG_FAMILY,null,TIMESTAMPS[j],Bytes.toBytes(TIMESTAMPS[j]));
      REGIONS[i].put(put);
    }
    HRegion.addRegionToMETA(meta,REGIONS[i]);
    REGIONS[i].close();
    REGIONS[i].getLog().closeAndDelete();
  }
  closeRootAndMeta();
}
