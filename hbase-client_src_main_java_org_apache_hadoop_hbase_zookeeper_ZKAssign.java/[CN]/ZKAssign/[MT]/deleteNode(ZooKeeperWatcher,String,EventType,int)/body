{
  LOG.debug(zkw.prefix("Deleting existing unassigned " + "node for " + encodedRegionName + " that is in expected state "+ expectedState));
  String node=getNodeName(zkw,encodedRegionName);
  zkw.sync(node);
  Stat stat=new Stat();
  byte[] bytes=ZKUtil.getDataNoWatch(zkw,node,stat);
  if (bytes == null) {
    throw KeeperException.create(Code.NONODE);
  }
  RegionTransition rt=getRegionTransition(bytes);
  EventType et=rt.getEventType();
  if (!et.equals(expectedState)) {
    LOG.warn(zkw.prefix("Attempting to delete unassigned node " + encodedRegionName + " in "+ expectedState+ " state but node is in "+ et+ " state"));
    return false;
  }
  if (expectedVersion != -1 && stat.getVersion() != expectedVersion) {
    LOG.warn("The node " + encodedRegionName + " we are trying to delete is not"+ " the expected one. Got a version mismatch");
    return false;
  }
  if (!ZKUtil.deleteNode(zkw,node,stat.getVersion())) {
    LOG.warn(zkw.prefix("Attempting to delete " + "unassigned node " + encodedRegionName + " in "+ expectedState+ " state but after verifying state, we got a version mismatch"));
    return false;
  }
  LOG.debug(zkw.prefix("Successfully deleted unassigned node for region " + encodedRegionName + " in expected state "+ expectedState));
  return true;
}
