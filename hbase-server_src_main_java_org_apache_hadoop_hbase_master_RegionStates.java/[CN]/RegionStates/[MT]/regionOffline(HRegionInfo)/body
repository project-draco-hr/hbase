{
  String regionName=hri.getEncodedName();
  RegionState oldState=regionStates.get(regionName);
  if (oldState == null) {
    LOG.warn("Offline a region not in RegionStates: " + hri);
  }
 else {
    State state=oldState.getState();
    ServerName sn=oldState.getServerName();
    if (state != State.OFFLINE || sn != null) {
      LOG.debug("Offline a region with current state=" + state + ", expected state=OFFLINE"+ ", assigned to server: "+ sn+ ", expected null");
    }
  }
  updateRegionState(hri,State.OFFLINE);
  regionsInTransition.remove(regionName);
  ServerName oldServerName=regionAssignments.remove(hri);
  if (oldServerName != null) {
    LOG.info("Offlined region " + hri + " from "+ oldServerName);
    serverHoldings.get(oldServerName).remove(hri);
  }
}
