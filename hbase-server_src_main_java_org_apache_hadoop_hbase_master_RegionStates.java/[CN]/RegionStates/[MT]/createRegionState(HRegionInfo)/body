{
  State newState=(hri.isOffline() && hri.isSplit()) ? State.SPLIT : State.OFFLINE;
  String regionName=hri.getEncodedName();
  RegionState regionState=regionStates.get(regionName);
  if (regionState != null) {
    LOG.warn("Tried to create a state for a region already in RegionStates, " + "used existing: " + regionState + ", ignored new: "+ newState);
  }
 else {
    regionState=new RegionState(hri,newState);
    regionStates.put(regionName,regionState);
  }
  return regionState;
}
