{
  ServerName newServerName=serverName;
  if (serverName != null && (state == State.CLOSED || state == State.OFFLINE)) {
    LOG.warn("Closed region " + hri + " still on "+ serverName+ "? Ignored, reset it to null");
    newServerName=null;
  }
  String regionName=hri.getEncodedName();
  RegionState regionState=new RegionState(hri,state,stamp,newServerName);
  RegionState oldState=regionStates.put(regionName,regionState);
  LOG.info("Region " + hri + " transitioned from "+ oldState+ " to "+ regionState);
  if (state != State.SPLITTING && (newServerName != null || (state != State.PENDING_CLOSE && state != State.CLOSING))) {
    regionsInTransition.put(regionName,regionState);
  }
  this.notifyAll();
  return regionState;
}
