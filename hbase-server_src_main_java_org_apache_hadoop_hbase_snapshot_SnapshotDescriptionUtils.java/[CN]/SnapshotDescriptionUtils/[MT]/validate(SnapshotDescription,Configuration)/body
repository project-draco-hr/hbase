{
  if (!snapshot.hasTable()) {
    throw new IllegalArgumentException("Descriptor doesn't apply to a table, so we can't build it.");
  }
  long time=snapshot.getCreationTime();
  if (time == SnapshotDescriptionUtils.NO_SNAPSHOT_START_TIME_SPECIFIED) {
    time=EnvironmentEdgeManager.currentTimeMillis();
    if (snapshot.getType().equals(SnapshotDescription.Type.TIMESTAMP)) {
      long increment=conf.getLong(SnapshotDescriptionUtils.TIMESTAMP_SNAPSHOT_SPLIT_POINT_ADDITION,SnapshotDescriptionUtils.DEFAULT_TIMESTAMP_SNAPSHOT_SPLIT_IN_FUTURE);
      LOG.debug("Setting timestamp snapshot in future by " + increment + " ms.");
      time+=increment;
    }
    LOG.debug("Creation time not specified, setting to:" + time + " (current time:"+ EnvironmentEdgeManager.currentTimeMillis()+ ").");
    SnapshotDescription.Builder builder=snapshot.toBuilder();
    builder.setCreationTime(time);
    snapshot=builder.build();
  }
  return snapshot;
}
