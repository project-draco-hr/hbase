{
  Path rootDir=FSUtils.getRootDir(conf);
  FileSystem fs=FileSystem.get(conf);
  Path snapshotDir=SnapshotDescriptionUtils.getCompletedSnapshotDir(snapshot,rootDir);
  final SnapshotStats stats=new SnapshotStats(conf,fs,snapshot);
  SnapshotReferenceUtil.visitReferencedFiles(fs,snapshotDir,new SnapshotReferenceUtil.FileVisitor(){
    public void storeFile(    final String region,    final String family,    final String hfile) throws IOException {
      stats.addStoreFile(region,family,hfile);
    }
    public void recoveredEdits(    final String region,    final String logfile) throws IOException {
      stats.addRecoveredEdits(region,logfile);
    }
    public void logFile(    final String server,    final String logfile) throws IOException {
      stats.addLogFile(server,logfile);
    }
  }
);
  return stats;
}
