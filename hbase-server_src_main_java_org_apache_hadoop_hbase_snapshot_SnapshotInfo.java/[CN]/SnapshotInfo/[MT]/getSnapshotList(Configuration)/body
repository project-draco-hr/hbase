{
  Path rootDir=FSUtils.getRootDir(conf);
  FileSystem fs=FileSystem.get(rootDir.toUri(),conf);
  Path snapshotDir=SnapshotDescriptionUtils.getSnapshotsDir(rootDir);
  FileStatus[] snapshots=fs.listStatus(snapshotDir,new SnapshotDescriptionUtils.CompletedSnaphotDirectoriesFilter(fs));
  List<SnapshotDescription> snapshotLists=new ArrayList<SnapshotDescription>(snapshots.length);
  for (  FileStatus snapshotDirStat : snapshots) {
    snapshotLists.add(SnapshotDescriptionUtils.readSnapshotInfo(fs,snapshotDirStat.getPath()));
  }
  return snapshotLists;
}
