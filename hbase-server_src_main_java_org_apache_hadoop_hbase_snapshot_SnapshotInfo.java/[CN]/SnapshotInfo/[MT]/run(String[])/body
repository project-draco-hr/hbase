{
  String snapshotName=null;
  boolean showSchema=false;
  boolean showFiles=false;
  boolean showStats=false;
  for (int i=0; i < args.length; i++) {
    String cmd=args[i];
    try {
      if (cmd.equals("-snapshot")) {
        snapshotName=args[++i];
      }
 else       if (cmd.equals("-files")) {
        showFiles=true;
        showStats=true;
      }
 else       if (cmd.equals("-stats")) {
        showStats=true;
      }
 else       if (cmd.equals("-schema")) {
        showSchema=true;
      }
 else       if (cmd.equals("-h") || cmd.equals("--help")) {
        printUsageAndExit();
      }
 else {
        System.err.println("UNEXPECTED: " + cmd);
        printUsageAndExit();
      }
    }
 catch (    Exception e) {
      printUsageAndExit();
    }
  }
  if (snapshotName == null) {
    System.err.println("Missing snapshot name!");
    printUsageAndExit();
    return 1;
  }
  Configuration conf=getConf();
  fs=FileSystem.get(conf);
  rootDir=FSUtils.getRootDir(conf);
  if (!loadSnapshotInfo(snapshotName)) {
    System.err.println("Snapshot '" + snapshotName + "' not found!");
    return 1;
  }
  printInfo();
  if (showSchema)   printSchema();
  printFiles(showFiles,showStats);
  return 0;
}
