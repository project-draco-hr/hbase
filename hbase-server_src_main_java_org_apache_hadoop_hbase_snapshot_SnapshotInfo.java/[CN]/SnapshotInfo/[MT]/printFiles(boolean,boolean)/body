{
  if (showFiles) {
    System.out.println("Snapshot Files");
    System.out.println("----------------------------------------");
  }
  final SnapshotDescription snapshotDesc=snapshotManifest.getSnapshotDescription();
  final String table=snapshotDesc.getTable();
  final SnapshotStats stats=new SnapshotStats(this.getConf(),this.fs,snapshotDesc);
  SnapshotReferenceUtil.visitReferencedFiles(getConf(),fs,snapshotManifest.getSnapshotDir(),snapshotDesc,new SnapshotReferenceUtil.SnapshotVisitor(){
    @Override public void storeFile(    final HRegionInfo regionInfo,    final String family,    final SnapshotRegionManifest.StoreFile storeFile) throws IOException {
      if (storeFile.hasReference())       return;
      SnapshotStats.FileInfo info=stats.addStoreFile(regionInfo,family,storeFile);
      if (showFiles) {
        System.out.printf("%8s %s/%s/%s/%s %s%n",(info.isMissing() ? "-" : StringUtils.humanReadableInt(info.getSize())),table,regionInfo.getEncodedName(),family,storeFile.getName(),(info.inArchive() ? "(archive)" : info.isMissing() ? "(NOT FOUND)" : ""));
      }
    }
    @Override public void logFile(    final String server,    final String logfile) throws IOException {
      SnapshotStats.FileInfo info=stats.addLogFile(server,logfile);
      if (showFiles) {
        System.out.printf("%8s log %s on server %s %s%n",(info.isMissing() ? "-" : StringUtils.humanReadableInt(info.getSize())),logfile,server,(info.isMissing() ? "(NOT FOUND)" : ""));
      }
    }
  }
);
  System.out.println();
  if (stats.isSnapshotCorrupted()) {
    System.out.println("**************************************************************");
    System.out.printf("BAD SNAPSHOT: %d hfile(s) and %d log(s) missing.%n",stats.getMissingStoreFilesCount(),stats.getMissingLogsCount());
    System.out.println("**************************************************************");
  }
  if (showStats) {
    System.out.printf("%d HFiles (%d in archive), total size %s (%.2f%% %s shared with the source table)%n",stats.getStoreFilesCount(),stats.getArchivedStoreFilesCount(),StringUtils.humanReadableInt(stats.getStoreFilesSize()),stats.getSharedStoreFilePercentage(),StringUtils.humanReadableInt(stats.getSharedStoreFilesSize()));
    System.out.printf("%d Logs, total size %s%n",stats.getLogsCount(),StringUtils.humanReadableInt(stats.getLogsSize()));
    System.out.println();
  }
}
