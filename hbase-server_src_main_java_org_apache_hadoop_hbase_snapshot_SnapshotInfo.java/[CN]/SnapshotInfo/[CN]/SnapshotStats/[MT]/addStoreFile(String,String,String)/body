{
  TableName table=snapshotTable;
  HFileLink link=HFileLink.create(conf,table,region,family,hfile);
  boolean inArchive=false;
  long size=-1;
  try {
    if ((inArchive=fs.exists(link.getArchivePath()))) {
      size=fs.getFileStatus(link.getArchivePath()).getLen();
      hfileArchiveSize+=size;
      hfileArchiveCount++;
    }
 else {
      size=link.getFileStatus(fs).getLen();
      hfileSize+=size;
      hfilesCount++;
    }
  }
 catch (  FileNotFoundException e) {
    hfilesMissing++;
  }
  return new FileInfo(inArchive,size);
}
