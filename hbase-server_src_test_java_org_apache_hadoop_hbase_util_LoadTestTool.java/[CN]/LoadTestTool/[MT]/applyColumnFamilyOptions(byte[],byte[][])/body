{
  HBaseAdmin admin=new HBaseAdmin(conf);
  HTableDescriptor tableDesc=admin.getTableDescriptor(tableName);
  LOG.info("Disabling table " + Bytes.toString(tableName));
  admin.disableTable(tableName);
  for (  byte[] cf : columnFamilies) {
    HColumnDescriptor columnDesc=tableDesc.getFamily(cf);
    if (bloomType != null) {
      columnDesc.setBloomFilterType(bloomType);
    }
    if (compressAlgo != null) {
      columnDesc.setCompressionType(compressAlgo);
    }
    if (dataBlockEncodingAlgo != null) {
      columnDesc.setDataBlockEncoding(dataBlockEncodingAlgo);
      columnDesc.setEncodeOnDisk(!encodeInCacheOnly);
    }
    admin.modifyColumn(tableName,columnDesc);
  }
  LOG.info("Enabling table " + Bytes.toString(tableName));
  admin.enableTable(tableName);
}
