{
  this.catalogTracker=createCatalogTracker(this.zooKeeper,this.conf,this,conf.getInt("hbase.master.catalog.timeout",Integer.MAX_VALUE));
  this.catalogTracker.start();
  this.assignmentManager=new AssignmentManager(this,serverManager,this.catalogTracker,this.executorService);
  this.balancer=LoadBalancerFactory.getLoadBalancer(conf);
  zooKeeper.registerListenerFirst(assignmentManager);
  this.regionServerTracker=new RegionServerTracker(zooKeeper,this,this.serverManager);
  this.regionServerTracker.start();
  this.drainingServerTracker=new DrainingServerTracker(zooKeeper,this,this.serverManager);
  this.drainingServerTracker.start();
  boolean wasUp=this.clusterStatusTracker.isClusterUp();
  if (!wasUp)   this.clusterStatusTracker.setClusterUp();
  this.schemaChangeTracker=new MasterSchemaChangeTracker(getZooKeeper(),this,this,conf.getInt("hbase.instant.schema.alter.timeout",60000));
  this.schemaChangeTracker.start();
  LOG.info("Server active/primary master; " + this.serverName + ", sessionid=0x"+ Long.toHexString(this.zooKeeper.getRecoverableZooKeeper().getSessionId())+ ", cluster-up flag was="+ wasUp);
}
