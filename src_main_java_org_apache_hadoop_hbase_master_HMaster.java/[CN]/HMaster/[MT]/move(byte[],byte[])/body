{
  Pair<HRegionInfo,ServerName> p=this.assignmentManager.getAssignment(encodedRegionName);
  if (p == null)   throw new UnknownRegionException(Bytes.toStringBinary(encodedRegionName));
  HRegionInfo hri=p.getFirst();
  ServerName dest=null;
  if (destServerName == null || destServerName.length == 0) {
    LOG.info("Passed destination servername is null/empty so " + "choosing a server at random");
    this.assignmentManager.clearRegionPlan(hri);
    this.assignmentManager.unassign(hri);
  }
 else {
    dest=new ServerName(Bytes.toString(destServerName));
    if (this.cpHost != null) {
      this.cpHost.preMove(p.getFirst(),p.getSecond(),dest);
    }
    RegionPlan rp=new RegionPlan(p.getFirst(),p.getSecond(),dest);
    LOG.info("Added move plan " + rp + ", running balancer");
    this.assignmentManager.balance(rp);
    if (this.cpHost != null) {
      this.cpHost.postMove(p.getFirst(),p.getSecond(),dest);
    }
  }
}
