{
  Pair<HRegionInfo,HServerInfo> p=this.assignmentManager.getAssignment(encodedRegionName);
  if (p == null)   throw new UnknownRegionException(Bytes.toString(encodedRegionName));
  HRegionInfo hri=p.getFirst();
  HServerInfo dest=null;
  if (destServerName == null || destServerName.length == 0) {
    LOG.info("Passed destination servername is null/empty so " + "choosing a server at random");
    this.assignmentManager.clearRegionPlan(hri);
    this.assignmentManager.unassign(hri);
  }
 else {
    dest=this.serverManager.getServerInfo(new String(destServerName));
    if (this.cpHost != null) {
      this.cpHost.preMove(p.getFirst(),p.getSecond(),dest);
    }
    RegionPlan rp=new RegionPlan(p.getFirst(),p.getSecond(),dest);
    this.assignmentManager.balance(rp);
    if (this.cpHost != null) {
      this.cpHost.postMove(p.getFirst(),p.getSecond(),dest);
    }
  }
}
