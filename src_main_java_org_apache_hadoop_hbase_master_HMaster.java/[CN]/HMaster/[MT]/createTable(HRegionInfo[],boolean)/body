{
  String tableName=newRegions[0].getTableDesc().getNameAsString();
  if (MetaReader.tableExists(catalogTracker,tableName)) {
    throw new TableExistsException(tableName);
  }
  for (  HRegionInfo newRegion : newRegions) {
    try {
      assignmentManager.getZKTable().setEnabledTable(tableName);
    }
 catch (    KeeperException e) {
      throw new IOException("Unable to ensure that the table will be" + " enabled because of a ZooKeeper issue",e);
    }
    HRegion region=HRegion.createHRegion(newRegion,fileSystemManager.getRootDir(),conf);
    MetaEditor.addRegionToMeta(catalogTracker,region.getRegionInfo());
    region.close();
    region.getLog().closeAndDelete();
  }
  List<HServerInfo> servers=serverManager.getOnlineServersList();
  try {
    this.assignmentManager.assignUserRegions(newRegions,servers);
  }
 catch (  InterruptedException ie) {
    LOG.error("Caught " + ie + " during round-robin assignment");
    throw new IOException(ie);
  }
  if (sync) {
    LOG.debug("Waiting for " + newRegions.length + " region(s) to be "+ "assigned before returning");
    for (    HRegionInfo regionInfo : newRegions) {
      try {
        assignmentManager.waitForAssignment(regionInfo);
      }
 catch (      InterruptedException e) {
        LOG.info("Interrupted waiting for region to be assigned during " + "create table call");
        return;
      }
    }
  }
  if (cpHost != null) {
    cpHost.postCreateTable(newRegions,sync);
  }
}
