{
  byte[] regioninfo=res.getValue(HConstants.CATALOG_FAMILY,HConstants.REGIONINFO_QUALIFIER);
  if (regioninfo == null) {
    StringBuilder sb=new StringBuilder();
    NavigableMap<byte[],byte[]> infoMap=res.getFamilyMap(HConstants.CATALOG_FAMILY);
    for (    byte[] e : infoMap.keySet()) {
      if (sb.length() > 0) {
        sb.append(", ");
      }
      sb.append(Bytes.toString(HConstants.CATALOG_FAMILY) + ":" + Bytes.toString(e));
    }
    LOG.warn(Bytes.toString(HConstants.CATALOG_FAMILY) + ":" + Bytes.toString(HConstants.REGIONINFO_QUALIFIER)+ " is empty for row: "+ Bytes.toString(row)+ "; has keys: "+ sb.toString());
    return null;
  }
  return Writables.getHRegionInfo(regioninfo);
}
