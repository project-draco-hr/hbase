{
  Set<MetaRegion> regions=this.regionManager.getMetaRegionsForTable(tableName);
  for (  MetaRegion m : regions) {
    byte[] firstRowInTable=Bytes.toBytes(Bytes.toString(tableName) + ",,");
    byte[] metaRegionName=m.getRegionName();
    HRegionInterface srvr=this.connection.getHRegionConnection(m.getServer());
    Scan scan=new Scan(firstRowInTable);
    scan.addColumn(CATALOG_FAMILY,REGIONINFO_QUALIFIER);
    scan.addColumn(CATALOG_FAMILY,SERVER_QUALIFIER);
    long scannerid=srvr.openScanner(metaRegionName,scan);
    try {
      while (true) {
        Result data=srvr.next(scannerid);
        if (data == null || data.size() <= 0)         break;
        HRegionInfo info=Writables.getHRegionInfo(data.getValue(CATALOG_FAMILY,REGIONINFO_QUALIFIER));
        if (Bytes.compareTo(info.getTableDesc().getName(),tableName) == 0) {
          if ((Bytes.compareTo(info.getStartKey(),rowKey) >= 0) && (Bytes.compareTo(info.getEndKey(),rowKey) < 0)) {
            byte[] value=data.getValue(CATALOG_FAMILY,SERVER_QUALIFIER);
            if (value != null && value.length > 0) {
              HServerAddress server=new HServerAddress(Bytes.toString(value));
              return new Pair<HRegionInfo,HServerAddress>(info,server);
            }
          }
        }
 else {
          break;
        }
      }
    }
  finally {
      srvr.close(scannerid);
    }
  }
  return null;
}
