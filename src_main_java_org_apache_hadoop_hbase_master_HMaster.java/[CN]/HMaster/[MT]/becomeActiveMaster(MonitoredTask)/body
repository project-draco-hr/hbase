{
  this.activeMasterManager=new ActiveMasterManager(zooKeeper,this.serverName,this);
  this.zooKeeper.registerListener(activeMasterManager);
  stallIfBackupMaster(this.conf,this.activeMasterManager);
  this.clusterStatusTracker=new ClusterStatusTracker(getZooKeeper(),this);
  this.clusterStatusTracker.start();
  return this.activeMasterManager.blockUntilBecomingActiveMaster(startupStatus,this.clusterStatusTracker);
}
