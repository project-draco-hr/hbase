{
  List<Pair<HRegionInfo,HServerAddress>> result=new ArrayList<Pair<HRegionInfo,HServerAddress>>();
  Set<MetaRegion> regions=this.regionManager.getMetaRegionsForTable(tableName);
  byte[] firstRowInTable=Bytes.toBytes(Bytes.toString(tableName) + ",,");
  for (  MetaRegion m : regions) {
    byte[] metaRegionName=m.getRegionName();
    HRegionInterface srvr=this.connection.getHRegionConnection(m.getServer());
    Scan scan=new Scan(firstRowInTable);
    scan.addColumn(HConstants.CATALOG_FAMILY,HConstants.REGIONINFO_QUALIFIER);
    scan.addColumn(HConstants.CATALOG_FAMILY,HConstants.SERVER_QUALIFIER);
    long scannerid=srvr.openScanner(metaRegionName,scan);
    try {
      while (true) {
        Result data=srvr.next(scannerid);
        if (data == null || data.size() <= 0)         break;
        HRegionInfo info=Writables.getHRegionInfo(data.getValue(HConstants.CATALOG_FAMILY,HConstants.REGIONINFO_QUALIFIER));
        if (Bytes.equals(info.getTableDesc().getName(),tableName)) {
          final byte[] value=data.getValue(HConstants.CATALOG_FAMILY,HConstants.SERVER_QUALIFIER);
          if (value != null && value.length > 0) {
            HServerAddress server=new HServerAddress(Bytes.toString(value));
            result.add(new Pair<HRegionInfo,HServerAddress>(info,server));
          }
        }
 else {
          break;
        }
      }
    }
  finally {
      srvr.close(scannerid);
    }
  }
  return result;
}
