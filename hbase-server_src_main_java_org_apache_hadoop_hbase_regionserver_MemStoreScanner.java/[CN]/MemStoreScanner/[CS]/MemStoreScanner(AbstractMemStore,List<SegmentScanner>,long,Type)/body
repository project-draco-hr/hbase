{
  super();
  this.readPoint=readPoint;
  this.type=type;
switch (type) {
case UNDEFINED:
case USER_SCAN_FORWARD:
case COMPACT_FORWARD:
    this.forwardHeap=new KeyValueHeap(scanners,ms.getComparator());
  break;
case USER_SCAN_BACKWARD:
this.backwardHeap=new ReversedKeyValueHeap(scanners,ms.getComparator());
break;
default :
throw new IllegalArgumentException("Unknown scanner type in MemStoreScanner");
}
this.backwardReferenceToMemStore=ms;
this.scanners=scanners;
if (Trace.isTracing() && Trace.currentSpan() != null) {
Trace.currentSpan().addTimelineAnnotation("Creating MemStoreScanner");
}
}
