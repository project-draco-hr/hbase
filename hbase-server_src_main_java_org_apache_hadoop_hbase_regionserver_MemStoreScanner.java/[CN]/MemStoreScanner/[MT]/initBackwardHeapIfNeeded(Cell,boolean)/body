{
  boolean res=false;
  if (toLast && (type != Type.UNDEFINED)) {
    throw new IllegalStateException("Wrong usage of initBackwardHeapIfNeeded in parameters. The type is:" + type.toString());
  }
  if (type == Type.UNDEFINED) {
    if ((backwardHeap == null) && (forwardHeap != null)) {
      forwardHeap.close();
      forwardHeap=null;
      for (      KeyValueScanner scan : scanners) {
        if (toLast) {
          res|=scan.seekToLastRow();
        }
 else {
          res|=scan.backwardSeek(cell);
        }
      }
      this.backwardHeap=new ReversedKeyValueHeap(scanners,comparator);
      type=Type.USER_SCAN_BACKWARD;
    }
  }
  if (type == Type.USER_SCAN_FORWARD) {
    throw new IllegalStateException("Traversing backward with forward scan");
  }
  return res;
}
