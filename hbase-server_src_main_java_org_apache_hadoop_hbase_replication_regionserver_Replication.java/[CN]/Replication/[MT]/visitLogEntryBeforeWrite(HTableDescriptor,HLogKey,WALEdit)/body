{
  NavigableMap<byte[],Integer> scopes=new TreeMap<byte[],Integer>(Bytes.BYTES_COMPARATOR);
  byte[] family;
  for (  KeyValue kv : logEdit.getKeyValues()) {
    family=kv.getFamily();
    int scope=htd.getFamily(family).getScope();
    if (scope != REPLICATION_SCOPE_LOCAL && !scopes.containsKey(family)) {
      scopes.put(family,scope);
    }
  }
  if (!scopes.isEmpty()) {
    logKey.setScopes(scopes);
  }
}
