{
  byte[] family;
  try {
    BulkLoadDescriptor bld=WALEdit.getBulkLoadDescriptor(cell);
    for (    StoreDescriptor s : bld.getStoresList()) {
      family=s.getFamilyName().toByteArray();
      if (!scopes.containsKey(family)) {
        int scope=htd.getFamily(family).getScope();
        if (scope != REPLICATION_SCOPE_LOCAL) {
          scopes.put(family,scope);
          addHFileRefsToQueue(replicationManager,tableName,family,s);
        }
      }
 else {
        addHFileRefsToQueue(replicationManager,tableName,family,s);
      }
    }
  }
 catch (  IOException e) {
    LOG.error("Failed to get bulk load events information from the wal file.",e);
    throw e;
  }
}
