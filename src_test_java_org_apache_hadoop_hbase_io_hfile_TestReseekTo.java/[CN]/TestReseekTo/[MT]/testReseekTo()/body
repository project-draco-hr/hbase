{
  Path ncTFile=new Path(HBaseTestingUtility.getTestDir(),"basic.hfile");
  FSDataOutputStream fout=TEST_UTIL.getTestFileSystem().create(ncTFile);
  HFile.Writer writer=new HFile.Writer(fout,4000,"none",null);
  int numberOfKeys=1000;
  String valueString="Value";
  List<Integer> keyList=new ArrayList<Integer>();
  List<String> valueList=new ArrayList<String>();
  for (int key=0; key < numberOfKeys; key++) {
    String value=valueString + key;
    keyList.add(key);
    valueList.add(value);
    writer.append(Bytes.toBytes(key),Bytes.toBytes(value));
  }
  writer.close();
  fout.close();
  HFile.Reader reader=new HFile.Reader(TEST_UTIL.getTestFileSystem(),ncTFile,null,false);
  reader.loadFileInfo();
  HFileScanner scanner=reader.getScanner(false,true);
  scanner.seekTo();
  for (int i=0; i < keyList.size(); i++) {
    Integer key=keyList.get(i);
    String value=valueList.get(i);
    long start=System.nanoTime();
    scanner.seekTo(Bytes.toBytes(key));
    System.out.println("Seek Finished in: " + (System.nanoTime() - start) / 1000 + " ?s");
    assertEquals(value,scanner.getValueString());
  }
  scanner.seekTo();
  for (int i=0; i < keyList.size(); i+=10) {
    Integer key=keyList.get(i);
    String value=valueList.get(i);
    long start=System.nanoTime();
    scanner.reseekTo(Bytes.toBytes(key));
    System.out.println("Reseek Finished in: " + (System.nanoTime() - start) / 1000 + " ?s");
    assertEquals(value,scanner.getValueString());
  }
}
