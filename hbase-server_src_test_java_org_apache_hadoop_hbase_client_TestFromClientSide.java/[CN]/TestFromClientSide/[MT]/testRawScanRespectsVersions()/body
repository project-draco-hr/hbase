{
  byte[] TABLE=Bytes.toBytes("testRawScan");
  Table table=TEST_UTIL.createTable(TABLE,new byte[][]{FAMILY});
  byte[] row=Bytes.toBytes("row");
  Put p=new Put(row);
  p.add(FAMILY,QUALIFIER,10,VALUE);
  table.put(p);
  table.flushCommits();
  p=new Put(row);
  p.add(FAMILY,QUALIFIER,11,ArrayUtils.add(VALUE,(byte)2));
  table.put(p);
  table.flushCommits();
  p=new Put(row);
  p.add(FAMILY,QUALIFIER,12,ArrayUtils.add(VALUE,(byte)3));
  table.put(p);
  table.flushCommits();
  p=new Put(row);
  p.add(FAMILY,QUALIFIER,13,ArrayUtils.add(VALUE,(byte)4));
  table.put(p);
  table.flushCommits();
  int versions=4;
  Scan s=new Scan(row);
  s.setMaxVersions();
  s.setRaw(true);
  ResultScanner scanner=table.getScanner(s);
  int count=0;
  for (  Result r : scanner) {
    assertEquals("Found an unexpected number of results for the row!",versions,r.listCells().size());
    count++;
  }
  assertEquals("Found more than a single row when raw scanning the table with a single row!",1,count);
  scanner.close();
  versions=2;
  s.setMaxVersions(versions);
  scanner=table.getScanner(s);
  count=0;
  for (  Result r : scanner) {
    assertEquals("Found an unexpected number of results for the row!",versions,r.listCells().size());
    count++;
  }
  assertEquals("Found more than a single row when raw scanning the table with a single row!",1,count);
  scanner.close();
  versions=3;
  s.setMaxVersions(versions);
  scanner=table.getScanner(s);
  count=0;
  for (  Result r : scanner) {
    assertEquals("Found an unexpected number of results for the row!",versions,r.listCells().size());
    count++;
  }
  assertEquals("Found more than a single row when raw scanning the table with a single row!",1,count);
  scanner.close();
  table.close();
  TEST_UTIL.deleteTable(TABLE);
}
