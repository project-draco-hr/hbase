{
  byte[] someBytes=Bytes.toBytes("pool");
  HTable table=TEST_UTIL.createTable(someBytes,someBytes);
  ThreadPoolExecutor pool=(ThreadPoolExecutor)table.getPool();
  assertEquals(1,pool.getCorePoolSize());
  assertEquals(0,pool.getPoolSize());
  final SynchronousQueue<Object> queue=new SynchronousQueue<Object>();
  List<Thread> threads=new ArrayList<Thread>(5);
  for (int i=0; i < 5; i++) {
    threads.add(new Thread(){
      public void run(){
        try {
          queue.take();
        }
 catch (        InterruptedException ie) {
        }
      }
    }
);
  }
  pool.submit(threads.get(0));
  assertEquals(1,pool.getPoolSize());
  pool.submit(threads.get(1));
  assertEquals(2,pool.getPoolSize());
  queue.put(new Object());
  threads.get(0).join();
  queue.put(new Object());
  threads.get(1).join();
  assertEquals(2,pool.getPoolSize());
  while (pool.getCompletedTaskCount() < 2) {
    Threads.sleep(1);
  }
  pool.submit(threads.get(2));
  pool.submit(threads.get(3));
  pool.submit(threads.get(4));
  assertEquals(3,pool.getPoolSize());
  queue.put(new Object());
  queue.put(new Object());
  queue.put(new Object());
}
