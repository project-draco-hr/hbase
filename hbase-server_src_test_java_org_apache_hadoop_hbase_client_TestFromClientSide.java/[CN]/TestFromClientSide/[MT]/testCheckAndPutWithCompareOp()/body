{
  final byte[] value1=Bytes.toBytes("aaaa");
  final byte[] value2=Bytes.toBytes("bbbb");
  final byte[] value3=Bytes.toBytes("cccc");
  final byte[] value4=Bytes.toBytes("dddd");
  Table table=TEST_UTIL.createTable(Bytes.toBytes("testCheckAndPutWithCompareOp"),new byte[][]{FAMILY});
  Put put2=new Put(ROW);
  put2.add(FAMILY,QUALIFIER,value2);
  Put put3=new Put(ROW);
  put3.add(FAMILY,QUALIFIER,value3);
  boolean ok=table.checkAndPut(ROW,FAMILY,QUALIFIER,null,put2);
  assertEquals(ok,true);
  ok=table.checkAndPut(ROW,FAMILY,QUALIFIER,CompareOp.GREATER,value1,put2);
  assertEquals(ok,false);
  ok=table.checkAndPut(ROW,FAMILY,QUALIFIER,CompareOp.EQUAL,value1,put2);
  assertEquals(ok,false);
  ok=table.checkAndPut(ROW,FAMILY,QUALIFIER,CompareOp.GREATER_OR_EQUAL,value1,put2);
  assertEquals(ok,false);
  ok=table.checkAndPut(ROW,FAMILY,QUALIFIER,CompareOp.LESS,value1,put2);
  assertEquals(ok,true);
  ok=table.checkAndPut(ROW,FAMILY,QUALIFIER,CompareOp.LESS_OR_EQUAL,value1,put2);
  assertEquals(ok,true);
  ok=table.checkAndPut(ROW,FAMILY,QUALIFIER,CompareOp.NOT_EQUAL,value1,put3);
  assertEquals(ok,true);
  ok=table.checkAndPut(ROW,FAMILY,QUALIFIER,CompareOp.LESS,value4,put3);
  assertEquals(ok,false);
  ok=table.checkAndPut(ROW,FAMILY,QUALIFIER,CompareOp.LESS_OR_EQUAL,value4,put3);
  assertEquals(ok,false);
  ok=table.checkAndPut(ROW,FAMILY,QUALIFIER,CompareOp.EQUAL,value4,put3);
  assertEquals(ok,false);
  ok=table.checkAndPut(ROW,FAMILY,QUALIFIER,CompareOp.GREATER,value4,put3);
  assertEquals(ok,true);
  ok=table.checkAndPut(ROW,FAMILY,QUALIFIER,CompareOp.GREATER_OR_EQUAL,value4,put3);
  assertEquals(ok,true);
  ok=table.checkAndPut(ROW,FAMILY,QUALIFIER,CompareOp.NOT_EQUAL,value4,put2);
  assertEquals(ok,true);
  ok=table.checkAndPut(ROW,FAMILY,QUALIFIER,CompareOp.GREATER,value2,put2);
  assertEquals(ok,false);
  ok=table.checkAndPut(ROW,FAMILY,QUALIFIER,CompareOp.NOT_EQUAL,value2,put2);
  assertEquals(ok,false);
  ok=table.checkAndPut(ROW,FAMILY,QUALIFIER,CompareOp.LESS,value2,put2);
  assertEquals(ok,false);
  ok=table.checkAndPut(ROW,FAMILY,QUALIFIER,CompareOp.GREATER_OR_EQUAL,value2,put2);
  assertEquals(ok,true);
  ok=table.checkAndPut(ROW,FAMILY,QUALIFIER,CompareOp.LESS_OR_EQUAL,value2,put2);
  assertEquals(ok,true);
  ok=table.checkAndPut(ROW,FAMILY,QUALIFIER,CompareOp.EQUAL,value2,put3);
  assertEquals(ok,true);
}
