{
  LOG.info("Starting testRowMutation");
  final byte[] TABLENAME=Bytes.toBytes("testRowMutation");
  HTable t=TEST_UTIL.createTable(TABLENAME,FAMILY);
  byte[][] QUALIFIERS=new byte[][]{Bytes.toBytes("a"),Bytes.toBytes("b")};
  RowMutations arm=new RowMutations(ROW);
  Put p=new Put(ROW);
  p.add(FAMILY,QUALIFIERS[0],VALUE);
  arm.add(p);
  t.mutateRow(arm);
  Get g=new Get(ROW);
  Result r=t.get(g);
  assertEquals(0,Bytes.compareTo(VALUE,r.getValue(FAMILY,QUALIFIERS[0])));
  arm=new RowMutations(ROW);
  p=new Put(ROW);
  p.add(FAMILY,QUALIFIERS[1],VALUE);
  arm.add(p);
  Delete d=new Delete(ROW);
  d.deleteColumns(FAMILY,QUALIFIERS[0]);
  arm.add(d);
  t.mutateRow(arm);
  r=t.get(g);
  assertEquals(0,Bytes.compareTo(VALUE,r.getValue(FAMILY,QUALIFIERS[1])));
  assertNull(r.getValue(FAMILY,QUALIFIERS[0]));
}
