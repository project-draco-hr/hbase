{
  final byte[] tableName=Bytes.toBytes("testUnmanagedHConnectionReconnect");
  HTable t=createUnmangedHConnectionHTable(tableName);
  HConnection conn=t.getConnection();
  HBaseAdmin ha=new HBaseAdmin(conn);
  assertTrue(ha.tableExists(tableName));
  assertTrue(t.get(new Get(ROW)).isEmpty());
  MiniHBaseCluster cluster=TEST_UTIL.getHBaseCluster();
  cluster.stopMaster(0,false);
  cluster.waitOnMaster(0);
  cluster.startMaster();
  assertTrue(cluster.waitForActiveAndReadyMaster());
  HBaseAdmin newAdmin=new HBaseAdmin(conn);
  assertTrue(newAdmin.tableExists(tableName));
  assert(newAdmin.getClusterStatus().getServersSize() == SLAVES);
}
