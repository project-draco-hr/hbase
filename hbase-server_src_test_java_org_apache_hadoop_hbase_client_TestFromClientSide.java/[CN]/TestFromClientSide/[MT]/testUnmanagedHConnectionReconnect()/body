{
  final TableName tableName=TableName.valueOf("testUnmanagedHConnectionReconnect");
  HTable t=createUnmangedHConnectionHTable(tableName);
  Connection conn=t.getConnection();
  try (HBaseAdmin ha=new HBaseAdmin(conn)){
    assertTrue(ha.tableExists(tableName));
    assertTrue(t.get(new Get(ROW)).isEmpty());
  }
   MiniHBaseCluster cluster=TEST_UTIL.getHBaseCluster();
  cluster.stopMaster(0,false);
  cluster.waitOnMaster(0);
  cluster.startMaster();
  assertTrue(cluster.waitForActiveAndReadyMaster());
  try (HBaseAdmin newAdmin=new HBaseAdmin(conn)){
    assertTrue(newAdmin.tableExists(tableName));
    assertTrue(newAdmin.getClusterStatus().getServersSize() == SLAVES + 1);
  }
 }
