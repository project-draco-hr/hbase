{
  TreeSet<KeyValue> map=new TreeSet<KeyValue>(KeyValue.COMPARATOR);
  for (  Put p : puts) {
    for (    List<KeyValue> kvs : p.getFamilyMap().values()) {
      for (      KeyValue kv : kvs) {
        map.add(kv.clone());
      }
    }
  }
  context.setStatus("Read " + map.getClass());
  int index=0;
  for (  KeyValue kv : map) {
    context.write(row,kv);
    if (index > 0 && index % 100 == 0)     context.setStatus("Wrote " + index);
  }
}
