{
  this.outputStream=outputStream;
  this.path=path;
  this.name=path != null ? path.getName() : outputStream.toString();
  this.hFileContext=fileContext;
  DataBlockEncoding encoding=hFileContext.getDataBlockEncoding();
  if (encoding != DataBlockEncoding.NONE) {
    this.blockEncoder=new HFileDataBlockEncoderImpl(encoding);
  }
 else {
    this.blockEncoder=NoOpDataBlockEncoder.INSTANCE;
  }
  this.comparator=comparator != null ? comparator : KeyValue.COMPARATOR;
  closeOutputStream=path != null;
  this.cacheConf=cacheConf;
}
