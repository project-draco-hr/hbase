{
  this.outputStream=outputStream;
  this.path=path;
  this.name=path != null ? path.getName() : outputStream.toString();
  this.hFileContext=fileContext;
  if (hFileContext.getEncodingOnDisk() != DataBlockEncoding.NONE || hFileContext.getEncodingInCache() != DataBlockEncoding.NONE) {
    this.blockEncoder=new HFileDataBlockEncoderImpl(hFileContext.getEncodingOnDisk(),hFileContext.getEncodingInCache());
  }
 else {
    this.blockEncoder=NoOpDataBlockEncoder.INSTANCE;
  }
  this.comparator=comparator != null ? comparator : KeyValue.COMPARATOR;
  closeOutputStream=path != null;
  this.cacheConf=cacheConf;
}
