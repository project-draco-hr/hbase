{
  HTable ht=null;
  try {
    ht=new HTable(conf,LABELS_TABLE_NAME.getName());
    Batch.Call<VisibilityLabelsService,VisibilityLabelsResponse> callable=new Batch.Call<VisibilityLabelsService,VisibilityLabelsResponse>(){
      ServerRpcController controller=new ServerRpcController();
      BlockingRpcCallback<VisibilityLabelsResponse> rpcCallback=new BlockingRpcCallback<VisibilityLabelsResponse>();
      public VisibilityLabelsResponse call(      VisibilityLabelsService service) throws IOException {
        VisibilityLabelsRequest.Builder builder=VisibilityLabelsRequest.newBuilder();
        for (        String label : labels) {
          if (label.length() > 0) {
            VisibilityLabel.Builder newBuilder=VisibilityLabel.newBuilder();
            newBuilder.setLabel(ZeroCopyLiteralByteString.wrap(Bytes.toBytes(label)));
            builder.addVisLabel(newBuilder.build());
          }
        }
        service.addLabels(controller,builder.build(),rpcCallback);
        return rpcCallback.get();
      }
    }
;
    Map<byte[],VisibilityLabelsResponse> result=ht.coprocessorService(VisibilityLabelsService.class,HConstants.EMPTY_BYTE_ARRAY,HConstants.EMPTY_BYTE_ARRAY,callable);
    return result.values().iterator().next();
  }
  finally {
    if (ht != null) {
      ht.close();
    }
  }
}
