{
  if (isCompact) {
    log.debug("Using compact protocol");
    return new TCompactProtocol.Factory();
  }
 else {
    log.debug("Using binary protocol");
    return new TBinaryProtocol.Factory();
  }
}
