{
  newScannerLock.readLock().lock();
  try {
    if (this.closed.get()) {
      throw new IOException("Region " + this + " closed");
    }
    HashSet<Store> storeSet=new HashSet<Store>();
    for (int i=0; i < cols.length; i++) {
      Store s=stores.get(Bytes.mapKey(HStoreKey.getFamily(cols[i])));
      if (s != null) {
        storeSet.add(s);
      }
    }
    return new HScanner(cols,firstRow,timestamp,storeSet.toArray(new Store[storeSet.size()]),filter);
  }
  finally {
    newScannerLock.readLock().unlock();
  }
}
