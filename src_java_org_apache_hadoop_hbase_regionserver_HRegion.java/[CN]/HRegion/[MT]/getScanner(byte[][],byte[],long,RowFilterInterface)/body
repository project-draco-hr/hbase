{
  newScannerLock.readLock().lock();
  try {
    if (this.closed.get()) {
      throw new IOException("Region " + this + " closed");
    }
    HashSet<Store> storeSet=new HashSet<Store>();
    NavigableSet<byte[]> columns=new TreeSet<byte[]>(Bytes.BYTES_COMPARATOR);
    for (int i=0; i < cols.length; i++) {
      columns.add(cols[i]);
      Store s=stores.get(cols[i]);
      if (s != null) {
        storeSet.add(s);
      }
    }
    return new HScanner(columns,firstRow,timestamp,storeSet.toArray(new Store[storeSet.size()]),filter);
  }
  finally {
    newScannerLock.readLock().unlock();
  }
}
