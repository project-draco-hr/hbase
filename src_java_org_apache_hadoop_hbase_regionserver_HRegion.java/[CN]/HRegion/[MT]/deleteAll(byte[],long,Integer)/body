{
  checkReadOnly();
  Integer lid=getLock(lockid,row);
  long now=System.currentTimeMillis();
  long time=ts;
  if (ts == HConstants.LATEST_TIMESTAMP) {
    time=now;
  }
  KeyValue kv=KeyValue.createFirstOnRow(row,time);
  try {
    for (    Store store : stores.values()) {
      List<KeyValue> keyvalues=new ArrayList<KeyValue>();
      store.getFull(kv,null,null,ALL_VERSIONS,null,keyvalues,time);
      List<KeyValue> edits=new ArrayList<KeyValue>();
      for (      KeyValue key : keyvalues) {
        edits.add(key.cloneDelete());
      }
      update(edits,now);
    }
  }
  finally {
    if (lockid == null)     releaseRowLock(lid);
  }
}
