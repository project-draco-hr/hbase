{
  if (columns != null) {
    for (    byte[] column : columns) {
      checkColumn(column);
    }
  }
  HStoreKey key=new HStoreKey(row,ts);
  Integer lid=getLock(lockid,row);
  HashSet<Store> storeSet=new HashSet<Store>();
  try {
    HbaseMapWritable<byte[],Cell> result=new HbaseMapWritable<byte[],Cell>();
    if (columns != null) {
      for (      byte[] bs : columns) {
        Store store=stores.get(Bytes.mapKey(HStoreKey.getFamily(bs)));
        if (store != null) {
          storeSet.add(store);
        }
      }
    }
 else {
      storeSet.addAll(stores.values());
    }
    if (columns != null) {
      for (      byte[] bs : columns) {
        if (HStoreKey.getFamilyDelimiterIndex(bs) == (bs.length - 1)) {
          Store store=stores.get(Bytes.mapKey(HStoreKey.getFamily(bs)));
          store.getFull(key,null,numVersions,result);
          storeSet.remove(store);
        }
      }
    }
    for (    Store targetStore : storeSet) {
      targetStore.getFull(key,columns,numVersions,result);
    }
    return result;
  }
  finally {
    if (lockid == null)     releaseRowLock(lid);
  }
}
