{
  checkReadOnly();
  Integer lid=getLock(lockid,row);
  long now=System.currentTimeMillis();
  try {
    Store store=getStore(family);
    List<KeyValue> keyvalues=new ArrayList<KeyValue>();
    store.getFull(new KeyValue(row,timestamp),null,null,ALL_VERSIONS,null,keyvalues,now);
    List<KeyValue> edits=new ArrayList<KeyValue>();
    for (    KeyValue kv : keyvalues) {
      edits.add(kv.cloneDelete());
    }
    update(edits,now);
  }
  finally {
    if (lockid == null)     releaseRowLock(lid);
  }
}
