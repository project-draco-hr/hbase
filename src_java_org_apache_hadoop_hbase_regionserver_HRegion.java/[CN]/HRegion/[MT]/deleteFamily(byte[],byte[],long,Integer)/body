{
  checkReadOnly();
  Integer lid=getLock(lockid,row);
  long now=System.currentTimeMillis();
  try {
    HStore store=getStore(family);
    List<HStoreKey> keys=store.getKeys(new HStoreKey(row,timestamp,this.regionInfo),ALL_VERSIONS,now);
    TreeMap<HStoreKey,byte[]> edits=new TreeMap<HStoreKey,byte[]>(new HStoreKey.HStoreKeyWritableComparator(regionInfo));
    for (    HStoreKey key : keys) {
      edits.put(key,HLogEdit.deleteBytes.get());
    }
    update(edits);
  }
  finally {
    if (lockid == null)     releaseRowLock(lid);
  }
}
