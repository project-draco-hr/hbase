{
  HStoreKey key=null;
  checkRow(row);
  lock.readLock().lock();
  try {
    for (    Text colFamily : stores.keySet()) {
      HStore store=stores.get(colFamily);
      Text closestKey=store.getRowKeyAtOrBefore(row);
      if (row.equals(closestKey)) {
        key=new HStoreKey(closestKey);
        break;
      }
      if (closestKey != null && (key == null || closestKey.compareTo(key.getRow()) > 0)) {
        key=new HStoreKey(closestKey);
      }
    }
    if (key == null) {
      return null;
    }
    Map<Text,Cell> cells=new HashMap<Text,Cell>();
    for (    Text colFamily : stores.keySet()) {
      HStore targetStore=stores.get(colFamily);
      targetStore.getFull(key,null,cells);
    }
    HbaseMapWritable cellsWritten=new HbaseMapWritable();
    cellsWritten.putAll(cells);
    return new RowResult(key.getRow(),cellsWritten);
  }
  finally {
    lock.readLock().unlock();
  }
}
