{
  checkRow(row);
  checkColumn(column);
  Integer lid=obtainRowLock(row);
  splitsAndClosesLock.readLock().lock();
  try {
    KeyValue kv=new KeyValue(row,column);
    long ts=System.currentTimeMillis();
    byte[] value=null;
    Store store=getStore(column);
    List<KeyValue> c;
    store.lock.readLock().lock();
    try {
      c=store.memcache.get(kv,1);
    }
  finally {
      store.lock.readLock().unlock();
    }
    if (c.size() >= 1) {
      LOG.debug("Overwriting the memcache value for " + Bytes.toString(row) + "/"+ Bytes.toString(column));
      ts=c.get(0).getTimestamp();
      value=c.get(0).getValue();
    }
    if (value == null) {
      c=store.get(kv,1);
      if (c != null && c.size() == 1) {
        LOG.debug("Using HFile previous value for " + Bytes.toString(row) + "/"+ Bytes.toString(column));
        value=c.get(0).getValue();
      }
 else       if (c != null && c.size() > 1) {
        throw new DoNotRetryIOException("more than 1 value returned in " + "incrementColumnValue from Store");
      }
    }
    if (value == null) {
      LOG.debug("Creating new counter value for " + Bytes.toString(row) + "/"+ Bytes.toString(column));
      value=Bytes.toBytes(amount);
    }
 else {
      value=incrementBytes(value,amount);
    }
    BatchUpdate b=new BatchUpdate(row,ts);
    b.put(column,value);
    batchUpdate(b,lid,true);
    return Bytes.toLong(value);
  }
  finally {
    splitsAndClosesLock.readLock().unlock();
    releaseRowLock(lid);
  }
}
