{
  KeyValue key=null;
  checkRow(row);
  splitsAndClosesLock.readLock().lock();
  try {
    Store store=getStore(family);
    KeyValue kv=new KeyValue(row,HConstants.LATEST_TIMESTAMP);
    LOG.debug("getClosestRowBefore looking for: " + Bytes.toStringBinary(row));
    key=store.getRowKeyAtOrBefore(kv);
    if (key == null) {
      return null;
    }
    List<KeyValue> results=new ArrayList<KeyValue>();
    if (!this.comparator.matchingRows(kv,key)) {
      kv=new KeyValue(key.getRow(),HConstants.LATEST_TIMESTAMP);
    }
    Get get=new Get(key.getRow());
    store.get(get,null,results);
    return new Result(results);
  }
  finally {
    splitsAndClosesLock.readLock().unlock();
  }
}
