{
  checkReadOnly();
  Pattern columnPattern=Pattern.compile(columnRegex);
  Integer lid=getLock(lockid,row);
  long now=System.currentTimeMillis();
  try {
    for (    Store store : stores.values()) {
      List<HStoreKey> keys=store.getKeys(new HStoreKey(row,timestamp),ALL_VERSIONS,now,columnPattern);
      TreeMap<HStoreKey,byte[]> edits=new TreeMap<HStoreKey,byte[]>(new HStoreKey.HStoreKeyWritableComparator());
      for (      HStoreKey key : keys) {
        edits.put(key,HLogEdit.DELETED_BYTES);
      }
      update(edits);
    }
  }
  finally {
    if (lockid == null)     releaseRowLock(lid);
  }
}
