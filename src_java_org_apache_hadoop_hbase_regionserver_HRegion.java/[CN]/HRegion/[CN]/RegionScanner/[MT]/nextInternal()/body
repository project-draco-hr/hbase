{
  KeyValue kv;
  byte[] currentRow=null;
  boolean filterCurrentRow=false;
  while (true) {
    kv=this.storeHeap.peek();
    if (kv == null) {
      return false;
    }
    byte[] row=kv.getRow();
    if (filterCurrentRow && Bytes.equals(currentRow,row)) {
      this.storeHeap.next(results);
      results.clear();
      continue;
    }
    if ((filter != null && filter.filterRowKey(row,0,row.length)) || (oldFilter != null && oldFilter.filterRowKey(row,0,row.length))) {
      if (!results.isEmpty() && !Bytes.equals(currentRow,row)) {
        return true;
      }
      this.storeHeap.next(results);
      results.clear();
      resetFilters();
      filterCurrentRow=true;
      currentRow=row;
      continue;
    }
    if (!Bytes.equals(currentRow,row)) {
      currentRow=row;
      filterCurrentRow=false;
      if (stopRow != null && comparator.compareRows(stopRow,0,stopRow.length,currentRow,0,currentRow.length) <= 0) {
        return false;
      }
      if (results.isEmpty() || filter != null && filter.filterRow()) {
        results.clear();
        resetFilters();
        continue;
      }
      return true;
    }
    this.storeHeap.next(results);
  }
}
