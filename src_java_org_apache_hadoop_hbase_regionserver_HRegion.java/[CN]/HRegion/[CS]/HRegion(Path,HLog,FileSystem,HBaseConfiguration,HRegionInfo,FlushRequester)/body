{
  this.basedir=basedir;
  this.comparator=regionInfo.getComparator();
  this.log=log;
  this.fs=fs;
  this.conf=conf;
  this.regionInfo=regionInfo;
  this.flushListener=flushListener;
  this.threadWakeFrequency=conf.getLong(THREAD_WAKE_FREQUENCY,10 * 1000);
  String encodedNameStr=Integer.toString(this.regionInfo.getEncodedName());
  this.regiondir=new Path(basedir,encodedNameStr);
  this.historian=RegionHistorian.getInstance();
  if (LOG.isDebugEnabled()) {
    LOG.debug("Opening region " + this + ", encoded="+ this.regionInfo.getEncodedName());
  }
  this.regionCompactionDir=new Path(getCompactionDir(basedir),encodedNameStr);
  int flushSize=regionInfo.getTableDesc().getMemStoreFlushSize();
  if (flushSize == HTableDescriptor.DEFAULT_MEMSTORE_FLUSH_SIZE) {
    flushSize=conf.getInt("hbase.hregion.memstore.flush.size",HTableDescriptor.DEFAULT_MEMSTORE_FLUSH_SIZE);
  }
  this.memstoreFlushSize=flushSize;
  this.blockingMemStoreSize=this.memstoreFlushSize * conf.getInt("hbase.hregion.memstore.block.multiplier",1);
}
