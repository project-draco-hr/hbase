{
  LOG.debug("Compacting table " + tableName);
  admin.majorCompact(tableName);
  Threads.sleepWithoutInterrupt(500);
  HRegionServer rs=TEST_UTIL.getMiniHBaseCluster().getRegionServer(0);
  while (rs.compactSplitThread.getCompactionQueueSize() > 0) {
    Threads.sleep(50);
  }
  LOG.debug("Compaction queue size reached 0, continuing");
}
