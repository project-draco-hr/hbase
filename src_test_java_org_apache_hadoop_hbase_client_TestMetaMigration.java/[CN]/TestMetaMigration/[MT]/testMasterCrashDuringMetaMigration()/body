{
  LOG.info("Starting testMasterCrashDuringMetaMigration");
  final byte[] FAMILY=Bytes.toBytes("family");
  HTableDescriptor htd=new HTableDescriptor("testMasterCrashDuringMetaMigration");
  HColumnDescriptor hcd=new HColumnDescriptor(FAMILY);
  htd.addFamily(hcd);
  Configuration conf=TEST_UTIL.getConfiguration();
  TEST_UTIL.createMultiRegionsWithNewHRI(conf,htd,FAMILY,10);
  TEST_UTIL.createMultiRegionsWithLegacyHRI(conf,htd,FAMILY,10);
  CatalogTracker ct=miniHBaseCluster.getMaster().getCatalogTracker();
  MetaMigrationRemovingHTD.updateRootWithMetaMigrationStatus(ct,false);
  LOG.info("MEta Print completed.testUpdatesOnMetaWithLegacyHRI");
  List<HTableDescriptor> htds=MetaMigrationRemovingHTD.updateMetaWithNewRegionInfo(TEST_UTIL.getHBaseCluster().getMaster());
  assertEquals(10,htds.size());
  boolean metaUpdated=MetaMigrationRemovingHTD.isMetaHRIUpdated(miniHBaseCluster.getMaster());
  assertEquals(true,metaUpdated);
  LOG.info("END testMetaWithLegacyHRI");
}
