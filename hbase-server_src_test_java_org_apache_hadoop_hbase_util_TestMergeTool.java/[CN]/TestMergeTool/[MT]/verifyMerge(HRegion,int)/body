{
  Scan scan=new Scan();
  scan.addFamily(FAMILY);
  InternalScanner scanner=merged.getScanner(scan);
  try {
    List<KeyValue> testRes=null;
    while (true) {
      testRes=new ArrayList<KeyValue>();
      boolean hasNext=scanner.next(testRes);
      if (!hasNext) {
        break;
      }
    }
  }
  finally {
    scanner.close();
  }
  for (int i=0; i < upperbound; i++) {
    for (int j=0; j < rows[i].length; j++) {
      Get get=new Get(rows[i][j]);
      get.addFamily(FAMILY);
      Result result=merged.get(get);
      assertEquals(1,result.size());
      byte[] bytes=result.raw()[0].getValue();
      assertNotNull(Bytes.toStringBinary(rows[i][j]),bytes);
      assertTrue(Bytes.equals(bytes,rows[i][j]));
    }
  }
}
