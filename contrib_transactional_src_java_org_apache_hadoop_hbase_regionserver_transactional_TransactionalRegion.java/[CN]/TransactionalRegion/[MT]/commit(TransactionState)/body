{
  LOG.debug("Commiting transaction: " + state.toString() + " to "+ super.getRegionInfo().getRegionNameAsString());
  for (  Put update : state.getPuts()) {
    this.put(update,true);
  }
  for (  Delete delete : state.getDeleteSet()) {
    this.delete(delete,null,true);
  }
  if (state.hasWrite()) {
    this.hlog.writeCommitToLog(super.getRegionInfo(),state.getTransactionId());
  }
  state.setStatus(Status.COMMITED);
  if (state.hasWrite() && !commitPendingTransactions.remove(state)) {
    LOG.fatal("Commiting a non-query transaction that is not in commitPendingTransactions");
    throw new IOException("commit failure");
  }
  retireTransaction(state);
}
