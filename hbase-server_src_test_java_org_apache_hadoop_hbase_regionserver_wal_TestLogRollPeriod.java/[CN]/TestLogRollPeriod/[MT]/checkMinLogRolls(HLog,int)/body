{
  final List<Path> paths=new ArrayList<Path>();
  log.registerWALActionsListener(new WALActionsListener(){
    @Override public void preLogRoll(    Path oldFile,    Path newFile){
    }
    @Override public void postLogRoll(    Path oldFile,    Path newFile){
      LOG.debug("postLogRoll: oldFile=" + oldFile + " newFile="+ newFile);
      paths.add(newFile);
    }
    @Override public void preLogArchive(    Path oldFile,    Path newFile){
    }
    @Override public void postLogArchive(    Path oldFile,    Path newFile){
    }
    @Override public void logRollRequested(){
    }
    @Override public void logCloseRequested(){
    }
    @Override public void visitLogEntryBeforeWrite(    HRegionInfo info,    HLogKey logKey,    WALEdit logEdit){
    }
    @Override public void visitLogEntryBeforeWrite(    HTableDescriptor htd,    HLogKey logKey,    WALEdit logEdit){
    }
  }
);
  Thread.sleep((minRolls + 1) * LOG_ROLL_PERIOD);
  assertFalse(paths.size() < minRolls);
}
