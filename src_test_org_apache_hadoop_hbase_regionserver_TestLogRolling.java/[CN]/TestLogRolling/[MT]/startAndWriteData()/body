{
  cluster=new MiniHBaseCluster(conf,1,dfs,true);
  try {
    Thread.sleep(10 * 1000);
  }
 catch (  InterruptedException e) {
  }
  this.server=cluster.getRegionThreads().get(0).getRegionServer();
  this.log=server.getLog();
  new HTable(conf,HConstants.META_TABLE_NAME);
  HTableDescriptor desc=new HTableDescriptor(tableName);
  desc.addFamily(new HColumnDescriptor(HConstants.COLUMN_FAMILY.toString()));
  HBaseAdmin admin=new HBaseAdmin(conf);
  admin.createTable(desc);
  HTable table=new HTable(conf,new Text(tableName));
  for (int i=1; i <= 256; i++) {
    BatchUpdate b=new BatchUpdate(new Text("row" + String.format("%1$04d",i)));
    b.put(HConstants.COLUMN_FAMILY,value);
    table.commit(b);
    if (i % 32 == 0) {
      try {
        Thread.sleep(2000);
      }
 catch (      InterruptedException e) {
      }
    }
  }
}
