{
  FileStatus[] families=FSUtils.listStatus(fs,regiondir,new FSUtils.FamilyDirFilter(fs));
  if (families == null || families.length == 0) {
    LOG.info("No families under region directory:" + regiondir + ", not attempting to add references.");
    return null;
  }
  List<Path> snapshotFamilyDirs=TakeSnapshotUtils.getFamilySnapshotDirectories(snapshot,snapshotDir,families);
  LOG.debug("Add hfile references to snapshot directories:" + snapshotFamilyDirs);
  for (int i=0; i < families.length; i++) {
    FileStatus family=families[i];
    Path familyDir=family.getPath();
    FileStatus[] hfiles=FSUtils.listStatus(fs,familyDir,fileFilter);
    if (hfiles == null || hfiles.length == 0) {
      LOG.debug("Not hfiles found for family: " + familyDir + ", skipping.");
      continue;
    }
    Path snapshotFamilyDir=snapshotFamilyDirs.get(i);
    fs.mkdirs(snapshotFamilyDir);
    for (    FileStatus hfile : hfiles) {
      Path referenceFile=new Path(snapshotFamilyDir,hfile.getPath().getName());
      LOG.debug("Creating reference for:" + hfile.getPath() + " at "+ referenceFile);
      if (!fs.createNewFile(referenceFile)) {
        throw new IOException("Failed to create reference file:" + referenceFile);
      }
    }
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("Finished referencing hfiles, current region state:");
    FSUtils.logFileSystemState(fs,regiondir,LOG);
    LOG.debug("and the snapshot directory:");
    FSUtils.logFileSystemState(fs,snapshotDir,LOG);
  }
  return null;
}
