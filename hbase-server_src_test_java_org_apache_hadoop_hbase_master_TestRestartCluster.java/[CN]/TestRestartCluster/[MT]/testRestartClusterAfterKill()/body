{
  UTIL.startMiniZKCluster();
  ZooKeeperWatcher zooKeeper=new ZooKeeperWatcher(UTIL.getConfiguration(),"cluster1",null,true);
  String unassignedZNode=zooKeeper.assignmentZNode;
  ZKUtil.createAndFailSilent(zooKeeper,unassignedZNode);
  ServerName sn=ServerName.valueOf(HMaster.MASTER,1,System.currentTimeMillis());
  ZKAssign.createNodeOffline(zooKeeper,HRegionInfo.FIRST_META_REGIONINFO,sn);
  LOG.debug("Created UNASSIGNED zNode for ROOT and hbase:meta regions in state " + EventType.M_ZK_REGION_OFFLINE);
  LOG.info("Starting HBase cluster...");
  UTIL.startMiniCluster(2);
  UTIL.createTable(TABLENAME,FAMILIES);
  LOG.info("Created a table, waiting for table to be available...");
  UTIL.waitTableAvailable(TABLENAME,60 * 1000);
  LOG.info("Master deleted unassigned region and started up successfully.");
}
