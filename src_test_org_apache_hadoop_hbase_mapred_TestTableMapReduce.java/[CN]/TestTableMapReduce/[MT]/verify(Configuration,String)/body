{
  HTable table=new HTable(conf,new Text(tableName));
  Text[] columns={TEXT_INPUT_COLUMN,TEXT_OUTPUT_COLUMN};
  HScannerInterface scanner=table.obtainScanner(columns,HConstants.EMPTY_START_ROW);
  try {
    HStoreKey key=new HStoreKey();
    TreeMap<Text,byte[]> results=new TreeMap<Text,byte[]>();
    while (scanner.next(key,results)) {
      byte[] firstValue=null;
      byte[] secondValue=null;
      int count=0;
      for (      Map.Entry<Text,byte[]> e : results.entrySet()) {
        if (count == 0)         firstValue=e.getValue();
        if (count == 1)         secondValue=e.getValue();
        count++;
      }
      assertNotNull(firstValue);
      assertNotNull(secondValue);
      assertEquals(firstValue.length,secondValue.length);
      for (int i=0; i < firstValue.length; i++) {
        assertEquals(firstValue[i],secondValue[firstValue.length - i - 1]);
      }
    }
  }
  finally {
    scanner.close();
  }
}
