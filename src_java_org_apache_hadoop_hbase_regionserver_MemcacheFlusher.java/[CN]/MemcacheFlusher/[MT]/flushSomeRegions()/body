{
  long globalMemcacheSize=-1;
  for (SortedMap<Long,HRegion> m=this.server.getCopyOfOnlineRegionsSortedBySize(); (globalMemcacheSize=server.getGlobalMemcacheSize()) >= this.globalMemcacheLimitLowMark; ) {
    if (m.size() <= 0) {
      LOG.info("No online regions to flush though we've been asked flush " + "some; globalMemcacheSize=" + globalMemcacheSize + ", globalMemcacheLimitLowMark="+ this.globalMemcacheLimitLowMark);
      break;
    }
    HRegion biggestMemcacheRegion=m.remove(m.firstKey());
    LOG.info("Forced flushing of " + biggestMemcacheRegion.toString() + " because global memcache limit of "+ this.globalMemcacheLimit+ " exceeded; currenly "+ globalMemcacheSize+ " and flushing till "+ this.globalMemcacheLimitLowMark);
    if (!flushRegion(biggestMemcacheRegion,true)) {
      break;
    }
  }
}
