{
  if (timeout < 0)   throw new IllegalArgumentException();
  if (zkw == null)   throw new IllegalArgumentException();
  if (znode == null)   throw new IllegalArgumentException();
  byte[] data=null;
  boolean finished=false;
  final long endTime=EnvironmentEdgeManager.currentTimeMillis() + timeout;
  while (!finished) {
    try {
      data=ZKUtil.getData(zkw,znode);
    }
 catch (    KeeperException e) {
      LOG.warn("Unexpected exception handling blockUntilAvailable",e);
    }
    if (data == null && (EnvironmentEdgeManager.currentTimeMillis() + HConstants.SOCKET_RETRY_WAIT_MS < endTime)) {
      Thread.sleep(HConstants.SOCKET_RETRY_WAIT_MS);
    }
 else {
      finished=true;
    }
  }
  return data;
}
