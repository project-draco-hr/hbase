{
  if (quorum == null) {
    throw new IOException("Unable to determine ZooKeeper quorum");
  }
  int timeout=conf.getInt("zookeeper.session.timeout",60 * 1000);
  LOG.debug("Opening connection to ZooKeeper with quorum (" + quorum + ")");
  return new ZooKeeper(quorum,timeout,watcher);
}
