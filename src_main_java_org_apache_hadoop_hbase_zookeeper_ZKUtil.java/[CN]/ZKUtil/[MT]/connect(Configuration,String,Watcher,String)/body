{
  if (ensemble == null) {
    throw new IOException("Unable to determine ZooKeeper ensemble");
  }
  int timeout=conf.getInt("zookeeper.session.timeout",180 * 1000);
  LOG.debug(descriptor + " opening connection to ZooKeeper with ensemble (" + ensemble+ ")");
  int retry=conf.getInt("zookeeper.recovery.retry",3);
  int retryIntervalMillis=conf.getInt("zookeeper.recovery.retry.intervalmill",1000);
  return new RecoverableZooKeeper(ensemble,timeout,watcher,retry,retryIntervalMillis);
}
