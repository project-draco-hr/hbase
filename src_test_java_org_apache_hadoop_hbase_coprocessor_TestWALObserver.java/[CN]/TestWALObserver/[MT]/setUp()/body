{
  this.conf=HBaseConfiguration.create(TEST_UTIL.getConfiguration());
  this.fs=TEST_UTIL.getDFSCluster().getFileSystem();
  this.hbaseRootDir=new Path(conf.get(HConstants.HBASE_DIR));
  this.dir=new Path(this.hbaseRootDir,TestWALObserver.class.getName());
  this.oldLogDir=new Path(this.hbaseRootDir,HConstants.HREGION_OLDLOGDIR_NAME);
  this.logDir=new Path(this.hbaseRootDir,HConstants.HREGION_LOGDIR_NAME);
  if (TEST_UTIL.getDFSCluster().getFileSystem().exists(this.hbaseRootDir)) {
    TEST_UTIL.getDFSCluster().getFileSystem().delete(this.hbaseRootDir,true);
  }
}
