{
  table=new HTable(conf,new Text("test"));
  assertEquals("Test table should have 20 regions",20,table.getStartKeys().length);
  assertRegionsAreBalanced();
  LOG.debug("Adding 2nd region server.");
  cluster.startRegionServer();
  assertRegionsAreBalanced();
  LOG.debug("Adding 3rd region server.");
  cluster.startRegionServer();
  assertRegionsAreBalanced();
  LOG.debug("Killing the 3rd region server.");
  cluster.stopRegionServer(2);
  cluster.waitOnRegionServer(2);
  assertRegionsAreBalanced();
  LOG.debug("Adding 3rd region server");
  cluster.startRegionServer();
  LOG.debug("Adding 4th region server");
  cluster.startRegionServer();
  assertRegionsAreBalanced();
}
