{
  if (keyLength > keyBuffer.length) {
    int newKeyBufferLength=Math.max(keyBuffer.length,1) * 2;
    while (keyLength > newKeyBufferLength) {
      newKeyBufferLength*=2;
    }
    byte[] newKeyBuffer=new byte[newKeyBufferLength];
    System.arraycopy(keyBuffer,0,newKeyBuffer,0,keyBuffer.length);
    keyBuffer=newKeyBuffer;
  }
}
