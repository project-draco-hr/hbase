{
  int version=in.readByte();
  if (version > RESULT_VERSION) {
    throw new IOException("version not supported");
  }
  int numResults=in.readInt();
  if (numResults == 0) {
    return new Result[0];
  }
  Result[] results=new Result[numResults];
  int bufSize=in.readInt();
  byte[] buf=new byte[bufSize];
  int offset=0;
  for (int i=0; i < numResults; i++) {
    int numKeys=in.readInt();
    offset+=Bytes.SIZEOF_INT;
    if (numKeys == 0) {
      results[i]=new Result((ImmutableBytesWritable)null);
      continue;
    }
    int initialOffset=offset;
    for (int j=0; j < numKeys; j++) {
      int keyLen=in.readInt();
      Bytes.putInt(buf,offset,keyLen);
      offset+=Bytes.SIZEOF_INT;
      in.readFully(buf,offset,keyLen);
      offset+=keyLen;
    }
    int totalLength=offset - initialOffset;
    results[i]=new Result(new ImmutableBytesWritable(buf,initialOffset,totalLength));
  }
  return results;
}
