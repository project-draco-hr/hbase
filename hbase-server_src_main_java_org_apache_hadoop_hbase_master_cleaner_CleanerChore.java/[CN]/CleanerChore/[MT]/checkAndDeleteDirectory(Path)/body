{
  LOG.debug("Checking directory: " + toCheck);
  FileStatus[] children=FSUtils.listStatus(fs,toCheck);
  if (children == null)   return true;
  boolean canDeleteThis=true;
  for (  FileStatus child : children) {
    Path path=child.getPath();
    if (child.isDir()) {
      if (!checkAndDeleteDirectory(path)) {
        canDeleteThis=false;
      }
    }
 else     if (!checkAndDelete(path)) {
      canDeleteThis=false;
    }
  }
  return canDeleteThis ? fs.delete(toCheck,false) : false;
}
