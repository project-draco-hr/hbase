{
  try {
    FileStatus[] files=FSUtils.listStatus(this.fs,this.oldFileDir,null);
    if (files == null)     return;
    for (    FileStatus file : files) {
      try {
        if (file.isDir())         checkAndDeleteDirectory(file.getPath());
 else         checkAndDelete(file);
      }
 catch (      IOException e) {
        e=RemoteExceptionHandler.checkIOException(e);
        LOG.warn("Error while cleaning the logs",e);
      }
    }
  }
 catch (  IOException e) {
    LOG.warn("Failed to get status of: " + oldFileDir);
  }
}
