{
  this.dataBlockEncoder=dataBlockEncoder != null ? dataBlockEncoder : NoOpDataBlockEncoder.INSTANCE;
  writer=HFile.getWriterFactory(conf,cacheConf).withPath(fs,path).withBlockSize(blocksize).withCompression(compress).withDataBlockEncoder(this.dataBlockEncoder).withComparator(comparator.getRawComparator()).withChecksumType(checksumType).withBytesPerChecksum(bytesPerChecksum).withFavoredNodes(favoredNodes).includeMVCCReadpoint(includeMVCCReadpoint).create();
  this.kvComparator=comparator;
  generalBloomFilterWriter=BloomFilterFactory.createGeneralBloomAtWrite(conf,cacheConf,bloomType,(int)Math.min(maxKeys,Integer.MAX_VALUE),writer);
  if (generalBloomFilterWriter != null) {
    this.bloomType=bloomType;
    if (LOG.isTraceEnabled())     LOG.trace("Bloom filter type for " + path + ": "+ this.bloomType+ ", "+ generalBloomFilterWriter.getClass().getSimpleName());
  }
 else {
    this.bloomType=BloomType.NONE;
  }
  if (this.bloomType != BloomType.ROWCOL) {
    this.deleteFamilyBloomFilterWriter=BloomFilterFactory.createDeleteBloomAtWrite(conf,cacheConf,(int)Math.min(maxKeys,Integer.MAX_VALUE),writer);
  }
 else {
    deleteFamilyBloomFilterWriter=null;
  }
  if (deleteFamilyBloomFilterWriter != null) {
    if (LOG.isTraceEnabled())     LOG.trace("Delete Family Bloom filter type for " + path + ": "+ deleteFamilyBloomFilterWriter.getClass().getSimpleName());
  }
  this.checksumType=checksumType;
  this.bytesPerChecksum=bytesPerChecksum;
}
