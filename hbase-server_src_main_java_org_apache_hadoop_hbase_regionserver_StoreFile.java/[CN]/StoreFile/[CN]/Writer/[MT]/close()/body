{
  long currentSize=writer.getCurrentSize();
  if (currentSize >= 0) {
    writer.appendFileInfo(DISK_DATA_SIZE_KEY,Bytes.toBytes(currentSize));
  }
  boolean hasGeneralBloom=this.closeGeneralBloomFilter();
  boolean hasDeleteFamilyBloom=this.closeDeleteFamilyBloomFilter();
  writer.close();
  StoreFile.LOG.info((hasGeneralBloom ? "" : "NO ") + "General Bloom and " + (hasDeleteFamilyBloom ? "" : "NO ")+ "DeleteFamily"+ " was added to HFile ("+ getPath()+ ") ");
}
