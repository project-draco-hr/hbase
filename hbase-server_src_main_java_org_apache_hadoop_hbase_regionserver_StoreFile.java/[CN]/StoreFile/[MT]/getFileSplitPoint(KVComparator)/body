{
  if (this.reader == null) {
    LOG.warn("Storefile " + this + " Reader is null; cannot get split point");
    return null;
  }
  byte[] midkey=this.reader.midkey();
  if (midkey != null) {
    KeyValue mk=KeyValue.createKeyValueFromKey(midkey,0,midkey.length);
    byte[] fk=this.reader.getFirstKey();
    KeyValue firstKey=KeyValue.createKeyValueFromKey(fk,0,fk.length);
    byte[] lk=this.reader.getLastKey();
    KeyValue lastKey=KeyValue.createKeyValueFromKey(lk,0,lk.length);
    if (comparator.compareRows(mk,firstKey) == 0 || comparator.compareRows(mk,lastKey) == 0) {
      if (LOG.isDebugEnabled()) {
        LOG.debug("cannot split because midkey is the same as first or last row");
      }
      return null;
    }
    return mk.getRow();
  }
  return null;
}
