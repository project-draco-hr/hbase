{
  if (isReference()) {
    FileStatus status;
    if (this.link != null) {
      status=this.link.getFileStatus(fs);
    }
 else {
      status=fs.getFileStatus(this.referencePath);
    }
    this.hdfsBlocksDistribution=computeRefFileHDFSBlockDistribution(this.fs,this.reference,status);
  }
 else {
    FileStatus status;
    if (isLink()) {
      status=link.getFileStatus(fs);
    }
 else {
      status=this.fs.getFileStatus(path);
    }
    long length=status.getLen();
    this.hdfsBlocksDistribution=FSUtils.computeHDFSBlocksDistribution(this.fs,status,0,length);
  }
}
