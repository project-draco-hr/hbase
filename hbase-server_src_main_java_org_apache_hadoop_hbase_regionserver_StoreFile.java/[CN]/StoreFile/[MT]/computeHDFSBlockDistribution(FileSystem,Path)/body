{
  if (isReference(p)) {
    Reference reference=Reference.read(fs,p);
    Path referencePath=getReferredToFile(p);
    return computeRefFileHDFSBlockDistribution(fs,reference,referencePath);
  }
 else {
    if (HFileLink.isHFileLink(p))     p=HFileLink.getReferencedPath(fs,p);
    FileStatus status=fs.getFileStatus(p);
    long length=status.getLen();
    return FSUtils.computeHDFSBlocksDistribution(fs,status,0,length);
  }
}
