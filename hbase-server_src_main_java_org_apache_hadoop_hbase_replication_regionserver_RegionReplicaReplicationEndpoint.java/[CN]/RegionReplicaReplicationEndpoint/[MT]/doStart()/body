{
  try {
    connection=(ClusterConnection)HConnectionManager.createConnection(ctx.getConfiguration());
    this.pool=getDefaultThreadPool(conf);
    outputSink=new RegionReplicaOutputSink(controller,entryBuffers,connection,pool,numWriterThreads,operationTimeout);
    outputSink.startWriterThreads();
    super.doStart();
  }
 catch (  IOException ex) {
    LOG.warn("Received exception while creating connection :" + ex);
    notifyFailed(ex);
  }
}
