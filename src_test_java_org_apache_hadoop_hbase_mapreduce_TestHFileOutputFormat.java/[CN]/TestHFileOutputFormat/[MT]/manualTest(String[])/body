{
  Configuration conf=HBaseConfiguration.create();
  util=new HBaseTestingUtility(conf);
  if ("newtable".equals(args[0])) {
    byte[] tname=args[1].getBytes();
    HTable table=util.createTable(tname,FAMILIES);
    HBaseAdmin admin=new HBaseAdmin(conf);
    admin.disableTable(tname);
    byte[][] startKeys=generateRandomStartKeys(5);
    util.createMultiRegions(conf,table,FAMILIES[0],startKeys);
    admin.enableTable(tname);
  }
 else   if ("incremental".equals(args[0])) {
    byte[] tname=args[1].getBytes();
    HTable table=new HTable(conf,tname);
    Path outDir=new Path("incremental-out");
    runIncrementalPELoad(conf,table,outDir);
  }
 else {
    throw new RuntimeException("usage: TestHFileOutputFormat newtable | incremental");
  }
}
