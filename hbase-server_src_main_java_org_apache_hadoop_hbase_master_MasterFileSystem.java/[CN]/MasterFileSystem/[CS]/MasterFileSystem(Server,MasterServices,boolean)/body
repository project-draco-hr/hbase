{
  this.conf=master.getConfiguration();
  this.master=master;
  this.services=services;
  this.rootdir=FSUtils.getRootDir(conf);
  this.tempdir=new Path(this.rootdir,HConstants.HBASE_TEMP_DIRECTORY);
  this.fs=this.rootdir.getFileSystem(conf);
  FSUtils.setFsDefault(conf,new Path(this.fs.getUri()));
  fs.setConf(conf);
  this.distributedLogReplay=HLogSplitter.isDistributedLogReplay(this.conf);
  this.oldLogDir=createInitialFileSystemLayout();
  HFileSystem.addLocationsOrderInterceptor(conf);
  this.splitLogManager=new SplitLogManager(master.getZooKeeper(),master.getConfiguration(),master,services,master.getServerName(),masterRecovery);
}
