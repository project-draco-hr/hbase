{
  this.conf=master.getConfiguration();
  this.master=master;
  this.services=services;
  this.metricsMaster=metricsMaster;
  this.rootdir=FSUtils.getRootDir(conf);
  this.tempdir=new Path(this.rootdir,HConstants.HBASE_TEMP_DIRECTORY);
  this.fs=this.rootdir.getFileSystem(conf);
  FSUtils.setFsDefault(conf,new Path(this.fs.getUri()));
  fs.setConf(conf);
  this.splitLogManager=new SplitLogManager(master.getZooKeeper(),master.getConfiguration(),master,services,master.getServerName());
  this.distributedLogSplitting=conf.getBoolean(HConstants.DISTRIBUTED_LOG_SPLITTING_KEY,true);
  if (this.distributedLogSplitting) {
    this.splitLogManager.finishInitialization(masterRecovery);
  }
  this.distributedLogReplay=this.conf.getBoolean(HConstants.DISTRIBUTED_LOG_REPLAY_KEY,HConstants.DEFAULT_DISTRIBUTED_LOG_REPLAY_CONFIG);
  this.oldLogDir=createInitialFileSystemLayout();
  HFileSystem.addLocationsOrderInterceptor(conf);
}
