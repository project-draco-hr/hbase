{
  this.conf=master.getConfiguration();
  this.master=master;
  this.services=services;
  this.metricsMaster=metricsMaster;
  this.rootdir=FSUtils.getRootDir(conf);
  this.fs=this.rootdir.getFileSystem(conf);
  String fsUri=this.fs.getUri().toString();
  conf.set("fs.default.name",fsUri);
  conf.set("fs.defaultFS",fsUri);
  fs.setConf(conf);
  this.distributedLogSplitting=conf.getBoolean(HConstants.DISTRIBUTED_LOG_SPLITTING_KEY,true);
  if (this.distributedLogSplitting) {
    this.splitLogManager=new SplitLogManager(master.getZooKeeper(),master.getConfiguration(),master,services,master.getServerName());
    this.splitLogManager.finishInitialization(masterRecovery);
  }
 else {
    this.splitLogManager=null;
  }
  this.oldLogDir=createInitialFileSystemLayout();
  HFileSystem.addLocationsOrderInterceptor(conf);
}
