{
  this.conf=master.getConfiguration();
  this.master=master;
  this.services=services;
  this.rootdir=FSUtils.getRootDir(conf);
  this.tempdir=new Path(this.rootdir,HConstants.HBASE_TEMP_DIRECTORY);
  this.fs=this.rootdir.getFileSystem(conf);
  FSUtils.setFsDefault(conf,new Path(this.fs.getUri()));
  fs.setConf(conf);
  this.oldLogDir=createInitialFileSystemLayout();
  HFileSystem.addLocationsOrderInterceptor(conf);
  try {
    this.splitLogManager=new SplitLogManager(master.getZooKeeper(),master.getConfiguration(),master,services,master.getServerName());
  }
 catch (  KeeperException e) {
    throw new IOException(e);
  }
  this.distributedLogReplay=(this.splitLogManager.getRecoveryMode() == RecoveryMode.LOG_REPLAY);
}
