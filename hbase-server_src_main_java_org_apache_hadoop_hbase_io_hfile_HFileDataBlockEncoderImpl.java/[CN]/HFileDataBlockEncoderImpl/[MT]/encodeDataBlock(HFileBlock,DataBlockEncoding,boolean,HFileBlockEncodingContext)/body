{
  encodeBufferToHFileBlockBuffer(block.getBufferWithoutHeader(),algo,includesMemstoreTS,encodingCtx);
  byte[] encodedUncompressedBytes=encodingCtx.getUncompressedBytesWithHeader();
  ByteBuffer bufferWrapper=ByteBuffer.wrap(encodedUncompressedBytes);
  int sizeWithoutHeader=bufferWrapper.limit() - encodingCtx.getHeaderSize();
  HFileBlock encodedBlock=new HFileBlock(BlockType.ENCODED_DATA,block.getOnDiskSizeWithoutHeader(),sizeWithoutHeader,block.getPrevBlockOffset(),bufferWrapper,HFileBlock.FILL_HEADER,block.getOffset(),includesMemstoreTS,block.getMinorVersion(),block.getBytesPerChecksum(),block.getChecksumType(),block.getOnDiskDataSizeWithHeader());
  return encodedBlock;
}
