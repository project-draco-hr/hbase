{
  byte[] dataBlockEncodingType=fileInfo.get(DATA_BLOCK_ENCODING);
  if (dataBlockEncodingType == null) {
    return NoOpDataBlockEncoder.INSTANCE;
  }
  String dataBlockEncodingStr=Bytes.toString(dataBlockEncodingType);
  DataBlockEncoding onDisk;
  try {
    onDisk=DataBlockEncoding.valueOf(dataBlockEncodingStr);
  }
 catch (  IllegalArgumentException ex) {
    throw new IOException("Invalid data block encoding type in file info: " + dataBlockEncodingStr,ex);
  }
  DataBlockEncoding inCache;
  if (onDisk == DataBlockEncoding.NONE) {
    inCache=preferredEncodingInCache;
  }
 else {
    inCache=onDisk;
  }
  return new HFileDataBlockEncoderImpl(onDisk,inCache);
}
