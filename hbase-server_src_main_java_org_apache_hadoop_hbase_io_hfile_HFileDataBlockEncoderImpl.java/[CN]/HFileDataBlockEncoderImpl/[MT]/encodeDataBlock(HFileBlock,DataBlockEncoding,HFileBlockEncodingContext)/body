{
  encodingCtx.setDummyHeader(block.getDummyHeaderForVersion());
  encodeBufferToHFileBlockBuffer(block.getBufferWithoutHeader(),algo,encodingCtx);
  byte[] encodedUncompressedBytes=encodingCtx.getUncompressedBytesWithHeader();
  ByteBuffer bufferWrapper=ByteBuffer.wrap(encodedUncompressedBytes);
  int sizeWithoutHeader=bufferWrapper.limit() - block.headerSize();
  HFileBlock encodedBlock=new HFileBlock(BlockType.ENCODED_DATA,block.getOnDiskSizeWithoutHeader(),sizeWithoutHeader,block.getPrevBlockOffset(),bufferWrapper,HFileBlock.FILL_HEADER,block.getOffset(),block.getOnDiskDataSizeWithHeader(),encodingCtx.getHFileContext());
  return encodedBlock;
}
