{
  MemStoreLAB tmpAllocator=null;
  if (this.snapshotId != id) {
    throw new UnexpectedException("Current snapshot id is " + this.snapshotId + ",passed "+ id);
  }
  if (!this.snapshot.isEmpty()) {
    this.snapshot=new KeyValueSkipListSet(this.comparator);
    this.snapshotTimeRangeTracker=new TimeRangeTracker();
  }
  this.snapshotSize=0;
  this.snapshotId=-1;
  if (this.snapshotAllocator != null) {
    tmpAllocator=this.snapshotAllocator;
    this.snapshotAllocator=null;
  }
  if (tmpAllocator != null) {
    tmpAllocator.close();
  }
}
