{
  byte[] cf=store.getFamily().getName();
  TimeRange timeRange=scan.getColumnFamilyTimeRange().get(cf);
  if (timeRange == null) {
    timeRange=scan.getTimeRange();
  }
  return (timeRangeTracker.includesTimeRange(timeRange) || snapshotTimeRangeTracker.includesTimeRange(timeRange)) && (Math.max(timeRangeTracker.getMaximumTimestamp(),snapshotTimeRangeTracker.getMaximumTimestamp()) >= oldestUnexpiredTS);
}
