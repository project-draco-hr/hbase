{
  int result=1;
  ArrayList<Path> regionPathList=this.getRegionList(tableArchivePath);
  if (regionPathList == null || regionPathList.size() == 0) {
    throw new IllegalStateException("Cannot restore hbase table because directory '" + tableArchivePath + "' is not a directory.");
  }
  for (  Path regionPath : regionPathList) {
    result=Math.max(result,getNumberOfFilesInDir(regionPath));
  }
  return result;
}
