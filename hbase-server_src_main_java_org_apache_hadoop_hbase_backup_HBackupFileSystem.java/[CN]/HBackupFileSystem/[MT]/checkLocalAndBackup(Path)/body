{
  boolean isCopyNeeded=false;
  FileSystem srcFs=tableArchivePath.getFileSystem(conf);
  FileSystem desFs=FileSystem.get(conf);
  if (tableArchivePath.getName().startsWith("/")) {
    isCopyNeeded=true;
  }
 else {
    if (srcFs.getUri().equals(desFs.getUri())) {
      LOG.debug("cluster hold the backup image: " + srcFs.getUri() + "; local cluster node: "+ desFs.getUri());
      isCopyNeeded=true;
    }
  }
  if (isCopyNeeded) {
    LOG.debug("File " + tableArchivePath + " on local cluster, back it up before restore");
    Path tmpPath=new Path(RESTORE_TMP_PATH);
    if (desFs.exists(tmpPath)) {
      try {
        desFs.delete(tmpPath,true);
      }
 catch (      IOException e) {
        LOG.debug("Failed to delete path: " + tmpPath + ", need to check whether restore target DFS cluster is healthy");
      }
    }
    FileUtil.copy(srcFs,tableArchivePath,desFs,tmpPath,false,conf);
    LOG.debug("Copied to temporary path on local cluster: " + tmpPath);
    tableArchivePath=tmpPath;
  }
  return tableArchivePath;
}
