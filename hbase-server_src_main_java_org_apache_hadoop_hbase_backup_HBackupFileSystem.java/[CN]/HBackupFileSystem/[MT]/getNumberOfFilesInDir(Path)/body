{
  int result=0;
  if (!fs.exists(regionPath) || !fs.getFileStatus(regionPath).isDirectory()) {
    throw new IllegalStateException("Cannot restore hbase table because directory '" + regionPath.toString() + "' is not a directory.");
  }
  FileStatus[] tableDirContent=fs.listStatus(regionPath);
  for (  FileStatus subDirStatus : tableDirContent) {
    FileStatus[] colFamilies=fs.listStatus(subDirStatus.getPath());
    for (    FileStatus colFamilyStatus : colFamilies) {
      FileStatus[] colFamilyContent=fs.listStatus(colFamilyStatus.getPath());
      result+=colFamilyContent.length;
    }
  }
  return result;
}
