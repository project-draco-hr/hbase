{
  kvs.clear();
  kvs.ensureCapacity(expectedCount);
  while (kvs.size() < expectedCount && cellDecoder.advance()) {
    Cell cell=cellDecoder.current();
    if (!(cell instanceof KeyValue)) {
      throw new IOException("WAL edit only supports KVs as cells");
    }
    kvs.add((KeyValue)cell);
  }
  return kvs.size();
}
