{
  out.writeInt(VERSION_2);
  out.writeInt(kvs.size());
  for (  KeyValue kv : kvs) {
    if (compressionContext != null) {
      KeyValueCompression.writeKV(out,kv,compressionContext);
    }
 else {
      KeyValue.write(kv,out);
    }
  }
  if (scopes == null) {
    out.writeInt(0);
  }
 else {
    out.writeInt(scopes.size());
    for (    byte[] key : scopes.keySet()) {
      Bytes.writeByteArray(out,key);
      out.writeInt(scopes.get(key));
    }
  }
}
