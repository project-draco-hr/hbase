{
  if (LOG.isDebugEnabled()) {
    LOG.debug("write RS log ts to HBASE_BACKUP");
  }
  StringBuilder sb=new StringBuilder();
  for (  Map.Entry<String,String> entry : newTimestamps.entrySet()) {
    String host=entry.getKey();
    String timestamp=entry.getValue();
    sb.append(host).append(BackupUtil.FIELD_SEPARATOR).append(timestamp).append(BackupUtil.RECORD_SEPARATOR);
  }
  String smap=sb.toString();
  List<Put> puts=new ArrayList<Put>();
  for (  String table : tables) {
    Put put=BackupSystemTableHelper.createPutForWriteRegionServerLogTimestamp(table,smap);
    puts.add(put);
  }
  Table table=null;
  try {
    table=connection.getTable(tableName);
    table.put(puts);
  }
  finally {
    if (table != null) {
      table.close();
    }
  }
}
