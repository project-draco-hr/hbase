{
  if (LOG.isDebugEnabled()) {
    LOG.debug("read region server last roll log result to hbase:backup");
  }
  Table table=null;
  ResultScanner scanner=null;
  try {
    table=connection.getTable(tableName);
    Scan scan=BackupSystemTableHelper.createScanForReadRegionServerLastLogRollResult();
    scan.setMaxVersions(1);
    scanner=table.getScanner(scan);
    Result res=null;
    HashMap<String,String> rsTimestampMap=new HashMap<String,String>();
    while ((res=scanner.next()) != null) {
      res.advance();
      Cell cell=res.current();
      byte[] row=CellUtil.cloneRow(cell);
      String server=BackupSystemTableHelper.getServerNameForReadRegionServerLastLogRollResult(row);
      byte[] data=CellUtil.cloneValue(cell);
      rsTimestampMap.put(server,new String(data));
    }
    return rsTimestampMap;
  }
  finally {
    if (scanner != null) {
      scanner.close();
    }
    if (table != null) {
      table.close();
    }
  }
}
