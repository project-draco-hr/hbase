{
  if (endpoint.getLastRegionServerUpdate() > this.lastUpdateToPeers) {
    LOG.info("Current list of sinks is out of date, updating");
    chooseSinks();
  }
  if (sinks.isEmpty()) {
    throw new IOException("No replication sinks are available");
  }
  ServerName serverName=sinks.get(random.nextInt(sinks.size()));
  return new SinkPeer(serverName,conn.getAdmin(serverName));
}
