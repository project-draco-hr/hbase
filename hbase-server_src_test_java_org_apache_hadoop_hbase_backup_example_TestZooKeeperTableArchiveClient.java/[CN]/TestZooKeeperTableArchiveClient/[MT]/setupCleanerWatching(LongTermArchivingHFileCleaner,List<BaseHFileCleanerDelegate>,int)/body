{
  BaseHFileCleanerDelegate delegateSpy=Mockito.spy(cleaner);
  final int[] counter=new int[]{0};
  final CountDownLatch finished=new CountDownLatch(1);
  Mockito.doAnswer(new Answer<Boolean>(){
    @Override public Boolean answer(    InvocationOnMock invocation) throws Throwable {
      counter[0]++;
      LOG.debug(counter[0] + "/ " + expected+ ") Mocking call to isFileDeletable");
      if (counter[0] > expected)       finished.countDown();
      return (Boolean)invocation.callRealMethod();
    }
  }
).when(delegateSpy).isFileDeletable(Mockito.any(Path.class));
  cleaners.set(0,delegateSpy);
  return finished;
}
