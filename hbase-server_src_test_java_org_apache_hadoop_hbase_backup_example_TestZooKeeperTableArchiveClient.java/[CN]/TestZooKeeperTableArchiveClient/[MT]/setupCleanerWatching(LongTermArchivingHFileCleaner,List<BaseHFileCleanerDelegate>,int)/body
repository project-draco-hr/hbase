{
  BaseHFileCleanerDelegate delegateSpy=Mockito.spy(cleaner);
  final int[] counter=new int[]{0};
  final CountDownLatch finished=new CountDownLatch(1);
  Mockito.doAnswer(new Answer<Boolean>(){
    @Override public Boolean answer(    InvocationOnMock invocation) throws Throwable {
      counter[0]++;
      LOG.debug(counter[0] + "/ " + expected+ ") Wrapping call to isFileDeletable for file: "+ invocation.getArguments()[0]);
      Boolean ret=(Boolean)invocation.callRealMethod();
      if (counter[0] >= expected)       finished.countDown();
      return ret;
    }
  }
).when(delegateSpy).isFileDeletable(Mockito.any(FileStatus.class));
  cleaners.set(0,delegateSpy);
  return finished;
}
