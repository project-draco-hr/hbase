{
  List<HRegion> servingRegions=UTIL.getHBaseCluster().getRegions(Bytes.toBytes(tablename));
  assertEquals("Test doesn't support more than 1 region serving table: " + tablename + "",1,servingRegions.size());
  HRegion region=servingRegions.get(0);
  Store store=region.getStore(TEST_FAM);
  Path storeArchiveDir=HFileArchiveTestingUtil.getStoreArchivePath(UTIL.getConfiguration(),region,store);
  Path regionArchiveDir=HFileArchiveUtil.getArchivePath(UTIL.getConfiguration());
  FSUtils.logFileSystemState(fs,regionArchiveDir,LOG);
  assertEquals("Didn't create a store archive directory:" + storeArchiveDir,expectedArchiveFiles != 0,fs.exists(storeArchiveDir));
  assertThat(expectedArchiveFiles,new HasExactFiles(fs,storeArchiveDir));
}
