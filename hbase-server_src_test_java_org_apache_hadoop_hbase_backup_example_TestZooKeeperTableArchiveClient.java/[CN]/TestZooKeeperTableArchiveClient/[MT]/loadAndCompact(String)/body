{
  byte[] table=Bytes.toBytes(tableName);
  List<HRegion> servingRegions=UTIL.getHBaseCluster().getRegions(table);
  assertEquals(1,servingRegions.size());
  HRegion region=servingRegions.get(0);
  HRegionServer hrs=UTIL.getRSForFirstRegionInTable(table);
  FileSystem fs=hrs.getFileSystem();
  LOG.debug("-------Loading table");
  UTIL.loadRegion(region,TEST_FAM);
  loadAndCompact(region);
  HStore store=region.getStore(TEST_FAM);
  Path storeArchiveDir=HFileArchiveTestingUtil.getStoreArchivePath(UTIL.getConfiguration(),region,store);
  assertTrue("Didn't create a store archive directory",fs.exists(storeArchiveDir));
  assertTrue("No files in the store archive",FSUtils.listStatus(fs,storeArchiveDir,null).length > 0);
  region.waitForFlushesAndCompactions();
}
