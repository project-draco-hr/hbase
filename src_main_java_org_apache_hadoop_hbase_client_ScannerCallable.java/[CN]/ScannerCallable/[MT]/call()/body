{
  if (scannerId != -1L && closed) {
    close();
  }
 else   if (scannerId == -1L && !closed) {
    this.scannerId=openScanner();
  }
 else {
    Result[] rrs=null;
    try {
      incRPCcallsMetrics();
      rrs=server.next(scannerId,caching);
      updateResultsMetrics(rrs);
    }
 catch (    IOException e) {
      IOException ioe=null;
      if (e instanceof RemoteException) {
        ioe=RemoteExceptionHandler.decodeRemoteException((RemoteException)e);
      }
      if (ioe == null)       throw new IOException(e);
      if (ioe instanceof NotServingRegionException) {
        if (this.scanMetrics != null) {
          this.scanMetrics.countOfNSRE.inc();
        }
        throw new DoNotRetryIOException("Reset scanner",ioe);
      }
 else       if (ioe instanceof RegionServerStoppedException) {
        throw new DoNotRetryIOException("Reset scanner",ioe);
      }
 else {
        throw ioe;
      }
    }
    return rrs;
  }
  return null;
}
