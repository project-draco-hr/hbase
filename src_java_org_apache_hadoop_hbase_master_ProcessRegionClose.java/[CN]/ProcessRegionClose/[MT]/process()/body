{
  Boolean result=new RetryableMetaOperation<Boolean>(this.metaRegion,this.master){
    public Boolean call() throws IOException {
      LOG.info("region closed: " + regionInfo.getRegionName());
      if (!metaRegionAvailable()) {
        return true;
      }
      if (deleteRegion) {
        HRegion.removeRegionFromMETA(server,metaRegionName,regionInfo.getRegionName());
      }
 else       if (offlineRegion) {
        HRegion.offlineRegionInMETA(server,metaRegionName,regionInfo);
        master.regionManager.regionOfflined(regionInfo.getRegionName());
      }
      return true;
    }
  }
.doWithRetries();
  if (deleteRegion) {
    try {
      HRegion.deleteRegion(master.fs,master.rootdir,regionInfo);
    }
 catch (    IOException e) {
      e=RemoteExceptionHandler.checkIOException(e);
      LOG.error("failed delete region " + regionInfo.getRegionName(),e);
      throw e;
    }
  }
  return result == null ? true : result;
}
