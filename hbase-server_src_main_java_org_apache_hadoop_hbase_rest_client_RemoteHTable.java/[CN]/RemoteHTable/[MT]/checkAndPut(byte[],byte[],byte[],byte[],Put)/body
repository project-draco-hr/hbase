{
  put.add(new KeyValue(row,family,qualifier,value));
  CellSetModel model=buildModelFromPut(put);
  StringBuilder sb=new StringBuilder();
  sb.append('/');
  if (accessToken != null) {
    sb.append(accessToken);
    sb.append('/');
  }
  sb.append(Bytes.toStringBinary(name));
  sb.append('/');
  sb.append(Bytes.toStringBinary(put.getRow()));
  sb.append("?check=put");
  for (int i=0; i < maxRetries; i++) {
    Response response=client.put(sb.toString(),Constants.MIMETYPE_PROTOBUF,model.createProtobufOutput());
    int code=response.getCode();
switch (code) {
case 200:
      return true;
case 304:
    return false;
case 509:
  try {
    Thread.sleep(sleepTime);
  }
 catch (  final InterruptedException e) {
  }
break;
default :
throw new IOException("checkAndPut request failed with " + code);
}
}
throw new IOException("checkAndPut request timed out");
}
