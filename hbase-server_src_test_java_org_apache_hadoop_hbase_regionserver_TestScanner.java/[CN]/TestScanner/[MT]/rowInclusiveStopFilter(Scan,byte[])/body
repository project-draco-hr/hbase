{
  List<Cell> results=new ArrayList<Cell>();
  scan.addFamily(HConstants.CATALOG_FAMILY);
  InternalScanner s=r.getScanner(scan);
  boolean hasMore=true;
  while (hasMore) {
    hasMore=NextState.hasMoreValues(s.next(results));
    for (    Cell kv : results) {
      assertTrue(Bytes.compareTo(CellUtil.cloneRow(kv),stopRow) <= 0);
    }
    results.clear();
  }
  s.close();
}
