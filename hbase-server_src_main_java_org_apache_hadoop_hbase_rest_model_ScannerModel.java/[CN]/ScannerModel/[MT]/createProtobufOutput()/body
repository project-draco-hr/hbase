{
  Scanner.Builder builder=Scanner.newBuilder();
  if (!Bytes.equals(startRow,HConstants.EMPTY_START_ROW)) {
    builder.setStartRow(ByteString.copyFrom(startRow));
  }
  if (!Bytes.equals(endRow,HConstants.EMPTY_START_ROW)) {
    builder.setEndRow(ByteString.copyFrom(endRow));
  }
  for (  byte[] column : columns) {
    builder.addColumns(ByteString.copyFrom(column));
  }
  if (startTime != 0) {
    builder.setStartTime(startTime);
  }
  if (endTime != 0) {
    builder.setEndTime(endTime);
  }
  builder.setBatch(getBatch());
  builder.setMaxVersions(maxVersions);
  if (filter != null) {
    builder.setFilter(filter);
  }
  return builder.build().toByteArray();
}
