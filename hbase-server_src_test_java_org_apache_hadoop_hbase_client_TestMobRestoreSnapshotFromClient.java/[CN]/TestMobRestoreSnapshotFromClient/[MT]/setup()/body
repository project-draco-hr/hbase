{
  this.admin=TEST_UTIL.getHBaseAdmin();
  long tid=System.currentTimeMillis();
  tableName=TableName.valueOf("testtb-" + tid);
  emptySnapshot=Bytes.toBytes("emptySnaptb-" + tid);
  snapshotName0=Bytes.toBytes("snaptb0-" + tid);
  snapshotName1=Bytes.toBytes("snaptb1-" + tid);
  snapshotName2=Bytes.toBytes("snaptb2-" + tid);
  MobSnapshotTestingUtils.createMobTable(TEST_UTIL,tableName,getNumReplicas(),FAMILY);
  admin.disableTable(tableName);
  admin.snapshot(emptySnapshot,tableName);
  Table table=ConnectionFactory.createConnection(TEST_UTIL.getConfiguration()).getTable(tableName);
  admin.enableTable(tableName);
  SnapshotTestingUtils.loadData(TEST_UTIL,tableName,500,FAMILY);
  snapshot0Rows=MobSnapshotTestingUtils.countMobRows(table);
  admin.disableTable(tableName);
  admin.snapshot(snapshotName0,tableName);
  admin.enableTable(tableName);
  SnapshotTestingUtils.loadData(TEST_UTIL,tableName,500,FAMILY);
  snapshot1Rows=MobSnapshotTestingUtils.countMobRows(table);
  table.close();
}
