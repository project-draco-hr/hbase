{
  out.writeByte(SCAN_VERSION);
  Bytes.writeByteArray(out,this.startRow);
  Bytes.writeByteArray(out,this.stopRow);
  out.writeInt(this.maxVersions);
  out.writeInt(this.batch);
  out.writeInt(this.caching);
  out.writeBoolean(this.cacheBlocks);
  if (this.filter == null) {
    out.writeBoolean(false);
  }
 else {
    out.writeBoolean(true);
    Bytes.writeByteArray(out,Bytes.toBytes(filter.getClass().getName()));
    filter.write(out);
  }
  tr.write(out);
  out.writeInt(familyMap.size());
  for (  Map.Entry<byte[],NavigableSet<byte[]>> entry : familyMap.entrySet()) {
    Bytes.writeByteArray(out,entry.getKey());
    NavigableSet<byte[]> columnSet=entry.getValue();
    if (columnSet != null) {
      out.writeInt(columnSet.size());
      for (      byte[] qualifier : columnSet) {
        Bytes.writeByteArray(out,qualifier);
      }
    }
 else {
      out.writeInt(0);
    }
  }
  if (this.attributes == null) {
    out.writeInt(0);
  }
 else {
    out.writeInt(this.attributes.size());
    for (    Map.Entry<String,byte[]> attr : this.attributes.entrySet()) {
      WritableUtils.writeString(out,attr.getKey());
      Bytes.writeByteArray(out,attr.getValue());
    }
  }
}
