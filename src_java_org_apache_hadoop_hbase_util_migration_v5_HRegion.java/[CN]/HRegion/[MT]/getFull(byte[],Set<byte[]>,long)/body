{
  if (columns != null) {
    for (    byte[] column : columns) {
      checkColumn(column);
    }
  }
  HStoreKey key=new HStoreKey(row,ts);
  Integer lid=obtainRowLock(row);
  try {
    TreeMap<byte[],Cell> result=new TreeMap<byte[],Cell>(Bytes.BYTES_COMPARATOR);
    for (    HStore targetStore : stores.values()) {
      targetStore.getFull(key,columns,result);
    }
    if (columns != null) {
      for (      byte[] bs : columns) {
        if (HStoreKey.getFamilyDelimiterIndex(bs) == (bs.length - 1)) {
          HStore store=stores.get(Bytes.mapKey(HStoreKey.getFamily(bs)));
          store.getFull(key,null,result);
        }
      }
    }
    return result;
  }
  finally {
    releaseRowLock(lid);
  }
}
