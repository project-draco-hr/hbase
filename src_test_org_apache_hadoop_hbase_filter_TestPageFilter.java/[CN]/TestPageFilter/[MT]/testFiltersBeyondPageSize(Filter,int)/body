{
  int count=0;
  for (int i=0; i < (pageSize * 2); i++) {
    byte[] bytes=Bytes.toBytes(Integer.toString(i) + ":tail");
    KeyValue kv=new KeyValue(bytes,bytes);
    boolean filterOut=f.filterRowKey(kv.getBuffer(),kv.getRowOffset(),kv.getRowLength());
    if (!filterOut) {
      assertFalse("Disagrees with 'filter'",f.filterAllRemaining());
    }
 else {
      assertTrue("Disagrees with 'filter'",f.filterAllRemaining());
      assertTrue(i >= pageSize);
    }
    count++;
    if (Filter.ReturnCode.NEXT_ROW == f.filterKeyValue(kv)) {
      break;
    }
  }
  assertEquals(pageSize,count);
}
