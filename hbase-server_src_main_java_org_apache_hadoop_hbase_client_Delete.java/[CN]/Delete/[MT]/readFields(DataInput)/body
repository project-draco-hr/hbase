{
  int version=in.readByte();
  if (version > DELETE_VERSION) {
    throw new IOException("version not supported");
  }
  this.row=Bytes.readByteArray(in);
  this.ts=in.readLong();
  this.lockId=in.readLong();
  if (version > 2) {
    this.writeToWAL=in.readBoolean();
  }
  this.familyMap.clear();
  int numFamilies=in.readInt();
  for (int i=0; i < numFamilies; i++) {
    byte[] family=Bytes.readByteArray(in);
    int numColumns=in.readInt();
    List<KeyValue> list=new ArrayList<KeyValue>(numColumns);
    for (int j=0; j < numColumns; j++) {
      KeyValue kv=new KeyValue();
      kv.readFields(in);
      list.add(kv);
    }
    this.familyMap.put(family,list);
  }
  if (version > 1) {
    readAttributes(in);
  }
}
