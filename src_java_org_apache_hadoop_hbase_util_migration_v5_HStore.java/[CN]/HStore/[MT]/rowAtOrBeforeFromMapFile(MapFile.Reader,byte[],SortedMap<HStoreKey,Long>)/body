{
  ImmutableBytesWritable readval=new ImmutableBytesWritable();
  HStoreKey readkey=new HStoreKey();
synchronized (map) {
    map.reset();
    if (!map.next(readkey,readval)) {
      return;
    }
    long now=System.currentTimeMillis();
    if (candidateKeys.isEmpty()) {
      rowKeyFromMapFileEmptyKeys(map,row,candidateKeys,now);
    }
 else {
      rowKeyAtOrBeforeExistingCandKeys(map,row,candidateKeys,now);
    }
  }
}
