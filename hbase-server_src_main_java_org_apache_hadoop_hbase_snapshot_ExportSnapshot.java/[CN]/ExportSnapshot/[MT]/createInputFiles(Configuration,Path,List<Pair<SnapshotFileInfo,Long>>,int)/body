{
  FileSystem fs=inputFolderPath.getFileSystem(conf);
  LOG.debug("Input folder location: " + inputFolderPath);
  List<List<SnapshotFileInfo>> splits=getBalancedSplits(snapshotFiles,mappers);
  Path[] inputFiles=new Path[splits.size()];
  BytesWritable key=new BytesWritable();
  for (int i=0; i < inputFiles.length; i++) {
    List<SnapshotFileInfo> files=splits.get(i);
    inputFiles[i]=new Path(inputFolderPath,String.format("export-%d.seq",i));
    SequenceFile.Writer writer=SequenceFile.createWriter(fs,conf,inputFiles[i],BytesWritable.class,NullWritable.class);
    LOG.debug("Input split: " + i);
    try {
      for (      SnapshotFileInfo file : files) {
        byte[] pbFileInfo=file.toByteArray();
        key.set(pbFileInfo,0,pbFileInfo.length);
        writer.append(key,NullWritable.get());
      }
    }
  finally {
      writer.close();
    }
  }
  return inputFiles;
}
