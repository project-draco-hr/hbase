{
  SnapshotDescription snapshotDesc=SnapshotDescriptionUtils.readSnapshotInfo(fs,snapshotDir);
  final List<Pair<Path,Long>> files=new ArrayList<Pair<Path,Long>>();
  final String table=snapshotDesc.getTable();
  final Configuration conf=getConf();
  SnapshotReferenceUtil.visitReferencedFiles(fs,snapshotDir,new SnapshotReferenceUtil.FileVisitor(){
    public void storeFile(    final String region,    final String family,    final String hfile) throws IOException {
      Path path=new Path(family,HFileLink.createHFileLinkName(table,region,hfile));
      long size=fs.getFileStatus(HFileLink.getReferencedPath(conf,fs,path)).getLen();
      files.add(new Pair<Path,Long>(path,size));
    }
    public void recoveredEdits(    final String region,    final String logfile) throws IOException {
    }
    public void logFile(    final String server,    final String logfile) throws IOException {
      long size=new HLogLink(conf,server,logfile).getFileStatus(fs).getLen();
      files.add(new Pair<Path,Long>(new Path(server,logfile),size));
    }
  }
);
  return files;
}
