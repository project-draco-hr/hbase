{
  FSDataInputStream in=openSourceFile(inputPath);
  if (in == null) {
    context.getCounter(Counter.MISSING_FILES).increment(1);
    return false;
  }
  try {
    FileStatus inputStat=getFileStatus(inputFs,inputPath);
    if (inputStat == null)     return false;
    if (outputFs.exists(outputPath)) {
      FileStatus outputStat=outputFs.getFileStatus(outputPath);
      if (sameFile(inputStat,outputStat)) {
        LOG.info("Skip copy " + inputPath + " to "+ outputPath+ ", same file.");
        return true;
      }
    }
    context.getCounter(Counter.BYTES_EXPECTED).increment(inputStat.getLen());
    outputFs.mkdirs(outputPath.getParent());
    FSDataOutputStream out=outputFs.create(outputPath,true);
    try {
      if (!copyData(context,inputPath,in,outputPath,out,inputStat.getLen()))       return false;
    }
  finally {
      out.close();
    }
    return preserveAttributes(outputPath,inputStat);
  }
  finally {
    in.close();
  }
}
