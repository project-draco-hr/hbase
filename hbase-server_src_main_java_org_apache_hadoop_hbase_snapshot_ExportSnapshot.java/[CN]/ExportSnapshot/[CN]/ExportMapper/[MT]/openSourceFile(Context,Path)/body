{
  try {
    if (HFileLink.isHFileLink(path) || StoreFileInfo.isReference(path)) {
      return new HFileLink(inputRoot,inputArchive,path).open(inputFs);
    }
 else     if (isHLogLinkPath(path)) {
      String serverName=path.getParent().getName();
      String logName=path.getName();
      return new HLogLink(inputRoot,serverName,logName).open(inputFs);
    }
    return inputFs.open(path);
  }
 catch (  IOException e) {
    context.getCounter(Counter.MISSING_FILES).increment(1);
    LOG.error("Unable to open source file=" + path,e);
    throw e;
  }
}
