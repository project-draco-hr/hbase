{
  FileStatus stat;
  try {
    stat=outputFs.getFileStatus(path);
  }
 catch (  IOException e) {
    LOG.warn("Unable to get the status for file=" + path);
    return false;
  }
  try {
    if (filesMode > 0 && stat.getPermission().toShort() != filesMode) {
      outputFs.setPermission(path,new FsPermission(filesMode));
    }
 else     if (!stat.getPermission().equals(refStat.getPermission())) {
      outputFs.setPermission(path,refStat.getPermission());
    }
  }
 catch (  IOException e) {
    LOG.error("Unable to set the permission for file=" + path,e);
    return false;
  }
  try {
    String user=(filesUser != null) ? filesUser : refStat.getOwner();
    String group=(filesGroup != null) ? filesGroup : refStat.getGroup();
    if (!(user.equals(stat.getOwner()) && group.equals(stat.getGroup()))) {
      outputFs.setOwner(path,user,group);
    }
  }
 catch (  IOException e) {
    LOG.error("Unable to set the owner/group for file=" + path,e);
    return false;
  }
  return true;
}
