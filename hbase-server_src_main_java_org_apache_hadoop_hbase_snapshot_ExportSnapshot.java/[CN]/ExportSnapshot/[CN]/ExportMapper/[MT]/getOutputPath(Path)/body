{
  Path path;
  if (HFileLink.isHFileLink(inputPath) || StoreFileInfo.isReference(inputPath)) {
    String family=inputPath.getParent().getName();
    String table=HFileLink.getReferencedTableName(inputPath.getName());
    String region=HFileLink.getReferencedRegionName(inputPath.getName());
    String hfile=HFileLink.getReferencedHFileName(inputPath.getName());
    path=new Path(table,new Path(region,new Path(family,hfile)));
  }
 else   if (isHLogLinkPath(inputPath)) {
    String logName=inputPath.getName();
    path=new Path(new Path(outputRoot,HConstants.HREGION_OLDLOGDIR_NAME),logName);
  }
 else {
    path=inputPath;
  }
  return new Path(outputArchive,path);
}
