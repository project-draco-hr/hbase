{
  Configuration conf=context.getConfiguration();
  verifyChecksum=conf.getBoolean(CONF_CHECKSUM_VERIFY,true);
  filesGroup=conf.get(CONF_FILES_GROUP);
  filesUser=conf.get(CONF_FILES_USER);
  filesMode=(short)conf.getInt(CONF_FILES_MODE,0);
  outputRoot=new Path(conf.get(CONF_OUTPUT_ROOT));
  inputRoot=new Path(conf.get(CONF_INPUT_ROOT));
  inputArchive=new Path(inputRoot,HConstants.HFILE_ARCHIVE_DIRECTORY);
  outputArchive=new Path(outputRoot,HConstants.HFILE_ARCHIVE_DIRECTORY);
  testFailures=conf.getBoolean(CONF_TEST_FAILURE,false);
  try {
    inputFs=FileSystem.get(inputRoot.toUri(),conf);
  }
 catch (  IOException e) {
    throw new RuntimeException("Could not get the input FileSystem with root=" + inputRoot,e);
  }
  try {
    outputFs=FileSystem.get(outputRoot.toUri(),conf);
  }
 catch (  IOException e) {
    throw new RuntimeException("Could not get the output FileSystem with root=" + outputRoot,e);
  }
}
