{
  try {
    HTable table=getTable(tableName);
    Scan scan=new Scan(getBytes(startAndPrefix));
    addAttributes(scan,attributes);
    Filter f=new WhileMatchFilter(new PrefixFilter(getBytes(startAndPrefix)));
    scan.setFilter(f);
    if (columns != null && columns.size() != 0) {
      for (      ByteBuffer column : columns) {
        byte[][] famQf=KeyValue.parseColumn(getBytes(column));
        if (famQf.length == 1) {
          scan.addFamily(famQf[0]);
        }
 else {
          scan.addColumn(famQf[0],famQf[1]);
        }
      }
    }
    return addScanner(table.getScanner(scan));
  }
 catch (  IOException e) {
    LOG.warn(e.getMessage(),e);
    throw new IOError(e.getMessage());
  }
}
