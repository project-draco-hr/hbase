{
  long tooBig=maxSize + 1;
  compactEquals(sfCreate(100,50,23,12,12),23,12,12);
  compactEquals(sfCreate(100,50,25,12,12));
  compactEquals(sfCreate(tooBig,tooBig,700,700,700),700,700,700);
  compactEquals(sfCreate(tooBig,tooBig,700,700));
  compactEquals(sfCreate(8,3,1),8,3,1);
  assertEquals(maxFiles,store.compactSelection(sfCreate(7,6,5,4,3,2,1)).getFilesToCompact().size());
  compactEquals(sfCreate(50,25,12,12),true,50,25,12,12);
  compactEquals(sfCreate(12,12),true,12,12);
  compactEquals(sfCreate(tooBig,12,12),true,tooBig,12,12);
  store.forceMajor=true;
  assertEquals(maxFiles,store.compactSelection(sfCreate(7,6,5,4,3,2,1)).getFilesToCompact().size());
  store.forceMajor=false;
  compactEquals(sfCreate(100,50,23,12,12),true,23,12,12);
  store.majorCompactionTime=1;
  compactEquals(sfCreate(50,25,12,12),50,25,12,12);
  store.majorCompactionTime=1;
  compactEquals(sfCreate(100,50,23,12,12),23,12,12);
  compactEquals(sfCreate(true,100,50,25,12,12),100,50,25,12,12);
  compactEquals(sfCreate(true,tooBig,12,12),tooBig,12,12);
  assertEquals(maxFiles,store.compactSelection(sfCreate(true,7,6,5,4,3,2,1)).getFilesToCompact().size());
  compactEquals(new ArrayList<StoreFile>());
  compactEquals(sfCreate(tooBig,tooBig));
}
