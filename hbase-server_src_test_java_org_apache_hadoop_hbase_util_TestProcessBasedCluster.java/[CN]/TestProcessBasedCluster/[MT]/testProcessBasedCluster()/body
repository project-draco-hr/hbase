{
  ProcessBasedLocalHBaseCluster cluster=new ProcessBasedLocalHBaseCluster(TEST_UTIL.getConfiguration(),2,3);
  cluster.startMiniDFS();
  cluster.startHBase();
  try {
    TEST_UTIL.createRandomTable(HTestConst.DEFAULT_TABLE_STR,HTestConst.DEFAULT_CF_STR_SET,HColumnDescriptor.DEFAULT_VERSIONS,COLS_PER_ROW,FLUSHES,NUM_REGIONS,ROWS_PER_FLUSH);
    Table table=TEST_UTIL.getConnection().getTable(HTestConst.DEFAULT_TABLE);
    ResultScanner scanner=table.getScanner(HTestConst.DEFAULT_CF_BYTES);
    Result result;
    int rows=0;
    int cols=0;
    while ((result=scanner.next()) != null) {
      ++rows;
      cols+=result.getFamilyMap(HTestConst.DEFAULT_CF_BYTES).size();
    }
    LOG.info("Read " + rows + " rows, "+ cols+ " columns");
    scanner.close();
    table.close();
    assertEquals(19,rows);
    assertEquals(35,cols);
  }
 catch (  Exception ex) {
    LOG.error(ex);
    throw ex;
  }
 finally {
    cluster.shutdown();
  }
}
