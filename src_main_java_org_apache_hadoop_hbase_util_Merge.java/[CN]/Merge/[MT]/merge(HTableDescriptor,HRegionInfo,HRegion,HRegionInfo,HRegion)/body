{
  if (info1 == null) {
    throw new IOException("Could not find " + Bytes.toStringBinary(region1) + " in "+ Bytes.toStringBinary(meta1.getRegionName()));
  }
  if (info2 == null) {
    throw new IOException("Cound not find " + Bytes.toStringBinary(region2) + " in "+ Bytes.toStringBinary(meta2.getRegionName()));
  }
  HRegion merged=null;
  HLog log=utils.getLog();
  HRegion r1=HRegion.openHRegion(info1,htd,log,getConf());
  try {
    HRegion r2=HRegion.openHRegion(info2,htd,log,getConf());
    try {
      merged=HRegion.merge(r1,r2);
    }
  finally {
      if (!r2.isClosed()) {
        r2.close();
      }
    }
  }
  finally {
    if (!r1.isClosed()) {
      r1.close();
    }
  }
  removeRegionFromMeta(meta1,info1);
  removeRegionFromMeta(meta2,info2);
  this.mergeInfo=merged.getRegionInfo();
  return merged;
}
