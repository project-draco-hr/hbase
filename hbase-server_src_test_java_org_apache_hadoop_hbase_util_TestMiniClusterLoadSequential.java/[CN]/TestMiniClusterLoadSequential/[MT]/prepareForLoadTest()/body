{
  LOG.info("Starting load test: dataBlockEncoding=" + dataBlockEncoding + ", isMultiPut="+ isMultiPut);
  numKeys=numKeys();
  HBaseAdmin admin=new HBaseAdmin(conf);
  while (admin.getClusterStatus().getServers().size() < NUM_RS) {
    LOG.info("Sleeping until " + NUM_RS + " RSs are online");
    Threads.sleepWithoutInterrupt(1000);
  }
  admin.close();
  int numRegions=HBaseTestingUtility.createPreSplitLoadTestTable(conf,TABLE,CF,compression,dataBlockEncoding);
  TEST_UTIL.waitUntilAllRegionsAssigned(numRegions);
  LoadTestDataGenerator dataGen=new MultiThreadedAction.DefaultDataGenerator(CF);
  writerThreads=new MultiThreadedWriter(dataGen,conf,TABLE);
  writerThreads.setMultiPut(isMultiPut);
  readerThreads=new MultiThreadedReader(dataGen,conf,TABLE,100);
}
