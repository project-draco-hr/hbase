{
  Path newMetaRegionDir=HRegion.getRegionDir(rootDir,HRegionInfo.FIRST_META_REGIONINFO);
  Path newMetaDir=FSUtils.getTableDir(rootDir,TableName.META_TABLE_NAME);
  Path oldMetaDir=new Path(rootDir,".META.");
  if (fs.exists(oldMetaDir)) {
    LOG.info("Migrating meta table " + oldMetaDir.getName() + " to "+ newMetaDir);
    if (!fs.rename(oldMetaDir,newMetaDir)) {
      throw new IOException("Failed to migrate meta table " + oldMetaDir.getName() + " to "+ newMetaDir);
    }
  }
  Path oldMetaRegionDir=HRegion.getRegionDir(rootDir,new Path(newMetaDir,"1028785192").toString());
  if (fs.exists(oldMetaRegionDir)) {
    LOG.info("Migrating meta region " + oldMetaRegionDir + " to "+ newMetaRegionDir);
    if (!fs.rename(oldMetaRegionDir,newMetaRegionDir)) {
      throw new IOException("Failed to migrate meta region " + oldMetaRegionDir + " to "+ newMetaRegionDir);
    }
  }
  Path oldRootDir=new Path(rootDir,"-ROOT-");
  if (!fs.rename(oldRootDir,backupDir)) {
    throw new IllegalStateException("Failed to old data: " + oldRootDir + " to "+ backupDir);
  }
}
