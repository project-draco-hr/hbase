{
  Path newMetaDir=new Path(this.sysNsDir,TableName.META_TABLE_NAME.getQualifierAsString());
  Path newMetaRegionDir=new Path(newMetaDir,HRegionInfo.FIRST_META_REGIONINFO.getEncodedName());
  Path oldMetaDir=new Path(rootDir,".META.");
  if (fs.exists(oldMetaDir)) {
    LOG.info("Migrating meta table " + oldMetaDir.getName() + " to "+ newMetaDir);
    if (!fs.rename(oldMetaDir,newMetaDir)) {
      throw new IOException("Failed to migrate meta table " + oldMetaDir.getName() + " to "+ newMetaDir);
    }
  }
 else {
    oldMetaDir=new Path(rootDir,".META");
    if (fs.exists(oldMetaDir)) {
      LOG.info("Migrating meta table " + oldMetaDir.getName() + " to "+ newMetaDir);
      if (!fs.rename(oldMetaDir,newMetaDir)) {
        throw new IOException("Failed to migrate meta table " + oldMetaDir.getName() + " to "+ newMetaDir);
      }
    }
  }
  Path oldMetaRegionDir=HRegion.getRegionDir(rootDir,new Path(newMetaDir,"1028785192").toString());
  if (fs.exists(oldMetaRegionDir)) {
    LOG.info("Migrating meta region " + oldMetaRegionDir + " to "+ newMetaRegionDir);
    if (!fs.rename(oldMetaRegionDir,newMetaRegionDir)) {
      throw new IOException("Failed to migrate meta region " + oldMetaRegionDir + " to "+ newMetaRegionDir);
    }
  }
  removeTableInfoInPre96Format(TableName.META_TABLE_NAME);
  Path oldRootDir=new Path(rootDir,"-ROOT-");
  if (!fs.rename(oldRootDir,backupDir)) {
    throw new IllegalStateException("Failed to old data: " + oldRootDir + " to "+ backupDir);
  }
}
