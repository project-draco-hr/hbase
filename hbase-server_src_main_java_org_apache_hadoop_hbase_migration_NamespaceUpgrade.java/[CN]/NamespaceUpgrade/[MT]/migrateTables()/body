{
  List<String> sysTables=Lists.newArrayList("-ROOT-",".META.",".META");
  for (  Path baseDir : baseDirs) {
    if (!fs.exists(baseDir))     continue;
    List<Path> oldTableDirs=FSUtils.getLocalTableDirs(fs,baseDir);
    for (    Path oldTableDir : oldTableDirs) {
      if (NON_USER_TABLE_DIRS.contains(oldTableDir.getName()))       continue;
      if (sysTables.contains(oldTableDir.getName()))       continue;
      Path nsDir=new Path(this.defNsDir,TableName.valueOf(oldTableDir.getName()).getQualifierAsString());
      LOG.info("Moving " + oldTableDir + " to "+ nsDir);
      if (!fs.exists(nsDir.getParent())) {
        if (!fs.mkdirs(nsDir.getParent())) {
          throw new IOException("Failed to create namespace dir " + nsDir.getParent());
        }
      }
      if (sysTables.indexOf(oldTableDir.getName()) < 0) {
        LOG.info("Migrating table " + oldTableDir.getName() + " to "+ nsDir);
        if (!fs.rename(oldTableDir,nsDir)) {
          throw new IOException("Failed to move " + oldTableDir + " to namespace dir "+ nsDir);
        }
      }
    }
  }
}
