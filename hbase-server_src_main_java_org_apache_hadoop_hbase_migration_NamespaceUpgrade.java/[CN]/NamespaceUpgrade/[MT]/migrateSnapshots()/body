{
  Path oldSnapshotDir=new Path(rootDir,HConstants.OLD_SNAPSHOT_DIR_NAME);
  Path newSnapshotDir=new Path(rootDir,HConstants.SNAPSHOT_DIR_NAME);
  if (fs.exists(oldSnapshotDir)) {
    boolean foundOldSnapshotDir=false;
    FileStatus[] snapshots=fs.listStatus(oldSnapshotDir,new SnapshotDescriptionUtils.CompletedSnaphotDirectoriesFilter(fs));
    for (    FileStatus snapshot : snapshots) {
      Path info=new Path(snapshot.getPath(),SnapshotDescriptionUtils.SNAPSHOTINFO_FILE);
      if (fs.exists(info)) {
        foundOldSnapshotDir=true;
        break;
      }
    }
    if (foundOldSnapshotDir) {
      LOG.info("Migrating snapshot dir");
      if (!fs.rename(oldSnapshotDir,newSnapshotDir)) {
        throw new IOException("Failed to move old snapshot dir " + oldSnapshotDir + " to new "+ newSnapshotDir);
      }
    }
  }
}
