{
  String table="testAssignRegion";
  try {
    HTableDescriptor desc=new HTableDescriptor(table);
    desc.addFamily(new HColumnDescriptor(FAMILY));
    admin.createTable(desc);
    HTable meta=new HTable(conf,HConstants.META_TABLE_NAME);
    HRegionInfo hri=new HRegionInfo(desc.getName(),Bytes.toBytes("A"),Bytes.toBytes("Z"));
    Put put=new Put(hri.getRegionName());
    put.add(HConstants.CATALOG_FAMILY,HConstants.REGIONINFO_QUALIFIER,Writables.getBytes(hri));
    meta.put(put);
    HMaster master=TEST_UTIL.getHBaseCluster().getMaster();
    master.assignRegion(hri);
    master.getAssignmentManager().waitForAssignment(hri);
    ServerName serverName=master.getAssignmentManager().getRegionStates().getRegionServerOfRegion(hri);
    TEST_UTIL.assertRegionOnServer(hri,serverName,200);
  }
  finally {
    TEST_UTIL.deleteTable(Bytes.toBytes(table));
  }
}
