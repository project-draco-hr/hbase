{
  if (authorize) {
    Class<?> protocol=null;
    try {
      protocol=getProtocolClass(connection.getProtocol(),getConf());
    }
 catch (    ClassNotFoundException cfne) {
      throw new AuthorizationException("Unknown protocol: " + connection.getProtocol());
    }
    authManager.authorize(user != null ? user : null,protocol,getConf(),addr);
  }
}
