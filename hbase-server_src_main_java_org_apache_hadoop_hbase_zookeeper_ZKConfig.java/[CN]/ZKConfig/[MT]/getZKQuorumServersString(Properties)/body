{
  String clientPort=null;
  List<String> servers=new ArrayList<String>();
  boolean anyValid=false;
  for (  Entry<Object,Object> property : properties.entrySet()) {
    String key=property.getKey().toString().trim();
    String value=property.getValue().toString().trim();
    if (key.equals("clientPort")) {
      clientPort=value;
    }
 else     if (key.startsWith("server.")) {
      String host=value.substring(0,value.indexOf(':'));
      servers.add(host);
      try {
        InetAddress.getByName(host);
        anyValid=true;
      }
 catch (      UnknownHostException e) {
        LOG.warn(StringUtils.stringifyException(e));
      }
    }
  }
  if (!anyValid) {
    LOG.error("no valid quorum servers found in " + HConstants.ZOOKEEPER_CONFIG_NAME);
    return null;
  }
  if (clientPort == null) {
    LOG.error("no clientPort found in " + HConstants.ZOOKEEPER_CONFIG_NAME);
    return null;
  }
  if (servers.isEmpty()) {
    LOG.fatal("No servers were found in provided ZooKeeper configuration. " + "HBase must have a ZooKeeper cluster configured for its " + "operation. Ensure that you've configured '" + HConstants.ZOOKEEPER_QUORUM + "' properly.");
    return null;
  }
  StringBuilder hostPortBuilder=new StringBuilder();
  for (int i=0; i < servers.size(); ++i) {
    String host=servers.get(i);
    if (i > 0) {
      hostPortBuilder.append(',');
    }
    hostPortBuilder.append(host);
    hostPortBuilder.append(':');
    hostPortBuilder.append(clientPort);
  }
  return hostPortBuilder.toString();
}
