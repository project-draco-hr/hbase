{
  validateParameters(scan);
  HTable table=new HTable(conf,tableName);
class MaxCallBack implements Batch.Callback<R> {
    R max=null;
    R getMax(){
      return max;
    }
    @Override public void update(    byte[] region,    byte[] row,    R result){
      max=ci.compare(max,result) < 0 ? result : max;
    }
  }
  MaxCallBack aMaxCallBack=new MaxCallBack();
  table.coprocessorExec(AggregateProtocol.class,scan.getStartRow(),scan.getStopRow(),new Batch.Call<AggregateProtocol,R>(){
    @Override public R call(    AggregateProtocol instance) throws IOException {
      return instance.getMax(ci,scan);
    }
  }
,aMaxCallBack);
  return aMaxCallBack.getMax();
}
