{
  while (true) {
    waitForMasterAddressAvailability();
    if (this.requestShutdown.get())     return;
    if (this.zookeeper.writeMasterAddress(address)) {
      this.zookeeper.setClusterState(true);
      this.zookeeper.readMasterAddress(this);
      return;
    }
  }
}
