{
  HConnection connection=HConnectionTestingUtility.getMockedConnection(UTIL.getConfiguration());
  final HRegionLocation anyLocation=new HRegionLocation(HRegionInfo.FIRST_META_REGIONINFO,SN.getHostname(),SN.getPort());
  Mockito.when(connection.getRegionLocation((byte[])Mockito.any(),(byte[])Mockito.any(),Mockito.anyBoolean())).thenReturn(anyLocation);
  if (implementation != null) {
    Mockito.when(connection.getHRegionConnection(Mockito.anyString(),Mockito.anyInt())).thenReturn(implementation);
  }
  return connection;
}
