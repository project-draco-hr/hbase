{
  while (!super.stop.get()) {
    try {
      this.queue.drainTo(this.tempArray);
      if (this.tempArray.size() > 0) {
        HServerAddress adr=currentPeers.get(random.nextInt(this.currentPeers.size()));
        ReplicationRegionInterface rrs=this.conn.getHRegionConnection(adr);
        LOG.debug("Replicating " + this.tempArray.size() + " to "+ adr.toString());
        rrs.replicateLogEntries(this.tempArray.toArray(dummyArray));
        this.tempArray.clear();
      }
      return;
    }
 catch (    IOException ioe) {
      LOG.warn("Unable to replicate, retrying with a new node",ioe);
      try {
        Thread.sleep(1000);
      }
 catch (      InterruptedException e) {
      }
      chooseSinksForPeer(0);
    }
  }
}
