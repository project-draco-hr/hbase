{
  List<String> unrecoveredLogs=new ArrayList<String>();
  for (int i=0; i < rootFiles.length; i++) {
    String name=rootFiles[i].getPath().getName();
    if (name.startsWith("log_")) {
      unrecoveredLogs.add(name);
    }
  }
  if (unrecoveredLogs.size() != 0) {
    throw new IOException("There are " + unrecoveredLogs.size() + " unrecovered region server logs. Please uninstall this version of "+ "HBase, re-install the previous version, start your cluster and "+ "shut it down cleanly, so that all region server logs are recovered"+ " and deleted.  Or, if you are sure logs are vestige of old "+ "failures in hbase, remove them and then rerun the migration.  "+ "See 'Redo Logs' in http://wiki.apache.org/hadoop/Hbase/HowToMigrate. "+ "Here are the problem log files: "+ unrecoveredLogs);
  }
}
