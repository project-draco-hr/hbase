{
  if (this.migrationNeeded && this.readOnly) {
    return;
  }
  final Path rootDir=FSUtils.getRootDir(conf);
  final MetaUtils utils=new MetaUtils(this.conf);
  try {
    utils.scanRootRegion(new MetaUtils.ScannerListener(){
      public boolean processRow(      HRegionInfo info) throws IOException {
        final HRegion metaRegion=utils.getMetaRegion(info);
        utils.scanMetaRegion(info,new MetaUtils.ScannerListener(){
          public boolean processRow(          HRegionInfo hri) throws IOException {
            HTableDescriptor desc=hri.getTableDesc();
            Path tableDir=HTableDescriptor.getTableDir(rootDir,desc.getName());
            for (            HColumnDescriptor column : desc.getFamilies()) {
              if (column.isBloomfilter()) {
                migrationNeeded=true;
                Path filterDir=HStoreFile.getFilterDir(tableDir,hri.getEncodedName(),column.getName());
                if (fs.exists(filterDir)) {
                  if (readOnly) {
                    return false;
                  }
                  fs.delete(filterDir,true);
                  column.setBloomfilter(false);
                  utils.updateMETARegionInfo(metaRegion,hri);
                }
              }
            }
            return true;
          }
        }
);
        return readOnly && migrationNeeded ? false : true;
      }
    }
);
  }
  finally {
    utils.shutdown();
  }
}
