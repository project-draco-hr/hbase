{
  FileStatus[] stats=fs.listStatus(rootdir);
  if (stats == null || stats.length == 0) {
    throw new IOException("No files found under root directory " + rootdir.toString());
  }
  for (int i=0; i < stats.length; i++) {
    String name=stats[i].getPath().getName();
    if (name.startsWith(OLD_PREFIX)) {
      if (!newRootRegion) {
        migrationNeeded=true;
        String regionName=name.substring(OLD_PREFIX.length());
        try {
          Integer.parseInt(regionName);
        }
 catch (        NumberFormatException e) {
          extraFile(otherFiles,"Old region format can not be upgraded: " + name,fs,stats[i].getPath());
        }
      }
 else {
        extraFile(otherFiles,"Old region directory found: " + name,fs,stats[i].getPath());
      }
    }
 else {
      if (name.startsWith("log_")) {
        String message="Unrecovered region server log file " + name + " this file can be recovered by the master when it starts.";
        extraFile(logFiles,message,fs,stats[i].getPath());
      }
 else       if (!newRootRegion) {
        String message="Unrecognized file " + name;
        extraFile(otherFiles,message,fs,stats[i].getPath());
      }
    }
  }
}
