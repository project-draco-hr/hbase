{
  String newName=newPath.getName();
  FileStatus[] children=fs.listStatus(newPath);
  for (int i=0; i < children.length; i++) {
    String child=children[i].getPath().getName();
    if (children[i].isDir()) {
      processRegionSubDirs(fs,children[i].getPath());
      if (child.startsWith(OLD_PREFIX)) {
        fs.rename(children[i].getPath(),new Path(newPath,child.substring(OLD_PREFIX.length())));
      }
    }
 else {
      if (newName.compareTo("mapfiles") == 0) {
        if (HStore.isReference(children[i].getPath())) {
          references.add(child.substring(child.indexOf(".") + 1));
        }
      }
    }
  }
}
