{
  final BlockType blockType=BlockType.DATA;
  HFileBlock.Writer hbw=new HFileBlock.Writer(algo,null,includesMemstoreTS,HFile.DEFAULT_CHECKSUM_TYPE,HFile.DEFAULT_BYTES_PER_CHECKSUM);
  DataOutputStream dos=hbw.startWriting(blockType);
  writeTestBlockContents(dos);
  byte[] headerAndData=hbw.getHeaderAndDataForTest();
  assertEquals(1000 * 4,hbw.getUncompressedSizeWithoutHeader());
  hbw.release();
  return hbw;
}
