{
  AssignmentManager am=this.masterServices.getAssignmentManager();
  HTableDescriptor htd=this.masterServices.getTableDescriptors().get(Bytes.toString(tableName));
  byte[] familyName=familyDesc.getName();
  if (htd == null) {
    throw new IOException("Add Family operation could not be completed as " + "HTableDescritor is missing for table = " + Bytes.toString(tableName));
  }
  if (htd.hasFamily(familyName)) {
    throw new InvalidFamilyOperationException("Family '" + Bytes.toString(familyName) + "' already exists so "+ "cannot be added");
  }
  htd=this.masterServices.getMasterFileSystem().addColumn(tableName,familyDesc);
  this.masterServices.getTableDescriptors().add(htd);
}
