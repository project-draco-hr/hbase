{
  ThriftServerRunner.HBaseHandler handler=new ThriftServerRunner.HBaseHandler(UTIL.getConfiguration(),UserProvider.instantiate(UTIL.getConfiguration()));
  handler.createTable(tableAname,getColumnDescriptors());
  long time1=System.currentTimeMillis();
  handler.mutateRowTs(tableAname,rowAname,getMutations(),time1,null);
  Thread.sleep(1000);
  long time2=System.currentTimeMillis();
  handler.mutateRowsTs(tableAname,getBatchMutations(),time2,null);
  handler.mutateRowTs(tableAname,rowBname,getMutations(),time2,null);
  time1+=1;
  time2+=2;
  assertEquals(2,handler.getVerTs(tableAname,rowAname,columnBname,time2,MAXVERSIONS,null).size());
  assertEquals(1,handler.getVerTs(tableAname,rowAname,columnBname,time1,MAXVERSIONS,null).size());
  TRowResult rowResult1=handler.getRowTs(tableAname,rowAname,time1,null).get(0);
  TRowResult rowResult2=handler.getRowTs(tableAname,rowAname,time2,null).get(0);
  assertEquals(rowResult1.columns.get(columnBname).value,valueBname);
  assertEquals(rowResult2.columns.get(columnBname).value,valueCname);
  assertFalse(rowResult2.columns.containsKey(columnAname));
  List<ByteBuffer> columns=new ArrayList<ByteBuffer>();
  columns.add(columnBname);
  rowResult1=handler.getRowWithColumns(tableAname,rowAname,columns,null).get(0);
  assertEquals(rowResult1.columns.get(columnBname).value,valueCname);
  assertFalse(rowResult1.columns.containsKey(columnAname));
  rowResult1=handler.getRowWithColumnsTs(tableAname,rowAname,columns,time1,null).get(0);
  assertEquals(rowResult1.columns.get(columnBname).value,valueBname);
  assertFalse(rowResult1.columns.containsKey(columnAname));
  handler.deleteAllTs(tableAname,rowAname,columnBname,time1,null);
  handler.deleteAllRowTs(tableAname,rowBname,time2,null);
  int size=handler.getVerTs(tableAname,rowAname,columnBname,time1,MAXVERSIONS,null).size();
  assertEquals(0,size);
  size=handler.getVerTs(tableAname,rowAname,columnBname,time2,MAXVERSIONS,null).size();
  assertEquals(1,size);
  assertEquals(handler.get(tableAname,rowAname,columnBname,null).get(0).value,valueCname);
  assertEquals(0,handler.getRow(tableAname,rowBname,null).size());
  handler.disableTable(tableAname);
  handler.deleteTable(tableAname);
}
