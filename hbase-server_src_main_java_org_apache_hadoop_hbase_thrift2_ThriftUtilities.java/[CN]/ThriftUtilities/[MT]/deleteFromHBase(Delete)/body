{
  TDelete out=new TDelete(ByteBuffer.wrap(in.getRow()));
  List<TColumn> columns=new ArrayList<TColumn>();
  long rowTimestamp=in.getTimeStamp();
  if (rowTimestamp != HConstants.LATEST_TIMESTAMP) {
    out.setTimestamp(rowTimestamp);
  }
  for (  Map.Entry<byte[],List<? extends org.apache.hadoop.hbase.Cell>> familyEntry : in.getFamilyCellMap().entrySet()) {
    TColumn column=new TColumn(ByteBuffer.wrap(familyEntry.getKey()));
    for (    org.apache.hadoop.hbase.Cell cell : familyEntry.getValue()) {
      KeyValue kv=KeyValueUtil.ensureKeyValue(cell);
      byte[] family=kv.getFamily();
      byte[] qualifier=kv.getQualifier();
      long timestamp=kv.getTimestamp();
      if (family != null) {
        column.setFamily(family);
      }
      if (qualifier != null) {
        column.setQualifier(qualifier);
      }
      if (timestamp != HConstants.LATEST_TIMESTAMP) {
        column.setTimestamp(kv.getTimestamp());
      }
    }
    columns.add(column);
  }
  out.setColumns(columns);
  return out;
}
