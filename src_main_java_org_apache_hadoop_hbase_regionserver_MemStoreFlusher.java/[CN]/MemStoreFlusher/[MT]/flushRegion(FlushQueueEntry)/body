{
  HRegion region=fqe.region;
  if (!fqe.region.getRegionInfo().isMetaRegion() && isTooManyStoreFiles(region)) {
    if (fqe.isMaximumWait(this.blockingWaitTime)) {
      LOG.info("Waited " + (System.currentTimeMillis() - fqe.createTime) + "ms on a compaction to clean up 'too many store files'; waited "+ "long enough... proceeding with flush of "+ region.getRegionNameAsString());
    }
 else {
      if (fqe.getRequeueCount() <= 0) {
        LOG.warn("Region " + region.getRegionNameAsString() + " has too many "+ "store files; delaying flush up to "+ this.blockingWaitTime+ "ms");
      }
      this.server.compactSplitThread.compactionRequested(region,getName());
      this.flushQueue.add(fqe.requeue(this.blockingWaitTime / 100));
      return true;
    }
  }
  return flushRegion(region,false);
}
