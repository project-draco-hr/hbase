{
  int count=0;
  try {
    while (count < maxOps) {
      Put put=new Put(Bytes.toBytes("row-" + count));
      put.add(FAMILY,QUALIFIER,Bytes.toBytes("data-" + count));
      for (      final HTable table : tables) {
        table.put(put);
      }
      count+=tables.length;
    }
  }
 catch (  RetriesExhaustedWithDetailsException e) {
    for (    Throwable t : e.getCauses()) {
      if (!(t instanceof ThrottlingException)) {
        throw e;
      }
    }
    LOG.error("put failed after nRetries=" + count,e);
  }
  return count;
}
