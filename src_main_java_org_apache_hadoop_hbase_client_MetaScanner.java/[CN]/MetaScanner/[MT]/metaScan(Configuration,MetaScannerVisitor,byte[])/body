{
  HConnection connection=HConnectionManager.getConnection(configuration);
  byte[] startRow=tableName == null || tableName.length == 0 ? HConstants.EMPTY_START_ROW : HRegionInfo.createRegionName(tableName,null,HConstants.ZEROES,false);
  ScannerCallable callable;
  int rows=configuration.getInt("hbase.meta.scanner.caching",100);
  do {
    final Scan scan=new Scan(startRow).addFamily(HConstants.CATALOG_FAMILY);
    callable=new ScannerCallable(connection,HConstants.META_TABLE_NAME,scan);
    connection.getRegionServerWithRetries(callable);
    try {
      callable.setCaching(rows);
      done:       do {
        Result[] rrs=connection.getRegionServerWithRetries(callable);
        if (rrs == null || rrs.length == 0 || rrs[0].size() == 0) {
          break;
        }
        for (        Result rr : rrs) {
          if (!visitor.processRow(rr))           break done;
        }
      }
 while (true);
      startRow=callable.getHRegionInfo().getEndKey();
    }
  finally {
      callable.setClose();
      connection.getRegionServerWithRetries(callable);
    }
  }
 while (Bytes.compareTo(startRow,HConstants.LAST_ROW) != 0);
}
