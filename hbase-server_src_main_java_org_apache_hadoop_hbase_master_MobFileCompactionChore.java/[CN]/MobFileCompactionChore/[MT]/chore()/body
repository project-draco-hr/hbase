{
  try {
    TableDescriptors htds=master.getTableDescriptors();
    Map<String,HTableDescriptor> map=htds.getAll();
    for (    HTableDescriptor htd : map.values()) {
      if (!master.getTableStateManager().isTableState(htd.getTableName(),TableState.State.ENABLED)) {
        continue;
      }
      boolean reported=false;
      try {
        for (        HColumnDescriptor hcd : htd.getColumnFamilies()) {
          if (!hcd.isMobEnabled()) {
            continue;
          }
          if (!reported) {
            master.reportMobFileCompactionStart(htd.getTableName());
            reported=true;
          }
          MobUtils.doMobFileCompaction(master.getConfiguration(),master.getFileSystem(),htd.getTableName(),hcd,pool,tableLockManager,false);
        }
      }
  finally {
        if (reported) {
          master.reportMobFileCompactionEnd(htd.getTableName());
        }
      }
    }
  }
 catch (  Exception e) {
    LOG.error("Fail to clean the expired mob files",e);
  }
}
