{
  Configuration conf=TEST_UTIL.getConfiguration();
  FSUtils.setRootDir(conf,TEST_UTIL.getDataTestDir());
  Path rootDir=FSUtils.getRootDir(conf);
  FileSystem fs=FileSystem.get(conf);
  SnapshotLogCleaner cleaner=new SnapshotLogCleaner();
  cleaner.setConf(conf);
  String snapshotName="snapshot";
  byte[] snapshot=Bytes.toBytes(snapshotName);
  Path snapshotDir=SnapshotDescriptionUtils.getCompletedSnapshotDir(snapshotName,rootDir);
  Path snapshotLogDir=new Path(snapshotDir,HConstants.HREGION_LOGDIR_NAME);
  String timestamp="1339643343027";
  String hostFromMaster="localhost%2C59648%2C1339643336601";
  Path hostSnapshotLogDir=new Path(snapshotLogDir,hostFromMaster);
  String snapshotlogfile=hostFromMaster + "." + timestamp+ ".hbase";
  fs.create(new Path(hostSnapshotLogDir,snapshotlogfile));
  Path oldlogDir=new Path(rootDir,".oldlogs");
  Path logFile=new Path(oldlogDir,snapshotlogfile);
  fs.create(logFile);
  assertFalse(cleaner.isFileDeletable(fs.getFileStatus(logFile)));
}
