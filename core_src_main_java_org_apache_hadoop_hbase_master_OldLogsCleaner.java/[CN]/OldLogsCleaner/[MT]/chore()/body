{
  try {
    FileStatus[] files=this.fs.listStatus(this.oldLogDir);
    int nbDeletedLog=0;
    for (    FileStatus file : files) {
      Path filePath=file.getPath();
      if (pattern.matcher(filePath.getName()).matches()) {
        if (logCleaner.isLogDeletable(filePath)) {
          this.fs.delete(filePath,true);
          nbDeletedLog++;
        }
      }
 else {
        LOG.warn("Found a wrongly formated file: " + file.getPath().getName());
        this.fs.delete(filePath,true);
        nbDeletedLog++;
      }
      if (nbDeletedLog >= maxDeletedLogs) {
        break;
      }
    }
  }
 catch (  IOException e) {
    e=RemoteExceptionHandler.checkIOException(e);
    LOG.warn("Error while cleaning the logs",e);
  }
}
