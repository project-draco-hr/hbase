{
  LOG.info("Running testDataIngest");
  LOG.info("Cluster size:" + util.getHBaseClusterInterface().getClusterStatus().getServersSize());
  LoadTestTool loadTool=new LoadTestTool();
  loadTool.setConf(util.getConfiguration());
  long start=System.currentTimeMillis();
  long runtime=util.getConfiguration().getLong(RUN_TIME_KEY,DEFAULT_RUN_TIME);
  long startKey=0;
  long numKeys=estimateDataSize();
  while (System.currentTimeMillis() - start < 0.9 * runtime) {
    LOG.info("Intended run time: " + (runtime / 60000) + " min, left:"+ ((runtime - (System.currentTimeMillis() - start)) / 60000)+ " min");
    int ret=loadTool.run(new String[]{"-tn",TABLE_NAME,"-write","10:100:20","-start_key",String.valueOf(startKey),"-num_keys",String.valueOf(numKeys)});
    Assert.assertEquals(0,ret);
    ret=loadTool.run(new String[]{"-tn",TABLE_NAME,"-read","100:20","-start_key",String.valueOf(startKey),"-num_keys",String.valueOf(numKeys)});
    Assert.assertEquals(0,ret);
    startKey+=numKeys;
  }
}
