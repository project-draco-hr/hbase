{
  TableName tn=TableName.valueOf("testReadPt");
  setUp(0L,tn);
  long ts=System.currentTimeMillis();
  byte[] value1=Bytes.toBytes("value1");
  Put put1=new Put(row1);
  put1.addColumn(family,qf1,ts,value1);
  table.put(put1);
  Put put2=new Put(row2);
  byte[] value2=Bytes.toBytes("value2");
  put2.addColumn(family,qf1,ts,value2);
  table.put(put2);
  Scan scan=new Scan();
  scan.setCaching(1);
  ResultScanner rs=table.getScanner(scan);
  Put put3=new Put(row1);
  byte[] value3=Bytes.toBytes("value3");
  put3.addColumn(family,qf1,ts,value3);
  table.put(put3);
  Put put4=new Put(row2);
  byte[] value4=Bytes.toBytes("value4");
  put4.addColumn(family,qf1,ts,value4);
  table.put(put4);
  Result result=rs.next();
  Cell cell=result.getColumnLatestCell(family,qf1);
  Assert.assertArrayEquals(value1,CellUtil.cloneValue(cell));
  admin.flush(tn);
  result=rs.next();
  cell=result.getColumnLatestCell(family,qf1);
  Assert.assertArrayEquals(value2,CellUtil.cloneValue(cell));
}
