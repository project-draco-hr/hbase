{
  Pair<byte[][],byte[][]> startEndKeys=getStartEndKeys();
  byte[][] startKeys=startEndKeys.getFirst();
  byte[][] endKeys=startEndKeys.getSecond();
  if (start == null) {
    start=HConstants.EMPTY_START_ROW;
  }
  if (end == null) {
    end=HConstants.EMPTY_END_ROW;
  }
  List<byte[]> rangeKeys=new ArrayList<byte[]>();
  for (int i=0; i < startKeys.length; i++) {
    if (Bytes.compareTo(start,startKeys[i]) >= 0) {
      if (Bytes.equals(endKeys[i],HConstants.EMPTY_END_ROW) || Bytes.compareTo(start,endKeys[i]) < 0) {
        rangeKeys.add(start);
      }
    }
 else     if (Bytes.equals(end,HConstants.EMPTY_END_ROW) || Bytes.compareTo(startKeys[i],end) <= 0) {
      rangeKeys.add(startKeys[i]);
    }
 else {
      break;
    }
  }
  return rangeKeys;
}
