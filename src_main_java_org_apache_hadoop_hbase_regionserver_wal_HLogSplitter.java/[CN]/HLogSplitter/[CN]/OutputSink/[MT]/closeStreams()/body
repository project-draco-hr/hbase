{
  Preconditions.checkState(!hasClosed);
  List<Path> paths=new ArrayList<Path>();
  List<IOException> thrown=Lists.newArrayList();
  for (  WriterAndPath wap : logWriters.values()) {
    try {
      wap.w.close();
    }
 catch (    IOException ioe) {
      LOG.error("Couldn't close log at " + wap.p,ioe);
      thrown.add(ioe);
      continue;
    }
    paths.add(wap.p);
    LOG.info("Closed path " + wap.p + " (wrote "+ wap.editsWritten+ " edits in "+ (wap.nanosSpent / 1000 / 1000)+ "ms)");
  }
  if (!thrown.isEmpty()) {
    throw MultipleIOException.createIOException(thrown);
  }
  hasClosed=true;
  return paths;
}
