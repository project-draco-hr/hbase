{
  byte region[]=entry.getKey().getEncodedRegionName();
  WriterAndPath ret=logWriters.get(region);
  if (ret != null) {
    return ret;
  }
  if (blacklistedRegions.contains(region)) {
    return null;
  }
  Path regionedits=getRegionSplitEditsPath(fs,entry,rootDir);
  if (regionedits == null) {
    blacklistedRegions.add(region);
    return null;
  }
  deletePreexistingOldEdits(regionedits);
  Writer w=createWriter(fs,regionedits,conf);
  ret=new WriterAndPath(regionedits,w);
  logWriters.put(region,ret);
  LOG.debug("Creating writer path=" + regionedits + " region="+ Bytes.toStringBinary(region));
  return ret;
}
