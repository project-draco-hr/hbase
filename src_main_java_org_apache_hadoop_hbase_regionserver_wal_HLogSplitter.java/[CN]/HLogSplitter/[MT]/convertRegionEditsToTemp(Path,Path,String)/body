{
  List<String> components=new ArrayList<String>(10);
  do {
    components.add(edits.getName());
    edits=edits.getParent();
  }
 while (edits.depth() > rootdir.depth());
  Path ret=ZKSplitLog.getSplitLogDir(rootdir,tmpname);
  for (int i=components.size() - 1; i >= 0; i--) {
    ret=new Path(ret,components.get(i));
  }
  try {
    if (fs.exists(ret)) {
      LOG.warn("Found existing old temporary edits file. It could be the " + "result of a previous failed split attempt. Deleting " + ret + ", length="+ fs.getFileStatus(ret).getLen());
      if (!fs.delete(ret,false)) {
        LOG.warn("Failed delete of old " + ret);
      }
    }
    Path dir=ret.getParent();
    if (!fs.exists(dir)) {
      if (!fs.mkdirs(dir))       LOG.warn("mkdir failed on " + dir);
    }
  }
 catch (  IOException e) {
    LOG.warn("Could not prepare temp staging area ",e);
  }
  return ret;
}
