{
  Path regionedits=getRegionSplitEditsPath(fs,entry,rootdir,tmpname == null);
  if (regionedits == null) {
    return null;
  }
  if ((tmpname == null) && fs.exists(regionedits)) {
    LOG.warn("Found existing old edits file. It could be the " + "result of a previous failed split attempt. Deleting " + regionedits + ", length="+ fs.getFileStatus(regionedits).getLen());
    if (!fs.delete(regionedits,false)) {
      LOG.warn("Failed delete of old " + regionedits);
    }
  }
  Path editsfile;
  if (tmpname != null) {
    editsfile=convertRegionEditsToTemp(rootdir,regionedits,tmpname);
  }
 else {
    editsfile=regionedits;
  }
  Writer w=createWriter(fs,editsfile,conf);
  LOG.debug("Creating writer path=" + editsfile + " region="+ Bytes.toStringBinary(region));
  return (new WriterAndPath(editsfile,w));
}
