{
  return new Callable<Void>(){
    public String getName(){
      return "Split writer thread for region " + Bytes.toStringBinary(region);
    }
    @Override public Void call() throws IOException {
      LinkedList<Entry> entries=logEntries.get(region);
      LOG.debug(this.getName() + " got " + entries.size()+ " to process");
      long threadTime=System.currentTimeMillis();
      try {
        int editsCount=0;
        WriterAndPath wap=logWriters.get(region);
        for (        Entry logEntry : entries) {
          if (wap == null) {
            Path regionedits=getRegionSplitEditsPath(fs,logEntry,rootDir);
            if (regionedits == null) {
              break;
            }
            if (fs.exists(regionedits)) {
              LOG.warn("Found existing old edits file. It could be the " + "result of a previous failed split attempt. Deleting " + regionedits + ", length="+ fs.getFileStatus(regionedits).getLen());
              if (!fs.delete(regionedits,false)) {
                LOG.warn("Failed delete of old " + regionedits);
              }
            }
            Writer w=createWriter(fs,regionedits,conf);
            wap=new WriterAndPath(regionedits,w);
            logWriters.put(region,wap);
            LOG.debug("Creating writer path=" + regionedits + " region="+ Bytes.toStringBinary(region));
          }
          wap.w.append(logEntry);
          editsCount++;
        }
        LOG.debug(this.getName() + " Applied " + editsCount+ " total edits to "+ Bytes.toStringBinary(region)+ " in "+ (System.currentTimeMillis() - threadTime)+ "ms");
      }
 catch (      IOException e) {
        e=RemoteExceptionHandler.checkIOException(e);
        LOG.fatal(this.getName() + " Got while writing log entry to log",e);
        throw e;
      }
      return null;
    }
  }
;
}
