{
  final Path corruptDir=new Path(conf.get(HConstants.HBASE_DIR),conf.get("hbase.regionserver.hlog.splitlog.corrupt.dir",".corrupt"));
  if (!fs.mkdirs(corruptDir)) {
    LOG.info("Unable to mkdir " + corruptDir);
  }
  fs.mkdirs(oldLogDir);
  for (  Path corrupted : corruptedLogs) {
    Path p=new Path(corruptDir,corrupted.getName());
    if (!fs.rename(corrupted,p)) {
      LOG.info("Unable to move corrupted log " + corrupted + " to "+ p);
    }
 else {
      LOG.info("Moving corrupted log " + corrupted + " to "+ p);
    }
  }
  for (  Path p : processedLogs) {
    Path newPath=HLog.getHLogArchivePath(oldLogDir,p);
    if (!fs.rename(p,newPath)) {
      LOG.info("Unable to move  " + p + " to "+ newPath);
    }
 else {
      LOG.info("Archived processed log " + p + " to "+ newPath);
    }
  }
}
