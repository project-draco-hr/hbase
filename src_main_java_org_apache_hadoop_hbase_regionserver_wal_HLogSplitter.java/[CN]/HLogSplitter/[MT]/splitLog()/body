{
  Preconditions.checkState(!hasSplit,"An HLogSplitter instance may only be used once");
  hasSplit=true;
  long startTime=EnvironmentEdgeManager.currentTimeMillis();
  List<Path> splits=null;
  if (!fs.exists(srcDir)) {
    return splits;
  }
  FileStatus[] logfiles=fs.listStatus(srcDir);
  if (logfiles == null || logfiles.length == 0) {
    return splits;
  }
  LOG.info("Splitting " + logfiles.length + " hlog(s) in "+ srcDir.toString());
  splits=splitLog(logfiles);
  splitTime=EnvironmentEdgeManager.currentTimeMillis() - startTime;
  LOG.info("hlog file splitting completed in " + splitTime + " ms for "+ srcDir.toString());
  return splits;
}
