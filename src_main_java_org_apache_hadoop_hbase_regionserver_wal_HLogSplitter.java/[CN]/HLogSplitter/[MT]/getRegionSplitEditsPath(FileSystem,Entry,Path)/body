{
  Path tableDir=HTableDescriptor.getTableDir(rootDir,logEntry.getKey().getTablename());
  Path regiondir=HRegion.getRegionDir(tableDir,Bytes.toString(logEntry.getKey().getEncodedRegionName()));
  Path dir=HLog.getRegionDirRecoveredEditsDir(regiondir);
  if (!fs.exists(dir)) {
    if (!fs.mkdirs(dir))     LOG.warn("mkdir failed on " + dir);
  }
  return new Path(dir,formatRecoveredEditsFileName(logEntry.getKey().getLogSeqNum()));
}
