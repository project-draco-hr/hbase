{
  try {
    FileStatus[] files=this.fs.listStatus(this.oldLogDir);
    long currentTime=System.currentTimeMillis();
    int nbDeletedLog=0;
    for (    FileStatus file : files) {
      Path filePath=file.getPath();
      if (pattern.matcher(filePath.getName()).matches()) {
        String[] parts=filePath.getName().split("\\.");
        long time=0;
        try {
          time=Long.parseLong(parts[3]);
        }
 catch (        NumberFormatException e) {
        }
        long life=currentTime - time;
        if (life < 0) {
          LOG.warn("Found a log newer than current time, " + "probably a clock skew");
          continue;
        }
        if (life > ttl) {
          this.fs.delete(filePath,true);
          nbDeletedLog++;
        }
      }
 else {
        LOG.warn("Found a wrongly formated file: " + file.getPath().getName());
        this.fs.delete(filePath,true);
        nbDeletedLog++;
      }
      if (nbDeletedLog >= maxDeletedLogs) {
        break;
      }
    }
  }
 catch (  IOException e) {
    e=RemoteExceptionHandler.checkIOException(e);
    LOG.warn("Error while cleaning the logs",e);
  }
}
