{
  this(conf);
  this.managed=managed;
  this.registry=setupRegistry();
  retrieveClusterId();
  this.rpcClient=new RpcClient(this.conf,this.clusterId);
  Class<? extends ClusterStatusListener.Listener> listenerClass=conf.getClass(ClusterStatusListener.STATUS_LISTENER_CLASS,ClusterStatusListener.DEFAULT_STATUS_LISTENER_CLASS,ClusterStatusListener.Listener.class);
  if (listenerClass != null) {
    clusterStatusListener=new ClusterStatusListener(new ClusterStatusListener.DeadServerHandler(){
      @Override public void newDead(      ServerName sn){
        clearCaches(sn);
        rpcClient.cancelConnections(sn.getHostname(),sn.getPort(),new SocketException(sn.getServerName() + " is dead: closing its connection."));
      }
    }
,conf,listenerClass);
  }
}
