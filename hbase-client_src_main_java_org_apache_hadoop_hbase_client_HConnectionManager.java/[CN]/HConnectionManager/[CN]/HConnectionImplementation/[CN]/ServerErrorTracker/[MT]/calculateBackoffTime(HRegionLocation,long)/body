{
  long result=0;
  ServerErrors errorStats=errorsByServer.get(server);
  if (errorStats != null) {
    result=ConnectionUtils.getPauseTime(basePause,errorStats.retries);
    long now=EnvironmentEdgeManager.currentTimeMillis();
    long timeSinceLastError=now - errorStats.getLastErrorTime();
    if (timeSinceLastError > 0) {
      result=Math.max(0,result - timeSinceLastError);
    }
    if (result > 0 && (now + result > this.canRetryUntil)) {
      result=Math.max(0,this.canRetryUntil - now);
    }
  }
  return result;
}
