{
  if (Bytes.equals(tableName,HConstants.ROOT_TABLE_NAME)) {
    return online;
  }
  String tableNameStr=Bytes.toString(tableName);
  ZooKeeperKeepAliveConnection zkw=getKeepAliveZooKeeperWatcher();
  try {
    if (online) {
      return ZKTableReadOnly.isEnabledTable(zkw,tableNameStr);
    }
    return ZKTableReadOnly.isDisabledTable(zkw,tableNameStr);
  }
 catch (  KeeperException e) {
    throw new IOException("Enable/Disable failed",e);
  }
 finally {
    zkw.close();
  }
}
