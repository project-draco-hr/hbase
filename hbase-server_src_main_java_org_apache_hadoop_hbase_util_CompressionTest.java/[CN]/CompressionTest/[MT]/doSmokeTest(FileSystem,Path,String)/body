{
  Configuration conf=HBaseConfiguration.create();
  HFileContext context=new HFileContextBuilder().withCompressionAlgo(AbstractHFileWriter.compressionByName(codec)).build();
  HFile.Writer writer=HFile.getWriterFactoryNoCache(conf).withPath(fs,path).withFileContext(context).create();
  writer.append(Bytes.toBytes("testkey"),Bytes.toBytes("testval"));
  writer.appendFileInfo(Bytes.toBytes("infokey"),Bytes.toBytes("infoval"));
  writer.close();
  HFile.Reader reader=HFile.createReader(fs,path,new CacheConfig(conf));
  reader.loadFileInfo();
  byte[] key=reader.getFirstKey();
  boolean rc=Bytes.toString(key).equals("testkey");
  reader.close();
  if (!rc) {
    throw new Exception("Read back incorrect result: " + Bytes.toStringBinary(key));
  }
}
