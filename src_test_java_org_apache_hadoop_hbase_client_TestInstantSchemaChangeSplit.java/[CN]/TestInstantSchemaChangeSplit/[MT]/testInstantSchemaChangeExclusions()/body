{
  MasterSchemaChangeTracker msct=TEST_UTIL.getHBaseCluster().getMaster().getSchemaChangeTracker();
  LOG.info("Start testInstantSchemaChangeExclusions() ");
  String tableName="testInstantSchemaChangeExclusions";
  HTable ht=createTableAndValidate(tableName);
  HColumnDescriptor hcd=new HColumnDescriptor(HConstants.CATALOG_FAMILY);
  hcd.setMaxVersions(99);
  hcd.setBlockCacheEnabled(false);
  HRegionServer hrs=findRSWithOnlineRegionFor(tableName);
  admin.modifyColumn(Bytes.toBytes(tableName),hcd);
  hrs.abort("Aborting for tests");
  hrs.getSchemaChangeTracker().setSleepTimeMillis(20000);
  LOG.debug("Waiting for Schema Change process to complete");
  waitForSchemaChangeProcess(tableName,15000);
  assertEquals(msct.doesSchemaChangeNodeExists(tableName),false);
  Thread.sleep(10000);
  List<HRegion> onlineRegions=miniHBaseCluster.getRegions(Bytes.toBytes("testInstantSchemaChangeExclusions"));
  assertTrue(!onlineRegions.isEmpty());
  for (  HRegion onlineRegion : onlineRegions) {
    HTableDescriptor htd=onlineRegion.getTableDesc();
    HColumnDescriptor tableHcd=htd.getFamily(HConstants.CATALOG_FAMILY);
    assertTrue(tableHcd.isBlockCacheEnabled() == false);
    assertEquals(tableHcd.getMaxVersions(),99);
  }
  LOG.info("End testInstantSchemaChangeExclusions() ");
  ht.close();
}
