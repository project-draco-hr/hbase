{
  LOG.info("Starting Log splitting");
  final Path rootDir=FSUtils.getRootDir(getConf());
  final Path oldLogDir=new Path(rootDir,HConstants.HREGION_OLDLOGDIR_NAME);
  FileSystem fs=FSUtils.getCurrentFileSystem(getConf());
  Path logDir=new Path(rootDir,HConstants.HREGION_LOGDIR_NAME);
  FileStatus[] regionServerLogDirs=FSUtils.listStatus(fs,logDir);
  if (regionServerLogDirs == null || regionServerLogDirs.length == 0) {
    LOG.info("No log directories to split, returning");
    return;
  }
  try {
    for (    FileStatus regionServerLogDir : regionServerLogDirs) {
      HLogSplitter.split(rootDir,regionServerLogDir.getPath(),oldLogDir,fs,getConf());
    }
    LOG.info("Successfully completed Log splitting");
  }
 catch (  Exception e) {
    LOG.error("Got exception while doing Log splitting ",e);
    throw e;
  }
}
