{
  if (!parseOption(args)) {
    printUsage();
    return -1;
  }
  if (checkForHFileV1) {
    int res=doHFileV1Check();
    if (res == 0)     LOG.info("No HFileV1 found.");
 else {
      LOG.warn("There are some HFileV1, or corrupt files (files with incorrect major version).");
      return -1;
    }
  }
  if (upgrade) {
    if (isAnyHBaseProcessAlive()) {
      LOG.error("Some HBase processes are still alive, or znodes not expired yet. " + "Please stop them before upgrade or try after some time.");
      throw new IOException("Some HBase processes are still alive, or znodes not expired yet");
    }
    return executeUpgrade();
  }
  return -1;
}
