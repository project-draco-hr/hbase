{
synchronized (serversToServerInfo) {
    try {
      if (cancelLease(serverName)) {
        LOG.info("Region server " + serverName + ": MSG_REPORT_EXITING -- lease cancelled");
        if (!master.closed.get()) {
          for (int i=1; i < msgs.length; i++) {
            LOG.info("Processing " + msgs[i] + " from "+ serverName);
            HRegionInfo info=msgs[i].getRegionInfo();
synchronized (master.regionManager) {
              if (info.isRootRegion()) {
                master.regionManager.reassignRootRegion();
              }
 else {
                if (info.isMetaTable()) {
                  master.regionManager.offlineMetaRegion(info.getStartKey());
                }
                if (!master.regionManager.isOfflined(info.getRegionName())) {
                  master.regionManager.setUnassigned(info,true);
                }
 else {
                  master.regionManager.removeRegion(info);
                }
              }
            }
          }
        }
      }
    }
  finally {
      serversToServerInfo.notifyAll();
    }
  }
}
