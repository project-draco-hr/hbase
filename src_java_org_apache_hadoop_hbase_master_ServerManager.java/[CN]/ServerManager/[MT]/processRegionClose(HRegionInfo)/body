{
synchronized (this.master.getRegionManager()) {
    if (region.isRootRegion()) {
      this.master.getRegionManager().unsetRootRegion();
      if (region.isOffline()) {
        LOG.fatal("root region is marked offline");
        this.master.shutdown();
        return;
      }
    }
 else     if (region.isMetaTable()) {
      this.master.getRegionManager().offlineMetaRegion(region.getStartKey());
    }
    boolean offlineRegion=this.master.getRegionManager().isOfflined(region.getRegionNameAsString());
    boolean reassignRegion=!region.isOffline() && !offlineRegion;
    this.master.getRegionManager().setClosed(region.getRegionNameAsString());
    this.master.queue(new ProcessRegionClose(master,region,offlineRegion,reassignRegion));
  }
}
