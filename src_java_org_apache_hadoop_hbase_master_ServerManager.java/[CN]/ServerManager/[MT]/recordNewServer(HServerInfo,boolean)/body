{
  HServerLoad load=useInfoLoad ? info.getLoad() : new HServerLoad();
  String serverName=HServerInfo.getServerName(info);
  info.setLoad(load);
  Watcher watcher=new ServerExpirer(serverName,info.getServerAddress());
  zooKeeperWrapper.updateRSLocationGetWatch(info,watcher);
  serversToServerInfo.put(serverName,info);
  serverAddressToServerInfo.put(info.getServerAddress(),info);
  serversToLoad.put(serverName,load);
synchronized (loadToServers) {
    Set<String> servers=loadToServers.get(load);
    if (servers == null) {
      servers=new HashSet<String>();
    }
    servers.add(serverName);
    loadToServers.put(load,servers);
  }
}
