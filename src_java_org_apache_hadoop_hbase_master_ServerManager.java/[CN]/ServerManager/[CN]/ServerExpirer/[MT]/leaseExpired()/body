{
  LOG.info(server + " lease expired");
  HServerInfo info=serversToServerInfo.remove(server);
  boolean rootServer=false;
  if (info != null) {
    HServerAddress root=master.getRootRegionLocation();
    if (root != null && root.equals(info.getServerAddress())) {
      master.regionManager.unsetRootRegion();
      rootServer=true;
    }
    String serverName=info.getServerAddress().toString();
    HServerLoad load=serversToLoad.remove(serverName);
    if (load != null) {
synchronized (loadToServers) {
        Set<String> servers=loadToServers.get(load);
        if (servers != null) {
          servers.remove(serverName);
          loadToServers.put(load,servers);
        }
      }
    }
    deadServers.add(server);
  }
synchronized (serversToServerInfo) {
    serversToServerInfo.notifyAll();
  }
  if (info != null) {
    try {
      master.toDoQueue.put(new ProcessServerShutdown(master,info,rootServer));
    }
 catch (    InterruptedException e) {
      LOG.error("Insertion into toDoQueue was interrupted",e);
    }
  }
}
