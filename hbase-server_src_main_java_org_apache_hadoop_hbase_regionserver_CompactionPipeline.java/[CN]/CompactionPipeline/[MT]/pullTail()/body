{
synchronized (pipeline) {
    if (pipeline.isEmpty()) {
      return EMPTY_MEM_STORE_SEGMENT;
    }
    return removeLast();
  }
}
