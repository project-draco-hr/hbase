{
  Text.writeString(out,(protocol == null) ? "" : protocol);
  if (user != null) {
    UserGroupInformation ugi=user.getUGI();
    if (authMethod == AuthMethod.KERBEROS) {
      out.writeBoolean(true);
      out.writeUTF(ugi.getUserName());
      out.writeBoolean(false);
    }
 else     if (authMethod == AuthMethod.DIGEST) {
      out.writeBoolean(false);
    }
 else {
      out.writeBoolean(true);
      out.writeUTF(ugi.getUserName());
      if (ugi.getRealUser() != null) {
        out.writeBoolean(true);
        out.writeUTF(ugi.getRealUser().getUserName());
      }
 else {
        out.writeBoolean(false);
      }
    }
  }
 else {
    out.writeBoolean(false);
  }
}
