{
  Configuration conf=getConf();
  HBaseAdmin.checkHBaseAvailable(conf);
  Connection connection=ConnectionFactory.createConnection(getConf());
  Admin admin=connection.getAdmin();
  try {
    FileSystem fs=FileSystem.get(conf);
    TableName tn=TableName.valueOf(tableName);
    HTableDescriptor htd=admin.getTableDescriptor(tn);
    HColumnDescriptor family=htd.getFamily(Bytes.toBytes(familyName));
    if (family == null || !family.isMobEnabled()) {
      throw new IOException("Column family " + familyName + " is not a MOB column family");
    }
    SweepJob job=new SweepJob(conf,fs);
    return job.sweep(tn,family);
  }
 catch (  Exception e) {
    System.err.println("Job aborted due to exception " + e);
    return 2;
  }
 finally {
    try {
      admin.close();
    }
 catch (    IOException e) {
      System.out.println("Failed to close the HBaseAdmin: " + e.getMessage());
    }
    try {
      connection.close();
    }
 catch (    IOException e) {
      System.out.println("Failed to close the connection: " + e.getMessage());
    }
  }
}
