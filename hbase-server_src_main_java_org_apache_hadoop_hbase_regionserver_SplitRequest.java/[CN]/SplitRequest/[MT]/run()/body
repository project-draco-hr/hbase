{
  if (this.server.isStopping() || this.server.isStopped()) {
    LOG.debug("Skipping split because server is stopping=" + this.server.isStopping() + " or stopped="+ this.server.isStopped());
    return;
  }
  try {
    final long startTime=System.currentTimeMillis();
    SplitTransaction st=new SplitTransaction(parent,midKey);
    if (!st.prepare())     return;
    try {
      st.execute(this.server,this.server);
      this.server.getMetrics().incrementSplitSuccessCount();
    }
 catch (    Exception e) {
      try {
        LOG.info("Running rollback/cleanup of failed split of " + parent.getRegionNameAsString() + "; "+ e.getMessage(),e);
        if (st.rollback(this.server,this.server)) {
          LOG.info("Successful rollback of failed split of " + parent.getRegionNameAsString());
          this.server.getMetrics().incrementSplitFailureCount();
        }
 else {
          this.server.abort("Abort; we got an error after point-of-no-return");
        }
      }
 catch (      RuntimeException ee) {
        String msg="Failed rollback of failed split of " + parent.getRegionNameAsString() + " -- aborting server";
        LOG.info(msg,ee);
        this.server.abort(msg);
      }
      return;
    }
    LOG.info("Region split, META updated, and report to master. Parent=" + parent.getRegionInfo().getRegionNameAsString() + ", new regions: "+ st.getFirstDaughter().getRegionNameAsString()+ ", "+ st.getSecondDaughter().getRegionNameAsString()+ ". Split took "+ StringUtils.formatTimeDiff(System.currentTimeMillis(),startTime));
  }
 catch (  IOException ex) {
    LOG.error("Split failed " + this,RemoteExceptionHandler.checkIOException(ex));
    this.server.getMetrics().incrementSplitFailureCount();
    server.checkFileSystem();
  }
}
