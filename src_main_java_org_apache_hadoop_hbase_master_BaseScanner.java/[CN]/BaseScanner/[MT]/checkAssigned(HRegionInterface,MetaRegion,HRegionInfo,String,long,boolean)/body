{
  boolean tryAgain=false;
  String serverName=null;
  String sa=hostnameAndPort;
  long sc=startCode;
  if (sa == null || sa.length() <= 0) {
    Get g=new Get(info.getRegionName());
    g.addFamily(HConstants.CATALOG_FAMILY);
    Result r=regionServer.get(meta.getRegionName(),g);
    if (r != null && !r.isEmpty()) {
      sa=getServerAddress(r);
      sc=getStartCode(r);
      info=master.getHRegionInfo(r.getRow(),r);
    }
  }
  if (sa != null && sa.length() > 0) {
    serverName=HServerInfo.getServerName(sa,sc);
  }
  HServerInfo storedInfo=null;
synchronized (this.master.getRegionManager()) {
    if (info == null || info.isOffline() || this.master.getRegionManager().regionIsInTransition(info.getRegionNameAsString()) || (serverName != null && this.master.getServerManager().isDead(serverName))) {
      return;
    }
    if (serverName != null) {
      storedInfo=this.master.getServerManager().getServerInfo(serverName);
    }
    if (storedInfo == null) {
      if (checkTwice) {
        tryAgain=true;
      }
 else {
        if (LOG.isDebugEnabled()) {
          LOG.debug("Current assignment of " + info.getRegionNameAsString() + " is not valid; "+ " serverAddress="+ sa+ ", startCode="+ sc+ " unknown.");
        }
        this.master.getRegionManager().setUnassigned(info,true);
      }
    }
  }
  if (tryAgain) {
    if (LOG.isDebugEnabled()) {
      LOG.debug("Current assignment of " + info.getRegionNameAsString() + " is not valid; "+ " serverAddress="+ sa+ ", startCode="+ sc+ " unknown; checking once more!");
    }
    checkAssigned(regionServer,meta,info,null,0,false);
  }
}
