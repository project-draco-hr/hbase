{
  EnvironmentEdgeManagerTestHelper.injectEdge(new IncrementingEnvironmentEdge());
  HTable t=new HTable(util.getConfiguration(),tableName);
  List<Put> puts=new ArrayList<Put>();
  Put p=new Put(row1);
  p.add(dummy,dummy,dummy);
  puts.add(p);
  p=new Put(row2);
  p.add(test,dummy,dummy);
  puts.add(p);
  p=new Put(row3);
  p.add(test,dummy,dummy);
  puts.add(p);
  t.put(puts);
  checkRowAndDelete(t,row1,1);
  checkRowAndDelete(t,row2,0);
  checkRowAndDelete(t,row3,0);
  puts.clear();
  p=new Put(row1);
  p.add(test,dummy,dummy);
  puts.add(p);
  p=new Put(row2);
  p.add(test,dummy,dummy);
  puts.add(p);
  p=new Put(row3);
  p.add(test,dummy,dummy);
  puts.add(p);
  t.put(puts);
  checkRowAndDelete(t,row1,0);
  checkRowAndDelete(t,row2,0);
  checkRowAndDelete(t,row3,0);
  puts.clear();
  p=new Put(row1);
  p.add(test,dummy,dummy);
  puts.add(p);
  p=new Put(row2);
  p.add(test,dummy,dummy);
  puts.add(p);
  p=new Put(row3);
  p.add(dummy,dummy,dummy);
  puts.add(p);
  t.put(puts);
  checkRowAndDelete(t,row1,0);
  checkRowAndDelete(t,row2,0);
  checkRowAndDelete(t,row3,1);
  puts.clear();
  p=new Put(row1);
  p.add(dummy,dummy,dummy);
  puts.add(p);
  p=new Put(row2);
  p.add(test,dummy,dummy);
  puts.add(p);
  p=new Put(row3);
  p.add(dummy,dummy,dummy);
  puts.add(p);
  t.put(puts);
  checkRowAndDelete(t,row1,1);
  checkRowAndDelete(t,row2,0);
  checkRowAndDelete(t,row3,1);
  puts.clear();
  p=new Put(row1);
  p.add(test,dummy,dummy);
  puts.add(p);
  p=new Put(row2);
  p.add(dummy,dummy,dummy);
  puts.add(p);
  p=new Put(row3);
  p.add(test,dummy,dummy);
  puts.add(p);
  t.put(puts);
  checkRowAndDelete(t,row1,0);
  checkRowAndDelete(t,row2,1);
  checkRowAndDelete(t,row3,0);
  t.close();
  EnvironmentEdgeManager.reset();
}
