{
  cluster=new MiniHBaseCluster(conf,1,dfs,true);
  try {
    Thread.sleep(10 * 1000);
  }
 catch (  InterruptedException e) {
  }
  this.server=cluster.getRegionThreads().get(0).getRegionServer();
  this.log=server.getLog();
  HTable meta=new HTable(conf,HConstants.META_TABLE_NAME);
  try {
    HTableDescriptor desc=new HTableDescriptor(tableName);
    desc.addFamily(new HColumnDescriptor(HConstants.COLUMN_FAMILY.toString()));
    HBaseAdmin admin=new HBaseAdmin(conf);
    admin.createTable(desc);
    HTable table=new HTable(conf,new Text(tableName));
    try {
      for (int i=1; i <= 2048; i++) {
        long lockid=table.startUpdate(new Text("row" + String.format("%1$04d",i)));
        table.put(lockid,HConstants.COLUMN_FAMILY,value);
        table.commit(lockid);
        if (i % 256 == 0) {
          try {
            Thread.sleep(2000);
          }
 catch (          InterruptedException e) {
          }
        }
      }
    }
  finally {
      table.close();
    }
  }
  finally {
    meta.close();
  }
}
