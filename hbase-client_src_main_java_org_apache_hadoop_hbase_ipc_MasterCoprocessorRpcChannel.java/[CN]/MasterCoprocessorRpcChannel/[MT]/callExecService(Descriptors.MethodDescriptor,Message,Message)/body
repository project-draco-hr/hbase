{
  if (LOG.isDebugEnabled()) {
    LOG.debug("Call: " + method.getName() + ", "+ request.toString());
  }
  final ClientProtos.CoprocessorServiceCall call=ClientProtos.CoprocessorServiceCall.newBuilder().setRow(ByteStringer.wrap(HConstants.EMPTY_BYTE_ARRAY)).setServiceName(method.getService().getFullName()).setMethodName(method.getName()).setRequest(request.toByteString()).build();
  CoprocessorServiceResponse result=ProtobufUtil.execService(connection.getMaster(),call);
  Message response=null;
  if (result.getValue().hasValue()) {
    Message.Builder builder=responsePrototype.newBuilderForType();
    ProtobufUtil.mergeFrom(builder,result.getValue().getValue());
    response=builder.build();
  }
 else {
    response=responsePrototype.getDefaultInstanceForType();
  }
  if (LOG.isTraceEnabled()) {
    LOG.trace("Master Result is value=" + response);
  }
  return response;
}
