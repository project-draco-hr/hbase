{
  LOG.info("Waiting for ZK node creation for table = " + tableName);
  final MasterSchemaChangeTracker msct=TEST_UTIL.getHBaseCluster().getMaster().getSchemaChangeTracker();
  final Runnable r=new Runnable(){
    public void run(){
      try {
        while (!msct.doesSchemaChangeNodeExists(tableName)) {
          try {
            Thread.sleep(50);
          }
 catch (          InterruptedException e) {
            Thread.currentThread().interrupt();
          }
        }
      }
 catch (      KeeperException ke) {
        ke.printStackTrace();
      }
      LOG.info("Waiting for ZK node deletion for table = " + tableName);
      try {
        while (msct.doesSchemaChangeNodeExists(tableName)) {
          try {
            Thread.sleep(50);
          }
 catch (          InterruptedException e) {
            Thread.currentThread().interrupt();
          }
        }
      }
 catch (      KeeperException ke) {
        ke.printStackTrace();
      }
    }
  }
;
  Thread t=new Thread(r);
  t.start();
  if (waitTimeMills > 0) {
    t.join(waitTimeMills);
  }
 else {
    t.join(10000);
  }
}
