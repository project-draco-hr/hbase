{
  String tableName=args[0];
  Path outputDir=new Path(args[1]);
  Job job=new Job(conf,NAME + "_" + tableName);
  job.setJarByClass(Exporter.class);
  Scan s=new Scan();
  int versions=args.length > 2 ? Integer.parseInt(args[2]) : 1;
  s.setMaxVersions(versions);
  long startTime=args.length > 3 ? Long.parseLong(args[3]) : 0L;
  long endTime=args.length > 4 ? Long.parseLong(args[4]) : Long.MAX_VALUE;
  s.setTimeRange(startTime,endTime);
  Log.info("verisons=" + versions + ", starttime="+ startTime+ ", endtime="+ endTime);
  TableMapReduceUtil.initTableMapperJob(tableName,s,Exporter.class,null,null,job);
  job.setNumReduceTasks(0);
  job.setOutputFormatClass(SequenceFileOutputFormat.class);
  job.setOutputKeyClass(ImmutableBytesWritable.class);
  job.setOutputValueClass(Result.class);
  FileOutputFormat.setOutputPath(job,outputDir);
  return job;
}
