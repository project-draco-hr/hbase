{
  invocations++;
  if (HTableDescriptor.ROOT_TABLEDESC.getNameAsString().equals(tablename)) {
    cachehits++;
    return HTableDescriptor.ROOT_TABLEDESC;
  }
  if (HTableDescriptor.META_TABLEDESC.getNameAsString().equals(tablename)) {
    cachehits++;
    return HTableDescriptor.META_TABLEDESC;
  }
  if (HConstants.HBASE_NON_USER_TABLE_DIRS.contains(tablename)) {
    throw new IOException("No descriptor found for table = " + tablename);
  }
  TableDescriptorModtime tdm=this.cache.get(tablename);
  long modtime=FSTableDescriptors.getTableInfoModtime(this.fs,this.rootdir,tablename);
  if (tdm != null) {
    if (modtime <= tdm.getModtime()) {
      cachehits++;
      return tdm.getTableDescriptor();
    }
  }
  HTableDescriptor htd=FSTableDescriptors.getTableDescriptor(this.fs,this.rootdir,tablename);
  if (htd == null) {
    throw new TableExistsException("No descriptor for " + tablename);
  }
  this.cache.put(tablename,new TableDescriptorModtime(modtime,htd));
  return htd;
}
