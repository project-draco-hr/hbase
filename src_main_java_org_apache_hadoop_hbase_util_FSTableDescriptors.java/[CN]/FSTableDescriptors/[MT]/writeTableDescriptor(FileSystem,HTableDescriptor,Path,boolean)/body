{
  FileStatus status=getTableInfoPath(fs,tableDir);
  int sequenceid=getTableInfoSequenceid(status == null ? null : status.getPath());
  Path tableInfoPath=null;
  do {
    sequenceid+=1;
    tableInfoPath=getTableInfoFileName(tableDir,sequenceid);
  }
 while (fs.exists(tableInfoPath));
  try {
    writeHTD(fs,tableInfoPath,hTableDescriptor);
    if (status != null) {
      if (!fs.delete(status.getPath(),false)) {
        LOG.warn("Failed delete of " + status.getPath());
      }
    }
  }
 catch (  IOException e) {
    LOG.error("Unable to write the tabledescriptor in the path" + tableInfoPath + ".",e);
    fs.delete(tableInfoPath,true);
    throw e;
  }
  return tableInfoPath;
}
