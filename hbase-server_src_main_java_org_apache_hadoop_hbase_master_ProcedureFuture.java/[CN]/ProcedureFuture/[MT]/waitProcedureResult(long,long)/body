{
  while (EnvironmentEdgeManager.currentTime() < deadlineTs) {
    Pair<ProcedureInfo,Procedure> pair=this.procedureExecutor.getResultOrProcedure(procId);
    if (pair.getFirst() != null) {
      this.procedureExecutor.removeResult(procId);
      return pair.getFirst();
    }
 else {
      if (pair.getSecond() == null)       return null;
    }
  }
  throw new TimeoutException("The procedure " + procId + " is still running");
}
