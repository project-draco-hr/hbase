{
  try {
    if (this.master != null && this.master.isStopped()) {
      return;
    }
    this.services.getMasterFileSystem().splitLog(serverName);
  }
 catch (  Exception ex) {
    if (ex instanceof IOException) {
      this.services.getExecutorService().submit((LogReplayHandler)this);
      this.deadServers.add(serverName);
      throw new IOException("failed log replay for " + serverName + ", will retry",ex);
    }
 else {
      throw new IOException(ex);
    }
  }
 finally {
    this.deadServers.finish(serverName);
  }
  LOG.info("Finished processing of shutdown of " + serverName);
}
