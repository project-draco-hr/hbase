{
  int lvlength=left.getValueLength();
  int rvlength=right.getValueLength();
  if (lvlength != rvlength)   return false;
  if (left instanceof ByteBufferedCell && right instanceof ByteBufferedCell) {
    return ByteBufferUtils.compareTo(((ByteBufferedCell)left).getValueByteBuffer(),((ByteBufferedCell)left).getValuePositionInByteBuffer(),lvlength,((ByteBufferedCell)right).getValueByteBuffer(),((ByteBufferedCell)right).getValuePositionInByteBuffer(),rvlength) == 0;
  }
  if (left instanceof ByteBufferedCell) {
    return ByteBufferUtils.compareTo(((ByteBufferedCell)left).getValueByteBuffer(),((ByteBufferedCell)left).getValuePositionInByteBuffer(),lvlength,right.getValueArray(),right.getValueOffset(),rvlength) == 0;
  }
  if (right instanceof ByteBufferedCell) {
    return ByteBufferUtils.compareTo(((ByteBufferedCell)right).getValueByteBuffer(),((ByteBufferedCell)right).getValuePositionInByteBuffer(),rvlength,left.getValueArray(),left.getValueOffset(),lvlength) == 0;
  }
  return Bytes.equals(left.getValueArray(),left.getValueOffset(),lvlength,right.getValueArray(),right.getValueOffset(),rvlength);
}
