{
  byte lfamlength=left.getFamilyLength();
  byte rfamlength=right.getFamilyLength();
  if (lfamlength != rfamlength)   return false;
  if (left instanceof ByteBufferedCell && right instanceof ByteBufferedCell) {
    return ByteBufferUtils.compareTo(((ByteBufferedCell)left).getFamilyByteBuffer(),((ByteBufferedCell)left).getFamilyPositionInByteBuffer(),lfamlength,((ByteBufferedCell)right).getFamilyByteBuffer(),((ByteBufferedCell)right).getFamilyPositionInByteBuffer(),rfamlength) == 0;
  }
  if (left instanceof ByteBufferedCell) {
    return ByteBufferUtils.compareTo(((ByteBufferedCell)left).getFamilyByteBuffer(),((ByteBufferedCell)left).getFamilyPositionInByteBuffer(),lfamlength,right.getFamilyArray(),right.getFamilyOffset(),rfamlength) == 0;
  }
  if (right instanceof ByteBufferedCell) {
    return ByteBufferUtils.compareTo(((ByteBufferedCell)right).getFamilyByteBuffer(),((ByteBufferedCell)right).getFamilyPositionInByteBuffer(),rfamlength,left.getFamilyArray(),left.getFamilyOffset(),lfamlength) == 0;
  }
  return Bytes.equals(left.getFamilyArray(),left.getFamilyOffset(),left.getFamilyLength(),right.getFamilyArray(),right.getFamilyOffset(),right.getFamilyLength());
}
