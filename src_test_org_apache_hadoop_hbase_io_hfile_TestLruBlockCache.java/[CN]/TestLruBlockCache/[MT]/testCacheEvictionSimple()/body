{
  long maxSize=100000;
  LruBlockCache cache=new LruBlockCache(maxSize,100,false);
  Block[] blocks=generateFixedBlocks(10,10000);
  long expectedCacheSize=0;
  for (  Block block : blocks) {
    cache.cacheBlock(block.blockName,block.buf);
    expectedCacheSize+=block.heapSize();
  }
  assertEquals(cache.getEvictionCount(),1);
  assertTrue(expectedCacheSize > (maxSize * LruBlockCache.DEFAULT_ACCEPTABLE_FACTOR));
  assertTrue(cache.cacheSize() < maxSize);
  assertTrue(cache.cacheSize() < (maxSize * LruBlockCache.DEFAULT_ACCEPTABLE_FACTOR));
  assertTrue(cache.getBlock(blocks[0].blockName) == null);
  assertTrue(cache.getBlock(blocks[1].blockName) == null);
  for (int i=2; i < blocks.length; i++) {
    assertEquals(cache.getBlock(blocks[i].blockName),blocks[i].buf);
  }
}
