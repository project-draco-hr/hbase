{
  this.scannerContext=ScannerContext.newBuilder().setBatchLimit(compactionKVMax).build();
  List<KeyValueScanner> scanners=new ArrayList<KeyValueScanner>();
  for (  Segment segment : segments) {
    scanners.add(segment.getScanner(store.getSmallestReadPoint()));
  }
  scanner=new MemStoreScanner(comparator,scanners,MemStoreScanner.Type.COMPACT_FORWARD);
  compactingScanner=createScanner(store,scanner);
  hasMore=compactingScanner.next(kvs,scannerContext);
  if (!kvs.isEmpty()) {
    kvsIterator=kvs.iterator();
  }
}
