{
  Scan s=new Scan();
  s.setMaxVersions(Integer.MAX_VALUE);
  s.setCacheBlocks(false);
  if (conf.get(TableInputFormat.SCAN_COLUMN_FAMILY) != null) {
    s.addFamily(Bytes.toBytes(conf.get(TableInputFormat.SCAN_COLUMN_FAMILY)));
  }
  Filter rowFilter=getRowFilter(args);
  if (rowFilter != null) {
    LOG.info("Setting Row Filter for counter.");
    s.setFilter(rowFilter);
  }
  return s;
}
