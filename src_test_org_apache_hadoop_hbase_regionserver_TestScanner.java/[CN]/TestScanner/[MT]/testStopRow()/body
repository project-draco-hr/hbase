{
  byte[] startrow=Bytes.toBytes("bbb");
  byte[] stoprow=Bytes.toBytes("ccc");
  try {
    this.r=createNewHRegion(REGION_INFO.getTableDesc(),null,null);
    addContent(this.r,HConstants.COLUMN_FAMILY);
    InternalScanner s=r.getScanner(HConstants.COLUMN_FAMILY_ARRAY,startrow,HConstants.LATEST_TIMESTAMP,new WhileMatchRowFilter(new StopRowFilter(stoprow)));
    HStoreKey key=new HStoreKey();
    SortedMap<byte[],Cell> results=new TreeMap<byte[],Cell>(Bytes.BYTES_COMPARATOR);
    int count=0;
    for (boolean first=true; s.next(key,results); ) {
      if (first) {
        assertTrue(Bytes.BYTES_COMPARATOR.compare(startrow,key.getRow()) == 0);
        first=false;
      }
      count++;
    }
    assertTrue(Bytes.BYTES_COMPARATOR.compare(stoprow,key.getRow()) > 0);
    assertTrue(count > 10);
    s.close();
  }
  finally {
    this.r.close();
    this.r.getLog().closeAndDelete();
    shutdownDfs(this.cluster);
  }
}
