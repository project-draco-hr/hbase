{
  byte[] startrow=Bytes.toBytes("bbb");
  byte[] stoprow=Bytes.toBytes("ccc");
  try {
    this.r=createNewHRegion(REGION_INFO.getTableDesc(),null,null);
    addContent(this.r,HConstants.COLUMN_FAMILY);
    InternalScanner s=r.getScanner(HConstants.COLUMN_FAMILY_ARRAY,startrow,HConstants.LATEST_TIMESTAMP,new WhileMatchRowFilter(new StopRowFilter(stoprow)));
    List<KeyValue> results=new ArrayList<KeyValue>();
    int count=0;
    KeyValue kv=null;
    for (boolean first=true; s.next(results); ) {
      kv=results.get(0);
      if (first) {
        assertTrue(Bytes.BYTES_COMPARATOR.compare(startrow,kv.getRow()) == 0);
        first=false;
      }
      count++;
    }
    assertTrue(Bytes.BYTES_COMPARATOR.compare(stoprow,kv.getRow()) > 0);
    assertTrue(count > 10);
    s.close();
  }
  finally {
    this.r.close();
    this.r.getLog().closeAndDelete();
    shutdownDfs(this.cluster);
  }
}
