{
  this.r=createNewHRegion(REGION_INFO.getTableDesc(),null,null);
  HRegionIncommon hri=new HRegionIncommon(r);
  try {
    String columnString=Bytes.toString(HConstants.CATALOG_FAMILY) + ':' + Bytes.toString(HConstants.REGIONINFO_QUALIFIER);
    LOG.info("Added: " + addContent(hri,columnString));
    int count=count(hri,-1);
    assertEquals(count,count(hri,100));
    assertEquals(count,count(hri,0));
    assertEquals(count,count(hri,count - 1));
  }
 catch (  Exception e) {
    LOG.error("Failed",e);
    throw e;
  }
 finally {
    this.r.close();
    this.r.getLog().closeAndDelete();
    shutdownDfs(cluster);
  }
}
