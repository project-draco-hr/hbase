{
  LOG.info("Taking out counting scan");
  ScannerIncommon s=hri.getScanner(EXPLICIT_COLS,HConstants.EMPTY_START_ROW,HConstants.LATEST_TIMESTAMP);
  HStoreKey key=new HStoreKey();
  SortedMap<byte[],Cell> values=new TreeMap<byte[],Cell>(Bytes.BYTES_COMPARATOR);
  int count=0;
  while (s.next(key,values)) {
    count++;
    if (flushIndex == count) {
      LOG.info("Starting flush at flush index " + flushIndex);
      hri.flushcache();
      LOG.info("Finishing flush");
    }
  }
  s.close();
  LOG.info("Found " + count + " items");
  return count;
}
