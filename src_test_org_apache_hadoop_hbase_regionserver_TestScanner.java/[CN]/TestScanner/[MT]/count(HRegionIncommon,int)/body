{
  LOG.info("Taking out counting scan");
  ScannerIncommon s=hri.getScanner(HConstants.CATALOG_FAMILY,EXPLICIT_COLS,HConstants.EMPTY_START_ROW,HConstants.LATEST_TIMESTAMP);
  List<KeyValue> values=new ArrayList<KeyValue>();
  int count=0;
  while (s.next(values)) {
    count++;
    if (flushIndex == count) {
      LOG.info("Starting flush at flush index " + flushIndex);
      hri.flushcache();
      LOG.info("Finishing flush");
    }
  }
  s.close();
  LOG.info("Found " + count + " items");
  return count;
}
