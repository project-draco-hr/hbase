{
  InternalScanner scanner=null;
  List<KeyValue> results=new ArrayList<KeyValue>();
  byte[][][] scanColumns={COLS,EXPLICIT_COLS};
  for (int i=0; i < scanColumns.length; i++) {
    try {
      scanner=r.getScanner(scanColumns[i],FIRST_ROW,System.currentTimeMillis(),null);
      while (scanner.next(results)) {
        assertTrue(hasColumn(results,HConstants.COL_REGIONINFO));
        byte[] val=getColumn(results,HConstants.COL_REGIONINFO).getValue();
        validateRegionInfo(val);
        if (validateStartcode) {
          assertTrue(hasColumn(results,HConstants.COL_STARTCODE));
          val=getColumn(results,HConstants.COL_STARTCODE).getValue();
          assertNotNull(val);
          assertFalse(val.length == 0);
          long startCode=Bytes.toLong(val);
          assertEquals(START_CODE,startCode);
        }
        if (serverName != null) {
          assertTrue(hasColumn(results,HConstants.COL_SERVER));
          val=getColumn(results,HConstants.COL_SERVER).getValue();
          assertNotNull(val);
          assertFalse(val.length == 0);
          String server=Bytes.toString(val);
          assertEquals(0,server.compareTo(serverName));
        }
        results.clear();
      }
    }
  finally {
      InternalScanner s=scanner;
      scanner=null;
      if (s != null) {
        s.close();
      }
    }
  }
}
