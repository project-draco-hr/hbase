{
  injectEmptyFile(".empty",true);
  generateHLogs(Integer.MAX_VALUE);
  injectEmptyFile("empty",true);
  fs.initialize(fs.getUri(),conf);
  HLogSplitter logSplitter=HLogSplitter.createLogSplitter(conf);
  logSplitter.splitLog(hbaseDir,hlogDir,oldLogDir,fs,conf);
  for (  String region : regions) {
    Path logfile=getLogForRegion(hbaseDir,TABLE_NAME,region);
    assertEquals(NUM_WRITERS * ENTRIES,countHLog(logfile,fs,conf));
  }
}
