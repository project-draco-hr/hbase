{
  conf.setBoolean(HBASE_SKIP_ERRORS,false);
  generateHLogs(-1);
  corruptHLog(new Path(hlogDir,HLOG_FILE_PREFIX + "5"),Corruptions.APPEND_GARBAGE,true,fs);
  fs.initialize(fs.getUri(),conf);
  try {
    HLogSplitter logSplitter=HLogSplitter.createLogSplitter(conf);
    logSplitter.splitLog(hbaseDir,hlogDir,oldLogDir,fs,conf);
  }
 catch (  IOException e) {
  }
  assertEquals("if skip.errors is false all files should remain in place",NUM_WRITERS,fs.listStatus(hlogDir).length);
}
