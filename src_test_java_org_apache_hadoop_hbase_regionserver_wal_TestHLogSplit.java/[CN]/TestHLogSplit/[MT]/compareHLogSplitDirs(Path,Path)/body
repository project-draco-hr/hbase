{
  FileStatus[] f1=fs.listStatus(p1);
  FileStatus[] f2=fs.listStatus(p2);
  for (int i=0; i < f1.length; i++) {
    Path rd1=HLog.getRegionDirRecoveredEditsDir(f1[i].getPath());
    FileStatus[] rd1fs=fs.listStatus(rd1);
    assertEquals(1,rd1fs.length);
    Path rd2=HLog.getRegionDirRecoveredEditsDir(f2[i].getPath());
    FileStatus[] rd2fs=fs.listStatus(rd2);
    assertEquals(1,rd2fs.length);
    if (!logsAreEqual(rd1fs[0].getPath(),rd2fs[0].getPath())) {
      return -1;
    }
  }
  return 0;
}
