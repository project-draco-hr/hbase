{
  AtomicBoolean stop=new AtomicBoolean(false);
  FileStatus[] stats=fs.listStatus(new Path("/hbase/t1"));
  assertTrue("Previous test should clean up table dir",stats == null || stats.length == 0);
  generateHLogs(-1);
  try {
    (new ZombieNewLogWriterRegionServer(stop)).start();
    HLogSplitter logSplitter=HLogSplitter.createLogSplitter(conf,hbaseDir,hlogDir,oldLogDir,fs);
    logSplitter.splitLog();
  }
  finally {
    stop.set(true);
  }
}
