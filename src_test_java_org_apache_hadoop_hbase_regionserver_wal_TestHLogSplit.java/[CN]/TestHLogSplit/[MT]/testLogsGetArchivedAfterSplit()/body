{
  conf.setBoolean(HBASE_SKIP_ERRORS,false);
  generateHLogs(-1);
  fs.initialize(fs.getUri(),conf);
  HLogSplitter logSplitter=HLogSplitter.createLogSplitter(conf);
  logSplitter.splitLog(hbaseDir,hlogDir,oldLogDir,fs,conf);
  FileStatus[] archivedLogs=fs.listStatus(oldLogDir);
  assertEquals("wrong number of files in the archive log",NUM_WRITERS,archivedLogs.length);
}
