{
  ClientProtos.Exec.Builder builder=ClientProtos.Exec.newBuilder();
  Configuration conf=exec.getConf();
  if (conf != null) {
    NameStringPair.Builder propertyBuilder=NameStringPair.newBuilder();
    Iterator<Entry<String,String>> iterator=conf.iterator();
    while (iterator.hasNext()) {
      Entry<String,String> entry=iterator.next();
      propertyBuilder.setName(entry.getKey());
      propertyBuilder.setValue(entry.getValue());
      builder.addProperty(propertyBuilder.build());
    }
  }
  builder.setProtocolName(exec.getProtocolName());
  builder.setMethodName(exec.getMethodName());
  builder.setRow(ByteString.copyFrom(exec.getRow()));
  Object[] parameters=exec.getParameters();
  if (parameters != null && parameters.length > 0) {
    Class<?>[] declaredClasses=exec.getParameterClasses();
    for (int i=0, n=parameters.length; i < n; i++) {
      builder.addParameter(ProtobufUtil.toParameter(declaredClasses[i],parameters[i]));
    }
  }
  return builder.build();
}
