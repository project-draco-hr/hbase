{
  long heapsize=cb.heapSize();
  if (evict) {
    heapsize*=-1;
  }
  Cacheable cachedBlock=cb.getBuffer();
  SchemaMetrics schemaMetrics=cachedBlock.getSchemaMetrics();
  if (schemaMetrics != null) {
    schemaMetrics.updateOnCachePutOrEvict(cachedBlock.getBlockType().getCategory(),heapsize,evict);
  }
  return size.addAndGet(heapsize);
}
