{
  Map<String,Path> sfMap=FSUtils.getTableStoreFilePathMap(FileSystem.get(conf),FSUtils.getRootDir(conf));
  Map<BlockCacheColumnFamilySummary,BlockCacheColumnFamilySummary> bcs=new HashMap<BlockCacheColumnFamilySummary,BlockCacheColumnFamilySummary>();
  for (  CachedBlock cb : map.values()) {
    String sf=cb.getCacheKey().getHfileName();
    Path path=sfMap.get(sf);
    if (path != null) {
      BlockCacheColumnFamilySummary lookup=BlockCacheColumnFamilySummary.createFromStoreFilePath(path);
      BlockCacheColumnFamilySummary bcse=bcs.get(lookup);
      if (bcse == null) {
        bcse=BlockCacheColumnFamilySummary.create(lookup);
        bcs.put(lookup,bcse);
      }
      bcse.incrementBlocks();
      bcse.incrementHeapSize(cb.heapSize());
    }
  }
  List<BlockCacheColumnFamilySummary> list=new ArrayList<BlockCacheColumnFamilySummary>(bcs.values());
  Collections.sort(list);
  return list;
}
