{
  TEST_UTIL.getConfiguration().setInt(HFileBlockIndex.MAX_CHUNK_SIZE_KEY,BLOCK_SIZE);
  HColumnDescriptor hcd=new HColumnDescriptor(Bytes.toBytes(CF)).setMaxVersions(MAX_VERSIONS).setCompressionType(COMPRESSION_ALGORITHM).setBloomFilterType(BLOOM_TYPE);
  hcd.setBlocksize(BLOCK_SIZE);
  hcd.setBlockCacheEnabled(cfCacheEnabled);
  HRegion region=TEST_UTIL.createTestRegion(TABLE,hcd);
  writeTestData(region);
  for (int i=0; i < NUM_ROWS; ++i) {
    Get get=new Get(Bytes.toBytes("row" + i));
    region.get(get);
  }
  List<BlockCategory> importantBlockCategories=new ArrayList<BlockCategory>();
  importantBlockCategories.add(BlockCategory.BLOOM);
  if (hfileVersion == 2) {
    importantBlockCategories.add(BlockCategory.INDEX);
  }
}
