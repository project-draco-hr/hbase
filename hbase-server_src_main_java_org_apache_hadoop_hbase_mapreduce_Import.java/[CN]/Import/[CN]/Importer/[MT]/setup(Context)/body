{
  Configuration conf=context.getConfiguration();
  cfRenameMap=createCfRenameMap(conf);
  filter=instantiateFilter(conf);
  ReplicationZookeeper zkHelper=null;
  ZooKeeperWatcher zkw=null;
  try {
    HConnection connection=HConnectionManager.getConnection(conf);
    zkw=new ZooKeeperWatcher(conf,context.getTaskAttemptID().toString(),null);
    zkHelper=new ReplicationZookeeper(connection,conf,zkw);
    try {
      this.clusterId=zkHelper.getUUIDForCluster(zkw);
    }
  finally {
      if (zkHelper != null)       zkHelper.close();
    }
  }
 catch (  ZooKeeperConnectionException e) {
    LOG.error("Problem connecting to ZooKeper during task setup",e);
  }
catch (  KeeperException e) {
    LOG.error("Problem reading ZooKeeper data during task setup",e);
  }
catch (  IOException e) {
    LOG.error("Problem setting up task",e);
  }
 finally {
    if (zkw != null)     zkw.close();
  }
}
