{
  Put put=null;
  Delete delete=null;
  for (  Cell kv : result.raw()) {
    kv=filterKv(kv);
    if (kv == null)     continue;
    kv=convertKv(kv,cfRenameMap);
    if (CellUtil.isDelete(kv)) {
      if (delete == null) {
        delete=new Delete(key.get());
      }
      delete.addDeleteMarker(kv);
    }
 else {
      if (put == null) {
        put=new Put(key.get());
      }
      put.add(kv);
    }
  }
  if (put != null) {
    put.setClusterIds(clusterIds);
    context.write(key,put);
  }
  if (delete != null) {
    delete.setClusterIds(clusterIds);
    context.write(key,delete);
  }
}
