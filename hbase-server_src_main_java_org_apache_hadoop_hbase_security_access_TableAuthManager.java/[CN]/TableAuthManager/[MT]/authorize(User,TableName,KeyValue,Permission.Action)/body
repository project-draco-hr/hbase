{
  PermissionCache<TablePermission> tablePerms=tableCache.get(table);
  if (tablePerms != null) {
    List<TablePermission> userPerms=tablePerms.getUser(user.getShortName());
    if (authorize(userPerms,table,kv,action)) {
      return true;
    }
    String[] groupNames=user.getGroupNames();
    if (groupNames != null) {
      for (      String group : groupNames) {
        List<TablePermission> groupPerms=tablePerms.getGroup(group);
        if (authorize(groupPerms,table,kv,action)) {
          return true;
        }
      }
    }
  }
  return false;
}
