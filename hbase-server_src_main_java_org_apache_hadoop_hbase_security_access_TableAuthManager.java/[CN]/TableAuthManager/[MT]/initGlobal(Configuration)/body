{
  User user=User.getCurrent();
  if (user == null) {
    throw new IOException("Unable to obtain the current user, " + "authorization checks for internal operations will not work correctly!");
  }
  PermissionCache<Permission> newCache=new PermissionCache<Permission>();
  String currentUser=user.getShortName();
  List<String> superusers=Lists.asList(currentUser,conf.getStrings(AccessControlLists.SUPERUSER_CONF_KEY,new String[0]));
  if (superusers != null) {
    for (    String name : superusers) {
      if (AccessControlLists.isGroupPrincipal(name)) {
        newCache.putGroup(AccessControlLists.getGroupName(name),new Permission(Permission.Action.values()));
      }
 else {
        newCache.putUser(name,new Permission(Permission.Action.values()));
      }
    }
  }
  return newCache;
}
