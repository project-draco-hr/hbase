{
  BlockIndex bi=new BlockIndex(c);
  bi.blockOffsets=new long[indexSize];
  bi.blockKeys=new byte[indexSize][];
  bi.blockDataSizes=new int[indexSize];
  if (indexSize > 0) {
    in.seek(indexOffset);
    byte[] magic=new byte[INDEXBLOCKMAGIC.length];
    IOUtils.readFully(in,magic,0,magic.length);
    if (!Arrays.equals(magic,INDEXBLOCKMAGIC)) {
      throw new IOException("Index block magic is wrong: " + Arrays.toString(magic));
    }
    for (int i=0; i < indexSize; ++i) {
      long offset=in.readLong();
      int dataSize=in.readInt();
      byte[] key=Bytes.readByteArray(in);
      bi.add(key,offset,dataSize);
    }
  }
  return bi;
}
