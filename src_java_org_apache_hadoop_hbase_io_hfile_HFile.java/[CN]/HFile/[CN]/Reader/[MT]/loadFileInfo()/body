{
  this.trailer=readTrailer();
  this.istream.seek(this.trailer.fileinfoOffset);
  FileInfo fi=new FileInfo();
  fi.readFields(this.istream);
  this.lastkey=fi.get(FileInfo.LASTKEY);
  this.avgKeyLen=Bytes.toInt(fi.get(FileInfo.AVG_KEY_LEN));
  this.avgValueLen=Bytes.toInt(fi.get(FileInfo.AVG_VALUE_LEN));
  String clazzName=Bytes.toString(fi.get(FileInfo.COMPARATOR));
  this.comparator=getComparator(clazzName);
  this.blockIndex=BlockIndex.readIndex(this.comparator,this.istream,this.trailer.dataIndexOffset,this.trailer.dataIndexCount);
  if (trailer.metaIndexCount > 0) {
    this.metaIndex=BlockIndex.readIndex(Bytes.BYTES_RAWCOMPARATOR,this.istream,this.trailer.metaIndexOffset,trailer.metaIndexCount);
  }
  this.fileInfoLoaded=true;
  return fi;
}
