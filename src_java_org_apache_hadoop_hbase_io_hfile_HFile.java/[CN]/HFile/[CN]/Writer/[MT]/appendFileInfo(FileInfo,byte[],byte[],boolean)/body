{
  if (k == null || v == null) {
    throw new NullPointerException("Key nor value may be null");
  }
  if (checkPrefix && Bytes.toString(k).toLowerCase().startsWith(FileInfo.RESERVED_PREFIX)) {
    throw new IOException("Keys with a " + FileInfo.RESERVED_PREFIX + " are reserved");
  }
  fi.put(k,v);
  return fi;
}
