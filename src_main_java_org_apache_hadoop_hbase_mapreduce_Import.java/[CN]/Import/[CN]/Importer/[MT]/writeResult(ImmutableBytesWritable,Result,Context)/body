{
  Put put=null;
  Delete delete=null;
  for (  KeyValue kv : result.raw()) {
    if (cfRenameMap != null) {
      byte[] newCfName=cfRenameMap.get(kv.getFamily());
      if (newCfName != null) {
        kv=new KeyValue(kv.getBuffer(),kv.getRowOffset(),kv.getRowLength(),newCfName,0,newCfName.length,kv.getBuffer(),kv.getQualifierOffset(),kv.getQualifierLength(),kv.getTimestamp(),KeyValue.Type.codeToType(kv.getType()),kv.getBuffer(),kv.getValueOffset(),kv.getValueLength());
      }
    }
    if (kv.isDelete()) {
      if (delete == null) {
        delete=new Delete(key.get());
      }
      delete.addDeleteMarker(kv);
    }
 else {
      if (put == null) {
        put=new Put(key.get());
      }
      put.add(kv);
    }
  }
  if (put != null) {
    context.write(key,put);
  }
  if (delete != null) {
    context.write(key,delete);
  }
}
