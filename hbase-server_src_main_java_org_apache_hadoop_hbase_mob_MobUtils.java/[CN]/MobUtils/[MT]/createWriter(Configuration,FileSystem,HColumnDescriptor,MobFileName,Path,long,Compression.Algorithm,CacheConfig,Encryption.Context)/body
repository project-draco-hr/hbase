{
  HFileContext hFileContext=new HFileContextBuilder().withCompression(compression).withIncludesMvcc(true).withIncludesTags(true).withChecksumType(ChecksumType.getDefaultChecksumType()).withBytesPerCheckSum(HFile.DEFAULT_BYTES_PER_CHECKSUM).withBlockSize(family.getBlocksize()).withHBaseCheckSum(true).withDataBlockEncoding(family.getDataBlockEncoding()).withEncryptionContext(cryptoContext).build();
  StoreFile.Writer w=new StoreFile.WriterBuilder(conf,cacheConfig,fs).withFilePath(new Path(basePath,mobFileName.getFileName())).withComparator(CellComparator.COMPARATOR).withBloomType(BloomType.NONE).withMaxKeyCount(maxKeyCount).withFileContext(hFileContext).build();
  return w;
}
