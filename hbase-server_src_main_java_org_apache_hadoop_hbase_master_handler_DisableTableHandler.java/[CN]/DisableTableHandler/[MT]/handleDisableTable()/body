{
  this.assignmentManager.getTableStateManager().setTableState(this.tableName,ZooKeeperProtos.Table.State.DISABLING);
  boolean done=false;
  while (true) {
    final List<HRegionInfo> regions=this.assignmentManager.getRegionStates().getRegionsOfTable(tableName);
    if (regions.size() == 0) {
      done=true;
      break;
    }
    LOG.info("Offlining " + regions.size() + " regions.");
    BulkDisabler bd=new BulkDisabler(this.server,regions);
    try {
      if (bd.bulkAssign()) {
        done=true;
        break;
      }
    }
 catch (    InterruptedException e) {
      LOG.warn("Disable was interrupted");
      Thread.currentThread().interrupt();
      break;
    }
  }
  if (done)   this.assignmentManager.getTableStateManager().setTableState(this.tableName,ZooKeeperProtos.Table.State.DISABLED);
  LOG.info("Disabled table, " + this.tableName + ", is done="+ done);
}
