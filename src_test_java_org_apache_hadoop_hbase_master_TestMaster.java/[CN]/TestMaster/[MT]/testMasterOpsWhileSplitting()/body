{
  MiniHBaseCluster cluster=TEST_UTIL.getHBaseCluster();
  HMaster m=cluster.getMaster();
  HBaseAdmin admin=TEST_UTIL.getHBaseAdmin();
  TEST_UTIL.createTable(TABLENAME,FAMILYNAME);
  TEST_UTIL.loadTable(new HTable(TABLENAME),FAMILYNAME);
  CountDownLatch aboutToOpen=new CountDownLatch(1);
  CountDownLatch proceed=new CountDownLatch(1);
  RegionOpenListener list=new RegionOpenListener(aboutToOpen,proceed);
  HBaseEventHandler.registerListener(list);
  admin.split(TABLENAME);
  aboutToOpen.await(60,TimeUnit.SECONDS);
  try {
    m.getTableRegions(TABLENAME);
    Pair<HRegionInfo,HServerAddress> pair=m.getTableRegionClosest(TABLENAME,Bytes.toBytes("cde"));
    m.getTableRegionFromName(pair.getFirst().getRegionName());
  }
  finally {
    proceed.countDown();
  }
}
