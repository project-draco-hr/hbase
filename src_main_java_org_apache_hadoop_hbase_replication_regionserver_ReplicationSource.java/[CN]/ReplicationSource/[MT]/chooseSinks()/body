{
  this.currentPeers.clear();
  List<ServerName> addresses=this.zkHelper.getSlavesAddresses(peerClusterId);
  Set<HServerAddress> setOfAddr=new HashSet<HServerAddress>();
  int nbPeers=(int)(Math.ceil(addresses.size() * ratio));
  LOG.info("Getting " + nbPeers + " rs from peer cluster # "+ peerClusterId);
  for (int i=0; i < nbPeers; i++) {
    HServerAddress address;
    do {
      ServerName sn=addresses.get(this.random.nextInt(addresses.size()));
      address=new HServerAddress(sn.getHostname(),sn.getPort());
    }
 while (setOfAddr.contains(address));
    LOG.info("Choosing peer " + address);
    setOfAddr.add(address);
  }
  this.currentPeers.addAll(setOfAddr);
}
