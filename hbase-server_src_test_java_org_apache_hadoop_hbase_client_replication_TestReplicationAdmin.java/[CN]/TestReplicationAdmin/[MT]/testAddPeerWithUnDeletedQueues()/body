{
  Configuration conf=TEST_UTIL.getConfiguration();
  ZooKeeperWatcher zkw=new ZooKeeperWatcher(conf,"Test HBaseAdmin",null);
  ReplicationQueues repQueues=ReplicationFactory.getReplicationQueues(zkw,conf,null);
  repQueues.init("server1");
  repQueues.addLog(ID_ONE,"file1");
  try {
    admin.addPeer(ID_ONE,KEY_ONE);
    fail();
  }
 catch (  ReplicationException e) {
  }
  repQueues.removeQueue(ID_ONE);
  assertEquals(0,repQueues.getAllQueues().size());
  repQueues.addLog(ID_ONE + "-server2","file1");
  try {
    admin.addPeer(ID_ONE,KEY_ONE);
    fail();
  }
 catch (  ReplicationException e) {
  }
  repQueues.removeAllQueues();
  zkw.close();
}
