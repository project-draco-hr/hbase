{
  TableName testName=TableName.valueOf("testReadPointAndPartialResults");
  int numRows=5;
  int numFamilies=5;
  int numQualifiers=5;
  byte[][] rows=HTestConst.makeNAscii(Bytes.toBytes("testRow"),numRows);
  byte[][] families=HTestConst.makeNAscii(Bytes.toBytes("testFamily"),numFamilies);
  byte[][] qualifiers=HTestConst.makeNAscii(Bytes.toBytes("testQualifier"),numQualifiers);
  byte[] value=Bytes.createMaxByteArray(100);
  Table tmpTable=createTestTable(testName,rows,families,qualifiers,value);
  Scan scan=new Scan();
  scan.setMaxResultSize(1);
  scan.setAllowPartialResults(true);
  ResultScanner scanner=tmpTable.getScanner(scan);
  Delete delete1=new Delete(rows[0]);
  delete1.addColumn(families[0],qualifiers[0],0);
  tmpTable.delete(delete1);
  Delete delete2=new Delete(rows[1]);
  delete2.addColumn(families[1],qualifiers[1],1);
  tmpTable.delete(delete2);
  int scannerCount=countCellsFromScanner(scanner);
  int expectedCount=numRows * numFamilies * numQualifiers;
  assertTrue("scannerCount: " + scannerCount + " expectedCount: "+ expectedCount,scannerCount == expectedCount);
  scanner=tmpTable.getScanner(scan);
  scannerCount=countCellsFromScanner(scanner);
  expectedCount=numRows * numFamilies * numQualifiers - 2;
  assertTrue("scannerCount: " + scannerCount + " expectedCount: "+ expectedCount,scannerCount == expectedCount);
  scanner=tmpTable.getScanner(scan);
  Put put1=new Put(rows[0]);
  put1.add(new KeyValue(rows[0],families[0],qualifiers[0],1,value));
  tmpTable.put(put1);
  Put put2=new Put(rows[1]);
  put2.add(new KeyValue(rows[1],families[1],qualifiers[1],2,value));
  tmpTable.put(put2);
  scannerCount=countCellsFromScanner(scanner);
  expectedCount=numRows * numFamilies * numQualifiers - 2;
  assertTrue("scannerCount: " + scannerCount + " expectedCount: "+ expectedCount,scannerCount == expectedCount);
  scanner=tmpTable.getScanner(scan);
  scannerCount=countCellsFromScanner(scanner);
  expectedCount=numRows * numFamilies * numQualifiers;
  assertTrue("scannerCount: " + scannerCount + " expectedCount: "+ expectedCount,scannerCount == expectedCount);
  TEST_UTIL.deleteTable(testName);
}
