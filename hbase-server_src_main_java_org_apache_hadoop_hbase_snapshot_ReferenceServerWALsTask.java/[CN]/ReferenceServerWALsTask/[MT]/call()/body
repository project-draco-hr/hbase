{
  FileStatus[] serverLogs=FSUtils.listStatus(fs,logDir,null);
  if (serverLogs == null) {
    LOG.debug("No logs for server directory:" + logDir + ", done referencing files.");
    return null;
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("Adding references for WAL files:" + Arrays.toString(serverLogs));
  }
  for (  FileStatus file : serverLogs) {
    this.rethrowException();
    Path rootDir=FSUtils.getRootDir(conf);
    Path snapshotDir=SnapshotDescriptionUtils.getWorkingSnapshotDir(this.snapshot,rootDir);
    Path snapshotLogDir=TakeSnapshotUtils.getSnapshotHLogsDir(snapshotDir,serverName);
    Path ref=new Path(snapshotLogDir,file.getPath().getName());
    if (!fs.createNewFile(ref)) {
      if (!fs.exists(ref)) {
        throw new IOException("Couldn't create reference for:" + file.getPath());
      }
    }
    LOG.debug("Completed WAL referencing for: " + file.getPath() + " to "+ ref);
  }
  LOG.debug("Successfully completed WAL referencing for ALL files");
  return null;
}
