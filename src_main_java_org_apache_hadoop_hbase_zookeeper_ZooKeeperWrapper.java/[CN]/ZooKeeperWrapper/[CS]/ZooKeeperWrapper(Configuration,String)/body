{
  this.instanceName=instanceName;
  Properties properties=HQuorumPeer.makeZKProps(conf);
  quorumServers=HQuorumPeer.getZKQuorumServersString(properties);
  if (quorumServers == null) {
    throw new IOException("Could not read quorum servers from " + HConstants.ZOOKEEPER_CONFIG_NAME);
  }
  sessionTimeout=conf.getInt("zookeeper.session.timeout",60 * 1000);
  reconnectToZk();
  parentZNode=conf.get(HConstants.ZOOKEEPER_ZNODE_PARENT,HConstants.DEFAULT_ZOOKEEPER_ZNODE_PARENT);
  String rootServerZNodeName=conf.get("zookeeper.znode.rootserver","root-region-server");
  String rsZNodeName=conf.get("zookeeper.znode.rs","rs");
  String masterAddressZNodeName=conf.get("zookeeper.znode.master","master");
  String stateZNodeName=conf.get("zookeeper.znode.state","shutdown");
  String regionsInTransitZNodeName=conf.get("zookeeper.znode.regionInTransition","UNASSIGNED");
  rootRegionZNode=getZNode(parentZNode,rootServerZNodeName);
  rsZNode=getZNode(parentZNode,rsZNodeName);
  rgnsInTransitZNode=getZNode(parentZNode,regionsInTransitZNodeName);
  masterElectionZNode=getZNode(parentZNode,masterAddressZNodeName);
  clusterStateZNode=getZNode(parentZNode,stateZNodeName);
}
