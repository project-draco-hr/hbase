{
  try {
    String fullyQualifiedZNodeName=getZNode(parentZNode,znodeName);
    zooKeeper.setData(fullyQualifiedZNodeName,data,version);
    if (watch) {
      zooKeeper.getData(fullyQualifiedZNodeName,this,null);
    }
    return true;
  }
 catch (  InterruptedException e) {
    LOG.warn("<" + instanceName + ">"+ "Failed to write data to ZooKeeper",e);
    throw new IOException(e);
  }
catch (  KeeperException e) {
    LOG.warn("<" + instanceName + ">"+ "Failed to write data to ZooKeeper",e);
    throw new IOException(e);
  }
}
