{
  if (getInstance(conf,name) != null) {
    return getInstance(conf,name);
  }
  ZooKeeperWrapper.createLock.lock();
  try {
    if (getInstance(conf,name) == null) {
      try {
        String fullname=getZookeeperClusterKey(conf,name);
        ZooKeeperWrapper instance=new ZooKeeperWrapper(conf,fullname);
        INSTANCES.put(fullname,instance);
      }
 catch (      Exception e) {
        LOG.error("<" + name + ">"+ "Error creating a ZooKeeperWrapper "+ e);
      }
    }
  }
  finally {
    createLock.unlock();
  }
  return getInstance(conf,name);
}
