{
  LOG.debug("<" + instanceName + ">"+ "Writing master address "+ address.toString()+ " to znode "+ masterElectionZNode);
  if (!ensureParentExists(masterElectionZNode)) {
    return false;
  }
  LOG.debug("<" + instanceName + ">"+ "Znode exists : "+ masterElectionZNode);
  String addressStr=address.toString();
  byte[] data=Bytes.toBytes(addressStr);
  try {
    zooKeeper.create(masterElectionZNode,data,Ids.OPEN_ACL_UNSAFE,CreateMode.EPHEMERAL);
    LOG.debug("<" + instanceName + ">"+ "Wrote master address "+ address+ " to ZooKeeper");
    return true;
  }
 catch (  InterruptedException e) {
    LOG.warn("<" + instanceName + ">"+ "Failed to write master address "+ address+ " to ZooKeeper",e);
  }
catch (  KeeperException e) {
    LOG.warn("<" + instanceName + ">"+ "Failed to write master address "+ address+ " to ZooKeeper",e);
  }
  return false;
}
