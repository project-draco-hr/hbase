{
  if (args.length != 2) {
    usage();
    return -1;
  }
  initialize();
  try (Connection connection=ConnectionFactory.createConnection(getConf());Admin admin=connection.getAdmin()){
    String dirPath=args[0];
    TableName tableName=TableName.valueOf(args[1]);
    boolean tableExists=admin.tableExists(tableName);
    if (!tableExists) {
      if ("yes".equalsIgnoreCase(getConf().get(CREATE_TABLE_CONF_KEY,"yes"))) {
        this.createTable(tableName,dirPath,admin);
      }
 else {
        String errorMsg=format("Table '%s' does not exist.",tableName);
        LOG.error(errorMsg);
        throw new TableNotFoundException(errorMsg);
      }
    }
    Path hfofDir=new Path(dirPath);
    try (Table table=connection.getTable(tableName);RegionLocator locator=connection.getRegionLocator(tableName)){
      doBulkLoad(hfofDir,admin,table,locator);
    }
   }
   return 0;
}
