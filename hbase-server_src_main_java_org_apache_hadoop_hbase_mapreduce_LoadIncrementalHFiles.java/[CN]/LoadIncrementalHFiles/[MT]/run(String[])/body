{
  if (args.length != 2) {
    usage();
    return -1;
  }
  initialize();
  String dirPath=args[0];
  TableName tableName=TableName.valueOf(args[1]);
  boolean tableExists=this.doesTableExist(tableName);
  if (!tableExists) {
    if ("yes".equalsIgnoreCase(getConf().get(CREATE_TABLE_CONF_KEY,"yes"))) {
      this.createTable(tableName,dirPath);
    }
 else {
      String errorMsg=format("Table '%s' does not exist.",tableName);
      LOG.error(errorMsg);
      throw new TableNotFoundException(errorMsg);
    }
  }
  Path hfofDir=new Path(dirPath);
  try (Connection connection=ConnectionFactory.createConnection(getConf());HTable table=(HTable)connection.getTable(tableName)){
    doBulkLoad(hfofDir,table);
  }
   return 0;
}
