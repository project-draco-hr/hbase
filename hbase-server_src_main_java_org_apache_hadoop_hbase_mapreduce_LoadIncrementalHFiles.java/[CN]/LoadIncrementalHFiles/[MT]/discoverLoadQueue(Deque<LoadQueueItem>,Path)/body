{
  fs=hfofDir.getFileSystem(getConf());
  if (!fs.exists(hfofDir)) {
    throw new FileNotFoundException("HFileOutputFormat dir " + hfofDir + " not found");
  }
  FileStatus[] familyDirStatuses=fs.listStatus(hfofDir);
  if (familyDirStatuses == null) {
    throw new FileNotFoundException("No families found in " + hfofDir);
  }
  for (  FileStatus stat : familyDirStatuses) {
    if (!stat.isDirectory()) {
      LOG.warn("Skipping non-directory " + stat.getPath());
      continue;
    }
    Path familyDir=stat.getPath();
    if (familyDir.getName().startsWith("_"))     continue;
    byte[] family=familyDir.getName().getBytes();
    Path[] hfiles=FileUtil.stat2Paths(fs.listStatus(familyDir));
    for (    Path hfile : hfiles) {
      String fileName=hfile.getName();
      if (fileName.startsWith("_"))       continue;
      if (StoreFileInfo.isReference(fileName)) {
        LOG.warn("Skipping reference " + fileName);
        continue;
      }
      if (HFileLink.isHFileLink(fileName)) {
        LOG.warn("Skipping HFileLink " + fileName);
        continue;
      }
      ret.add(new LoadQueueItem(family,hfile));
    }
  }
}
