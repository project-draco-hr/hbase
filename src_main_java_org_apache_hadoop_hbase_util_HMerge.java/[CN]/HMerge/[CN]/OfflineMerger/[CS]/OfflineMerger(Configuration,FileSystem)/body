{
  super(conf,fs,HConstants.META_TABLE_NAME);
  Path rootTableDir=HTableDescriptor.getTableDir(fs.makeQualified(new Path(conf.get(HConstants.HBASE_DIR))),HConstants.ROOT_TABLE_NAME);
  root=HRegion.newHRegion(rootTableDir,hlog,fs,conf,HRegionInfo.ROOT_REGIONINFO,HTableDescriptor.ROOT_TABLEDESC,null);
  root.initialize();
  Scan scan=new Scan();
  scan.addColumn(HConstants.CATALOG_FAMILY,HConstants.REGIONINFO_QUALIFIER);
  InternalScanner rootScanner=root.getScanner(scan);
  try {
    List<KeyValue> results=new ArrayList<KeyValue>();
    boolean hasMore;
    do {
      hasMore=rootScanner.next(results);
      for (      KeyValue kv : results) {
        HRegionInfo info=Writables.getHRegionInfoOrNull(kv.getValue());
        if (info != null) {
          metaRegions.add(info);
        }
      }
    }
 while (hasMore);
  }
  finally {
    rootScanner.close();
    try {
      root.close();
    }
 catch (    IOException e) {
      LOG.error(e);
    }
  }
}
