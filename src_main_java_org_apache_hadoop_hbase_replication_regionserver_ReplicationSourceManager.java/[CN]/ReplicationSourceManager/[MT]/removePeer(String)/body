{
  LOG.info("Closing the following queue " + id + ", currently have "+ sources.size()+ " and another "+ oldsources.size()+ " that were recovered");
  ReplicationSourceInterface srcToRemove=null;
  List<ReplicationSourceInterface> oldSourcesToDelete=new ArrayList<ReplicationSourceInterface>();
  for (  ReplicationSourceInterface src : oldsources) {
    if (id.equals(src.getPeerClusterId())) {
      oldSourcesToDelete.add(src);
    }
  }
  for (  ReplicationSourceInterface src : oldSourcesToDelete) {
    closeRecoveredQueue((src));
  }
  LOG.info("Number of deleted recovered sources for " + id + ": "+ oldSourcesToDelete.size());
  for (  ReplicationSourceInterface src : this.sources) {
    if (id.equals(src.getPeerClusterId())) {
      srcToRemove=src;
      break;
    }
  }
  if (srcToRemove == null) {
    LOG.error("The queue we wanted to close is missing " + id);
    return;
  }
  srcToRemove.terminate("Replication stream was removed by a user");
  this.sources.remove(srcToRemove);
  this.zkHelper.deleteSource(id,true);
}
