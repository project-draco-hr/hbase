{
  byte[] indexRow=indexSpec.getKeyGenerator().createIndexKey(row,columnValues);
  Put update=new Put(indexRow);
  update.add(IndexedTable.INDEX_COL_FAMILY_NAME,IndexedTable.INDEX_BASE_ROW,row);
  try {
    for (    byte[] col : indexSpec.getIndexedColumns()) {
      byte[] val=columnValues.get(col);
      if (val == null) {
        throw new RuntimeException("Unexpected missing column value. [" + Bytes.toString(col) + "]");
      }
      byte[][] colSeparated=KeyValue.parseColumn(col);
      if (colSeparated.length == 1) {
        throw new ColumnNameParseException("Expected family:qualifier but only got a family");
      }
      update.add(colSeparated[0],colSeparated[1],val);
    }
    for (    byte[] col : indexSpec.getAdditionalColumns()) {
      byte[] val=columnValues.get(col);
      if (val != null) {
        byte[][] colSeparated=KeyValue.parseColumn(col);
        if (colSeparated.length == 1) {
          throw new ColumnNameParseException("Expected family:qualifier but only got a family");
        }
        update.add(colSeparated[0],colSeparated[1],val);
      }
    }
  }
 catch (  ColumnNameParseException e) {
    throw new RuntimeException(e);
  }
  return update;
}
