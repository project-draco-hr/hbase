{
  Scan scan=new Scan();
  scan.setMaxVersions(store.getFamily().getMaxVersions());
  if (scanType == ScanType.COMPACT_DROP_DELETES) {
    scanType=ScanType.COMPACT_RETAIN_DELETES;
    return new MobCompactionStoreScanner(store,store.getScanInfo(),scan,scanners,scanType,smallestReadPoint,earliestPutTs,true);
  }
 else {
    return new MobCompactionStoreScanner(store,store.getScanInfo(),scan,scanners,scanType,smallestReadPoint,earliestPutTs,false);
  }
}
