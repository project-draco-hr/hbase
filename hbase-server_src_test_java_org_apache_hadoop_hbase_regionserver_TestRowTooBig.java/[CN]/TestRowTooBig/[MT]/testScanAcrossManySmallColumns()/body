{
  byte[] row1=Bytes.toBytes("row1");
  byte[] fam1=Bytes.toBytes("fam1");
  HTableDescriptor htd=TEST_HTD;
  HColumnDescriptor hcd=new HColumnDescriptor(fam1);
  if (htd.hasFamily(hcd.getName())) {
    htd.modifyFamily(hcd);
  }
 else {
    htd.addFamily(hcd);
  }
  final HRegionInfo hri=new HRegionInfo(htd.getTableName(),HConstants.EMPTY_END_ROW,HConstants.EMPTY_END_ROW);
  HRegion region=HTU.createLocalHRegion(hri,htd);
  for (int i=0; i < 10; i++) {
    Put put=new Put(row1);
    for (int j=0; j < 10 * 10000; j++) {
      put.add(fam1,Bytes.toBytes("col_" + i + "_"+ j),new byte[10]);
    }
    region.put(put);
    region.flushcache();
  }
  region.compactStores(true);
  Get get=new Get(row1);
  region.get(get);
}
