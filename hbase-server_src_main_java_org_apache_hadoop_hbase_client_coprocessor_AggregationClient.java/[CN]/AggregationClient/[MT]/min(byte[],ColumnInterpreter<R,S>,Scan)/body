{
  validateParameters(scan);
class MinCallBack implements Batch.Callback<R> {
    private R min=null;
    public R getMinimum(){
      return min;
    }
    @Override public synchronized void update(    byte[] region,    byte[] row,    R result){
      min=(min == null || (result != null && ci.compare(result,min) < 0)) ? result : min;
    }
  }
  MinCallBack minCallBack=new MinCallBack();
  HTable table=null;
  try {
    table=new HTable(conf,tableName);
    table.coprocessorExec(AggregateProtocol.class,scan.getStartRow(),scan.getStopRow(),new Batch.Call<AggregateProtocol,R>(){
      @Override public R call(      AggregateProtocol instance) throws IOException {
        return instance.getMin(ci,scan);
      }
    }
,minCallBack);
  }
  finally {
    if (table != null) {
      table.close();
    }
  }
  log.debug("Min fom all regions is: " + minCallBack.getMinimum());
  return minCallBack.getMinimum();
}
