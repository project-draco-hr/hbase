{
  TableName.isLegalTableQualifierName(Bytes.toBytes(snapshot.getName()));
  if (snapshot.hasTable()) {
    TableName tableName=TableName.valueOf(snapshot.getTable());
    if (HTableDescriptor.isSystemTable(tableName)) {
      throw new IllegalArgumentException("System table snapshots are not allowed");
    }
  }
}
