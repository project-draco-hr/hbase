{
  long maxSize=100000;
  long blockSize=calculateBlockSizeDefault(maxSize,10);
  LruBlockCache cache=new LruBlockCache(maxSize,blockSize,false);
  CachedItem[] blocks=generateFixedBlocks(10,blockSize,"block");
  long expectedCacheSize=cache.heapSize();
  for (  CachedItem block : blocks) {
    cache.cacheBlock(block.blockName,block);
    expectedCacheSize+=block.cacheBlockHeapSize();
  }
  assertEquals(1,cache.getEvictionCount());
  assertTrue(expectedCacheSize > (maxSize * LruBlockCache.DEFAULT_ACCEPTABLE_FACTOR));
  assertTrue(cache.heapSize() < maxSize);
  assertTrue(cache.heapSize() < (maxSize * LruBlockCache.DEFAULT_ACCEPTABLE_FACTOR));
  assertTrue(cache.getBlock(blocks[0].blockName,true) == null);
  assertTrue(cache.getBlock(blocks[1].blockName,true) == null);
  for (int i=2; i < blocks.length; i++) {
    assertEquals(cache.getBlock(blocks[i].blockName,true),blocks[i]);
  }
}
