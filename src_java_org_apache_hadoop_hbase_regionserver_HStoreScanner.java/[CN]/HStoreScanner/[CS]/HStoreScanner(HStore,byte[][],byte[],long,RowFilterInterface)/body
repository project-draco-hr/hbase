{
  this.store=store;
  this.dataFilter=filter;
  if (null != dataFilter) {
    dataFilter.reset();
  }
  this.scanners=new InternalScanner[2];
  this.resultSets=new TreeMap[scanners.length];
  this.keys=new HStoreKey[scanners.length];
  this.timestamp=timestamp;
  this.targetCols=targetCols;
  try {
    scanners[MEMS_INDEX]=store.memcache.getScanner(timestamp,targetCols,firstRow);
    scanners[HSFS_INDEX]=new StoreFileScanner(store,timestamp,targetCols,firstRow);
    for (int i=MEMS_INDEX; i < scanners.length; i++) {
      checkScannerFlags(i);
    }
  }
 catch (  IOException e) {
    doClose();
    throw e;
  }
  for (int i=MEMS_INDEX; i < scanners.length; i++) {
    setupScanner(i);
  }
  this.store.addChangedReaderObserver(this);
}
