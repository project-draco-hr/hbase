{
  String familyName=dstFamilyPath.getName();
  String regionName=dstFamilyPath.getParent().getName();
  String tableName=dstFamilyPath.getParent().getParent().getName();
  String name=createHFileLinkName(hfileRegionInfo,hfileName);
  String refName=createBackReferenceName(tableName,regionName);
  fs.mkdirs(dstFamilyPath);
  Path archiveStoreDir=HFileArchiveUtil.getStoreArchivePath(conf,hfileRegionInfo.getTableNameAsString(),hfileRegionInfo.getEncodedName(),familyName);
  Path backRefssDir=getBackReferencesDir(archiveStoreDir,hfileName);
  fs.mkdirs(backRefssDir);
  Path backRefPath=new Path(backRefssDir,refName);
  fs.createNewFile(backRefPath);
  try {
    return fs.createNewFile(new Path(dstFamilyPath,name));
  }
 catch (  IOException e) {
    LOG.error("couldn't create the link=" + name + " for "+ dstFamilyPath,e);
    fs.delete(backRefPath,false);
    throw e;
  }
}
