{
  this.reader=reader;
  totalByteSize=meta.readLong();
  hashCount=meta.readInt();
  hashType=meta.readInt();
  totalKeyCount=meta.readLong();
  totalMaxKeys=meta.readLong();
  numChunks=meta.readInt();
  comparator=FixedFileTrailer.createComparator(Bytes.toString(Bytes.readByteArray(meta)));
  hash=Hash.getInstance(hashType);
  if (hash == null) {
    throw new IllegalArgumentException("Invalid hash type: " + hashType);
  }
  index=new HFileBlockIndex.BlockIndexReader(comparator,1);
  index.readRootIndex(meta,numChunks);
}
