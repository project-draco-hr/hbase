{
  this.regionWrapper=regionWrapper;
  agg=aggregate;
  agg.register(this);
  LOG.debug("Creating new MetricsRegionSourceImpl for table " + regionWrapper.getTableName() + " "+ regionWrapper.getRegionName());
  registry=agg.getMetricsRegistry();
  regionNamePrefix="Namespace_" + regionWrapper.getNamespace() + "_table_"+ regionWrapper.getTableName()+ "_region_"+ regionWrapper.getRegionName()+ "_metric_";
  String suffix="Count";
  regionPutKey=regionNamePrefix + MetricsRegionServerSource.MUTATE_KEY + suffix;
  regionPut=registry.getLongCounter(regionPutKey,0L);
  regionDeleteKey=regionNamePrefix + MetricsRegionServerSource.DELETE_KEY + suffix;
  regionDelete=registry.getLongCounter(regionDeleteKey,0L);
  regionIncrementKey=regionNamePrefix + MetricsRegionServerSource.INCREMENT_KEY + suffix;
  regionIncrement=registry.getLongCounter(regionIncrementKey,0L);
  regionAppendKey=regionNamePrefix + MetricsRegionServerSource.APPEND_KEY + suffix;
  regionAppend=registry.getLongCounter(regionAppendKey,0L);
  regionGetKey=regionNamePrefix + MetricsRegionServerSource.GET_KEY;
  regionGet=registry.newTimeHistogram(regionGetKey);
  regionScanNextKey=regionNamePrefix + MetricsRegionServerSource.SCAN_NEXT_KEY;
  regionScanNext=registry.newTimeHistogram(regionScanNextKey);
  hashCode=regionWrapper.getRegionHashCode();
}
