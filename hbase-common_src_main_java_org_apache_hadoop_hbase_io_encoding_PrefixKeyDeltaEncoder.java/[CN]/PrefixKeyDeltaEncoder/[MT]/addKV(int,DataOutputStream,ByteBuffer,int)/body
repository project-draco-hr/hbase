{
  int keyLength=in.getInt();
  int valueLength=in.getInt();
  if (prevKeyOffset == -1) {
    ByteBufferUtils.putCompressedInt(out,keyLength);
    ByteBufferUtils.putCompressedInt(out,valueLength);
    ByteBufferUtils.putCompressedInt(out,0);
    ByteBufferUtils.moveBufferToStream(out,in,keyLength + valueLength);
  }
 else {
    int common=ByteBufferUtils.findCommonPrefix(in,prevKeyOffset + KeyValue.ROW_OFFSET,in.position(),Math.min(prevKeyLength,keyLength));
    ByteBufferUtils.putCompressedInt(out,keyLength - common);
    ByteBufferUtils.putCompressedInt(out,valueLength);
    ByteBufferUtils.putCompressedInt(out,common);
    ByteBufferUtils.skip(in,common);
    ByteBufferUtils.moveBufferToStream(out,in,keyLength - common + valueLength);
  }
  return keyLength;
}
