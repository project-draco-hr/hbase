{
  buf.rewind();
  sanityCheckAssertion(BlockType.read(buf),blockType);
  sanityCheckAssertion(buf.getInt(),onDiskSizeWithoutHeader,"onDiskSizeWithoutHeader");
  sanityCheckAssertion(buf.getInt(),uncompressedSizeWithoutHeader,"uncompressedSizeWithoutHeader");
  sanityCheckAssertion(buf.getLong(),prevBlockOffset,"prevBlocKOffset");
  if (this.fileContext.isUseHBaseChecksum()) {
    sanityCheckAssertion(buf.get(),this.fileContext.getChecksumType().getCode(),"checksumType");
    sanityCheckAssertion(buf.getInt(),this.fileContext.getBytesPerChecksum(),"bytesPerChecksum");
    sanityCheckAssertion(buf.getInt(),onDiskDataSizeWithHeader,"onDiskDataSizeWithHeader");
  }
  int cksumBytes=totalChecksumBytes();
  int expectedBufLimit=onDiskDataSizeWithHeader + cksumBytes;
  if (buf.limit() != expectedBufLimit) {
    throw new AssertionError("Expected buffer limit " + expectedBufLimit + ", got "+ buf.limit());
  }
  int hdrSize=headerSize();
  if (buf.capacity() != expectedBufLimit && buf.capacity() != expectedBufLimit + hdrSize) {
    throw new AssertionError("Invalid buffer capacity: " + buf.capacity() + ", expected "+ expectedBufLimit+ " or "+ (expectedBufLimit + hdrSize));
  }
}
