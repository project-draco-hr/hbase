{
  int cksumBytes=totalChecksumBytes();
  int headerSize=headerSize();
  int capacityNeeded=headerSize + uncompressedSizeWithoutHeader + cksumBytes+ (hasNextBlockHeader() ? headerSize : 0);
  ByteBuffer newBuf=ByteBuffer.allocate(capacityNeeded);
  ByteBuffer dup=buf.duplicate();
  dup.position(0);
  dup.get(newBuf.array(),newBuf.arrayOffset(),headerSize);
  buf=newBuf;
  buf.limit(headerSize + uncompressedSizeWithoutHeader + cksumBytes);
}
