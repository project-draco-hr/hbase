{
  this.dataBlockEncoder=dataBlockEncoder != null ? dataBlockEncoder : NoOpDataBlockEncoder.INSTANCE;
  defaultBlockEncodingCtx=new HFileBlockDefaultEncodingContext(null,HConstants.HFILEBLOCK_DUMMY_HEADER,fileContext);
  dataBlockEncodingCtx=this.dataBlockEncoder.newOnDiskDataBlockEncodingContext(HConstants.HFILEBLOCK_DUMMY_HEADER,fileContext);
  if (fileContext.getBytesPerChecksum() < HConstants.HFILEBLOCK_HEADER_SIZE) {
    throw new RuntimeException("Unsupported value of bytesPerChecksum. " + " Minimum is " + HConstants.HFILEBLOCK_HEADER_SIZE + " but the configured value is "+ fileContext.getBytesPerChecksum());
  }
  baosInMemory=new ByteArrayOutputStream();
  prevOffsetByType=new long[BlockType.values().length];
  for (int i=0; i < prevOffsetByType.length; ++i)   prevOffsetByType[i]=-1;
  this.fileContext=fileContext;
}
