{
  this.dataBlockEncoder=dataBlockEncoder != null ? dataBlockEncoder : NoOpDataBlockEncoder.INSTANCE;
  defaultBlockEncodingCtx=new HFileBlockDefaultEncodingContext(compressionAlgorithm,null,HConstants.HFILEBLOCK_DUMMY_HEADER);
  dataBlockEncodingCtx=this.dataBlockEncoder.newOnDiskDataBlockEncodingContext(compressionAlgorithm,HConstants.HFILEBLOCK_DUMMY_HEADER);
  if (bytesPerChecksum < HConstants.HFILEBLOCK_HEADER_SIZE) {
    throw new RuntimeException("Unsupported value of bytesPerChecksum. " + " Minimum is " + HConstants.HFILEBLOCK_HEADER_SIZE + " but the configured value is "+ bytesPerChecksum);
  }
  baosInMemory=new ByteArrayOutputStream();
  prevOffsetByType=new long[BlockType.values().length];
  for (int i=0; i < prevOffsetByType.length; ++i)   prevOffsetByType[i]=-1;
  this.includesMemstoreTS=includesMemstoreTS;
  this.checksumType=checksumType;
  this.bytesPerChecksum=bytesPerChecksum;
}
