{
  HBaseAdmin admin=this.context.getHaseIntegrationTestingUtility().getHBaseAdmin();
  List<HRegionInfo> regions=admin.getTableRegions(tableNameBytes);
  Collection<ServerName> serversList=admin.getClusterStatus().getServers();
  ServerName[] servers=serversList.toArray(new ServerName[serversList.size()]);
  for (  HRegionInfo regionInfo : regions) {
    try {
      byte[] destServerName=Bytes.toBytes(servers[RandomUtils.nextInt(servers.length)].getServerName());
      admin.move(regionInfo.getRegionName(),destServerName);
    }
 catch (    Exception e) {
      LOG.debug("Error moving region",e);
    }
  }
  if (sleepTime > 0) {
    Thread.sleep(sleepTime);
  }
}
