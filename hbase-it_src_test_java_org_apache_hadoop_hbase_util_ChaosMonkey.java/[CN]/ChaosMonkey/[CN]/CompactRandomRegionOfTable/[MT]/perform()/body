{
  HBaseTestingUtility util=context.getHaseIntegrationTestingUtility();
  HBaseAdmin admin=util.getHBaseAdmin();
  List<HRegionInfo> regions=admin.getTableRegions(tableNameBytes);
  HRegionInfo region=selectRandomItem(regions.toArray(new HRegionInfo[regions.size()]));
  boolean major=RandomUtils.nextInt(100) < majorRatio;
  LOG.info("Performing action: Compact random region of table " + tableName + ", major="+ major+ ", region="+ region.getRegionNameAsString());
  if (major) {
    admin.majorCompact(region.getRegionName());
  }
 else {
    admin.compact(region.getRegionName());
  }
  if (sleepTime > 0) {
    Thread.sleep(sleepTime);
  }
}
