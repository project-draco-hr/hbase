{
  HBaseTestingUtility util=context.getHaseIntegrationTestingUtility();
  HBaseAdmin admin=util.getHBaseAdmin();
  List<HRegionInfo> regions=admin.getTableRegions(tableNameBytes);
  if (regions.size() < 2) {
    LOG.info("Table " + tableName + " doesn't have enough region to merge");
    return;
  }
  int i=RandomUtils.nextInt(regions.size() - 1);
  HRegionInfo a=regions.get(i++);
  HRegionInfo b=regions.get(i);
  admin.mergeRegions(a.getEncodedNameAsBytes(),b.getEncodedNameAsBytes(),false);
  if (sleepTime > 0) {
    Thread.sleep(sleepTime);
  }
}
