{
  String secondRelation=condition.get(Constants.JOIN_SECOND_RELATION);
  HColumnDescriptor[] firstColumns=null;
  HColumnDescriptor[] secondColumns=null;
  for (int i=0; i < tables.length; i++) {
    if (tables[i].getName().equals(new Text(input))) {
      firstColumns=tables[i].getFamilies().values().toArray(new HColumnDescriptor[]{});
    }
 else     if (tables[i].getName().equals(new Text(secondRelation))) {
      secondColumns=tables[i].getFamilies().values().toArray(new HColumnDescriptor[]{});
    }
  }
  String firstColumnsStr="";
  String secondColumnsStr="";
  for (int i=0; i < firstColumns.length; i++) {
    desc.addFamily(firstColumns[i]);
    firstColumnsStr+=firstColumns[i].getName() + " ";
  }
  for (int i=0; i < secondColumns.length; i++) {
    desc.addFamily(secondColumns[i]);
    secondColumnsStr+=secondColumns[i].getName() + " ";
  }
  admin.createTable(desc);
  IndexJoinMap.initJob(input,secondRelation,firstColumnsStr,secondColumnsStr,condition.get(Constants.RELATIONAL_JOIN),IndexJoinMap.class,jobConf);
  IndexJoinReduce.initJob(output,IndexJoinReduce.class,jobConf);
  return jobConf;
}
