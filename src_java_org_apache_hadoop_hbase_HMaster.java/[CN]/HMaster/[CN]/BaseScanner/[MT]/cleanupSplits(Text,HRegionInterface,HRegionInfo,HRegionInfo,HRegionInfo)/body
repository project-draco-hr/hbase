{
  boolean result=false;
  if (LOG.isDebugEnabled()) {
    LOG.debug("Checking " + info.getRegionName() + " to see if daughter "+ "splits still hold references");
  }
  boolean noReferencesA=splitA == null;
  boolean noReferencesB=splitB == null;
  if (!noReferencesA) {
    noReferencesA=hasReferences(metaRegionName,server,info.getRegionName(),splitA,COL_SPLITA);
  }
  if (!noReferencesB) {
    noReferencesB=hasReferences(metaRegionName,server,info.getRegionName(),splitB,COL_SPLITB);
  }
  if (!noReferencesA && !noReferencesB) {
    LOG.info("Deleting region " + info.getRegionName() + " because daughter splits no longer hold references");
    if (!HRegion.deleteRegion(fs,dir,info.getRegionName())) {
      LOG.warn("Deletion of " + info.getRegionName() + " failed");
    }
    BatchUpdate b=new BatchUpdate();
    long lockid=b.startUpdate(info.getRegionName());
    b.delete(lockid,COL_REGIONINFO);
    b.delete(lockid,COL_SERVER);
    b.delete(lockid,COL_STARTCODE);
    server.batchUpdate(metaRegionName,System.currentTimeMillis(),b);
    result=true;
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("Done checking " + info.getRegionName() + ": splitA: "+ noReferencesA+ ", splitB: "+ noReferencesB);
  }
  return result;
}
