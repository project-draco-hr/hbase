{
  boolean scannedRegion=false;
  HRegionInterface server=null;
  long scannerId=-1L;
  if (LOG.isDebugEnabled()) {
    LOG.debug("scanning meta region " + region.regionName);
  }
  try {
    server=client.getHRegionConnection(region.server);
    scannerId=server.openScanner(region.regionName,METACOLUMNS,FIRST_ROW);
    DataInputBuffer inbuf=new DataInputBuffer();
    while (true) {
      TreeMap<Text,byte[]> results=new TreeMap<Text,byte[]>();
      HStoreKey key=new HStoreKey();
      LabelledData[] values=server.next(scannerId,key);
      if (values.length == 0) {
        break;
      }
      for (int i=0; i < values.length; i++) {
        results.put(values[i].getLabel(),values[i].getData().get());
      }
      HRegionInfo info=getRegionInfo(COL_REGIONINFO,results,inbuf);
      String serverName=getServerName(COL_SERVER,results);
      long startCode=getStartCode(COL_STARTCODE,results);
      if (LOG.isDebugEnabled()) {
        LOG.debug("row: " + info.toString() + ", server: "+ serverName+ ", startCode: "+ startCode);
      }
      checkAssigned(info,serverName,startCode);
      scannedRegion=true;
    }
  }
  finally {
    try {
      if (scannerId != -1L) {
        server.close(scannerId);
      }
    }
 catch (    IOException e) {
      LOG.error(e);
    }
    scannerId=-1L;
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("scan of meta region " + region.regionName + " complete");
  }
  return scannedRegion;
}
