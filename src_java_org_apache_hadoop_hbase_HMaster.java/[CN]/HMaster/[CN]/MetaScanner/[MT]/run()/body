{
  while ((!closed)) {
    MetaRegion region=null;
    while (region == null) {
synchronized (metaRegionsToScan) {
        if (metaRegionsToScan.size() != 0) {
          region=metaRegionsToScan.remove(0);
        }
      }
      if (region == null) {
        try {
          metaRegionsToScan.wait();
        }
 catch (        InterruptedException e) {
        }
      }
    }
    scanRegion(region);
synchronized (knownMetaRegions) {
      knownMetaRegions.put(region.startKey,region);
      if (rootScanned && knownMetaRegions.size() == numMetaRegions) {
        allMetaRegionsScanned=true;
        allMetaRegionsScanned.notifyAll();
      }
    }
    do {
      try {
        Thread.sleep(metaRescanInterval);
      }
 catch (      InterruptedException ex) {
      }
      if (!allMetaRegionsScanned) {
        break;
      }
      Vector<MetaRegion> v=new Vector<MetaRegion>();
      v.addAll(knownMetaRegions.values());
      for (Iterator<MetaRegion> i=v.iterator(); i.hasNext(); ) {
        scanRegion(i.next());
      }
    }
 while (true);
  }
}
