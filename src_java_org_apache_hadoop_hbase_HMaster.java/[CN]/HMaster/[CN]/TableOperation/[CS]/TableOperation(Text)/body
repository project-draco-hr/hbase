{
  if (!isMasterRunning()) {
    throw new MasterNotRunningException();
  }
  this.metaRegions=new HashSet<MetaRegion>();
  this.tableName=tableName;
  this.unservedRegions=new HashSet<HRegionInfo>();
  if (metaScanner.waitForMetaRegionsOrClose()) {
    throw new MasterNotRunningException();
  }
  Text firstMetaRegion=null;
  if (onlineMetaRegions.size() == 1) {
    firstMetaRegion=onlineMetaRegions.firstKey();
  }
 else   if (onlineMetaRegions.containsKey(tableName)) {
    firstMetaRegion=tableName;
  }
 else {
    firstMetaRegion=onlineMetaRegions.headMap(tableName).lastKey();
  }
  this.metaRegions.addAll(onlineMetaRegions.tailMap(firstMetaRegion).values());
}
