{
  metaScanner.waitForMetaScan();
  LOG.debug("region closed: " + regionInfo.regionName);
  Text metaRegionName;
  HRegionInterface server;
  if (rootRegion) {
    metaRegionName=HGlobals.rootRegionInfo.regionName;
    waitForRootRegion();
    server=client.getHRegionConnection(rootRegionLocation);
  }
 else {
    Text metaStartRow=knownMetaRegions.headMap(regionInfo.regionName).lastKey();
    MetaRegion r=knownMetaRegions.get(metaStartRow);
    metaRegionName=r.regionName;
    server=client.getHRegionConnection(r.server);
  }
  long lockid=server.startUpdate(metaRegionName,clientId,regionInfo.regionName);
  server.delete(metaRegionName,clientId,lockid,META_COL_SERVER);
  server.delete(metaRegionName,clientId,lockid,META_COL_STARTCODE);
  server.commit(metaRegionName,clientId,lockid);
  if (reassignRegion) {
    LOG.debug("reassign region: " + regionInfo.regionName);
    unassignedRegions.put(regionInfo.regionName,regionInfo);
    assignAttempts.put(regionInfo.regionName,0L);
  }
}
