{
  if (LOG.isDebugEnabled()) {
    LOG.debug("Running ROOT scanner");
  }
  int tries=0;
  while (!closed && tries < numRetries) {
    try {
      if (waitForRootRegionOrClose()) {
        continue;
      }
synchronized (rootScannerLock) {
        rootScanned=false;
        MetaRegion mr=new MetaRegion();
        mr.regionName=HGlobals.rootRegionInfo.regionName;
        mr.server=HMaster.this.rootRegionLocation;
        mr.startKey=null;
        if (scanRegion(mr)) {
          numMetaRegions+=1;
        }
        rootScanned=true;
      }
      tries=0;
    }
 catch (    IOException e) {
      if (e instanceof RemoteException) {
        try {
          e=RemoteExceptionHandler.decodeRemoteException((RemoteException)e);
        }
 catch (        IOException ex) {
          LOG.warn(ex);
        }
      }
      tries++;
      if (tries < numRetries) {
        LOG.warn("ROOT scanner",e);
      }
 else {
        LOG.error("ROOT scanner",e);
        closed=true;
        break;
      }
    }
    try {
      Thread.sleep(metaRescanInterval);
    }
 catch (    InterruptedException e) {
    }
  }
  LOG.info("ROOT scanner exiting");
}
