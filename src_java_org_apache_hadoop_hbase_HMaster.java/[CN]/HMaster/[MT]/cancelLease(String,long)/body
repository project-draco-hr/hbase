{
  boolean leaseCancelled=false;
  HServerInfo info=serversToServerInfo.remove(serverName);
  if (rootRegionLocation.get() != null && info.getServerAddress().equals(rootRegionLocation.get())) {
    unassignRootRegion();
  }
  if (info != null) {
    LOG.info("Cancelling lease for " + serverName);
    serverLeases.cancelLease(serverLabel,serverLabel);
    leaseCancelled=true;
    HServerLoad load=serversToLoad.remove(serverName);
    if (load != null) {
      Set<String> servers=loadToServers.get(load);
      if (servers != null) {
        servers.remove(serverName);
        loadToServers.put(load,servers);
      }
    }
  }
  return leaseCancelled;
}
