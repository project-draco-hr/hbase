{
  if (!isMasterRunning()) {
    throw new MasterNotRunningException();
  }
  HRegionInfo newRegion=new HRegionInfo(rand.nextLong(),desc,null,null);
  for (int tries=0; tries < numRetries; tries++) {
    try {
      if (metaScanner.waitForMetaScanOrClose()) {
        return;
      }
      createTable(newRegion);
      break;
    }
 catch (    IOException e) {
      if (tries == numRetries - 1) {
        if (e instanceof RemoteException) {
          e=RemoteExceptionHandler.decodeRemoteException((RemoteException)e);
        }
        throw e;
      }
    }
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("created table " + desc.getName());
  }
}
