{
  if (mw == null) {
    throw new IllegalArgumentException("Passed MapWritable cannot be null");
  }
  SortedMap<Text,byte[]> m=new TreeMap<Text,byte[]>();
  Text row=null;
  for (  Map.Entry<Writable,Writable> e : mw.entrySet()) {
    HStoreKey key=(HStoreKey)e.getKey();
    Text thisRow=key.getRow();
    if (row == null) {
      row=thisRow;
    }
 else {
      if (!row.equals(thisRow)) {
        LOG.error("Multiple rows in same scanner result set. firstRow=" + row + ", currentRow="+ thisRow);
      }
    }
    m.put(key.getColumn(),((ImmutableBytesWritable)e.getValue()).get());
  }
  return new RowMap(row,m);
}
