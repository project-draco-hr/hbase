{
  HInternalScannerInterface scanner=null;
  TreeMap<Text,byte[]> results=new TreeMap<Text,byte[]>();
  HStoreKey key=new HStoreKey();
  Text[][] scanColumns={COLS,EXPLICIT_COLS};
  for (int i=0; i < scanColumns.length; i++) {
    try {
      scanner=region.getScanner(scanColumns[i],FIRST_ROW);
      while (scanner.next(key,results)) {
        assertTrue(results.containsKey(HConstants.COL_REGIONINFO));
        byte[] val=results.get(HConstants.COL_REGIONINFO);
        validateRegionInfo(val);
        if (validateStartcode) {
          assertTrue(results.containsKey(HConstants.COL_STARTCODE));
          val=results.get(HConstants.COL_STARTCODE);
          assertNotNull(val);
          assertFalse(val.length == 0);
          long startCode=Long.valueOf(new String(val,HConstants.UTF8_ENCODING));
          assertEquals(START_CODE,startCode);
        }
        if (serverName != null) {
          assertTrue(results.containsKey(HConstants.COL_SERVER));
          val=results.get(HConstants.COL_SERVER);
          assertNotNull(val);
          assertFalse(val.length == 0);
          String server=new String(val,HConstants.UTF8_ENCODING);
          assertEquals(0,server.compareTo(serverName));
        }
        results.clear();
      }
    }
 catch (    IOException e) {
      e.printStackTrace();
      throw e;
    }
 finally {
      if (scanner != null) {
        scanner.close();
        scanner=null;
      }
    }
  }
}
