{
  HInternalScannerInterface scanner=null;
  TreeMap<Text,BytesWritable> results=new TreeMap<Text,BytesWritable>();
  HStoreKey key=new HStoreKey();
  Text[][] scanColumns={COLS,EXPLICIT_COLS};
  for (int i=0; i < scanColumns.length; i++) {
    try {
      scanner=region.getScanner(scanColumns[i],FIRST_ROW);
      while (scanner.next(key,results)) {
        assertTrue(results.containsKey(HConstants.COL_REGIONINFO));
        BytesWritable val=results.get(HConstants.COL_REGIONINFO);
        byte[] bytes=new byte[val.getSize()];
        System.arraycopy(val.get(),0,bytes,0,bytes.length);
        validateRegionInfo(new BytesWritable(bytes));
        if (validateStartcode) {
          assertTrue(results.containsKey(HConstants.COL_STARTCODE));
          val=results.get(HConstants.COL_STARTCODE);
          assertNotNull(val);
          bytes=new byte[val.getSize()];
          System.arraycopy(val.get(),0,bytes,0,bytes.length);
          assertFalse(bytes.length == 0);
          long startCode=Long.valueOf(new String(bytes,HConstants.UTF8_ENCODING));
          assertEquals(START_CODE,startCode);
        }
        if (serverName != null) {
          assertTrue(results.containsKey(HConstants.COL_SERVER));
          val=results.get(HConstants.COL_SERVER);
          assertNotNull(val);
          bytes=new byte[val.getSize()];
          System.arraycopy(val.get(),0,bytes,0,bytes.length);
          assertFalse(bytes.length == 0);
          String server=new String(bytes,HConstants.UTF8_ENCODING);
          assertEquals(0,server.compareTo(serverName));
        }
        results.clear();
      }
    }
 catch (    IOException e) {
      e.printStackTrace();
      throw e;
    }
 finally {
      if (scanner != null) {
        try {
          scanner.close();
        }
 catch (        IOException e) {
          e.printStackTrace();
        }
        scanner=null;
      }
    }
  }
}
