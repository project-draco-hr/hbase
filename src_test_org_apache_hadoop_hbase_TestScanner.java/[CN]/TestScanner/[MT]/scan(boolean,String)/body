{
  HInternalScannerInterface scanner=null;
  TreeMap<Text,byte[]> results=new TreeMap<Text,byte[]>();
  HStoreKey key=new HStoreKey();
  Text[][] scanColumns={COLS,EXPLICIT_COLS};
  for (int i=0; i < scanColumns.length; i++) {
    try {
      scanner=region.getScanner(scanColumns[i],FIRST_ROW,System.currentTimeMillis(),null);
      while (scanner.next(key,results)) {
        assertTrue(results.containsKey(HConstants.COL_REGIONINFO));
        byte[] val=results.get(HConstants.COL_REGIONINFO);
        validateRegionInfo(val);
        if (validateStartcode) {
          assertTrue(results.containsKey(HConstants.COL_STARTCODE));
          val=results.get(HConstants.COL_STARTCODE);
          assertNotNull(val);
          assertFalse(val.length == 0);
          long startCode=Writables.bytesToLong(val);
          assertEquals(START_CODE,startCode);
        }
        if (serverName != null) {
          assertTrue(results.containsKey(HConstants.COL_SERVER));
          val=results.get(HConstants.COL_SERVER);
          assertNotNull(val);
          assertFalse(val.length == 0);
          String server=Writables.bytesToString(val);
          assertEquals(0,server.compareTo(serverName));
        }
        results.clear();
      }
    }
  finally {
      HInternalScannerInterface s=scanner;
      scanner=null;
      if (s != null) {
        s.close();
      }
    }
  }
}
