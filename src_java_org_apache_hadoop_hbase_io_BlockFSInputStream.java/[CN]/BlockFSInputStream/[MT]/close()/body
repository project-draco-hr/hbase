{
  if (closed) {
    throw new IOException("Stream closed");
  }
  if (!this.registration.cancel(false)) {
    LOG.warn("Failed cancel of " + this.registration);
  }
  int cleared=checkReferences();
  if (LOG.isDebugEnabled() && cleared > 0) {
    LOG.debug("Close cleared " + cleared + " in "+ hashCode());
  }
  if (blockStream != null) {
    blockStream.close();
    blockStream=null;
  }
  super.close();
  closed=true;
}
