{
  if (hi.metaEntry == null && hi.hdfsEntry == null) {
    undeployRegions(hi);
    return;
  }
  Get get=new Get(hi.getRegionName());
  get.addColumn(HConstants.CATALOG_FAMILY,HConstants.REGIONINFO_QUALIFIER);
  get.addColumn(HConstants.CATALOG_FAMILY,HConstants.SERVER_QUALIFIER);
  get.addColumn(HConstants.CATALOG_FAMILY,HConstants.STARTCODE_QUALIFIER);
  Result r=meta.get(get);
  byte[] value=r.getValue(HConstants.CATALOG_FAMILY,HConstants.SERVER_QUALIFIER);
  byte[] startcodeBytes=r.getValue(HConstants.CATALOG_FAMILY,HConstants.STARTCODE_QUALIFIER);
  if (value == null || startcodeBytes == null) {
    errors.reportError("Unable to close region " + hi.getRegionNameAsString() + " because meta does not "+ "have handle to reach it.");
    return;
  }
  long startcode=Bytes.toLong(startcodeBytes);
  ServerName hsa=new ServerName(Bytes.toString(value),startcode);
  byte[] hriVal=r.getValue(HConstants.CATALOG_FAMILY,HConstants.REGIONINFO_QUALIFIER);
  HRegionInfo hri=Writables.getHRegionInfoOrNull(hriVal);
  if (hri == null) {
    LOG.warn("Unable to close region " + hi.getRegionNameAsString() + " because META had invalid or missing "+ HConstants.CATALOG_FAMILY_STR+ ":"+ Bytes.toString(HConstants.REGIONINFO_QUALIFIER)+ " qualifier value.");
    return;
  }
  HBaseFsckRepair.closeRegionSilentlyAndWait(admin,hsa,hri);
}
