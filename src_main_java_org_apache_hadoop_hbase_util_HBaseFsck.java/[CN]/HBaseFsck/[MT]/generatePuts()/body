{
  ArrayList<Put> puts=new ArrayList<Put>();
  boolean hasProblems=false;
  for (  Entry<String,TInfo> e : tablesInfo.entrySet()) {
    String name=e.getKey();
    if (Bytes.compareTo(Bytes.toBytes(name),HConstants.ROOT_TABLE_NAME) == 0 || Bytes.compareTo(Bytes.toBytes(name),HConstants.META_TABLE_NAME) == 0) {
      continue;
    }
    TInfo ti=e.getValue();
    for (    Entry<byte[],Collection<HbckInfo>> spl : ti.sc.getStarts().asMap().entrySet()) {
      Collection<HbckInfo> his=spl.getValue();
      int sz=his.size();
      if (sz != 1) {
        LOG.error("Split starting at " + Bytes.toStringBinary(spl.getKey()) + " had "+ sz+ " regions instead of exactly 1.");
        hasProblems=true;
        continue;
      }
      HbckInfo hi=his.iterator().next();
      HRegionInfo hri=hi.metaEntry;
      Put p=new Put(hri.getRegionName());
      p.add(HConstants.CATALOG_FAMILY,HConstants.REGIONINFO_QUALIFIER,Writables.getBytes(hri));
      puts.add(p);
    }
  }
  return hasProblems ? null : puts;
}
