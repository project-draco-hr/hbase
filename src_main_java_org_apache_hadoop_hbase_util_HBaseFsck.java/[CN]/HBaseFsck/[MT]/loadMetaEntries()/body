{
  if (!recordRootRegion()) {
    errors.reportError("Fatal error: unable to get root region location. Exiting...");
    return false;
  }
  MetaScannerVisitor visitor=new MetaScannerVisitorBase(){
    int countRecord=1;
    final Comparator<KeyValue> comp=new Comparator<KeyValue>(){
      public int compare(      KeyValue k1,      KeyValue k2){
        return (int)(k1.getTimestamp() - k2.getTimestamp());
      }
    }
;
    public boolean processRow(    Result result) throws IOException {
      try {
        long ts=Collections.max(result.list(),comp).getTimestamp();
        Pair<HRegionInfo,ServerName> pair=MetaReader.parseCatalogResult(result);
        if (pair == null || pair.getFirst() == null) {
          emptyRegionInfoQualifiers.add(result);
          return true;
        }
        ServerName sn=null;
        if (pair.getSecond() != null) {
          sn=pair.getSecond();
        }
        MetaEntry m=new MetaEntry(pair.getFirst(),sn,ts);
        HbckInfo hbInfo=new HbckInfo(m);
        HbckInfo previous=regionInfoMap.put(pair.getFirst().getEncodedName(),hbInfo);
        if (previous != null) {
          throw new IOException("Two entries in META are same " + previous);
        }
        if (countRecord % 100 == 0) {
          errors.progress();
        }
        countRecord++;
        return true;
      }
 catch (      RuntimeException e) {
        LOG.error("Result=" + result);
        throw e;
      }
    }
  }
;
  MetaScanner.metaScan(conf,visitor,null,null,Integer.MAX_VALUE,HConstants.ROOT_TABLE_NAME);
  if (!checkMetaOnly) {
    MetaScanner.metaScan(conf,visitor);
  }
  errors.print("");
  return true;
}
