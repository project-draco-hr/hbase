{
  tablesInfo.clear();
  for (  HbckInfo hbi : regionInfoMap.values()) {
    if (hbi.getHdfsHRI() == null) {
      try {
        loadHdfsRegioninfo(hbi);
      }
 catch (      IOException ioe) {
        String msg="Orphan region in HDFS: Unable to load .regioninfo from table " + Bytes.toString(hbi.getTableName()) + " in hdfs dir "+ hbi.getHdfsRegionDir()+ "!  It may be an invalid format or version file.  Treating as "+ "an orphaned regiondir.";
        errors.reportError(ERROR_CODE.ORPHAN_HDFS_REGION,msg);
        debugLsr(hbi.getHdfsRegionDir());
        orphanHdfsDirs.add(hbi);
        continue;
      }
    }
    String tableName=Bytes.toString(hbi.getTableName());
    if (tableName == null) {
      LOG.warn("tableName was null for: " + hbi);
      continue;
    }
    TableInfo modTInfo=tablesInfo.get(tableName);
    if (modTInfo == null) {
      modTInfo=new TableInfo(tableName);
      Path hbaseRoot=new Path(conf.get(HConstants.HBASE_DIR));
      HTableDescriptor htd=FSTableDescriptors.getTableDescriptor(hbaseRoot.getFileSystem(conf),hbaseRoot,tableName);
      modTInfo.htds.add(htd);
    }
    modTInfo.addRegionInfo(hbi);
    tablesInfo.put(tableName,modTInfo);
  }
  return tablesInfo;
}
