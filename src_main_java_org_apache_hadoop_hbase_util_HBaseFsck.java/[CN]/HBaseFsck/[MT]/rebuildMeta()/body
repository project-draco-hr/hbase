{
  LOG.info("Loading HBase regioninfo from HDFS...");
  checkHdfs();
  loadTableInfo();
  LOG.info("Checking HBase region split map from HDFS data...");
  int errs=errors.getErrorList().size();
  for (  TInfo tInfo : tablesInfo.values()) {
    if (!tInfo.checkRegionChain()) {
      errors.report("Found inconsistency in table " + tInfo.getName());
    }
  }
  if (errors.getErrorList().size() != errs) {
    suggestFixes(tablesInfo);
    return false;
  }
  LOG.info("HDFS regioninfo's seems good.  Sidelining old .META.");
  sidelineOldRootAndMeta();
  LOG.info("Creating new .META.");
  HRegion meta=createNewRootAndMeta();
  List<Put> puts=generatePuts();
  if (puts == null) {
    LOG.fatal("Problem encountered when creating new .META. entries.  " + "You may need to restore the previously sidlined -ROOT- and .META.");
    return false;
  }
  meta.put(puts.toArray(new Put[0]));
  meta.close();
  meta.getLog().closeAndDelete();
  LOG.info("Success! .META. table rebuilt.");
  return true;
}
