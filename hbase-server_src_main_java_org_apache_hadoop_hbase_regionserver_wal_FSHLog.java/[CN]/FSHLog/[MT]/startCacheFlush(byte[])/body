{
  this.cacheFlushLock.lock();
  Long seq=this.lastSeqWritten.remove(encodedRegionName);
  if (seq != null) {
    Long oldseq=lastSeqWritten.put(getSnapshotName(encodedRegionName),seq);
    if (oldseq != null) {
      LOG.error("Logic Error Snapshot seq id from earlier flush still" + " present! for region " + Bytes.toString(encodedRegionName) + " overwritten oldseq="+ oldseq+ "with new seq="+ seq);
      Runtime.getRuntime().halt(1);
    }
  }
  return obtainSeqNum();
}
