{
  close();
  if (!fs.exists(this.dir))   return;
  FileStatus[] files=fs.listStatus(this.dir);
  if (files != null) {
    for (    FileStatus file : files) {
      Path p=getHLogArchivePath(this.oldLogDir,file.getPath());
      if (!this.listeners.isEmpty()) {
        for (        WALActionsListener i : this.listeners) {
          i.preLogArchive(file.getPath(),p);
        }
      }
      if (!FSUtils.renameAndSetModifyTime(fs,file.getPath(),p)) {
        throw new IOException("Unable to rename " + file.getPath() + " to "+ p);
      }
      if (!this.listeners.isEmpty()) {
        for (        WALActionsListener i : this.listeners) {
          i.postLogArchive(file.getPath(),p);
        }
      }
    }
    LOG.debug("Moved " + files.length + " WAL file(s) to "+ FSUtils.getPath(this.oldLogDir));
  }
  if (!fs.delete(dir,true)) {
    LOG.info("Unable to delete " + dir);
  }
}
