{
  if (!this.enabled || edits.isEmpty())   return this.highestUnsyncedSequence;
  if (this.closed)   throw new IOException("Cannot append; log is closed");
  TraceScope traceScope=Trace.startSpan("FSHlog.append");
  HLogKey logKey=makeKey(info.getEncodedNameAsBytes(),tableName,-1,now,clusterIds,nonceGroup,nonce);
  long sequence=this.disruptor.getRingBuffer().next();
  try {
    RingBufferTruck truck=this.disruptor.getRingBuffer().get(sequence);
    FSWALEntry entry=new FSWALEntry(sequence,logKey,edits,sequenceId,inMemstore,htd,info);
    truck.loadPayload(entry,traceScope.detach());
  }
  finally {
    this.disruptor.getRingBuffer().publish(sequence);
  }
  if (doSync || info.isMetaRegion())   publishSyncThenBlockOnCompletion();
  return sequence;
}
