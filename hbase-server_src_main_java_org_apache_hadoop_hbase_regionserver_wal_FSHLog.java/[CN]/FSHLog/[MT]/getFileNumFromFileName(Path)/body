{
  if (fileName == null)   throw new IllegalArgumentException("file name can't be null");
  String prefixPathStr=new Path(dir,prefix + ".").toString();
  if (!fileName.toString().startsWith(prefixPathStr)) {
    throw new IllegalArgumentException("The log doesn't belong to this regionserver");
  }
  String chompedPath=fileName.toString().substring(prefixPathStr.length());
  if (forMeta)   chompedPath=chompedPath.substring(0,chompedPath.indexOf(META_HLOG_FILE_EXTN));
  return Long.parseLong(chompedPath);
}
