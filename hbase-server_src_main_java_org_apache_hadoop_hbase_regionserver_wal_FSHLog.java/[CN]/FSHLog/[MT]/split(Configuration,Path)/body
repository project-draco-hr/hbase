{
  FileSystem fs=FileSystem.get(conf);
  if (!fs.exists(p)) {
    throw new FileNotFoundException(p.toString());
  }
  if (!fs.getFileStatus(p).isDirectory()) {
    throw new IOException(p + " is not a directory");
  }
  final Path baseDir=FSUtils.getRootDir(conf);
  final Path oldLogDir=new Path(baseDir,HConstants.HREGION_OLDLOGDIR_NAME);
  HLogSplitter.split(baseDir,p,oldLogDir,fs,conf);
}
