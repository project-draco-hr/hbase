{
  SequenceFileLogReader in=new SequenceFileLogReader();
  SequenceFileLogWriter out=new SequenceFileLogWriter();
  try {
    Configuration conf=HBaseConfiguration.create();
    FileSystem inFS=input.getFileSystem(conf);
    FileSystem outFS=output.getFileSystem(conf);
    in.init(inFS,input,conf);
    boolean compress=in.reader.isWALCompressionEnabled();
    conf.setBoolean(HConstants.ENABLE_WAL_COMPRESSION,!compress);
    out.init(outFS,output,conf);
    Entry e=null;
    while ((e=in.next()) != null)     out.append(e);
  }
  finally {
    in.close();
    out.close();
  }
}
