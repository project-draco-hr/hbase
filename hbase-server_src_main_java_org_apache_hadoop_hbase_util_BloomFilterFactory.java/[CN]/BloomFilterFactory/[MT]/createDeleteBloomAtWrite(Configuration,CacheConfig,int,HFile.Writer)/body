{
  if (!isDeleteFamilyBloomEnabled(conf)) {
    LOG.info("Delete Bloom filters are disabled by configuration for " + writer.getPath() + (conf == null ? " (configuration is null)" : ""));
    return null;
  }
  float err=getErrorRate(conf);
  if (HFile.getFormatVersion(conf) > HFile.MIN_FORMAT_VERSION) {
    int maxFold=getMaxFold(conf);
    CompoundBloomFilterWriter bloomWriter=new CompoundBloomFilterWriter(getBloomBlockSize(conf),err,Hash.getHashType(conf),maxFold,cacheConf.shouldCacheBloomsOnWrite(),Bytes.BYTES_RAWCOMPARATOR);
    writer.addInlineBlockWriter(bloomWriter);
    return bloomWriter;
  }
 else {
    LOG.info("Delete Family Bloom filter is not supported in HFile V1");
    return null;
  }
}
