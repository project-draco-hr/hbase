{
  int maxQueueLength=conf.getInt("ipc.server.max.callqueue.length",handlerCount * RpcServer.DEFAULT_MAX_CALLQUEUE_LENGTH_PER_HANDLER);
  this.handlerCount=handlerCount;
  this.priorityHandlerCount=priorityHandlerCount;
  this.replicationHandlerCount=replicationHandlerCount;
  this.qosFunction=qosFunction;
  this.highPriorityLevel=highPriorityLevel;
  this.callQueue=new LinkedBlockingQueue<RpcServer.CallRunner>(maxQueueLength);
  this.priorityCallQueue=priorityHandlerCount > 0 ? new LinkedBlockingQueue<RpcServer.CallRunner>(maxQueueLength) : null;
  this.replicationQueue=replicationHandlerCount > 0 ? new LinkedBlockingQueue<RpcServer.CallRunner>(maxQueueLength) : null;
}
