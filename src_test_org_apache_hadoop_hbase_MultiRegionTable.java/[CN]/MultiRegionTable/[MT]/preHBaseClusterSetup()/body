{
  try {
    HRegion[] regions=new HRegion[KEYS.length];
    for (int i=0; i < regions.length; i++) {
      int j=(i + 1) % regions.length;
      regions[i]=createARegion(KEYS[i],KEYS[j]);
    }
    HRegion root=HRegion.createHRegion(HRegionInfo.rootRegionInfo,testDir,this.conf);
    HRegion meta=HRegion.createHRegion(HRegionInfo.firstMetaRegionInfo,testDir,this.conf);
    HRegion.addRegionToMETA(root,meta);
    for (int i=0; i < regions.length; i++) {
      HRegion.addRegionToMETA(meta,regions[i]);
    }
    closeRegionAndDeleteLog(root);
    closeRegionAndDeleteLog(meta);
  }
 catch (  Exception e) {
    StaticTestEnvironment.shutdownDfs(dfsCluster);
    throw e;
  }
}
