{
  TDelete out=new TDelete(ByteBuffer.wrap(in.getRow()));
  List<TColumn> columns=new ArrayList<TColumn>();
  long rowTimestamp=in.getTimeStamp();
  if (rowTimestamp != HConstants.LATEST_TIMESTAMP) {
    out.setTimestamp(rowTimestamp);
  }
  for (  Map.Entry<byte[],List<KeyValue>> familyEntry : in.getFamilyMap().entrySet()) {
    TColumn column=new TColumn(ByteBuffer.wrap(familyEntry.getKey()));
    for (    KeyValue keyValue : familyEntry.getValue()) {
      byte[] family=keyValue.getFamily();
      byte[] qualifier=keyValue.getQualifier();
      long timestamp=keyValue.getTimestamp();
      if (family != null) {
        column.setFamily(family);
      }
      if (qualifier != null) {
        column.setQualifier(qualifier);
      }
      if (timestamp != HConstants.LATEST_TIMESTAMP) {
        column.setTimestamp(keyValue.getTimestamp());
      }
    }
    columns.add(column);
  }
  out.setColumns(columns);
  return out;
}
