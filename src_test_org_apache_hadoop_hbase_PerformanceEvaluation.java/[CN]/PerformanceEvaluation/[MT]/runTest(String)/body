{
  if (cmd.equals(RANDOM_READ_MEM)) {
    R=(ONE_GB / 10) * N;
  }
  MiniHBaseCluster hbaseMiniCluster=null;
  if (this.miniCluster) {
    hbaseMiniCluster=new MiniHBaseCluster(this.conf,N);
  }
  try {
    if (cmd.equals(MAPFILE)) {
      doMapFile();
    }
 else     if (N == 1) {
      runNIsOne(cmd);
    }
 else {
      runNIsMoreThanOne(cmd);
    }
  }
  finally {
    if (this.miniCluster && hbaseMiniCluster != null) {
      hbaseMiniCluster.shutdown();
    }
  }
}
