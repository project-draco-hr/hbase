{
  final String name="testHTableDescriptors";
  FileSystem fs=FileSystem.get(UTIL.getConfiguration());
  Path rootdir=new Path(HBaseTestingUtility.getTestDir(),name);
  final int count=10;
  for (int i=0; i < count; i++) {
    HTableDescriptor htd=new HTableDescriptor(name + i);
    createHTDInFS(fs,rootdir,htd);
  }
  FSTableDescriptors htds=new FSTableDescriptors(fs,rootdir){
    @Override public HTableDescriptor get(    byte[] tablename) throws TableExistsException, FileNotFoundException, IOException {
      System.out.println(Bytes.toString(tablename) + ", cachehits=" + this.cachehits);
      return super.get(tablename);
    }
  }
;
  for (int i=0; i < count; i++) {
    assertTrue(htds.get(Bytes.toBytes(name + i)) != null);
  }
  for (int i=0; i < count; i++) {
    assertTrue(htds.get(Bytes.toBytes(name + i)) != null);
  }
  Thread.sleep(1000);
  for (int i=0; i < count; i++) {
    HTableDescriptor htd=new HTableDescriptor(name + i);
    htd.addFamily(new HColumnDescriptor("" + i));
    FSUtils.updateHTableDescriptor(fs,rootdir,htd);
  }
  for (int i=0; i < count; i++) {
    assertTrue(htds.get(Bytes.toBytes(name + i)) != null);
  }
  for (int i=0; i < count; i++) {
    assertTrue(htds.get(Bytes.toBytes(name + i)) != null);
  }
  assertEquals(count * 4,htds.invocations);
  assertEquals(count * 2,htds.cachehits);
  assertTrue(htds.get(HConstants.ROOT_TABLE_NAME) != null);
  assertEquals(htds.invocations,count * 4 + 1);
  assertEquals(htds.cachehits,count * 2 + 1);
}
