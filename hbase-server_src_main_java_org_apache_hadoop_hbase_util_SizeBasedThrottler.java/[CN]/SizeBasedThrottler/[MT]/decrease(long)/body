{
  final long newSize=currentSize.addAndGet(-delta);
  if (newSize < threshold && newSize + delta >= threshold) {
synchronized (this) {
      notifyAll();
    }
  }
  return newSize;
}
