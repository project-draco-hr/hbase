{
  int compactionKVMax=conf.getInt(HConstants.COMPACTION_KV_MAX,HConstants.COMPACTION_KV_MAX_DEFAULT);
  List<Cell> kvs=new ArrayList<Cell>();
  boolean hasMore;
  do {
    hasMore=scanner.next(kvs,compactionKVMax);
    if (!kvs.isEmpty()) {
      for (      Cell c : kvs) {
        KeyValue kv=KeyValueUtil.ensureKeyValue(c);
        sink.append(kv);
      }
      kvs.clear();
    }
  }
 while (hasMore);
}
