{
  int compactionKVMax=conf.getInt(HConstants.COMPACTION_KV_MAX,HConstants.COMPACTION_KV_MAX_DEFAULT);
  ScannerContext scannerContext=ScannerContext.newBuilder().setBatchLimit(compactionKVMax).build();
  List<Cell> kvs=new ArrayList<Cell>();
  boolean hasMore;
  do {
    hasMore=scanner.next(kvs,scannerContext);
    if (!kvs.isEmpty()) {
      for (      Cell c : kvs) {
        sink.append(c);
      }
      kvs.clear();
    }
  }
 while (hasMore);
}
