{
  HTable t=new HTable(TEST_UTIL.getConfiguration(),TABLENAME);
  HTable meta=new HTable(TEST_UTIL.getConfiguration(),HConstants.META_TABLE_NAME);
  int rows=0;
  Scan scan=new Scan();
  scan.addColumn(HConstants.CATALOG_FAMILY,HConstants.REGIONINFO_QUALIFIER);
  ResultScanner s=meta.getScanner(scan);
  for (Result r=null; (r=s.next()) != null; ) {
    byte[] b=r.getValue(HConstants.CATALOG_FAMILY,HConstants.REGIONINFO_QUALIFIER);
    if (b == null || b.length <= 0)     break;
    HRegionInfo hri=Writables.getHRegionInfo(b);
    byte[] row=getStartKey(hri);
    Put p=new Put(row);
    p.setWriteToWAL(false);
    p.add(getTestFamily(),getTestQualifier(),row);
    t.put(p);
    rows++;
  }
  s.close();
  Assert.assertEquals(expected,rows);
  t.close();
  meta.close();
  return rows;
}
