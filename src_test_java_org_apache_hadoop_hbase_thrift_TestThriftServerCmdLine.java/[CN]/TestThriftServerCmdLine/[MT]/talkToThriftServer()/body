{
  TSocket sock=new TSocket(InetAddress.getLocalHost().getHostName(),port);
  TTransport transport=sock;
  if (specifyFramed || implType.isAlwaysFramed) {
    transport=new TFramedTransport(transport);
  }
  sock.open();
  TProtocol prot;
  if (specifyCompact) {
    prot=new TCompactProtocol(transport);
  }
 else {
    prot=new TBinaryProtocol(transport);
  }
  Hbase.Client client=new Hbase.Client(prot);
  List<ByteBuffer> tableNames=client.getTableNames();
  if (tableNames.isEmpty()) {
    TestThriftServer.createTestTables(client);
    assertEquals(2,client.getTableNames().size());
  }
 else {
    assertEquals(2,tableNames.size());
    assertEquals(2,client.getColumnDescriptors(tableNames.get(0)).size());
  }
  sock.close();
}
