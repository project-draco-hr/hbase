{
  try {
    List<String> tables=getCurrentTables();
    for (    String table : tables) {
      String statmsg="Cleaning failed or expired schema change requests. " + "current tables undergoing " + "schema change process = "+ tables;
      MonitoredTask status=TaskMonitor.get().createStatus(statmsg);
      LOG.debug(statmsg);
      if (hasSchemaChangeExpiredFor(table)) {
        String msg="Schema change for table = " + table + " has expired."+ " Schema change for this table has been in progress for "+ +schemaChangeTimeoutMillis+ "Deleting the node now.";
        LOG.debug(msg);
        ZKUtil.deleteNodeRecursively(this.watcher,getSchemaChangeNodePathForTable(table));
      }
 else {
        String msg="Schema change request is in progress for " + " table = " + table;
        LOG.debug(msg);
        status.setStatus(msg);
      }
    }
  }
 catch (  IOException e) {
    String msg="IOException during handleFailedExpiredSchemaChanges." + e.getCause();
    LOG.error(msg,e);
    TaskMonitor.get().createStatus(msg);
  }
catch (  KeeperException ke) {
    String msg="KeeperException during handleFailedExpiredSchemaChanges." + ke.getCause();
    LOG.error(msg,ke);
    TaskMonitor.get().createStatus(msg);
  }
}
