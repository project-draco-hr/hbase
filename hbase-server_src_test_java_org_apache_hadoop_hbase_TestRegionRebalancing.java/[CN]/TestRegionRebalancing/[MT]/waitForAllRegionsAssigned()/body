{
  int totalRegions=HBaseTestingUtility.KEYS.length;
  while (UTIL.getMiniHBaseCluster().countServedRegions() < totalRegions) {
    LOG.debug("Waiting for there to be " + totalRegions + " regions, but there are "+ UTIL.getMiniHBaseCluster().countServedRegions()+ " right now.");
    try {
      Thread.sleep(200);
    }
 catch (    InterruptedException e) {
    }
  }
  RegionStates regionStates=UTIL.getHBaseCluster().getMaster().getAssignmentManager().getRegionStates();
  while (!regionStates.getRegionsInTransition().isEmpty()) {
    Threads.sleep(100);
  }
}
