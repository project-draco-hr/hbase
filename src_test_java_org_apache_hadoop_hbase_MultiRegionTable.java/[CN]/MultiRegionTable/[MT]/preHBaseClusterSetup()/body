{
  try {
    FileSystem filesystem=FileSystem.get(conf);
    Path rootdir=filesystem.makeQualified(new Path(conf.get(HConstants.HBASE_DIR)));
    filesystem.mkdirs(rootdir);
    FSUtils.createTableDescriptor(fs,rootdir,desc);
    HRegion[] regions=new HRegion[KEYS.length];
    for (int i=0; i < regions.length; i++) {
      int j=(i + 1) % regions.length;
      regions[i]=createARegion(KEYS[i],KEYS[j]);
    }
    createRootAndMetaRegions();
    for (int i=0; i < regions.length; i++) {
      HRegion.addRegionToMETA(meta,regions[i]);
    }
    closeRootAndMeta();
  }
 catch (  Exception e) {
    shutdownDfs(dfsCluster);
    throw e;
  }
}
