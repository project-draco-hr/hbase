{
  super(server.getThreadWakeFrequency(),stopper);
  this.conf=server.getConfiguration();
  this.conn=new ReplicationConnectionManager(this.conf);
  this.zkHelper=server.getZkHelper();
  this.ratio=this.conf.getFloat("replication.ratio",0.1f);
  currentPeers=new ArrayList<HServerAddress>();
  this.random=new Random();
  this.clusterId=zkHelper.getClusterId();
  this.isReplicating=isReplicating;
}
