{
  HTU.startMiniCluster(NB_SERVERS);
  final byte[] tableName=Bytes.toBytes(TestRegionServerNoMaster.class.getSimpleName());
  table=HTU.createTable(tableName,HConstants.CATALOG_FAMILY);
  Put p=new Put(row);
  p.add(HConstants.CATALOG_FAMILY,row,row);
  table.put(p);
  hri=table.getRegionLocation(row,false).getRegionInfo();
  regionName=hri.getRegionName();
  HTU.getHBaseCluster().getMaster().stopMaster();
  HRegionServer hrs=HTU.getHBaseCluster().getRegionServer(0);
  ZooKeeperWatcher zkw=hrs.getZooKeeper();
  ZKAssign.createNodeOffline(zkw,HRegionInfo.FIRST_META_REGIONINFO,hrs.getServerName());
  ProtobufUtil.openRegion(hrs.getRSRpcServices(),hrs.getServerName(),HRegionInfo.FIRST_META_REGIONINFO);
  while (true) {
    ServerName sn=MetaRegionTracker.getMetaRegionLocation(zkw);
    if (sn != null && sn.equals(hrs.getServerName())) {
      break;
    }
    Thread.sleep(100);
  }
}
