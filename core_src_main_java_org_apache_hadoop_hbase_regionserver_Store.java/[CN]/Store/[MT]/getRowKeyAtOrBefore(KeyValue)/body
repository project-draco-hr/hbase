{
  GetClosestRowBeforeTracker state=new GetClosestRowBeforeTracker(this.comparator,kv,this.ttl,this.region.getRegionInfo().isMetaRegion());
  this.lock.readLock().lock();
  try {
    this.memstore.getRowKeyAtOrBefore(state);
    Map<Long,StoreFile> m=this.storefiles.descendingMap();
    for (    Map.Entry<Long,StoreFile> e : m.entrySet()) {
      rowAtOrBeforeFromStoreFile(e.getValue(),state);
    }
    return state.getCandidate();
  }
  finally {
    this.lock.readLock().unlock();
  }
}
