{
  LOG.debug("Validating table.");
  HTable table=new HTable(conf,tableName);
  boolean verified=false;
  long pause=conf.getLong("hbase.client.pause",5 * 1000);
  int numRetries=conf.getInt(HConstants.HBASE_CLIENT_RETRIES_NUMBER,5);
  for (int i=0; i < numRetries; i++) {
    try {
      Scan scan=new Scan();
      scan.addFamily(Bytes.toBytes(family));
      ResultScanner resScanner=table.getScanner(scan);
      for (      Result res : resScanner) {
        assertTrue(res.size() == 2);
        List<Cell> kvs=res.listCells();
        assertTrue(CellUtil.matchingRow(kvs.get(0),Bytes.toBytes("KEY")));
        assertTrue(CellUtil.matchingRow(kvs.get(1),Bytes.toBytes("KEY")));
        assertTrue(CellUtil.matchingValue(kvs.get(0),Bytes.toBytes("VALUE" + valueMultiplier)));
        assertTrue(CellUtil.matchingValue(kvs.get(1),Bytes.toBytes("VALUE" + 2 * valueMultiplier)));
      }
      verified=true;
      break;
    }
 catch (    NullPointerException e) {
    }
    try {
      Thread.sleep(pause);
    }
 catch (    InterruptedException e) {
    }
  }
  table.close();
  assertTrue(verified);
}
