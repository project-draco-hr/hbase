{
  LOG.debug("Validating table.");
  HTable table=new HTable(conf,tableName);
  boolean verified=false;
  long pause=conf.getLong("hbase.client.pause",5 * 1000);
  int numRetries=conf.getInt("hbase.client.retries.number",5);
  for (int i=0; i < numRetries; i++) {
    try {
      Scan scan=new Scan();
      scan.addFamily(Bytes.toBytes(family));
      ResultScanner resScanner=table.getScanner(scan);
      for (      Result res : resScanner) {
        assertTrue(res.size() == 2);
        List<KeyValue> kvs=res.list();
        assertArrayEquals(kvs.get(0).getRow(),Bytes.toBytes("KEY"));
        assertArrayEquals(kvs.get(1).getRow(),Bytes.toBytes("KEY"));
        assertArrayEquals(kvs.get(0).getValue(),Bytes.toBytes("VALUE" + valueMultiplier));
        assertArrayEquals(kvs.get(1).getValue(),Bytes.toBytes("VALUE" + 2 * valueMultiplier));
      }
      verified=true;
      break;
    }
 catch (    NullPointerException e) {
    }
    try {
      Thread.sleep(pause);
    }
 catch (    InterruptedException e) {
    }
  }
  table.close();
  assertTrue(verified);
}
