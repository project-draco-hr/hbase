{
  List<String> state=new ArrayList<String>();
  Procedure proc=new TestWaitingProcedure("wproc",state,true);
  proc.setTimeout(2500);
  long rootId=ProcedureTestingUtility.submitAndWait(procExecutor,proc);
  LOG.info(state);
  ProcedureResult result=procExecutor.getResult(rootId);
  LOG.info(result.getException());
  assertTrue(state.toString(),result.isFailed());
  assertTrue(result.getException().toString(),result.getException().getCause() instanceof TimeoutException);
  assertEquals(state.toString(),4,state.size());
  assertEquals("wproc-execute",state.get(0));
  assertEquals("wproc-child-execute",state.get(1));
  assertEquals("wproc-child-rollback",state.get(2));
  assertEquals("wproc-rollback",state.get(3));
}
