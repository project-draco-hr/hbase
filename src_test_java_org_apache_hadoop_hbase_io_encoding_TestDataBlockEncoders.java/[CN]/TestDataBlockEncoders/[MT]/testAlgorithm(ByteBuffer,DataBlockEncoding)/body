{
  byte[] encodedBytes=encodeBytes(encoding,dataset);
  ByteArrayInputStream bais=new ByteArrayInputStream(encodedBytes);
  DataInputStream dis=new DataInputStream(bais);
  ByteBuffer actualDataset;
  DataBlockEncoder encoder=encoding.getEncoder();
  actualDataset=encoder.decodeKeyValues(dis,includesMemstoreTS);
  dataset.rewind();
  actualDataset.rewind();
  assertEquals("Encoding -> decoding gives different results for " + encoder,Bytes.toStringBinary(dataset),Bytes.toStringBinary(actualDataset));
}
