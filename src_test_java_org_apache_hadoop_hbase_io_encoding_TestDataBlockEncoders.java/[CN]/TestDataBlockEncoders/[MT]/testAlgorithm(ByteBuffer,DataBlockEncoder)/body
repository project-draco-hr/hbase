{
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStream dataOut=new DataOutputStream(baos);
  encoder.compressKeyValues(dataOut,dataset,includesMemstoreTS);
  ByteArrayInputStream bais=new ByteArrayInputStream(baos.toByteArray());
  DataInputStream dis=new DataInputStream(bais);
  ByteBuffer actualDataset;
  actualDataset=encoder.uncompressKeyValues(dis,includesMemstoreTS);
  dataset.rewind();
  actualDataset.rewind();
  assertEquals("Encoding -> decoding gives different results for " + encoder,Bytes.toStringBinary(dataset),Bytes.toStringBinary(actualDataset));
}
