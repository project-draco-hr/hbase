{
  try {
    this.errorReporter=errorReporter;
    this.queuesClient=ReplicationFactory.getReplicationQueuesClient(zkw,conf,connection);
    this.queuesClient.init();
    this.replicationPeers=ReplicationFactory.getReplicationPeers(zkw,conf,this.queuesClient,connection);
    this.replicationPeers.init();
    this.queueDeletor=new ReplicationQueueDeletor(zkw,conf,connection);
  }
 catch (  ReplicationException e) {
    throw new IOException("failed to construct ReplicationChecker",e);
  }
}
