{
  int numDataNodes=numSlaves;
  if (dataNodeHosts != null && dataNodeHosts.length != 0) {
    numDataNodes=dataNodeHosts.length;
  }
  LOG.info("Starting up minicluster with " + numMasters + " master(s) and "+ numSlaves+ " regionserver(s) and "+ numDataNodes+ " datanode(s)");
  isRunningCluster();
  startMiniDFSCluster(numDataNodes,dataNodeHosts);
  if (this.zkCluster == null) {
    startMiniZKCluster(clusterTestDir);
  }
  return startMiniHBaseCluster(numMasters,numSlaves);
}
