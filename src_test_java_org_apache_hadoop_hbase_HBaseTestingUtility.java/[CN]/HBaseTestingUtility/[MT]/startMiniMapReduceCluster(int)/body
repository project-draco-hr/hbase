{
  if (mrCluster != null) {
    throw new IllegalStateException("MiniMRCluster is already running");
  }
  LOG.info("Starting mini mapreduce cluster...");
  setupClusterTestDir();
  createDirsAndSetProperties();
  forceChangeTaskLogDir();
  mrCluster=new MiniMRCluster(servers,FS_URI != null ? FS_URI : FileSystem.get(conf).getUri().toString(),1);
  JobConf jobConf=MapreduceTestingShim.getJobConf(mrCluster);
  if (jobConf != null) {
    jobConf.set("mapred.local.dir",conf.get("mapred.local.dir"));
  }
  LOG.info("Mini mapreduce cluster started");
  conf.set("mapred.job.tracker",mrCluster.createJobConf().get("mapred.job.tracker"));
  conf.set("mapreduce.framework.name","yarn");
}
