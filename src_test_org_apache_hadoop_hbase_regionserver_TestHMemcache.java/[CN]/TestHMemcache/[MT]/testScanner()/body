{
  addRows(this.hmemcache);
  Thread.sleep(1);
  addRows(this.hmemcache);
  Thread.sleep(1);
  addRows(this.hmemcache);
  long timestamp=System.currentTimeMillis();
  NavigableSet<byte[]> columns=new TreeSet<byte[]>(Bytes.BYTES_COMPARATOR);
  for (int i=0; i < ROW_COUNT; i++) {
    for (int ii=0; ii < COLUMNS_COUNT; ii++) {
      columns.add(getColumnName(i,ii));
    }
  }
  InternalScanner scanner=this.hmemcache.getScanner(timestamp,columns,HConstants.EMPTY_START_ROW);
  List<KeyValue> results=new ArrayList<KeyValue>();
  for (int i=0; scanner.next(results); i++) {
    KeyValue.COMPARATOR.compareRows(results.get(0),getRowName(i));
    assertEquals("Count of columns",COLUMNS_COUNT,results.size());
    isExpectedRowWithoutTimestamps(i,results);
    results.clear();
  }
}
