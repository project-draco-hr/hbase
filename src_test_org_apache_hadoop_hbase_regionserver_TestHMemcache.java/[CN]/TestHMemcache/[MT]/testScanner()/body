{
  addRows(this.hmemcache);
  long timestamp=System.currentTimeMillis();
  byte[][] cols=new byte[COLUMNS_COUNT * ROW_COUNT][];
  for (int i=0; i < ROW_COUNT; i++) {
    for (int ii=0; ii < COLUMNS_COUNT; ii++) {
      cols[(ii + (i * COLUMNS_COUNT))]=getColumnName(i,ii);
    }
  }
  InternalScanner scanner=this.hmemcache.getScanner(timestamp,cols,HConstants.EMPTY_START_ROW);
  HStoreKey key=new HStoreKey();
  TreeMap<byte[],Cell> results=new TreeMap<byte[],Cell>(Bytes.BYTES_COMPARATOR);
  for (int i=0; scanner.next(key,results); i++) {
    assertTrue("Row name",key.toString().startsWith(Bytes.toString(getRowName(i))));
    assertEquals("Count of columns",COLUMNS_COUNT,results.size());
    TreeMap<byte[],Cell> row=new TreeMap<byte[],Cell>(Bytes.BYTES_COMPARATOR);
    for (    Map.Entry<byte[],Cell> e : results.entrySet()) {
      row.put(e.getKey(),e.getValue());
    }
    isExpectedRowWithoutTimestamps(i,row);
    results.clear();
  }
}
