{
  List<StoreFile> storeFiles=new ArrayList<StoreFile>();
  List<String> toBeArchived=getUnusedFiles(job.getConfiguration());
  Path mobStorePath=MobUtils.getMobFamilyPath(job.getConfiguration(),tn,hcd.getNameAsString());
  for (  String archiveFileName : toBeArchived) {
    Path path=new Path(mobStorePath,archiveFileName);
    storeFiles.add(new StoreFile(fs,path,job.getConfiguration(),cacheConfig,BloomType.NONE));
  }
  if (!storeFiles.isEmpty()) {
    try {
      MobUtils.removeMobFiles(job.getConfiguration(),fs,tn,FSUtils.getTableDir(MobUtils.getMobHome(conf),tn),hcd.getName(),storeFiles);
      LOG.info(storeFiles.size() + " unused MOB files are removed");
    }
 catch (    Exception e) {
      LOG.error("Fail to archive the store files " + storeFiles,e);
    }
  }
}
