{
  Job job=Job.getInstance(conf);
  job.setJarByClass(SweepMapper.class);
  TableMapReduceUtil.initTableMapperJob(tn.getNameAsString(),scan,SweepMapper.class,Text.class,Writable.class,job);
  job.setInputFormatClass(TableInputFormat.class);
  job.setMapOutputKeyClass(Text.class);
  job.setMapOutputValueClass(KeyValue.class);
  job.setReducerClass(SweepReducer.class);
  job.setOutputFormatClass(NullOutputFormat.class);
  String jobName=getCustomJobName(this.getClass().getSimpleName(),tn.getNameAsString(),familyName);
  job.setJobName(jobName);
  if (StringUtils.isNotEmpty(conf.get(CREDENTIALS_LOCATION))) {
    String fileLoc=conf.get(CREDENTIALS_LOCATION);
    Credentials cred=Credentials.readTokenStorageFile(new File(fileLoc),conf);
    job.getCredentials().addAll(cred);
  }
  return job;
}
