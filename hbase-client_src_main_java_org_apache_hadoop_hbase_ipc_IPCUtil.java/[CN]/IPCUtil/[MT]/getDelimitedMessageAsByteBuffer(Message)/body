{
  if (m == null)   return null;
  int serializedSize=m.getSerializedSize();
  int vintSize=CodedOutputStream.computeRawVarint32Size(serializedSize);
  byte[] buffer=new byte[serializedSize + vintSize];
  CodedOutputStream cos=CodedOutputStream.newInstance(buffer);
  cos.writeMessageNoTag(m);
  cos.flush();
  cos.checkNoSpaceLeft();
  return ByteBuffer.wrap(buffer);
}
