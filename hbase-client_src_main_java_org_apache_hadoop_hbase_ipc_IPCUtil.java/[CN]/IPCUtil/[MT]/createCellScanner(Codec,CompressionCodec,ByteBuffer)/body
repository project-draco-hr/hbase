{
  InputStream is=null;
  if (compressor != null) {
    if (compressor instanceof Configurable)     ((Configurable)compressor).setConf(this.conf);
    Decompressor poolDecompressor=CodecPool.getDecompressor(compressor);
    CompressionInputStream cis=compressor.createInputStream(new ByteBufferInputStream(cellBlock),poolDecompressor);
    ByteBufferOutputStream bbos=null;
    try {
      bbos=new ByteBufferOutputStream(cellBlock.remaining() * this.cellBlockDecompressionMultiplier);
      IOUtils.copy(cis,bbos);
      bbos.close();
      ByteBuffer bb=bbos.getByteBuffer();
      is=new ByteBufferInputStream(bb);
    }
  finally {
      if (is != null)       is.close();
      if (bbos != null)       bbos.close();
      CodecPool.returnDecompressor(poolDecompressor);
    }
  }
 else {
    is=new ByteBufferInputStream(cellBlock);
  }
  return codec.getDecoder(is);
}
