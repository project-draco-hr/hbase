{
  InputStream is=null;
  if (compressor != null) {
    if (compressor instanceof Configurable)     ((Configurable)compressor).setConf(this.conf);
    Decompressor poolDecompressor=CodecPool.getDecompressor(compressor);
    CompressionInputStream cis=compressor.createInputStream(new ByteArrayInputStream(cellBlock,offset,length),poolDecompressor);
    ByteBufferOutputStream bbos=null;
    try {
      bbos=new ByteBufferOutputStream((length - offset) * this.cellBlockDecompressionMultiplier);
      IOUtils.copy(cis,bbos);
      bbos.close();
      ByteBuffer bb=bbos.getByteBuffer();
      is=new ByteArrayInputStream(bb.array(),0,bb.limit());
    }
  finally {
      if (is != null)       is.close();
      if (bbos != null)       bbos.close();
      CodecPool.returnDecompressor(poolDecompressor);
    }
  }
 else {
    is=new ByteArrayInputStream(cellBlock,offset,length);
  }
  return codec.getDecoder(is);
}
