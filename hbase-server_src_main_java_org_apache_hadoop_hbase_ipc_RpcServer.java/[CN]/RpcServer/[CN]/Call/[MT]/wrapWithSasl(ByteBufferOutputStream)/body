{
  if (connection.useSasl) {
    ByteBuffer buf=response.getByteBuffer();
    byte[] token;
synchronized (connection.saslServer) {
      token=connection.saslServer.wrap(buf.array(),buf.arrayOffset(),buf.remaining());
    }
    if (LOG.isDebugEnabled())     LOG.debug("Adding saslServer wrapped token of size " + token.length + " as call response.");
    buf.clear();
    DataOutputStream saslOut=new DataOutputStream(response);
    saslOut.writeInt(token.length);
    saslOut.write(token,0,token.length);
  }
}
