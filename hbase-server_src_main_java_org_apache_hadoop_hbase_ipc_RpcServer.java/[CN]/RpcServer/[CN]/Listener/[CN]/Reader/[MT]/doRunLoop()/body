{
  while (running) {
    try {
      readSelector.select();
      Iterator<SelectionKey> iter=readSelector.selectedKeys().iterator();
      while (iter.hasNext()) {
        SelectionKey key=iter.next();
        iter.remove();
        if (key.isValid()) {
          if (key.isReadable()) {
            metrics.getMetricsSource().incrRunningReaders();
            try {
              doRead(key);
            }
  finally {
              metrics.getMetricsSource().decrRunningReaders();
            }
          }
        }
        key=null;
      }
    }
 catch (    InterruptedException e) {
      if (running) {
        LOG.info(Thread.currentThread().getName() + " unexpectedly interrupted",e);
      }
      return;
    }
catch (    IOException ex) {
      LOG.info(getName() + ": IOException in Reader",ex);
    }
  }
}
