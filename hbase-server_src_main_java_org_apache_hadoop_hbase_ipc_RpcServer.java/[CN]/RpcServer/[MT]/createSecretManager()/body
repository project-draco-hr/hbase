{
  if (!isSecurityEnabled)   return null;
  if (serverInstance == null)   return null;
  if (!(serverInstance instanceof org.apache.hadoop.hbase.Server))   return null;
  org.apache.hadoop.hbase.Server server=(org.apache.hadoop.hbase.Server)serverInstance;
  Configuration conf=server.getConfiguration();
  long keyUpdateInterval=conf.getLong("hbase.auth.key.update.interval",24 * 60 * 60* 1000);
  long maxAge=conf.getLong("hbase.auth.token.max.lifetime",7 * 24 * 60* 60* 1000);
  return new AuthenticationTokenSecretManager(conf,server.getZooKeeper(),server.getServerName().toString(),keyUpdateInterval,maxAge);
}
