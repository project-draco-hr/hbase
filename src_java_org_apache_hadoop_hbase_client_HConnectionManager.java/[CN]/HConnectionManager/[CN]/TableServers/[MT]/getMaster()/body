{
  HServerAddress masterLocation=null;
synchronized (this.masterLock) {
    for (int tries=0; !this.closed && !this.masterChecked && this.master == null && tries < numRetries; tries++) {
      masterLocation=new HServerAddress(this.conf.get(MASTER_ADDRESS,DEFAULT_MASTER_ADDRESS));
      try {
        HMasterInterface tryMaster=(HMasterInterface)HBaseRPC.getProxy(HMasterInterface.class,HBaseRPCProtocolVersion.versionID,masterLocation.getInetSocketAddress(),this.conf);
        if (tryMaster.isMasterRunning()) {
          this.master=tryMaster;
          break;
        }
      }
 catch (      IOException e) {
        if (tries == numRetries - 1) {
          break;
        }
        LOG.info("getMaster attempt " + tries + " of "+ this.numRetries+ " failed; retrying after sleep of "+ getPauseTime(tries),e);
      }
      try {
        Thread.sleep(getPauseTime(tries));
      }
 catch (      InterruptedException e) {
      }
    }
    this.masterChecked=true;
  }
  if (this.master == null) {
    if (masterLocation == null) {
      throw new MasterNotRunningException();
    }
    throw new MasterNotRunningException(masterLocation.toString());
  }
  return this.master;
}
