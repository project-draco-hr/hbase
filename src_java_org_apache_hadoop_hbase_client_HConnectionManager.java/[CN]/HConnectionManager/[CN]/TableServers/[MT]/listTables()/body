{
  HashSet<HTableDescriptor> uniqueTables=new HashSet<HTableDescriptor>();
  long scannerId=-1L;
  HRegionInterface server=null;
  Text startRow=EMPTY_START_ROW;
  HRegionLocation metaLocation=null;
  do {
    for (int triesSoFar=0; triesSoFar < numRetries; triesSoFar++) {
      try {
        metaLocation=locateRegion(META_TABLE_NAME,startRow);
        server=getHRegionConnection(metaLocation.getServerAddress());
        scannerId=server.openScanner(metaLocation.getRegionInfo().getRegionName(),new Text[]{COL_REGIONINFO},startRow,LATEST_TIMESTAMP,null);
        while (true) {
          RowResult values=server.next(scannerId);
          if (values == null || values.size() == 0) {
            break;
          }
          HRegionInfo info=Writables.getHRegionInfo(values.get(COL_REGIONINFO));
          if (info.getStartKey().getLength() == 0) {
            uniqueTables.add(info.getTableDesc());
          }
        }
        server.close(scannerId);
        scannerId=-1L;
        startRow=metaLocation.getRegionInfo().getEndKey();
        break;
      }
 catch (      IOException e) {
        metaLocation=relocateRegion(META_TABLE_NAME,startRow);
        continue;
      }
 finally {
        if (scannerId != -1L && server != null) {
          server.close(scannerId);
        }
      }
    }
  }
 while (startRow.compareTo(LAST_ROW) != 0);
  return uniqueTables.toArray(new HTableDescriptor[uniqueTables.size()]);
}
