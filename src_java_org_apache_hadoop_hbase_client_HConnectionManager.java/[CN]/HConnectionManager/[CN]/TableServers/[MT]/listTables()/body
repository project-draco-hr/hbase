{
  getMaster();
  final TreeSet<HTableDescriptor> uniqueTables=new TreeSet<HTableDescriptor>();
  MetaScannerVisitor visitor=new MetaScannerVisitor(){
    public boolean processRow(    Result result) throws IOException {
      try {
        HRegionInfo info=Writables.getHRegionInfo(result.getValue(CATALOG_FAMILY,REGIONINFO_QUALIFIER));
        if (info != null && info.getStartKey().length == 0) {
          uniqueTables.add(info.getTableDesc());
        }
        return true;
      }
 catch (      RuntimeException e) {
        LOG.error("Result=" + result);
        throw e;
      }
    }
  }
;
  MetaScanner.metaScan(conf,visitor);
  return uniqueTables.toArray(new HTableDescriptor[uniqueTables.size()]);
}
