{
  if (Bytes.equals(tableName,HConstants.ROOT_TABLE_NAME)) {
    return new UnmodifyableHTableDescriptor(HTableDescriptor.ROOT_TABLEDESC);
  }
  HTable meta=new HTable(conf,Bytes.equals(tableName,HConstants.META_TABLE_NAME) ? HConstants.ROOT_TABLE_NAME : HConstants.META_TABLE_NAME);
  Scanner s=meta.getScanner(HConstants.COL_REGIONINFO_ARRAY,HRegionInfo.createRegionName(tableName,null,HConstants.ZEROES));
  try {
    RowResult r=null;
    while ((r=s.next()) != null) {
      Cell c=r.get(HConstants.COL_REGIONINFO);
      if (c != null) {
        HRegionInfo info=Writables.getHRegionInfoOrNull(c.getValue());
        if (info != null) {
          if (Bytes.equals(info.getTableDesc().getName(),tableName)) {
            return new UnmodifyableHTableDescriptor(info.getTableDesc());
          }
        }
      }
    }
    return null;
  }
  finally {
    s.close();
  }
}
