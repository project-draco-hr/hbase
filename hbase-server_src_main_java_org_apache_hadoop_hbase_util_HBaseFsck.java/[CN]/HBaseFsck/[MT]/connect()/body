{
  hbckOutFd=checkAndMarkRunningHbck();
  if (hbckOutFd == null) {
    setRetCode(-1);
    LOG.error("Another instance of hbck is running, exiting this instance.[If you are sure" + " no other instance is running, delete the lock file " + HBCK_LOCK_PATH + " and rerun the tool]");
    throw new IOException("Duplicate hbck - Abort");
  }
  Runtime.getRuntime().addShutdownHook(new Thread(){
    public void run(){
      try {
        unlockHbck();
      }
 catch (      Exception e) {
        LOG.debug("Error while removing hbck lock " + e.getMessage());
      }
    }
  }
);
  LOG.debug("Launching hbck");
  connection=HConnectionManager.createConnection(getConf());
  admin=new HBaseAdmin(connection);
  meta=new HTable(TableName.META_TABLE_NAME,connection);
  status=admin.getClusterStatus();
}
