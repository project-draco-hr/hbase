{
  Configuration conf=HBaseConfiguration.create();
  Path hbasedir=new Path(conf.get(HConstants.HBASE_DIR));
  URI defaultFs=hbasedir.getFileSystem(conf).getUri();
  conf.set("fs.defaultFS",defaultFs.toString());
  conf.set("fs.default.name",defaultFs.toString());
  int numThreads=conf.getInt("hbasefsck.numthreads",MAX_NUM_THREADS);
  ExecutorService exec=new ScheduledThreadPoolExecutor(numThreads);
  HBaseFsck hbck=new HBaseFsck(conf,exec);
  hbck.exec(exec,args);
  int retcode=hbck.getRetCode();
  Runtime.getRuntime().exit(retcode);
}
