{
  if (shouldIgnorePreCheckPermission()) {
    return;
  }
  Path hbaseDir=new Path(conf.get(HConstants.HBASE_DIR));
  FileSystem fs=hbaseDir.getFileSystem(conf);
  UserGroupInformation ugi=User.getCurrent().getUGI();
  FileStatus[] files=fs.listStatus(hbaseDir);
  for (  FileStatus file : files) {
    try {
      FSUtils.checkAccess(ugi,file,FsAction.WRITE);
    }
 catch (    AccessControlException ace) {
      LOG.warn("Got AccessControlException when preCheckPermission ",ace);
      System.err.println("Current user " + ugi.getUserName() + " does not have write perms to "+ file.getPath()+ ". Please rerun hbck as hdfs user "+ file.getOwner());
      throw new AccessControlException(ace);
    }
  }
}
