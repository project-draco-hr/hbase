{
  Path rootdir=new Path(conf.get(HConstants.HBASE_DIR));
  Configuration c=conf;
  HRegionInfo rootHRI=new HRegionInfo(HRegionInfo.ROOT_REGIONINFO);
  MasterFileSystem.setInfoFamilyCachingForRoot(false);
  HRegionInfo metaHRI=new HRegionInfo(HRegionInfo.FIRST_META_REGIONINFO);
  MasterFileSystem.setInfoFamilyCachingForMeta(false);
  HRegion root=HRegion.createHRegion(rootHRI,rootdir,c,HTableDescriptor.ROOT_TABLEDESC);
  HRegion meta=HRegion.createHRegion(metaHRI,rootdir,c,HTableDescriptor.META_TABLEDESC);
  MasterFileSystem.setInfoFamilyCachingForRoot(true);
  MasterFileSystem.setInfoFamilyCachingForMeta(true);
  HRegion.addRegionToMETA(root,meta);
  HRegion.closeHRegion(root);
  return meta;
}
