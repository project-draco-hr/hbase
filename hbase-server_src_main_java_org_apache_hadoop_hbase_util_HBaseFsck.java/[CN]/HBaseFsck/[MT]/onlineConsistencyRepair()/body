{
  clearState();
  loadDeployedRegions();
  if (!recordMetaRegion()) {
    errors.reportError("Fatal error: unable to get hbase:meta region location. Exiting...");
    return -2;
  }
  if (!checkMetaRegion()) {
    String errorMsg="hbase:meta table is not consistent. ";
    if (shouldFixAssignments()) {
      errorMsg+="HBCK will try fixing it. Rerun once hbase:meta is back to consistent state.";
    }
 else {
      errorMsg+="Run HBCK with proper fix options to fix hbase:meta inconsistency.";
    }
    errors.reportError(errorMsg + " Exiting...");
    return -2;
  }
  LOG.info("Loading regionsinfo from the hbase:meta table");
  boolean success=loadMetaEntries();
  if (!success)   return -1;
  reportEmptyMetaCells();
  if (shouldFixEmptyMetaCells()) {
    fixEmptyMetaCells();
  }
  if (!checkMetaOnly) {
    reportTablesInFlux();
  }
  if (shouldCheckHdfs()) {
    loadHdfsRegionDirs();
    loadHdfsRegionInfos();
  }
  loadDisabledTables();
  fixOrphanTables();
  checkAndFixConsistency();
  checkIntegrity();
  return errors.getErrorList().size();
}
