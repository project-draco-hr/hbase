{
  errors.print("Version: " + status.getHBaseVersion());
  offlineHdfsIntegrityRepair();
  boolean oldBalancer=true;
  if (switchBalancer) {
    oldBalancer=admin.setBalancerRunning(false,true);
  }
  try {
    onlineConsistencyRepair();
  }
  finally {
    if (switchBalancer) {
      admin.setBalancerRunning(oldBalancer,false);
    }
  }
  if (checkRegionBoundaries) {
    checkRegionBoundaries();
  }
  offlineReferenceFileRepair();
  checkAndFixTableLocks();
  unlockHbck();
  printTableSummary(tablesInfo);
  return errors.summarize();
}
