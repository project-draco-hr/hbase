{
  errors.print("Version: " + status.getHBaseVersion());
  offlineHdfsIntegrityRepair();
  boolean oldBalancer=false;
  if (shouldDisableBalancer()) {
    oldBalancer=admin.setBalancerRunning(false,true);
  }
  boolean[] oldSplitAndMerge=null;
  if (shouldDisableSplitAndMerge()) {
    admin.releaseSplitOrMergeLockAndRollback();
    oldSplitAndMerge=admin.setSplitOrMergeEnabled(false,false,false,Admin.MasterSwitchType.SPLIT,Admin.MasterSwitchType.MERGE);
  }
  try {
    onlineConsistencyRepair();
  }
  finally {
    if (shouldDisableBalancer() && oldBalancer) {
      admin.setBalancerRunning(oldBalancer,false);
    }
    if (shouldDisableSplitAndMerge()) {
      if (oldSplitAndMerge != null) {
        admin.releaseSplitOrMergeLockAndRollback();
      }
    }
  }
  if (checkRegionBoundaries) {
    checkRegionBoundaries();
  }
  offlineReferenceFileRepair();
  checkAndFixTableLocks();
  checkAndFixReplication();
  unlockHbck();
  printTableSummary(tablesInfo);
  return errors.summarize();
}
