{
  LOG.info("Checking HBase region split map from HDFS data...");
  for (  TableInfo tInfo : tablesInfo.values()) {
    TableIntegrityErrorHandler handler;
    if (fixHoles || fixOverlaps) {
      if (shouldFixTable(Bytes.toBytes(tInfo.getName()))) {
        handler=tInfo.new HDFSIntegrityFixer(tInfo,errors,conf,fixHoles,fixOverlaps);
      }
 else {
        LOG.info("Table " + tInfo.getName() + " is not in the include table "+ "list.  Just suggesting fixes.");
        handler=tInfo.new IntegrityFixSuggester(tInfo,errors);
      }
    }
 else {
      handler=tInfo.new IntegrityFixSuggester(tInfo,errors);
    }
    if (!tInfo.checkRegionChain(handler)) {
      errors.report("Found inconsistency in table " + tInfo.getName());
    }
  }
  return tablesInfo;
}
