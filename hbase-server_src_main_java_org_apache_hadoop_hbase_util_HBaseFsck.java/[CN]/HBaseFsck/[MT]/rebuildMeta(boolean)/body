{
  LOG.info("Loading HBase regioninfo from HDFS...");
  loadHdfsRegionDirs();
  int errs=errors.getErrorList().size();
  tablesInfo=loadHdfsRegionInfos();
  checkHdfsIntegrity(false,false);
  if (errors.getErrorList().size() != errs) {
    while (true) {
      fixes=0;
      suggestFixes(tablesInfo);
      errors.clear();
      loadHdfsRegionInfos();
      checkHdfsIntegrity(shouldFixHdfsHoles(),shouldFixHdfsOverlaps());
      int errCount=errors.getErrorList().size();
      if (fixes == 0) {
        if (errCount > 0) {
          return false;
        }
 else {
          break;
        }
      }
    }
  }
  LOG.info("HDFS regioninfo's seems good.  Sidelining old .META.");
  Path backupDir=sidelineOldMeta();
  LOG.info("Creating new .META.");
  HRegion meta=createNewMeta();
  List<Put> puts=generatePuts(tablesInfo);
  if (puts == null) {
    LOG.fatal("Problem encountered when creating new .META. entries.  " + "You may need to restore the previously sidelined .META.");
    return false;
  }
  meta.put(puts.toArray(new Put[0]));
  HRegion.closeHRegion(meta);
  LOG.info("Success! .META. table rebuilt.");
  LOG.info("Old .META. is moved into " + backupDir);
  return true;
}
