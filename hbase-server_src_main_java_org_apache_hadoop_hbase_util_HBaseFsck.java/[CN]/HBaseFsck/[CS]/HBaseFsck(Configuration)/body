{
  super(conf);
  setConf(HBaseConfiguration.create(getConf()));
  getConf().setFloat(HConstants.HFILE_BLOCK_CACHE_SIZE_KEY,0);
  getConf().setBoolean(HConstants.USE_META_REPLICAS,false);
  errors=getErrorReporter(conf);
  int numThreads=conf.getInt("hbasefsck.numthreads",MAX_NUM_THREADS);
  executor=new ScheduledThreadPoolExecutor(numThreads,Threads.newDaemonThreadFactory("hbasefsck"));
  lockFileRetryCounterFactory=new RetryCounterFactory(getConf().getInt("hbase.hbck.lockfile.attempts",DEFAULT_MAX_LOCK_FILE_ATTEMPTS),getConf().getInt("hbase.hbck.lockfile.attempt.sleep.interval",DEFAULT_LOCK_FILE_ATTEMPT_SLEEP_INTERVAL),getConf().getInt("hbase.hbck.lockfile.attempt.maxsleeptime",DEFAULT_LOCK_FILE_ATTEMPT_MAX_SLEEP_TIME));
}
