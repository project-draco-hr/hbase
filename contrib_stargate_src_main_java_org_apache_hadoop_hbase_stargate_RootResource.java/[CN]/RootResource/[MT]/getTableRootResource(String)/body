{
  if (servlet.isMultiUser()) {
    User user=servlet.getAuthenticator().getUserForToken(token);
    if (user == null || user.isDisabled()) {
      throw new WebApplicationException(Response.Status.FORBIDDEN);
    }
    try {
      ResponseBuilder response=Response.ok(getTableListForUser(user));
      response.cacheControl(cacheControl);
      return response.build();
    }
 catch (    IOException e) {
      throw new WebApplicationException(e,Response.Status.SERVICE_UNAVAILABLE);
    }
  }
  throw new WebApplicationException(Response.Status.BAD_REQUEST);
}
