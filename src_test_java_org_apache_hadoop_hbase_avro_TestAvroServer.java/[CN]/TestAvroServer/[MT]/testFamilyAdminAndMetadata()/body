{
  AvroServer.HBaseImpl impl=new AvroServer.HBaseImpl(TEST_UTIL.getConfiguration());
  ATableDescriptor tableA=new ATableDescriptor();
  tableA.name=tableAname;
  AFamilyDescriptor familyA=new AFamilyDescriptor();
  familyA.name=familyAname;
  Schema familyArraySchema=Schema.createArray(AFamilyDescriptor.SCHEMA$);
  GenericArray<AFamilyDescriptor> families=new GenericData.Array<AFamilyDescriptor>(1,familyArraySchema);
  families.add(familyA);
  tableA.families=families;
  impl.createTable(tableA);
  assertEquals(impl.describeTable(tableAname).families.size(),1);
  impl.disableTable(tableAname);
  assertFalse(impl.isTableEnabled(tableAname));
  familyA.maxVersions=123456;
  impl.modifyFamily(tableAname,familyAname,familyA);
  assertEquals((int)impl.describeFamily(tableAname,familyAname).maxVersions,123456);
  impl.deleteFamily(tableAname,familyAname);
  assertEquals(impl.describeTable(tableAname).families.size(),0);
  impl.disableTable(tableAname);
  impl.deleteTable(tableAname);
}
