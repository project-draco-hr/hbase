{
  AvroServer.HBaseImpl impl=new AvroServer.HBaseImpl(TEST_UTIL.getConfiguration());
  assertEquals(impl.listTables().size(),0);
  ATableDescriptor tableA=new ATableDescriptor();
  tableA.name=tableAname;
  impl.createTable(tableA);
  assertEquals(impl.listTables().size(),1);
  assertTrue(impl.isTableEnabled(tableAname));
  assertTrue(impl.tableExists(tableAname));
  ATableDescriptor tableB=new ATableDescriptor();
  tableB.name=tableBname;
  impl.createTable(tableB);
  assertEquals(impl.listTables().size(),2);
  impl.disableTable(tableBname);
  assertFalse(impl.isTableEnabled(tableBname));
  impl.deleteTable(tableBname);
  assertEquals(impl.listTables().size(),1);
  impl.disableTable(tableAname);
  assertFalse(impl.isTableEnabled(tableAname));
  long oldMaxFileSize=impl.describeTable(tableAname).maxFileSize;
  tableA.maxFileSize=123456L;
  impl.modifyTable(tableAname,tableA);
  while (impl.describeTable(tableAname).maxFileSize == oldMaxFileSize) {
    Threads.sleep(100);
  }
  assertTrue(impl.describeTable(tableAname).maxFileSize == 123456L);
  assertEquals(123456L,(long)impl.describeTable(tableAname).maxFileSize);
  impl.deleteTable(tableAname);
}
