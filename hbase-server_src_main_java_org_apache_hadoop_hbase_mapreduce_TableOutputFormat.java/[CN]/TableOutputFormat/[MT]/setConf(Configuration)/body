{
  this.conf=HBaseConfiguration.create(otherConf);
  String tableName=this.conf.get(OUTPUT_TABLE);
  if (tableName == null || tableName.length() <= 0) {
    throw new IllegalArgumentException("Must specify table name");
  }
  String address=this.conf.get(QUORUM_ADDRESS);
  int zkClientPort=this.conf.getInt(QUORUM_PORT,0);
  String serverClass=this.conf.get(REGION_SERVER_CLASS);
  String serverImpl=this.conf.get(REGION_SERVER_IMPL);
  try {
    if (address != null) {
      ZKUtil.applyClusterKeyToConf(this.conf,address);
    }
    if (serverClass != null) {
      this.conf.set(HConstants.REGION_SERVER_IMPL,serverImpl);
    }
    if (zkClientPort != 0) {
      this.conf.setInt(HConstants.ZOOKEEPER_CLIENT_PORT,zkClientPort);
    }
    this.connection=ConnectionFactory.createConnection(this.conf);
    this.table=connection.getTable(TableName.valueOf(tableName));
    ((HTable)this.table).setAutoFlush(false,true);
    LOG.info("Created table instance for " + tableName);
  }
 catch (  IOException e) {
    LOG.error(e);
    throw new RuntimeException(e);
  }
}
