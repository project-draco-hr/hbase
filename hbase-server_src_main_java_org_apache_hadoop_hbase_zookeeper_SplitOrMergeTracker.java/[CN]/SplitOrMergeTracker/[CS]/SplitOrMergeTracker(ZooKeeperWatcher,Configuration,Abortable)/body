{
  try {
    if (ZKUtil.checkExists(watcher,watcher.getSwitchZNode()) < 0) {
      ZKUtil.createAndFailSilent(watcher,watcher.getSwitchZNode());
    }
    if (ZKUtil.checkExists(watcher,watcher.getSwitchLockZNode()) < 0) {
      ZKUtil.createAndFailSilent(watcher,watcher.getSwitchLockZNode());
    }
  }
 catch (  KeeperException e) {
    throw new RuntimeException(e);
  }
  splitZnode=ZKUtil.joinZNode(watcher.getSwitchZNode(),conf.get("zookeeper.znode.switch.split","split"));
  mergeZnode=ZKUtil.joinZNode(watcher.getSwitchZNode(),conf.get("zookeeper.znode.switch.merge","merge"));
  splitOrMergeLock=ZKUtil.joinZNode(watcher.getSwitchLockZNode(),LOCK);
  splitStateTracker=new SwitchStateTracker(watcher,splitZnode,abortable);
  mergeStateTracker=new SwitchStateTracker(watcher,mergeZnode,abortable);
  this.watcher=watcher;
}
