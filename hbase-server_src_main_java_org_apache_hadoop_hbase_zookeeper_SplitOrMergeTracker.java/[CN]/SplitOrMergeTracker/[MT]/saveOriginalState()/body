{
  boolean splitEnabled=isSplitOrMergeEnabled(MasterSwitchType.SPLIT);
  boolean mergeEnabled=isSplitOrMergeEnabled(MasterSwitchType.MERGE);
  String splitOrMergeStates=ZKUtil.joinZNode(watcher.getSwitchLockZNode(),SplitOrMergeTracker.STATE);
  ZooKeeperProtos.SplitAndMergeState.Builder builder=ZooKeeperProtos.SplitAndMergeState.newBuilder();
  builder.setSplitEnabled(splitEnabled);
  builder.setMergeEnabled(mergeEnabled);
  ZKUtil.createSetData(watcher,splitOrMergeStates,ProtobufUtil.prependPBMagic(builder.build().toByteArray()));
}
