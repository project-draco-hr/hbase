{
  final AsyncCall<R,O> call=new AsyncCall<>(this,client.callIdCnt.getAndIncrement(),method,request,cellScanner,responsePrototype,messageConverter,exceptionConverter,rpcTimeout,priority,client.metrics);
synchronized (pendingCalls) {
    if (closed) {
      call.setFailure(new ConnectException());
      return call;
    }
    pendingCalls.put(call.id,call);
    if (cleanupTimer == null && call.getRpcTimeout() > 0) {
      cleanupTimer=client.newTimeout(timeoutTask,call.getRpcTimeout(),TimeUnit.MILLISECONDS);
    }
    if (!connected) {
      return call;
    }
  }
  writeRequest(call);
  return call;
}
