{
synchronized (this.master.regionManager) {
    if (info.isOffline() || this.master.regionManager.regionIsInTransition(info.getRegionName()) || this.master.serverManager.isDead(serverName)) {
      return;
    }
    HServerInfo storedInfo=null;
    if (serverName.length() != 0) {
      storedInfo=this.master.serverManager.getServerInfo(serverName);
    }
    if (storedInfo == null || storedInfo.getStartCode() != startCode) {
      if (LOG.isDebugEnabled()) {
        LOG.debug("Current assignment of " + info.getRegionNameAsString() + " is not valid; "+ (storedInfo == null ? " Server '" + serverName + "' unknown." : " serverInfo: " + storedInfo + ", passed startCode: "+ startCode+ ", storedInfo.startCode: "+ storedInfo.getStartCode()));
      }
      if (!this.master.regionManager.isInitialMetaScanComplete() && serverName.length() != 0) {
        StringBuilder dirName=new StringBuilder("log_");
        dirName.append(serverName.replace(":","_"));
        Path logDir=new Path(this.master.rootdir,dirName.toString());
        try {
          if (master.fs.exists(logDir)) {
            this.master.regionManager.splitLogLock.lock();
            try {
              HLog.splitLog(master.rootdir,logDir,master.fs,master.getConfiguration());
            }
  finally {
              this.master.regionManager.splitLogLock.unlock();
            }
          }
          if (LOG.isDebugEnabled()) {
            LOG.debug("Split " + logDir.toString());
          }
        }
 catch (        IOException e) {
          LOG.warn("unable to split region server log because: ",e);
          throw e;
        }
      }
      this.master.regionManager.setUnassigned(info,true);
    }
  }
}
