{
  byte[] tableName=Bytes.toBytes("baseCases");
  if (TEST_UTIL.getHBaseAdmin().tableExists(tableName)) {
    TEST_UTIL.deleteTable(tableName);
  }
  HTable t=TEST_UTIL.createTable(tableName,F,1);
  Put p=new Put(R);
  p.setAttribute("versions",new byte[]{});
  p.add(F,tableName,Bytes.toBytes(2));
  t.put(p);
  long now=EnvironmentEdgeManager.currentTimeMillis();
  p=new Put(R);
  p.add(F,Q,now,Q);
  t.put(p);
  p=new Put(R);
  p.add(F,Q,now + 1,Q);
  t.put(p);
  Get g=new Get(R);
  g.setMaxVersions(10);
  Result r=t.get(g);
  assertEquals(2,r.size());
  TEST_UTIL.flush(tableName);
  TEST_UTIL.compact(tableName,true);
  g=new Get(R);
  g.setMaxVersions(10);
  r=t.get(g);
  assertEquals(2,r.size());
  p=new Put(R);
  p.add(F,Q,now + 2,Q);
  t.put(p);
  g=new Get(R);
  g.setMaxVersions(10);
  r=t.get(g);
  assertEquals(2,r.size());
  t.close();
}
