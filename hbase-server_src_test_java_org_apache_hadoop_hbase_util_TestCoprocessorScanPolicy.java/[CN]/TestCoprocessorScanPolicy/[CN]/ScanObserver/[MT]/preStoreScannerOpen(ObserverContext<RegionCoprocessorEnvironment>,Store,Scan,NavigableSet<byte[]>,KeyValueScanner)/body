{
  Long newTtl=ttls.get(store.getTableName());
  Integer newVersions=versions.get(store.getTableName());
  Store.ScanInfo oldSI=store.getScanInfo();
  HColumnDescriptor family=store.getFamily();
  Store.ScanInfo scanInfo=new Store.ScanInfo(family.getName(),family.getMinVersions(),newVersions == null ? family.getMaxVersions() : newVersions,newTtl == null ? oldSI.getTtl() : newTtl,family.getKeepDeletedCells(),oldSI.getTimeToPurgeDeletes(),oldSI.getComparator());
  return new StoreScanner(store,scanInfo,scan,targetCols);
}
