{
  Long newTtl=ttls.get(store.getTableName());
  Integer newVersions=versions.get(store.getTableName());
  HStore.ScanInfo oldSI=store.getScanInfo();
  HColumnDescriptor family=store.getFamily();
  HStore.ScanInfo scanInfo=new HStore.ScanInfo(family.getName(),family.getMinVersions(),newVersions == null ? family.getMaxVersions() : newVersions,newTtl == null ? oldSI.getTtl() : newTtl,family.getKeepDeletedCells(),oldSI.getTimeToPurgeDeletes(),oldSI.getComparator());
  Scan scan=new Scan();
  scan.setMaxVersions(newVersions == null ? oldSI.getMaxVersions() : newVersions);
  return new StoreScanner(store,scanInfo,scan,scanners,scanType,store.getHRegion().getSmallestReadPoint(),earliestPutTs);
}
