{
  Table htab1A=connection1.getTable(tabAName);
  Table htab2A=connection2.getTable(tabAName);
  Table htab1B=connection1.getTable(tabBName);
  Table htab2B=connection2.getTable(tabBName);
  admin.peerAdded("2");
  ReplicationPeerConfig rpc=admin.getPeerConfig("2");
  Set<String> namespaces=new HashSet<>();
  namespaces.add(ns1);
  rpc.setNamespaces(namespaces);
  admin.updatePeerConfig("2",rpc);
  LOG.info("update peer config");
  put(htab1A,row,f1Name,f2Name);
  ensureRowExisted(htab2A,row,f1Name,f2Name);
  delete(htab1A,row,f1Name,f2Name);
  ensureRowNotExisted(htab2A,row,f1Name,f2Name);
  put(htab1B,row,f1Name,f2Name);
  ensureRowNotExisted(htab2B,row,f1Name,f2Name);
  rpc=admin.getPeerConfig("2");
  namespaces=new HashSet<>();
  namespaces.add(ns2);
  rpc.setNamespaces(namespaces);
  Map<TableName,List<String>> tableCfs=new HashMap<>();
  tableCfs.put(tabAName,new ArrayList<String>());
  tableCfs.get(tabAName).add("f1");
  rpc.setTableCFsMap(tableCfs);
  admin.updatePeerConfig("2",rpc);
  LOG.info("update peer config");
  put(htab1A,row,f1Name,f2Name);
  ensureRowExisted(htab2A,row,f1Name);
  delete(htab1A,row,f1Name,f2Name);
  ensureRowNotExisted(htab2A,row,f1Name);
  put(htab1B,row,f1Name,f2Name);
  ensureRowExisted(htab2B,row,f1Name,f2Name);
  delete(htab1B,row,f1Name,f2Name);
  ensureRowNotExisted(htab2B,row,f1Name,f2Name);
  admin.removePeer("2");
}
