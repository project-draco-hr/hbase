{
  block=newBlock;
  if (block.getBlockType() != BlockType.ENCODED_DATA) {
    throw new IllegalStateException("EncodedScanner works only on encoded data blocks");
  }
  short dataBlockEncoderId=block.getDataBlockEncodingId();
  if (!DataBlockEncoding.isCorrectEncoder(dataBlockEncoder,dataBlockEncoderId)) {
    String encoderCls=dataBlockEncoder.getClass().getName();
    throw new CorruptHFileException("Encoder " + encoderCls + " doesn't support data block encoding "+ DataBlockEncoding.getNameFromId(dataBlockEncoderId));
  }
  ByteBuff encodedBuffer=getEncodedBuffer(newBlock);
  seeker.setCurrentBuffer(encodedBuffer);
  blockFetches++;
  this.nextIndexedKey=null;
}
