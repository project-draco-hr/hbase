{
  if (!isSeeked())   return null;
  KeyValue ret;
  if (currTagsLen > 0) {
    if (this.curBlock.getMemoryType() == MemoryType.SHARED) {
      ret=new ShareableMemoryKeyValue(blockBuffer.array(),blockBuffer.arrayOffset() + blockBuffer.position(),getCellBufSize());
    }
 else {
      ret=new SizeCachedKeyValue(blockBuffer.array(),blockBuffer.arrayOffset() + blockBuffer.position(),getCellBufSize());
    }
  }
 else {
    if (this.curBlock.getMemoryType() == MemoryType.SHARED) {
      ret=new ShareableMemoryNoTagsKeyValue(blockBuffer.array(),blockBuffer.arrayOffset() + blockBuffer.position(),getCellBufSize());
    }
 else {
      ret=new SizeCachedNoTagsKeyValue(blockBuffer.array(),blockBuffer.arrayOffset() + blockBuffer.position(),getCellBufSize());
    }
  }
  if (this.reader.shouldIncludeMemstoreTS()) {
    ret.setSequenceId(currMemstoreTS);
  }
  return ret;
}
