{
  Scan scan=new Scan();
  scan.addColumn(family,qualifier);
  int sumResult=0;
  InternalScanner scanner=((RegionCoprocessorEnvironment)getEnvironment()).getRegion().getScanner(scan);
  try {
    List<KeyValue> curVals=new ArrayList<KeyValue>();
    boolean hasMore=false;
    do {
      curVals.clear();
      hasMore=scanner.next(curVals);
      for (      KeyValue kv : curVals) {
        if (Bytes.equals(qualifier,kv.getQualifier())) {
          sumResult+=Bytes.toInt(kv.getBuffer(),kv.getValueOffset());
        }
      }
    }
 while (hasMore);
  }
  finally {
    scanner.close();
  }
  return sumResult;
}
