{
  byte[] tableName=Bytes.toBytes(tableNameString);
  if (!onlineSnapshot) {
    try {
      admin.disableTable(tableNameString);
    }
 catch (    TableNotEnabledException tne) {
      LOG.info("In attempting to disable " + tableNameString + " it turns out that this table is already disabled.");
    }
  }
  admin.snapshot(snapshotNameString,tableNameString);
  List<SnapshotDescription> snapshots=SnapshotTestingUtils.assertExistsMatchingSnapshot(admin,snapshotNameString,tableNameString);
  if (snapshots == null || snapshots.size() != 1) {
    Assert.fail("Incorrect number of snapshots for table " + String.valueOf(tableNameString));
  }
  SnapshotTestingUtils.confirmSnapshotValid(snapshots.get(0),tableName,Bytes.toBytes(familyName),rootDir,admin,fs,false,new Path(rootDir,HConstants.HREGION_LOGDIR_NAME),familyEmpty,null);
}
