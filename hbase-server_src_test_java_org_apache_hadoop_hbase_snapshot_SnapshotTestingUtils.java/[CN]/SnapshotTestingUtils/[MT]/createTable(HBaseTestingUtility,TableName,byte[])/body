{
  HTableDescriptor htd=new HTableDescriptor(tableName);
  for (  byte[] family : families) {
    HColumnDescriptor hcd=new HColumnDescriptor(family);
    htd.addFamily(hcd);
  }
  byte[][] splitKeys=new byte[KEYS.length - 2][];
  for (int i=0; i < splitKeys.length; ++i) {
    splitKeys[i]=new byte[]{KEYS[i + 1]};
  }
  util.getHBaseAdmin().createTable(htd,splitKeys);
  waitForTableToBeOnline(util,tableName);
  assertEquals(KEYS.length - 1,util.getHBaseAdmin().getTableRegions(tableName).size());
}
