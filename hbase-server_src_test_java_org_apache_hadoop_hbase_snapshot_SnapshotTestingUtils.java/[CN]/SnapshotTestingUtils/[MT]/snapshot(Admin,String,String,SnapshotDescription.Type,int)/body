{
  int tries=0;
  CorruptedSnapshotException lastEx=null;
  while (tries++ < numTries) {
    try {
      admin.snapshot(snapshotName,TableName.valueOf(tableName),type);
      return;
    }
 catch (    CorruptedSnapshotException cse) {
      LOG.warn("Got CorruptedSnapshotException",cse);
      lastEx=cse;
    }
  }
  throw lastEx;
}
