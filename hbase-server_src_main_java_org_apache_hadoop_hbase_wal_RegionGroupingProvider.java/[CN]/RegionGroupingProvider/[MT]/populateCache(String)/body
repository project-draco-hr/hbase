{
  boolean isMeta=META_WAL_PROVIDER_ID.equals(providerId);
  String hlogPrefix;
  List<WALActionsListener> listeners;
  if (isMeta) {
    hlogPrefix=this.providerId;
    listeners=Collections.<WALActionsListener>singletonList(new MetricsWAL());
  }
 else {
    hlogPrefix=groupName;
    listeners=this.listeners;
  }
  FSHLog log=new FSHLog(FileSystem.get(conf),FSUtils.getRootDir(conf),DefaultWALProvider.getWALDirectoryName(providerId),HConstants.HREGION_OLDLOGDIR_NAME,conf,listeners,true,hlogPrefix,isMeta ? META_WAL_PROVIDER_ID : null);
  cached.put(groupName,log);
  logs.add(log);
  return log;
}
