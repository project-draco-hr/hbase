{
  super(name,Math.max(writeHandlers + readHandlers,numWriteQueues + numReadQueues));
  this.writeHandlersCount=Math.max(writeHandlers,numWriteQueues);
  this.readHandlersCount=Math.max(readHandlers,numReadQueues);
  this.numWriteQueues=numWriteQueues;
  this.numReadQueues=numReadQueues;
  queues=new ArrayList<BlockingQueue<CallRunner>>(writeHandlersCount + readHandlersCount);
  LOG.debug(name + " writeQueues=" + numWriteQueues+ " writeHandlers="+ writeHandlersCount+ " readQueues="+ numReadQueues+ " readHandlers="+ readHandlersCount);
  for (int i=0; i < numWriteQueues; ++i) {
    queues.add((BlockingQueue<CallRunner>)ReflectionUtils.newInstance(writeQueueClass,writeQueueInitArgs));
  }
  for (int i=0; i < numReadQueues; ++i) {
    queues.add((BlockingQueue<CallRunner>)ReflectionUtils.newInstance(readQueueClass,readQueueInitArgs));
  }
}
