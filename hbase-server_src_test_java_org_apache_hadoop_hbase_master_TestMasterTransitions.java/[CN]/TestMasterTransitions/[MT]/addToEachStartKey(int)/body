{
  HTable t=new HTable(TEST_UTIL.getConfiguration(),TABLENAME);
  HTable meta=new HTable(TEST_UTIL.getConfiguration(),TableName.META_TABLE_NAME);
  int rows=0;
  Scan scan=new Scan();
  scan.addColumn(HConstants.CATALOG_FAMILY,HConstants.REGIONINFO_QUALIFIER);
  ResultScanner s=meta.getScanner(scan);
  for (Result r=null; (r=s.next()) != null; ) {
    HRegionInfo hri=HRegionInfo.getHRegionInfo(r);
    if (hri == null)     break;
    if (!hri.getTableName().getNameAsString().equals(TABLENAME)) {
      continue;
    }
    if (!hri.getTableName().getNameAsString().equals(TABLENAME)) {
      continue;
    }
    byte[] row=getStartKey(hri);
    Put p=new Put(row);
    p.setDurability(Durability.SKIP_WAL);
    p.add(getTestFamily(),getTestQualifier(),row);
    t.put(p);
    rows++;
  }
  s.close();
  Assert.assertEquals(expected,rows);
  t.close();
  meta.close();
  return rows;
}
