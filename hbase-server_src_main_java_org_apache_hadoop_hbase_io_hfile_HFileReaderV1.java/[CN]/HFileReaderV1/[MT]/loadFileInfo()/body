{
  if (fileInfoLoaded)   return fileInfo;
  istream.seek(trailer.getFileInfoOffset());
  fileInfo=new FileInfo();
  fileInfo.read(istream);
  lastKey=fileInfo.get(FileInfo.LASTKEY);
  avgKeyLen=Bytes.toInt(fileInfo.get(FileInfo.AVG_KEY_LEN));
  avgValueLen=Bytes.toInt(fileInfo.get(FileInfo.AVG_VALUE_LEN));
  String clazzName=Bytes.toString(fileInfo.get(FileInfo.COMPARATOR));
  comparator=getComparator(clazzName);
  dataBlockIndexReader=new HFileBlockIndex.BlockIndexReader(comparator,1);
  metaBlockIndexReader=new HFileBlockIndex.BlockIndexReader(Bytes.BYTES_RAWCOMPARATOR,1);
  int sizeToLoadOnOpen=(int)(fileSize - trailer.getLoadOnOpenDataOffset() - trailer.getTrailerSize());
  byte[] dataAndMetaIndex=readAllIndex(istream,trailer.getLoadOnOpenDataOffset(),sizeToLoadOnOpen);
  ByteArrayInputStream bis=new ByteArrayInputStream(dataAndMetaIndex);
  DataInputStream dis=new DataInputStream(bis);
  if (trailer.getDataIndexCount() > 0)   BlockType.INDEX_V1.readAndCheck(dis);
  dataBlockIndexReader.readRootIndex(dis,trailer.getDataIndexCount());
  if (trailer.getMetaIndexCount() > 0)   BlockType.INDEX_V1.readAndCheck(dis);
  metaBlockIndexReader.readRootIndex(dis,trailer.getMetaIndexCount());
  fileInfoLoaded=true;
  return fileInfo;
}
