{
  try {
    if (logWriterClass == null) {
      logWriterClass=Class.forName(conf.get("hbase.regionserver.hlog.writer.impl",SequenceFileLogWriter.class.getCanonicalName()));
    }
    HLog.Writer writer=(HLog.Writer)logWriterClass.newInstance();
    writer.init(fs,path,conf);
    return writer;
  }
 catch (  Exception e) {
    IOException ie=new IOException("cannot get log writer");
    ie.initCause(e);
    throw ie;
  }
}
