{
  BackupSystemTable table=BackupSystemTable.getTable(conf);
  TreeSet<String> tables=new TreeSet<String>();
  tables.add("t1");
  tables.add("t2");
  tables.add("t3");
  HashMap<String,String> rsTimestampMap=new HashMap<String,String>();
  rsTimestampMap.put("rs1","100");
  rsTimestampMap.put("rs2","101");
  rsTimestampMap.put("rs3","103");
  table.writeRegionServerLogTimestamp(tables,rsTimestampMap);
  HashMap<String,HashMap<String,String>> result=table.readLogTimestampMap();
  assertTrue(tables.size() == result.size());
  for (  String t : tables) {
    HashMap<String,String> rstm=result.get(t);
    assertNotNull(rstm);
    assertEquals(rstm.get("rs1"),"100");
    assertEquals(rstm.get("rs2"),"101");
    assertEquals(rstm.get("rs3"),"103");
  }
  Set<String> tables1=new TreeSet<String>();
  tables1.add("t3");
  tables1.add("t4");
  tables1.add("t5");
  HashMap<String,String> rsTimestampMap1=new HashMap<String,String>();
  rsTimestampMap1.put("rs1","200");
  rsTimestampMap1.put("rs2","201");
  rsTimestampMap1.put("rs3","203");
  table.writeRegionServerLogTimestamp(tables1,rsTimestampMap1);
  result=table.readLogTimestampMap();
  assertTrue(5 == result.size());
  for (  String t : tables) {
    HashMap<String,String> rstm=result.get(t);
    assertNotNull(rstm);
    if (t.equals("t3") == false) {
      assertEquals(rstm.get("rs1"),"100");
      assertEquals(rstm.get("rs2"),"101");
      assertEquals(rstm.get("rs3"),"103");
    }
 else {
      assertEquals(rstm.get("rs1"),"200");
      assertEquals(rstm.get("rs2"),"201");
      assertEquals(rstm.get("rs3"),"203");
    }
  }
  for (  String t : tables1) {
    HashMap<String,String> rstm=result.get(t);
    assertNotNull(rstm);
    assertEquals(rstm.get("rs1"),"200");
    assertEquals(rstm.get("rs2"),"201");
    assertEquals(rstm.get("rs3"),"203");
  }
  cleanBackupTable();
}
