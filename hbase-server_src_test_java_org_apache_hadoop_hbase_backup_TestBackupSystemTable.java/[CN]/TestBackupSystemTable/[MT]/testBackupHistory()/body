{
  BackupSystemTable table=BackupSystemTable.getTable(conf);
  int n=10;
  List<BackupContext> list=createBackupContextList(n);
  for (  BackupContext bc : list) {
    bc.setFlag(BACKUPSTATUS.COMPLETE);
    table.updateBackupStatus(bc);
  }
  Collections.reverse(list);
  ArrayList<BackupCompleteData> history=table.getBackupHistory();
  assertTrue(history.size() == n);
  for (int i=0; i < n; i++) {
    BackupContext ctx=list.get(i);
    BackupCompleteData data=history.get(i);
    assertTrue(compare(ctx,data));
  }
  cleanBackupTable();
}
