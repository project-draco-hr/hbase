{
  BackupSystemTable table=BackupSystemTable.getTable(conf);
  String[] servers=new String[]{"server1","server2","server3"};
  String[] timestamps=new String[]{"100","102","107"};
  for (int i=0; i < servers.length; i++) {
    table.writeRegionServerLastLogRollResult(servers[i],timestamps[i]);
  }
  HashMap<String,String> result=table.readRegionServerLastLogRollResult();
  assertTrue(servers.length == result.size());
  Set<String> keys=result.keySet();
  String[] keysAsArray=new String[keys.size()];
  keys.toArray(keysAsArray);
  Arrays.sort(keysAsArray);
  for (int i=0; i < keysAsArray.length; i++) {
    assertEquals(keysAsArray[i],servers[i]);
    String ts1=timestamps[i];
    String ts2=result.get(keysAsArray[i]);
    assertEquals(ts1,ts2);
  }
  cleanBackupTable();
}
