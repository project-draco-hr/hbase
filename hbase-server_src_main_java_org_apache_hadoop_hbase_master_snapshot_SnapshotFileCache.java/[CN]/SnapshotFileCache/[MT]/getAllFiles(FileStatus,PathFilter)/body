{
  if (!file.isDir())   return Collections.singleton(file.getPath().getName());
  Set<String> ret=new HashSet<String>();
  FileStatus[] files=FSUtils.listStatus(fs,file.getPath(),filter);
  if (files == null)   return ret;
  for (  FileStatus child : files) {
    ret.addAll(getAllFiles(child,null));
  }
  return ret;
}
