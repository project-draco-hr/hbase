{
  this.lock.obtainReadLock();
  try {
    ArrayList<byte[]> results=get(memcache,key,numVersions);
    for (int i=history.size() - 1; i >= 0; i--) {
      if (numVersions > 0 && results.size() >= numVersions) {
        break;
      }
      results.addAll(results.size(),get(history.elementAt(i),key,numVersions - results.size()));
    }
    return (results.size() == 0) ? null : ImmutableBytesWritable.toArray(results);
  }
  finally {
    this.lock.releaseReadLock();
  }
}
