{
  List<byte[]> results=new ArrayList<byte[]>();
  this.lock.obtainReadLock();
  try {
    ArrayList<byte[]> result=get(memcache,key,numVersions - results.size());
    results.addAll(0,result);
    for (int i=history.size() - 1; i >= 0; i--) {
      if (numVersions > 0 && results.size() >= numVersions) {
        break;
      }
      result=get(history.elementAt(i),key,numVersions - results.size());
      results.addAll(results.size(),result);
    }
    return (results.size() == 0) ? null : ImmutableBytesWritable.toArray(results);
  }
  finally {
    this.lock.releaseReadLock();
  }
}
