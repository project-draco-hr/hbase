{
  TreeMap<Text,byte[]> results=new TreeMap<Text,byte[]>();
  this.lock.obtainReadLock();
  try {
    internalGetFull(memcache,key,results);
synchronized (history) {
      for (int i=history.size() - 1; i >= 0; i--) {
        SortedMap<HStoreKey,byte[]> cur=history.get(i);
        internalGetFull(cur,key,results);
      }
    }
    return results;
  }
  finally {
    this.lock.releaseReadLock();
  }
}
