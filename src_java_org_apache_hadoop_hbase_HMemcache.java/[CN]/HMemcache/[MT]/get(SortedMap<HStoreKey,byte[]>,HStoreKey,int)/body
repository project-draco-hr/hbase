{
  ArrayList<byte[]> result=new ArrayList<byte[]>();
  HStoreKey curKey=new HStoreKey(key);
  SortedMap<HStoreKey,byte[]> tailMap=map.tailMap(curKey);
  for (  Map.Entry<HStoreKey,byte[]> es : tailMap.entrySet()) {
    HStoreKey itKey=es.getKey();
    if (itKey.matchesRowCol(curKey)) {
      if (!isDeleted(es.getValue())) {
        result.add(tailMap.get(itKey));
        curKey.setVersion(itKey.getTimestamp() - 1);
      }
    }
    if (numVersions > 0 && result.size() >= numVersions) {
      break;
    }
  }
  return result;
}
