{
  locking.obtainWriteLock();
  try {
    for (Iterator<Text> it=columns.keySet().iterator(); it.hasNext(); ) {
      Text column=it.next();
      byte[] val=columns.get(column);
      HStoreKey key=new HStoreKey(row,column,timestamp);
      memcache.put(key,new BytesWritable(val));
    }
  }
  finally {
    locking.releaseWriteLock();
  }
}
