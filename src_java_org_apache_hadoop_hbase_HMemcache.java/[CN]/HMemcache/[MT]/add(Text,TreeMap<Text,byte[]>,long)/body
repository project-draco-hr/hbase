{
  this.lock.obtainWriteLock();
  try {
    for (    Map.Entry<Text,byte[]> es : columns.entrySet()) {
      HStoreKey key=new HStoreKey(row,es.getKey(),timestamp);
      byte[] value=es.getValue();
      this.size.addAndGet(key.getSize());
      this.size.addAndGet(((value == null) ? 0 : value.length));
      memcache.put(key,value);
    }
  }
  finally {
    this.lock.releaseWriteLock();
  }
}
