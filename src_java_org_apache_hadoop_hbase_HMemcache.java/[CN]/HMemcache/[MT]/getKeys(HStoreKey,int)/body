{
  this.lock.obtainReadLock();
  try {
    List<HStoreKey> results=getKeys(this.memcache,origin,versions);
    for (int i=history.size() - 1; i >= 0; i--) {
      results.addAll(results.size(),getKeys(history.get(i),origin,versions == HConstants.ALL_VERSIONS ? versions : (versions - results.size())));
    }
    return results;
  }
  finally {
    this.lock.releaseReadLock();
  }
}
