{
  this.lock.obtainWriteLock();
  try {
    if (snapshot == null) {
      throw new IOException("Snapshot not present!");
    }
synchronized (history) {
      history.remove(snapshot);
    }
    this.snapshot=null;
  }
  finally {
    this.lock.releaseWriteLock();
  }
}
