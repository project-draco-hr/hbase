{
  Iterator<Map.Entry<String,String>> iter=iterator();
  try {
    Document doc=DocumentBuilderFactory.newInstance().newDocumentBuilder().newDocument();
    Element conf=doc.createElement("configuration");
    doc.appendChild(conf);
    conf.appendChild(doc.createTextNode("\n"));
    Map.Entry<String,String> entry;
    while (iter.hasNext()) {
      entry=iter.next();
      String name=entry.getKey();
      String value=entry.getValue();
      writeProperty(doc,conf,name,value);
    }
    Iterator<String> columnIter=columnNameIterator();
    while (columnIter.hasNext()) {
      writeColumn(doc,conf,columnIter.next());
    }
    return doc;
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
}
