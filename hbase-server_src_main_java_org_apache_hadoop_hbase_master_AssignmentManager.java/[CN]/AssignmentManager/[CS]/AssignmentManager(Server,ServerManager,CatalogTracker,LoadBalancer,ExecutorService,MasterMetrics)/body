{
  super(server.getZooKeeper());
  this.server=server;
  this.serverManager=serverManager;
  this.catalogTracker=catalogTracker;
  this.executorService=service;
  this.regionsToReopen=Collections.synchronizedMap(new HashMap<String,HRegionInfo>());
  Configuration conf=server.getConfiguration();
  this.timeoutMonitor=new TimeoutMonitor(conf.getInt("hbase.master.assignment.timeoutmonitor.period",60000),server,serverManager,conf.getInt("hbase.master.assignment.timeoutmonitor.timeout",1200000));
  this.timerUpdater=new TimerUpdater(conf.getInt("hbase.master.assignment.timerupdater.period",10000),server);
  Threads.setDaemonThreadRunning(timerUpdater.getThread(),server.getServerName() + ".timerUpdater");
  this.zkTable=new ZKTable(this.watcher);
  this.maximumAttempts=this.server.getConfiguration().getInt("hbase.assignment.maximum.attempts",10);
  this.balancer=balancer;
  this.threadPoolExecutorService=Executors.newCachedThreadPool();
  this.masterMetrics=metrics;
  this.regionStates=new RegionStates(server,serverManager);
  asyncOfflineZKWatcher=new ZooKeeperWatcher(conf,"async offline ZK watcher",server);
}
