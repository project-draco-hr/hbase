{
  if (this.bulkAssign)   return;
  boolean noRSAvailable=this.serverManager.createDestinationServersList().isEmpty();
  long now=System.currentTimeMillis();
  for (  RegionState regionState : regionStates.getRegionsInTransition().values()) {
    if (regionState.getStamp() + timeout <= now) {
      actOnTimeOut(regionState);
    }
 else     if (this.allRegionServersOffline && !noRSAvailable) {
      RegionPlan existingPlan=regionPlans.get(regionState.getRegion().getEncodedName());
      if (existingPlan == null || !this.serverManager.isServerOnline(existingPlan.getDestination())) {
        actOnTimeOut(regionState);
      }
    }
  }
  setAllRegionServersOffline(noRSAvailable);
}
