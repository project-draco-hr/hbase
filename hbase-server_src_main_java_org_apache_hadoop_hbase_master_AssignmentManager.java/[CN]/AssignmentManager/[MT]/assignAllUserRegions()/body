{
  Set<String> disablingAndDisabledTables=new HashSet<String>(this.disablingTables);
  disablingAndDisabledTables.addAll(this.zkTable.getDisabledTables());
  Map<HRegionInfo,ServerName> allRegions=MetaReader.fullScan(catalogTracker,disablingAndDisabledTables,true);
  if (allRegions == null || allRegions.isEmpty())   return;
  List<ServerName> destServers=serverManager.createDestinationServersList();
  if (destServers.isEmpty())   return;
  boolean retainAssignment=master.getConfiguration().getBoolean("hbase.master.startup.retainassign",true);
  Map<ServerName,List<HRegionInfo>> bulkPlan=null;
  if (retainAssignment) {
    bulkPlan=balancer.retainAssignment(allRegions,destServers);
  }
 else {
    assignUserRegions(new ArrayList<HRegionInfo>(allRegions.keySet()),destServers);
    for (    HRegionInfo hri : allRegions.keySet()) {
      setEnabledTable(hri);
    }
    return;
  }
  LOG.info("Bulk assigning " + allRegions.size() + " region(s) across "+ destServers.size()+ " server(s), retainAssignment="+ retainAssignment);
  BulkAssigner ba=new StartupBulkAssigner(this.master,bulkPlan,this);
  ba.bulkAssign();
  for (  HRegionInfo hri : allRegions.keySet()) {
    setEnabledTable(hri);
  }
  LOG.info("Bulk assigning done");
}
