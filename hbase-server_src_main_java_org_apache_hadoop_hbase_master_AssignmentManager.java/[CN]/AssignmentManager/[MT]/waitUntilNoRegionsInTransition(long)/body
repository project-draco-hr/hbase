{
  final long endTime=System.currentTimeMillis() + timeout;
  while (!this.master.isStopped() && !regionsInTransition.isEmpty() && endTime > System.currentTimeMillis()) {
    regionsInTransition.waitForUpdate(100);
  }
  return regionsInTransition.isEmpty();
}
