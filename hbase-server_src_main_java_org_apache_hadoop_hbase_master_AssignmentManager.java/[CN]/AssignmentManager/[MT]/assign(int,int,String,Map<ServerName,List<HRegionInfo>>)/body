{
  int servers=bulkPlan.size();
  if (servers == 1 || (regions < bulkAssignThresholdRegions && servers < bulkAssignThresholdServers)) {
    if (LOG.isTraceEnabled()) {
      LOG.trace("Not using bulk assignment since we are assigning only " + regions + " region(s) to "+ servers+ " server(s)");
    }
    for (    Map.Entry<ServerName,List<HRegionInfo>> plan : bulkPlan.entrySet()) {
      assign(plan.getKey(),plan.getValue());
    }
  }
 else {
    LOG.info("Bulk assigning " + regions + " region(s) across "+ totalServers+ " server(s), "+ message);
    BulkAssigner ba=new GeneralBulkAssigner(this.server,bulkPlan,this,bulkAssignWaitTillAllAssigned);
    ba.bulkAssign();
    LOG.info("Bulk assigning done");
  }
}
