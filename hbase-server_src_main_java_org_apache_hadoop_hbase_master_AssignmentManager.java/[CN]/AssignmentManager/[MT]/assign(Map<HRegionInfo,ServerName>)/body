{
  if (regions == null || regions.isEmpty()) {
    return;
  }
  List<ServerName> servers=serverManager.createDestinationServersList();
  if (servers == null || servers.isEmpty()) {
    throw new IOException("Found no destination server to assign region(s)");
  }
  Map<ServerName,List<HRegionInfo>> bulkPlan=balancer.retainAssignment(regions,servers);
  LOG.info("Bulk assigning " + regions.size() + " region(s) across "+ servers.size()+ " server(s), retainAssignment=true");
  BulkAssigner ba=new GeneralBulkAssigner(this.server,bulkPlan,this);
  ba.bulkAssign();
  LOG.info("Bulk assigning done");
}
