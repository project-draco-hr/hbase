{
  if (!state.isClosed() && !state.isOffline()) {
    this.server.abort("Unexpected state trying to OFFLINE; " + state,new IllegalStateException());
    return false;
  }
  regionStates.updateRegionState(state.getRegion(),State.OFFLINE);
  try {
    ZKAssign.asyncCreateNodeOffline(watcher,state.getRegion(),destination,cb,state);
  }
 catch (  KeeperException e) {
    if (e instanceof NodeExistsException) {
      LOG.warn("Node for " + state.getRegion() + " already exists");
    }
 else {
      server.abort("Unexpected ZK exception creating/setting node OFFLINE",e);
    }
    return false;
  }
  return true;
}
