{
  long startTime=System.currentTimeMillis();
  Set<ServerName> deadServers=rebuildUserRegions();
  boolean failover=processDeadServersAndRegionsInTransition(deadServers);
  if (!useZKForAssignment) {
    ZKUtil.deleteNodeRecursively(watcher,watcher.assignmentZNode);
  }
  recoverTableInDisablingState();
  recoverTableInEnablingState();
  LOG.info("Joined the cluster in " + (System.currentTimeMillis() - startTime) + "ms, failover="+ failover);
}
