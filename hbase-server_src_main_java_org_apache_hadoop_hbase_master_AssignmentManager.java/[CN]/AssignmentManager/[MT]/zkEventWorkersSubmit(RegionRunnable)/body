{
synchronized (regionsInProgress) {
    if (regionsInProgress.contains(regRunnable.getRegionName())) {
synchronized (zkEventWorkerWaitingList) {
        zkEventWorkerWaitingList.put(regRunnable.getRegionName(),regRunnable);
      }
      return;
    }
    regionsInProgress.add(regRunnable.getRegionName());
    zkEventWorkers.submit(new Runnable(){
      @Override public void run(){
        try {
          regRunnable.run();
        }
  finally {
synchronized (regionsInProgress) {
            regionsInProgress.remove(regRunnable.getRegionName());
synchronized (zkEventWorkerWaitingList) {
              java.util.Set<RegionRunnable> waiting=zkEventWorkerWaitingList.get(regRunnable.getRegionName());
              if (!waiting.isEmpty()) {
                RegionRunnable toSubmit=waiting.iterator().next();
                zkEventWorkerWaitingList.remove(toSubmit.getRegionName(),toSubmit);
                zkEventWorkersSubmit(toSubmit);
              }
            }
          }
        }
      }
    }
);
  }
}
