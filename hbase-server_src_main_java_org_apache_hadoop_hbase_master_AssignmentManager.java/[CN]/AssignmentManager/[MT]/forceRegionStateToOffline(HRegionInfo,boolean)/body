{
  String encodedName=region.getEncodedName();
  Lock lock=locker.acquireLock(encodedName);
  try {
    RegionState state=regionStates.getRegionTransitionState(encodedName);
    if (state == null) {
      state=regionStates.updateRegionState(region,RegionState.State.OFFLINE);
    }
 else {
      if (!hijack) {
        LOG.debug("Forcing OFFLINE; was=" + state);
        state=regionStates.updateRegionState(region,RegionState.State.OFFLINE);
      }
    }
    return state;
  }
  finally {
    lock.unlock();
  }
}
