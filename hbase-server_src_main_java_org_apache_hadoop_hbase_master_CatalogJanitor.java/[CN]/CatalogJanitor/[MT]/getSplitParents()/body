{
  final AtomicInteger count=new AtomicInteger(0);
  final Map<HRegionInfo,Result> splitParents=new TreeMap<HRegionInfo,Result>(new SplitParentFirstComparator());
  MetaReader.Visitor visitor=new MetaReader.Visitor(){
    @Override public boolean visit(    Result r) throws IOException {
      if (r == null || r.isEmpty())       return true;
      count.incrementAndGet();
      HRegionInfo info=getHRegionInfo(r);
      if (info == null)       return true;
      if (info.isSplitParent())       splitParents.put(info,r);
      return true;
    }
  }
;
  MetaReader.fullScan(this.server.getCatalogTracker(),visitor);
  return new Pair<Integer,Map<HRegionInfo,Result>>(count.get(),splitParents);
}
