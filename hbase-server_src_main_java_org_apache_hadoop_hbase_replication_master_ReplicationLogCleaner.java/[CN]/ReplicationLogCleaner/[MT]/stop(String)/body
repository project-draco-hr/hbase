{
  if (this.stopped)   return;
  this.stopped=true;
  if (this.zkw != null) {
    LOG.info("Stopping " + this.zkw);
    this.zkw.close();
  }
  if (this.replicationState != null) {
    LOG.info("Stopping " + this.replicationState);
    try {
      this.replicationState.close();
    }
 catch (    IOException e) {
      LOG.error("Error while stopping " + this.replicationState,e);
    }
  }
  HConnectionManager.deleteConnection(this.getConf());
}
