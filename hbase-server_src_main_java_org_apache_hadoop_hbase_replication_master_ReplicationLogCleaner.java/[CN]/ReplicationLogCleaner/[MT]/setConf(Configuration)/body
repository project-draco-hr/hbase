{
  if (!config.getBoolean(HConstants.REPLICATION_ENABLE_KEY,HConstants.REPLICATION_ENABLE_DEFAULT)) {
    LOG.warn("Not configured - allowing all wals to be deleted");
    return;
  }
  Configuration conf=new Configuration(config);
  super.setConf(conf);
  try {
    this.zkw=new ZooKeeperWatcher(conf,"replicationLogCleaner",null);
    this.replicationQueues=ReplicationFactory.getReplicationQueuesClient(zkw,conf,this);
    this.replicationQueues.init();
  }
 catch (  ReplicationException e) {
    LOG.error("Error while configuring " + this.getClass().getName(),e);
  }
catch (  IOException e) {
    LOG.error("Error while configuring " + this.getClass().getName(),e);
  }
}
