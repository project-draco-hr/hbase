{
  List<String> rss=replicationQueues.getListOfReplicators();
  if (rss == null) {
    LOG.debug("Didn't find any region server that replicates, won't prevent any deletions.");
    return ImmutableSet.of();
  }
  Set<String> hlogs=Sets.newHashSet();
  for (  String rs : rss) {
    List<String> listOfPeers=replicationQueues.getAllQueues(rs);
    if (listOfPeers == null) {
      continue;
    }
    for (    String id : listOfPeers) {
      List<String> peersHlogs=replicationQueues.getLogsInQueue(rs,id);
      if (peersHlogs != null) {
        hlogs.addAll(peersHlogs);
      }
    }
  }
  return hlogs;
}
