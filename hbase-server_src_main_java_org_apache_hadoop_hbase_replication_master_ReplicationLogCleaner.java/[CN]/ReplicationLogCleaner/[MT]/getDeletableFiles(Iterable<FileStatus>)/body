{
  if (this.getConf() == null) {
    return files;
  }
  final Set<String> hlogs=loadHLogsFromQueues();
  return Iterables.filter(files,new Predicate<FileStatus>(){
    @Override public boolean apply(    FileStatus file){
      String hlog=file.getPath().getName();
      boolean logInReplicationQueue=hlogs.contains(hlog);
      if (LOG.isDebugEnabled()) {
        if (logInReplicationQueue) {
          LOG.debug("Found log in ZK, keeping: " + hlog);
        }
 else {
          LOG.debug("Didn't find this log in ZK, deleting: " + hlog);
        }
      }
      return !logInReplicationQueue;
    }
  }
);
}
