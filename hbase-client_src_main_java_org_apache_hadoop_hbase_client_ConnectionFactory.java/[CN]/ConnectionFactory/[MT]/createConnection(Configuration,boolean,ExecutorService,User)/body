{
  String className=conf.get(HConnection.HBASE_CLIENT_CONNECTION_IMPL,ConnectionManager.HConnectionImplementation.class.getName());
  Class<?> clazz=null;
  try {
    clazz=Class.forName(className);
  }
 catch (  ClassNotFoundException e) {
    throw new IOException(e);
  }
  try {
    Constructor<?> constructor=clazz.getDeclaredConstructor(Configuration.class,boolean.class,ExecutorService.class,User.class);
    constructor.setAccessible(true);
    return (Connection)constructor.newInstance(conf,managed,pool,user);
  }
 catch (  Exception e) {
    throw new IOException(e);
  }
}
