{
  if (this.labels == null && cellVisibilityExpr != null) {
    createLabels();
  }
  KeyValue kv=null;
  if (cellVisibilityExpr != null) {
    try {
      List<Tag> visibilityTags=createVisibilityTags(cellVisibilityExpr);
      kv=new KeyValue(lineBytes,rowKeyOffset,rowKeyLength,family,familyOffset,familyLength,qualifier,qualifierOffset,qualifierLength,ts,KeyValue.Type.Put,lineBytes,columnOffset,columnLength,visibilityTags);
    }
 catch (    ParseException e) {
      throw new BadTsvLineException("Parse Exception " + e.getMessage());
    }
  }
 else {
    kv=new KeyValue(lineBytes,rowKeyOffset,rowKeyLength,family,familyOffset,familyLength,qualifier,qualifierOffset,qualifierLength,ts,KeyValue.Type.Put,lineBytes,columnOffset,columnLength);
  }
  return kv;
}
