{
  if (this.labels == null && cellVisibilityExpr != null) {
    createLabels();
  }
  KeyValue kv=null;
  if (cellVisibilityExpr != null) {
    List<Tag> visibilityTags=createVisibilityTags(cellVisibilityExpr);
    kv=new KeyValue(lineBytes,rowKeyOffset,rowKeyLength,family,familyOffset,familyLength,qualifier,qualifierOffset,qualifierLength,ts,KeyValue.Type.Put,lineBytes,columnOffset,columnLength,visibilityTags);
  }
 else {
    kv=new KeyValue(lineBytes,rowKeyOffset,rowKeyLength,family,familyOffset,familyLength,qualifier,qualifierOffset,qualifierLength,ts,KeyValue.Type.Put,lineBytes,columnOffset,columnLength);
  }
  return kv;
}
