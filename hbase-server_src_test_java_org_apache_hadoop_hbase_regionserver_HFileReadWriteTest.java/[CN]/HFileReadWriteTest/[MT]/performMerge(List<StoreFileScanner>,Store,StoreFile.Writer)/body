{
  InternalScanner scanner=null;
  try {
    Scan scan=new Scan();
    scanner=new StoreScanner(store,scan,scanners,ScanType.MAJOR_COMPACT,Long.MIN_VALUE,Long.MIN_VALUE);
    ArrayList<KeyValue> kvs=new ArrayList<KeyValue>();
    while (scanner.next(kvs) || kvs.size() != 0) {
      numKV.addAndGet(kvs.size());
      for (      KeyValue kv : kvs) {
        totalBytes.addAndGet(kv.getLength());
        writer.append(kv);
      }
      kvs.clear();
    }
  }
  finally {
    if (scanner != null)     scanner.close();
  }
}
