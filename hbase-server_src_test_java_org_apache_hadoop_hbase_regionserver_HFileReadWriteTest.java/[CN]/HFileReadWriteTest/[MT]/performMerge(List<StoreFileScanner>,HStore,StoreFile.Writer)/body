{
  InternalScanner scanner=null;
  try {
    Scan scan=new Scan();
    scanner=new StoreScanner(store,store.getScanInfo(),scan,scanners,ScanType.COMPACT_DROP_DELETES,Long.MIN_VALUE,Long.MIN_VALUE);
    ArrayList<Cell> kvs=new ArrayList<Cell>();
    while (scanner.next(kvs) || kvs.size() != 0) {
      numKV.addAndGet(kvs.size());
      for (      Cell c : kvs) {
        KeyValue kv=KeyValueUtil.ensureKeyValue(c);
        totalBytes.addAndGet(kv.getLength());
        writer.append(kv);
      }
      kvs.clear();
    }
  }
  finally {
    if (scanner != null)     scanner.close();
  }
}
