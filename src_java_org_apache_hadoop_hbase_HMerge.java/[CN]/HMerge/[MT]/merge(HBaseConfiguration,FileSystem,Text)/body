{
  HConnection connection=HConnectionManager.getConnection(conf);
  boolean masterIsRunning=connection.isMasterRunning();
  HConnectionManager.deleteConnection(conf);
  if (tableName.equals(META_TABLE_NAME)) {
    if (masterIsRunning) {
      throw new IllegalStateException("Can not compact META table if instance is on-line");
    }
    new OfflineMerger(conf,fs).process();
  }
 else {
    if (!masterIsRunning) {
      throw new IllegalStateException("HBase instance must be running to merge a normal table");
    }
    new OnlineMerger(conf,fs,tableName).process();
  }
}
