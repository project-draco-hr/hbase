{
  super(conf,fs,tableName);
  this.dir=new Path(conf.get(HBASE_DIR,DEFAULT_HBASE_DIR));
  this.metaRegions=new TreeSet<HRegionInfo>();
  this.results=new TreeMap<Text,BytesWritable>();
  HRegion root=new HRegion(dir,hlog,fs,conf,HGlobals.rootRegionInfo,null);
  HInternalScannerInterface rootScanner=root.getScanner(META_COLS,new Text());
  try {
    while (rootScanner.next(key,results)) {
      for (      BytesWritable b : results.values()) {
        byte[] bytes=new byte[b.getSize()];
        System.arraycopy(b.get(),0,bytes,0,bytes.length);
        in.reset(bytes,bytes.length);
        info.readFields(in);
        metaRegions.add(info);
        results.clear();
      }
    }
  }
  finally {
    rootScanner.close();
    try {
      root.close();
    }
 catch (    IOException e) {
      LOG.error(e);
    }
  }
}
