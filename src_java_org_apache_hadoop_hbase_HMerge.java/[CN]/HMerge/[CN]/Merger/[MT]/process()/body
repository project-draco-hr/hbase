{
  try {
    while (more) {
      TreeSet<HRegionInfo> regionsToMerge=next();
      if (regionsToMerge == null) {
        break;
      }
      merge(regionsToMerge.toArray(new HRegionInfo[regionsToMerge.size()]));
    }
  }
  finally {
    try {
      hlog.closeAndDelete();
    }
 catch (    IOException e) {
      LOG.error(e);
    }
    try {
      fs.delete(basedir);
    }
 catch (    IOException e) {
      LOG.error(e);
    }
  }
}
