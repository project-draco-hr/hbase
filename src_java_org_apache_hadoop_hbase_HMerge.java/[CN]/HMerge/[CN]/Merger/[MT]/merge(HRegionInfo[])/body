{
  if (info.length < 2) {
    LOG.info("only one region - nothing to merge");
    return false;
  }
  HRegion currentRegion=null;
  long currentSize=0;
  HRegion nextRegion=null;
  long nextSize=0;
  Text midKey=new Text();
  for (int i=0; i < info.length - 1; i++) {
    if (currentRegion == null) {
      currentRegion=new HRegion(tabledir,hlog,fs,conf,info[i],null,null);
      currentSize=currentRegion.largestHStore(midKey).getAggregate();
    }
    nextRegion=new HRegion(tabledir,hlog,fs,conf,info[i + 1],null,null);
    nextSize=nextRegion.largestHStore(midKey).getAggregate();
    if ((currentSize + nextSize) <= (maxFilesize / 2)) {
      LOG.info("merging regions " + currentRegion.getRegionName() + " and "+ nextRegion.getRegionName());
      HRegion mergedRegion=HRegion.closeAndMerge(currentRegion,nextRegion);
      updateMeta(currentRegion.getRegionName(),nextRegion.getRegionName(),mergedRegion);
      break;
    }
    LOG.info("not merging regions " + currentRegion.getRegionName() + " and "+ nextRegion.getRegionName());
    currentRegion.close();
    currentRegion=nextRegion;
    currentSize=nextSize;
  }
  if (currentRegion != null) {
    currentRegion.close();
  }
  return true;
}
