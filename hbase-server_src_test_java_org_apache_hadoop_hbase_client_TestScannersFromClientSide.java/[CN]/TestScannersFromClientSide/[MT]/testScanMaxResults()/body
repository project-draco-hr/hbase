{
  byte[] TABLE=Bytes.toBytes("testScanLimit-" + prefetching + "_"+ maxSize);
  byte[][] ROWS=HTestConst.makeNAscii(ROW,2);
  byte[][] FAMILIES=HTestConst.makeNAscii(FAMILY,3);
  byte[][] QUALIFIERS=HTestConst.makeNAscii(QUALIFIER,10);
  HTable ht=TEST_UTIL.createTable(TABLE,FAMILIES);
  Put put;
  Scan scan;
  Result result;
  boolean toLog=true;
  List<KeyValue> kvListExp, kvListScan;
  kvListExp=new ArrayList<KeyValue>();
  for (int r=0; r < ROWS.length; r++) {
    put=new Put(ROWS[r]);
    for (int c=0; c < FAMILIES.length; c++) {
      for (int q=0; q < QUALIFIERS.length; q++) {
        KeyValue kv=new KeyValue(ROWS[r],FAMILIES[c],QUALIFIERS[q],1,VALUE);
        put.add(kv);
        if (q < 4) {
          kvListExp.add(kv);
        }
      }
    }
    ht.put(put);
  }
  scan=new Scan();
  scan.setCaching(1);
  scan.setPrefetching(prefetching);
  scan.setMaxResultsPerColumnFamily(4);
  ClientScanner scanner=(ClientScanner)ht.getScanner(scan);
  kvListScan=new ArrayList<KeyValue>();
  while ((result=scanner.next()) != null) {
    verifyPrefetching(scanner);
    for (    KeyValue kv : result.list()) {
      kvListScan.add(kv);
    }
  }
  result=new Result(kvListScan);
  verifyResult(result,kvListExp,toLog,"Testing scan with maxResults");
}
