{
  long scannerId=scanner.currentScannerId();
  if (scannerId == -1L)   return;
  RegionScannerHolder rsh=findRegionScannerHolder(scanner);
  assertNotNull("We should be able to find the scanner",rsh);
  boolean isPrefetchSubmitted=rsh.isPrefetchSubmitted();
  if (prefetching && (RegionScannerHolder.getPrefetchedResultSize() < this.maxSize)) {
    assertTrue("Prefetching should be submitted or no more result",isPrefetchSubmitted || scanner.next() == null);
  }
 else   if (isPrefetchSubmitted) {
    long sizeBefore=RegionScannerHolder.getPrefetchedResultSize() - rsh.currentPrefetchedResultSize();
    assertTrue("There should have room before prefetching is submitted",prefetching && sizeBefore < this.maxSize);
  }
  if (isPrefetchSubmitted && rsh.waitForPrefetchingDone()) {
    assertTrue("Prefetched result size should not be 0",rsh.currentPrefetchedResultSize() > 0);
  }
}
