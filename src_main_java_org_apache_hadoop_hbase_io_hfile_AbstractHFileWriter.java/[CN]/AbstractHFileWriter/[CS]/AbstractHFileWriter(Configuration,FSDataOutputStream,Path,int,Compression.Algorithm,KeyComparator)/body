{
  this.outputStream=outputStream;
  this.path=path;
  this.name=path != null ? path.getName() : outputStream.toString();
  this.blockSize=blockSize;
  this.compressAlgo=compressAlgo == null ? HFile.DEFAULT_COMPRESSION_ALGORITHM : compressAlgo;
  this.comparator=comparator != null ? comparator : Bytes.BYTES_RAWCOMPARATOR;
  closeOutputStream=path != null;
  cacheDataBlocksOnWrite=conf.getBoolean(HFile.CACHE_BLOCKS_ON_WRITE_KEY,false);
  cacheIndexBlocksOnWrite=HFileBlockIndex.shouldCacheOnWrite(conf);
  this.conf=conf;
  if (cacheDataBlocksOnWrite || cacheIndexBlocksOnWrite)   initBlockCache();
}
