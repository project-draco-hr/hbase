{
  if (regionInfo.equals(regionInfoForFs)) {
    return new StoreFileInfo(conf,fs,status);
  }
  if (StoreFileInfo.isReference(status.getPath())) {
    Reference reference=Reference.read(fs,status.getPath());
    return new StoreFileInfo(conf,fs,status,reference);
  }
  HFileLink link=new HFileLink(conf,HFileLink.createPath(regionInfoForFs.getTable(),regionInfoForFs.getEncodedName(),familyName,status.getPath().getName()));
  return new StoreFileInfo(conf,fs,status,link);
}
