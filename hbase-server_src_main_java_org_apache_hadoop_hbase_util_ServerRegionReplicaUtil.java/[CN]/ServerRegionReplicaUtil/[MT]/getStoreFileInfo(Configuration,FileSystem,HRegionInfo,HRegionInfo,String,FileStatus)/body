{
  if (regionInfo.equals(regionInfoForFs)) {
    return new StoreFileInfo(conf,fs,status);
  }
  if (StoreFileInfo.isReference(status.getPath())) {
    Reference reference=Reference.read(fs,status.getPath());
    return new StoreFileInfo(conf,fs,status,reference);
  }
  HFileLink link=HFileLink.build(conf,regionInfoForFs.getTable(),regionInfoForFs.getEncodedName(),familyName,status.getPath().getName());
  return new StoreFileInfo(conf,fs,status,link);
}
