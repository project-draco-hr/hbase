{
  HTableDescriptor tableDescriptor=getTableDescriptor(opts);
  if (opts.presplitRegions > 0) {
    if (admin.tableExists(tableDescriptor.getTableName())) {
      admin.disableTable(tableDescriptor.getTableName());
      admin.deleteTable(tableDescriptor.getTableName());
    }
    byte[][] splits=getSplits(opts);
    for (int i=0; i < splits.length; i++) {
      LOG.debug(" split " + i + ": "+ Bytes.toStringBinary(splits[i]));
    }
    admin.createTable(tableDescriptor,splits);
    LOG.info("Table created with " + opts.presplitRegions + " splits");
  }
 else {
    boolean tableExists=admin.tableExists(tableDescriptor.getTableName());
    if (!tableExists) {
      admin.createTable(tableDescriptor);
      LOG.info("Table " + tableDescriptor + " created");
    }
  }
  return admin.tableExists(tableDescriptor.getTableName());
}
