{
  Configuration conf=getConf();
  Path inputDir=writeInputFile(conf,opts);
  conf.set(EvaluationMapTask.CMD_KEY,cmd.getName());
  conf.set(EvaluationMapTask.PE_KEY,getClass().getName());
  Job job=new Job(conf);
  job.setJarByClass(PerformanceEvaluation.class);
  job.setJobName("HBase Performance Evaluation");
  job.setInputFormatClass(NLineInputFormat.class);
  NLineInputFormat.setInputPaths(job,inputDir);
  NLineInputFormat.setNumLinesPerSplit(job,1);
  job.setOutputKeyClass(LongWritable.class);
  job.setOutputValueClass(LongWritable.class);
  job.setMapperClass(EvaluationMapTask.class);
  job.setReducerClass(LongSumReducer.class);
  job.setNumReduceTasks(1);
  job.setOutputFormatClass(TextOutputFormat.class);
  TextOutputFormat.setOutputPath(job,new Path(inputDir.getParent(),"outputs"));
  TableMapReduceUtil.addDependencyJars(job);
  TableMapReduceUtil.addDependencyJars(job.getConfiguration(),DescriptiveStatistics.class,ObjectMapper.class);
  TableMapReduceUtil.initCredentials(job);
  job.waitForCompletion(true);
}
