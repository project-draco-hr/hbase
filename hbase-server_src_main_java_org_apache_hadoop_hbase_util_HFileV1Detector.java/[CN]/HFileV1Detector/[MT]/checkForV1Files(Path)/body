{
  LOG.info("Target dir is: " + targetDir);
  if (!fs.exists(targetDir)) {
    throw new IOException("The given path does not exist: " + targetDir);
  }
  if (isTableDir(fs,targetDir)) {
    processedTables.add(targetDir);
    return processTable(targetDir);
  }
  Set<Path> regionsWithHFileV1=new HashSet<Path>();
  FileStatus[] fsStats=fs.listStatus(targetDir);
  for (  FileStatus fsStat : fsStats) {
    if (isTableDir(fs,fsStat.getPath()) && !isRootTable(fsStat.getPath())) {
      processedTables.add(fsStat.getPath());
      regionsWithHFileV1.addAll(processTable(fsStat.getPath()));
    }
 else {
      LOG.info("Ignoring path: " + fsStat.getPath());
    }
  }
  return regionsWithHFileV1;
}
