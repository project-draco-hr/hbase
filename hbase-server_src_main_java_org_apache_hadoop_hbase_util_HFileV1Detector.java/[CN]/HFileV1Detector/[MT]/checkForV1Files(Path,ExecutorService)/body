{
  if (isTableDir(fs,targetDir)) {
    return processTable(targetDir,exec);
  }
  if (!fs.exists(targetDir)) {
    throw new IOException("The given path does not exist: " + targetDir);
  }
  Set<Path> regionsWithHFileV1=new HashSet<Path>();
  FileStatus[] fsStats=fs.listStatus(targetDir);
  for (  FileStatus fsStat : fsStats) {
    if (isTableDir(fs,fsStat.getPath())) {
      regionsWithHFileV1.addAll(processTable(fsStat.getPath(),exec));
    }
 else {
      LOG.info("Ignoring path: " + fsStat.getPath());
    }
  }
  return regionsWithHFileV1;
}
