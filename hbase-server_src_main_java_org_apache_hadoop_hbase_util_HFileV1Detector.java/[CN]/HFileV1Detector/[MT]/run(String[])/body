{
  fs=FileSystem.get(getConf());
  numOfThreads=DEFAULT_NUM_OF_THREADS;
  dirToProcess=FSUtils.getRootDir(getConf());
  if (!parseOption(args)) {
    System.exit(1);
  }
  ExecutorService exec=Executors.newFixedThreadPool(numOfThreads);
  Set<Path> regionsWithHFileV1;
  try {
    regionsWithHFileV1=checkForV1Files(dirToProcess,exec);
    printHRegionsWithHFileV1(regionsWithHFileV1);
    printAllHFileV1();
    printCorruptedHFiles();
    if (hFileV1Set.isEmpty() && corruptedHFiles.isEmpty()) {
      System.out.println("No HFile V1 Found");
    }
  }
 catch (  Exception e) {
    System.err.println(e);
    return 1;
  }
 finally {
    exec.shutdown();
    fs.close();
  }
  return 0;
}
