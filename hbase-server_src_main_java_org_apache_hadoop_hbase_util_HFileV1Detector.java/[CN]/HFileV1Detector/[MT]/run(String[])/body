{
  FSUtils.setFsDefault(getConf(),new Path(FSUtils.getRootDir(getConf()).toUri()));
  fs=FileSystem.get(getConf());
  numOfThreads=DEFAULT_NUM_OF_THREADS;
  targetDirPath=FSUtils.getRootDir(getConf());
  if (!parseOption(args)) {
    System.exit(-1);
  }
  this.exec=Executors.newFixedThreadPool(numOfThreads);
  try {
    return processResult(checkForV1Files(targetDirPath));
  }
 catch (  Exception e) {
    LOG.error(e);
  }
 finally {
    exec.shutdown();
    fs.close();
  }
  return -1;
}
