{
  LOG.debug("processing table: " + tableDir);
  List<Future<Path>> regionLevelResults=new ArrayList<Future<Path>>();
  Set<Path> regionsWithHFileV1=new HashSet<Path>();
  FileStatus[] fsStats=fs.listStatus(tableDir);
  for (  FileStatus fsStat : fsStats) {
    if (isRegionDir(fs,fsStat.getPath())) {
      regionLevelResults.add(processRegion(fsStat.getPath()));
    }
  }
  for (  Future<Path> f : regionLevelResults) {
    try {
      if (f.get() != null) {
        regionsWithHFileV1.add(f.get());
      }
    }
 catch (    InterruptedException e) {
      LOG.error(e);
    }
catch (    ExecutionException e) {
      LOG.error(e);
    }
  }
  return regionsWithHFileV1;
}
