{
  if (!started) {
    return;
  }
  for (int i=0; i < standaloneServerFactoryList.size(); i++) {
    NIOServerCnxnFactory standaloneServerFactory=standaloneServerFactoryList.get(i);
    int clientPort=clientPortList.get(i);
    standaloneServerFactory.shutdown();
    if (!waitForServerDown(clientPort,CONNECTION_TIMEOUT)) {
      throw new IOException("Waiting for shutdown of standalone server");
    }
  }
  for (  ZooKeeperServer zkServer : zooKeeperServers) {
    zkServer.getZKDatabase().close();
  }
  started=false;
  activeZKServerIndex=0;
  standaloneServerFactoryList.clear();
  clientPortList.clear();
  zooKeeperServers.clear();
  LOG.info("Shutdown MiniZK cluster with all ZK servers");
}
