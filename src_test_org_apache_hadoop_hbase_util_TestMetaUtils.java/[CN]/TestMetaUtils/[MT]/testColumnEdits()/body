{
  HBaseAdmin admin=new HBaseAdmin(this.conf);
  final String oldColumn="oldcolumn:";
  for (int i=0; i < 5; i++) {
    HTableDescriptor htd=new HTableDescriptor(getName() + i);
    htd.addFamily(new HColumnDescriptor(oldColumn));
    admin.createTable(htd);
  }
  this.cluster.shutdown();
  this.cluster=null;
  MetaUtils utils=new MetaUtils(this.conf);
  final byte[] editTable=Bytes.toBytes(getName() + 2);
  final byte[] newColumn=Bytes.toBytes("newcolumn:");
  utils.addColumn(editTable,new HColumnDescriptor(newColumn));
  utils.deleteColumn(editTable,Bytes.toBytes(oldColumn));
  utils.shutdown();
  this.cluster=new MiniHBaseCluster(this.conf,1);
  HTable t=new HTable(conf,editTable);
  HTableDescriptor htd=t.getMetadata();
  HColumnDescriptor hcd=htd.getFamily(newColumn);
  assertTrue(hcd != null);
  assertNull(htd.getFamily(Bytes.toBytes(oldColumn)));
}
