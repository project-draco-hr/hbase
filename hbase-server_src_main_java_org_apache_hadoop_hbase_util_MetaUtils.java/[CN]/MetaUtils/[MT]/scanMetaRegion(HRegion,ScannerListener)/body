{
  Scan scan=new Scan();
  scan.addColumn(HConstants.CATALOG_FAMILY,HConstants.REGIONINFO_QUALIFIER);
  InternalScanner s=r.getScanner(scan);
  try {
    List<KeyValue> results=new ArrayList<KeyValue>();
    boolean hasNext=true;
    do {
      hasNext=s.next(results);
      HRegionInfo info=null;
      for (      KeyValue kv : results) {
        info=HRegionInfo.parseFromOrNull(kv.getValue());
        if (info == null) {
          LOG.warn("Region info is null for row " + Bytes.toStringBinary(kv.getRow()) + " in table "+ r.getTableDesc().getNameAsString());
        }
        continue;
      }
      if (!listener.processRow(info)) {
        break;
      }
      results.clear();
    }
 while (hasNext);
  }
  finally {
    s.close();
  }
}
