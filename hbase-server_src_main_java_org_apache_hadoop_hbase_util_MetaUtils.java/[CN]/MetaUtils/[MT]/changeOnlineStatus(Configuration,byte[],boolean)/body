{
  HTable t=new HTable(c,HConstants.META_TABLE_NAME);
  Get get=new Get(row);
  get.addColumn(HConstants.CATALOG_FAMILY,HConstants.REGIONINFO_QUALIFIER);
  Result res=t.get(get);
  KeyValue[] kvs=res.raw();
  if (kvs.length <= 0) {
    throw new IOException("no information for row " + Bytes.toString(row));
  }
  HRegionInfo info=HRegionInfo.getHRegionInfo(res);
  if (info == null) {
    throw new IOException("no information for row " + Bytes.toString(row));
  }
  info.setOffline(onlineOffline);
  MetaEditor.addRegionToMeta(t,info);
  Delete delete=new Delete(row);
  delete.deleteColumns(HConstants.CATALOG_FAMILY,HConstants.SERVER_QUALIFIER);
  delete.deleteColumns(HConstants.CATALOG_FAMILY,HConstants.STARTCODE_QUALIFIER);
  t.delete(delete);
}
