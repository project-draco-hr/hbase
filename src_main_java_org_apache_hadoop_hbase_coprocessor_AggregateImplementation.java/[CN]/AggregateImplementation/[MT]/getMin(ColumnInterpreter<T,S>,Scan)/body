{
  T min=null;
  T temp;
  InternalScanner scanner=((RegionCoprocessorEnvironment)getEnvironment()).getRegion().getScanner(scan);
  List<KeyValue> results=new ArrayList<KeyValue>();
  byte[] colFamily=scan.getFamilies()[0];
  byte[] qualifier=scan.getFamilyMap().get(colFamily).pollFirst();
  try {
    boolean hasMoreRows=false;
    do {
      hasMoreRows=scanner.next(results);
      for (      KeyValue kv : results) {
        temp=ci.getValue(colFamily,qualifier,kv);
        min=(min == null || (temp != null && ci.compare(temp,min) < 0)) ? temp : min;
      }
      results.clear();
    }
 while (hasMoreRows);
  }
  finally {
    scanner.close();
  }
  log.info("Minimum from this region is " + ((RegionCoprocessorEnvironment)getEnvironment()).getRegion().getRegionNameAsString() + ": "+ min);
  return min;
}
