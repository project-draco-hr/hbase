{
  String tableName=snapshotDesc.getTable();
  Path refPath=StoreFile.getReferredToFile(new Path(new Path(new Path(tableName,regionInfo.getEncodedName()),familyDir.getName()),hfileName));
  String snapshotRegionName=refPath.getParent().getParent().getName();
  String fileName=refPath.getName();
  String clonedRegionName=Bytes.toString(regionsMap.get(Bytes.toBytes(snapshotRegionName)));
  if (clonedRegionName == null)   clonedRegionName=snapshotRegionName;
  String refLink=fileName;
  if (!HFileLink.isHFileLink(fileName)) {
    refLink=HFileLink.createHFileLinkName(tableName,snapshotRegionName,fileName);
  }
  Path outPath=new Path(familyDir,refLink + '.' + clonedRegionName);
  Path linkPath=new Path(familyDir,HFileLink.createHFileLinkName(tableName,regionInfo.getEncodedName(),hfileName));
  InputStream in=new HFileLink(conf,linkPath).open(fs);
  OutputStream out=fs.create(outPath);
  IOUtils.copyBytes(in,out,conf);
}
