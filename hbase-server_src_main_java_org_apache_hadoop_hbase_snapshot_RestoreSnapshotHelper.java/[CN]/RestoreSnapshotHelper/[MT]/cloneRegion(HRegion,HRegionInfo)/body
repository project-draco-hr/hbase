{
  final Path snapshotRegionDir=new Path(snapshotDir,snapshotRegionInfo.getEncodedName());
  final Path regionDir=new Path(tableDir,region.getRegionInfo().getEncodedName());
  final String tableName=tableDesc.getNameAsString();
  SnapshotReferenceUtil.visitRegionStoreFiles(fs,snapshotRegionDir,new FSVisitor.StoreFileVisitor(){
    public void storeFile(    final String region,    final String family,    final String hfile) throws IOException {
      LOG.info("Adding HFileLink " + hfile + " to table="+ tableName);
      Path familyDir=new Path(regionDir,family);
      restoreStoreFile(familyDir,snapshotRegionInfo,hfile);
    }
  }
);
}
