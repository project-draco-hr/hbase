{
  LOG.debug("get table regions: " + tableDir);
  FileStatus[] regionDirs=FSUtils.listStatus(fs,tableDir,new FSUtils.RegionDirFilter(fs));
  if (regionDirs == null)   return null;
  List<HRegionInfo> regions=new LinkedList<HRegionInfo>();
  for (  FileStatus regionDir : regionDirs) {
    HRegionInfo hri=HRegionFileSystem.loadRegionInfoFileContent(fs,regionDir.getPath());
    regions.add(hri);
  }
  LOG.debug("found " + regions.size() + " regions for table="+ tableDesc.getTableName().getNameAsString());
  return regions;
}
