{
  final HBaseAdmin admin=UTIL.getHBaseAdmin();
  List<HRegion> servingRegions=UTIL.getHBaseCluster().getRegions(TABLE_NAME);
  assertEquals(1,servingRegions.size());
  HRegion region=servingRegions.get(0);
  UTIL.loadRegion(region,TEST_FAM);
  admin.disableTable(STRING_TABLE_NAME);
  FileSystem fs=UTIL.getTestFileSystem();
  Path regionDir=HRegion.getRegionDir(region.getTableDir().getParent(),region.getRegionInfo());
  HFileArchiver.archiveRegion(fs,region.getRegionInfo());
  Path archiveDir=HFileArchiveTestingUtil.getRegionArchiveDir(UTIL.getConfiguration(),region);
  assertTrue(fs.exists(archiveDir));
  FileStatus[] stores=fs.listStatus(archiveDir);
  assertTrue(stores.length == 1);
  FileStatus[] storeFiles=fs.listStatus(stores[0].getPath());
  assertTrue(storeFiles.length > 0);
  assertFalse(fs.exists(regionDir));
}
