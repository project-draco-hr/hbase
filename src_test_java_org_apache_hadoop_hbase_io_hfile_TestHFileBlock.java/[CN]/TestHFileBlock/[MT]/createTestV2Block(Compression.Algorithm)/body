{
  final BlockType blockType=BlockType.DATA;
  HFileBlock.Writer hbw=new HFileBlock.Writer(algo);
  DataOutputStream dos=hbw.startWriting(blockType,false);
  writeTestBlockContents(dos);
  byte[] headerAndData=hbw.getHeaderAndData();
  assertEquals(1000 * 4,hbw.getUncompressedSizeWithoutHeader());
  hbw.releaseCompressor();
  return headerAndData;
}
