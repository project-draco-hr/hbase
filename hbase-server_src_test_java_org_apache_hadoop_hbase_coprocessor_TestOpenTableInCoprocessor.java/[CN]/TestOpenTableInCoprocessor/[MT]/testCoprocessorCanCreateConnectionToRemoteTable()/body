{
  HTableDescriptor primary=new HTableDescriptor(TableName.valueOf("primary"));
  primary.addFamily(new HColumnDescriptor(family));
  primary.addCoprocessor(SendToOtherTableCoprocessor.class.getName());
  HTableDescriptor other=new HTableDescriptor(otherTable);
  other.addFamily(new HColumnDescriptor(family));
  UTIL.startMiniCluster();
  HBaseAdmin admin=UTIL.getHBaseAdmin();
  admin.createTable(primary);
  admin.createTable(other);
  admin.close();
  HTable table=new HTable(UTIL.getConfiguration(),"primary");
  Put p=new Put(new byte[]{'a'});
  p.add(family,null,new byte[]{'a'});
  table.put(p);
  table.flushCommits();
  table.close();
  HTable target=new HTable(UTIL.getConfiguration(),otherTable);
  assertTrue("Didn't complete update to target table!",completed);
  assertEquals("Didn't find inserted row",1,getKeyValueCount(target));
  target.close();
  UTIL.shutdownMiniCluster();
}
