{
  HTableDescriptor primary=new HTableDescriptor(primaryTable);
  primary.addFamily(new HColumnDescriptor(family));
  primary.addCoprocessor(clazz.getName());
  HTableDescriptor other=new HTableDescriptor(otherTable);
  other.addFamily(new HColumnDescriptor(family));
  HBaseAdmin admin=UTIL.getHBaseAdmin();
  admin.createTable(primary);
  admin.createTable(other);
  HTable table=new HTable(UTIL.getConfiguration(),"primary");
  Put p=new Put(new byte[]{'a'});
  p.add(family,null,new byte[]{'a'});
  table.put(p);
  table.flushCommits();
  table.close();
  HTable target=new HTable(UTIL.getConfiguration(),otherTable);
  assertTrue("Didn't complete update to target table!",completeCheck[0]);
  assertEquals("Didn't find inserted row",1,getKeyValueCount(target));
  target.close();
}
