{
  long chainId=value.get();
  byte[] chainIdArray=Bytes.toBytes(chainId);
  long currentRow=0;
  long nextRow=Math.abs(rand.nextLong());
  int chainLength=context.getConfiguration().getInt(CHAIN_LENGTH_KEY,CHAIN_LENGTH);
  for (long i=0; i < chainLength; i++) {
    byte[] rk=Bytes.toBytes(currentRow);
    KeyValue linkKv=new KeyValue(rk,CHAIN_FAM,chainIdArray,Bytes.toBytes(nextRow));
    KeyValue sortKv=new KeyValue(rk,SORT_FAM,chainIdArray,Bytes.toBytes(i));
    KeyValue dataKv=new KeyValue(rk,DATA_FAM,chainIdArray,Bytes.toBytes(RandomStringUtils.randomAlphabetic(100)));
    context.write(new ImmutableBytesWritable(rk),linkKv);
    context.write(new ImmutableBytesWritable(rk),sortKv);
    context.write(new ImmutableBytesWritable(rk),dataKv);
    currentRow=nextRow;
    nextRow=Math.abs(rand.nextLong());
  }
}
