{
  long next=-1L;
  long count=0L;
  for (  LinkChain lc : values) {
    if (next == -1) {
      if (lc.getRk() != 0L)       throw new RuntimeException("Chains should all start at 0 rk" + ". Chain:" + key.chainId + ", order:"+ key.order);
      next=lc.getNext();
    }
 else {
      if (next != lc.getRk())       throw new RuntimeException("Missing a link in the chain. Expecting " + next + " got "+ lc.getRk()+ ". Chain:"+ key.chainId+ ", order:"+ key.order);
      next=lc.getNext();
    }
    count++;
  }
  int expectedChainLen=context.getConfiguration().getInt(CHAIN_LENGTH_KEY,CHAIN_LENGTH);
  if (count != expectedChainLen)   throw new RuntimeException("Chain wasn't the correct length.  Expected " + expectedChainLen + " got "+ count+ ". Chain:"+ key.chainId+ ", order:"+ key.order);
}
