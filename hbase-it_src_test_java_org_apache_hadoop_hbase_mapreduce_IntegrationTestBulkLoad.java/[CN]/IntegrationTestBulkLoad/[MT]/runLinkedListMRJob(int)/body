{
  String jobName=IntegrationTestBulkLoad.class.getSimpleName() + " - " + EnvironmentEdgeManager.currentTime();
  Configuration conf=new Configuration(util.getConfiguration());
  Path p=util.getDataTestDirOnTestFS(getTablename() + "-" + iteration);
  HTable table=new HTable(conf,getTablename());
  conf.setBoolean("mapreduce.map.speculative",false);
  conf.setBoolean("mapreduce.reduce.speculative",false);
  conf.setInt(ROUND_NUM_KEY,iteration);
  Job job=new Job(conf);
  job.setJobName(jobName);
  job.setInputFormatClass(ITBulkLoadInputFormat.class);
  job.setMapperClass(LinkedListCreationMapper.class);
  job.setMapOutputKeyClass(ImmutableBytesWritable.class);
  job.setMapOutputValueClass(KeyValue.class);
  job.setJarByClass(getClass());
  FileOutputFormat.setOutputPath(job,p);
  HFileOutputFormat2.configureIncrementalLoad(job,table,table);
  assertEquals(true,job.waitForCompletion(true));
  LoadIncrementalHFiles loader=new LoadIncrementalHFiles(conf);
  loader.doBulkLoad(p,table);
  util.getTestFileSystem().delete(p,true);
}
