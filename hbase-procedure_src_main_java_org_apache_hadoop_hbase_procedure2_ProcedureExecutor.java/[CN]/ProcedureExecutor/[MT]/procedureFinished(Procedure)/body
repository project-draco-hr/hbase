{
  try {
    proc.completionCleanup(getEnvironment());
  }
 catch (  Throwable e) {
    LOG.error("CODE-BUG: uncatched runtime exception for procedure: " + proc,e);
  }
  completed.put(proc.getProcId(),Procedure.createProcedureInfo(proc,proc.getNonceKey()));
  rollbackStack.remove(proc.getProcId());
  procedures.remove(proc.getProcId());
  try {
    runnables.completionCleanup(proc);
  }
 catch (  Throwable e) {
    LOG.error("CODE-BUG: uncatched runtime exception for runnableSet: " + runnables,e);
  }
  sendProcedureFinishedNotification(proc.getProcId());
}
