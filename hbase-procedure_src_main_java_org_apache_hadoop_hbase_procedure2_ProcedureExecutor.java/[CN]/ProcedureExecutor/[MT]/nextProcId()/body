{
  long procId=lastProcId.incrementAndGet();
  if (procId < 0) {
    while (!lastProcId.compareAndSet(procId,0)) {
      procId=lastProcId.get();
      if (procId >= 0)       break;
    }
    while (procedures.containsKey(procId)) {
      procId=lastProcId.incrementAndGet();
    }
  }
  return procId;
}
