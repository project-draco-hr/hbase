{
  String namespacePath1="/namespaces/" + NAMESPACE1;
  String namespacePath2="/namespaces/" + NAMESPACE2;
  NamespacesInstanceModel model1;
  NamespacesInstanceModel model2;
  Response response;
  Admin admin=TEST_UTIL.getHBaseAdmin();
  assertNull(findNamespace(admin,NAMESPACE1));
  assertNull(findNamespace(admin,NAMESPACE2));
  model1=testNamespacesInstanceModel.buildTestModel(NAMESPACE1,NAMESPACE1_PROPS);
  testNamespacesInstanceModel.checkModel(model1,NAMESPACE1,NAMESPACE1_PROPS);
  model2=testNamespacesInstanceModel.buildTestModel(NAMESPACE2,NAMESPACE2_PROPS);
  testNamespacesInstanceModel.checkModel(model2,NAMESPACE2,NAMESPACE2_PROPS);
  response=client.put(namespacePath1,Constants.MIMETYPE_XML,toXML(model1));
  assertEquals(403,response.getCode());
  String jsonString=jsonMapper.writeValueAsString(model2);
  response=client.put(namespacePath2,Constants.MIMETYPE_JSON,Bytes.toBytes(jsonString));
  assertEquals(403,response.getCode());
  conf.set("hbase.rest.readonly","true");
  response=client.post(namespacePath1,Constants.MIMETYPE_XML,toXML(model1));
  assertEquals(403,response.getCode());
  jsonString=jsonMapper.writeValueAsString(model2);
  response=client.post(namespacePath2,Constants.MIMETYPE_JSON,Bytes.toBytes(jsonString));
  assertEquals(403,response.getCode());
  NamespaceDescriptor nd1=findNamespace(admin,NAMESPACE1);
  NamespaceDescriptor nd2=findNamespace(admin,NAMESPACE2);
  assertNull(nd1);
  assertNull(nd2);
  conf.set("hbase.rest.readonly","false");
  response=client.post(namespacePath1,Constants.MIMETYPE_XML,toXML(model1));
  assertEquals(201,response.getCode());
  jsonString=jsonMapper.writeValueAsString(model2);
  response=client.post(namespacePath2,Constants.MIMETYPE_JSON,Bytes.toBytes(jsonString));
  assertEquals(201,response.getCode());
  nd1=findNamespace(admin,NAMESPACE1);
  nd2=findNamespace(admin,NAMESPACE2);
  assertNotNull(nd1);
  assertNotNull(nd2);
  checkNamespaceProperties(nd1,NAMESPACE1_PROPS);
  checkNamespaceProperties(nd1,NAMESPACE1_PROPS);
  conf.set("hbase.rest.readonly","true");
  response=client.delete(namespacePath1);
  assertEquals(403,response.getCode());
  response=client.delete(namespacePath2);
  assertEquals(403,response.getCode());
  nd1=findNamespace(admin,NAMESPACE1);
  nd2=findNamespace(admin,NAMESPACE2);
  assertNotNull(nd1);
  assertNotNull(nd2);
  conf.set("hbase.rest.readonly","false");
  response=client.delete(namespacePath1);
  assertEquals(200,response.getCode());
  response=client.delete(namespacePath2);
  assertEquals(200,response.getCode());
  nd1=findNamespace(admin,NAMESPACE1);
  nd2=findNamespace(admin,NAMESPACE2);
  assertNull(nd1);
  assertNull(nd2);
}
