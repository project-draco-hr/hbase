{
  if (test == Test.RANDOM_READ_MEM) {
    R=ROWS_PER_100_MB * N;
  }
  MiniHBaseCluster hbaseMiniCluster=null;
  if (this.miniCluster) {
    hbaseMiniCluster=new MiniHBaseCluster(this.conf,N);
  }
  try {
    if (N == 1) {
      runNIsOne(test);
    }
 else {
      runOneTest(test);
    }
  }
  finally {
    if (this.miniCluster && hbaseMiniCluster != null) {
      hbaseMiniCluster.shutdown();
    }
  }
}
