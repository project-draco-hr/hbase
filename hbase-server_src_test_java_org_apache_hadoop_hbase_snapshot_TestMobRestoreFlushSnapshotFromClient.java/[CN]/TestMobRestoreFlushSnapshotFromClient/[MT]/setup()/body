{
  this.admin=UTIL.getHBaseAdmin();
  long tid=System.currentTimeMillis();
  tableName=TableName.valueOf("testtb-" + tid);
  snapshotName0=Bytes.toBytes("snaptb0-" + tid);
  snapshotName1=Bytes.toBytes("snaptb1-" + tid);
  snapshotName2=Bytes.toBytes("snaptb2-" + tid);
  MobSnapshotTestingUtils.createMobTable(UTIL,tableName,1,FAMILY);
  HTable table=new HTable(UTIL.getConfiguration(),tableName);
  SnapshotTestingUtils.loadData(UTIL,table,500,FAMILY);
  snapshot0Rows=MobSnapshotTestingUtils.countMobRows(table);
  LOG.info("=== before snapshot with 500 rows");
  logFSTree();
  admin.snapshot(Bytes.toString(snapshotName0),tableName,SnapshotDescription.Type.FLUSH);
  LOG.info("=== after snapshot with 500 rows");
  logFSTree();
  SnapshotTestingUtils.loadData(UTIL,table,500,FAMILY);
  snapshot1Rows=MobSnapshotTestingUtils.countMobRows(table);
  LOG.info("=== before snapshot with 1000 rows");
  logFSTree();
  admin.snapshot(Bytes.toString(snapshotName1),tableName,SnapshotDescription.Type.FLUSH);
  LOG.info("=== after snapshot with 1000 rows");
  logFSTree();
  table.close();
}
