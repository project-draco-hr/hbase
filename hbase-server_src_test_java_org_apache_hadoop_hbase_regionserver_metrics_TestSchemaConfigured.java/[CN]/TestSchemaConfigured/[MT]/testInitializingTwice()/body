{
  Configuration conf=HBaseConfiguration.create();
  for (int i=0; i < 4; ++i) {
    SchemaConfigured sc=new SchemaConfigured(conf,TABLE_NAME,CF_NAME);
    SchemaConfigured target=new SchemaConfigured(conf,TABLE_NAME + (i % 2 == 1 ? "1" : ""),CF_NAME + ((i & 2) != 0 ? "1" : ""));
    if (i == 0) {
      sc.passSchemaMetricsTo(target);
      continue;
    }
    String testDesc="Trying to re-configure " + target.schemaConfAsJSON() + " with "+ sc.schemaConfAsJSON();
    try {
      sc.passSchemaMetricsTo(target);
      fail(IllegalArgumentException.class.getSimpleName() + " expected");
    }
 catch (    IllegalArgumentException ex) {
      final String errorMsg=testDesc + ". Unexpected exception message: " + ex.getMessage();
      final String exceptionRegex="Trying to change table .* CF .*";
      assertTrue(errorMsg,Pattern.matches(exceptionRegex,ex.getMessage()));
      LOG.debug("Expected exception: " + ex.getMessage());
    }
  }
}
