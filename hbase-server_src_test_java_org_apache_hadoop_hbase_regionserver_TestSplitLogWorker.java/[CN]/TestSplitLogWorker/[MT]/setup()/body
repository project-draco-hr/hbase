{
  TEST_UTIL.startMiniZKCluster();
  Configuration conf=TEST_UTIL.getConfiguration();
  zkw=new ZooKeeperWatcher(TEST_UTIL.getConfiguration(),"split-log-worker-tests",null);
  ZKUtil.deleteChildrenRecursively(zkw,zkw.baseZNode);
  ZKUtil.createAndFailSilent(zkw,zkw.baseZNode);
  assertTrue(ZKUtil.checkExists(zkw,zkw.baseZNode) != -1);
  LOG.debug(zkw.baseZNode + " created");
  ZKUtil.createAndFailSilent(zkw,zkw.splitLogZNode);
  assertTrue(ZKUtil.checkExists(zkw,zkw.splitLogZNode) != -1);
  LOG.debug(zkw.splitLogZNode + " created");
  ZKUtil.createAndFailSilent(zkw,zkw.rsZNode);
  assertTrue(ZKUtil.checkExists(zkw,zkw.rsZNode) != -1);
  SplitLogCounters.resetCounters();
  executorService=new ExecutorService("TestSplitLogWorker");
  executorService.startExecutorService(ExecutorType.RS_LOG_REPLAY_OPS,10);
  this.mode=(conf.getBoolean(HConstants.DISTRIBUTED_LOG_REPLAY_KEY,false) ? RecoveryMode.LOG_REPLAY : RecoveryMode.LOG_SPLITTING);
}
