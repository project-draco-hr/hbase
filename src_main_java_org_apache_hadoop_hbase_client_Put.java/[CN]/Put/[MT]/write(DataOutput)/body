{
  out.writeByte(PUT_VERSION);
  Bytes.writeByteArray(out,this.row);
  out.writeLong(this.timestamp);
  out.writeLong(this.lockId);
  out.writeBoolean(this.writeToWAL);
  out.writeInt(familyMap.size());
  for (  Map.Entry<byte[],List<KeyValue>> entry : familyMap.entrySet()) {
    Bytes.writeByteArray(out,entry.getKey());
    List<KeyValue> keys=entry.getValue();
    out.writeInt(keys.size());
    int totalLen=0;
    for (    KeyValue kv : keys) {
      totalLen+=kv.getLength();
    }
    out.writeInt(totalLen);
    for (    KeyValue kv : keys) {
      out.writeInt(kv.getLength());
      out.write(kv.getBuffer(),kv.getOffset(),kv.getLength());
    }
  }
  if (this.attributes == null) {
    out.writeInt(0);
  }
 else {
    out.writeInt(this.attributes.size());
    for (    Map.Entry<String,byte[]> attr : this.attributes.entrySet()) {
      WritableUtils.writeString(out,attr.getKey());
      Bytes.writeByteArray(out,attr.getValue());
    }
  }
}
