{
  String krbKeytab=getKeytabFileForTesting();
  String krbPrincipal=getPrincipalForTesting();
  UserGroupInformation ugi=loginKerberosPrincipal(krbKeytab,krbPrincipal);
  assertEquals(AuthenticationMethod.KERBEROS,ugi.getAuthenticationMethod());
  assertEquals(krbPrincipal,ugi.getUserName());
  String clientUsername="testuser";
  UserGroupInformation clientUgi=UserGroupInformation.createUserForTesting(clientUsername,new String[]{clientUsername});
  assertNotSame(ugi,clientUgi);
  assertEquals(AuthenticationMethod.SIMPLE,clientUgi.getAuthenticationMethod());
  assertEquals(clientUsername,clientUgi.getUserName());
  Configuration clientConf=new Configuration();
  clientConf.set(User.HBASE_SECURITY_CONF_KEY,"simple");
  callRpcService(rpcImplClass,User.create(clientUgi),clientConf,true);
}
