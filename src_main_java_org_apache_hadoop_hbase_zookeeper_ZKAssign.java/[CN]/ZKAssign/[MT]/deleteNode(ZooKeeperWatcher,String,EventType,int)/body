{
  LOG.debug(zkw.prefix("Deleting existing unassigned " + "node for " + regionName + " that is in expected state "+ expectedState));
  String node=getNodeName(zkw,regionName);
  zkw.sync(node);
  Stat stat=new Stat();
  byte[] bytes=ZKUtil.getDataNoWatch(zkw,node,stat);
  if (bytes == null) {
    throw KeeperException.create(Code.NONODE);
  }
  RegionTransitionData data=RegionTransitionData.fromBytes(bytes);
  if (!data.getEventType().equals(expectedState)) {
    LOG.warn(zkw.prefix("Attempting to delete unassigned " + "node " + regionName + " in "+ expectedState+ " state but node is in "+ data.getEventType()+ " state"));
    return false;
  }
  if (expectedVersion != -1 && stat.getVersion() != expectedVersion) {
    LOG.warn("The node " + regionName + " we are trying to delete is not"+ " the expected one. Got a version mismatch");
    return false;
  }
  if (!ZKUtil.deleteNode(zkw,node,stat.getVersion())) {
    LOG.warn(zkw.prefix("Attempting to delete " + "unassigned node " + regionName + " in "+ expectedState+ " state but after verifying state, we got a version mismatch"));
    return false;
  }
  LOG.debug(zkw.prefix("Successfully deleted unassigned node for region " + regionName + " in expected state "+ expectedState));
  return true;
}
