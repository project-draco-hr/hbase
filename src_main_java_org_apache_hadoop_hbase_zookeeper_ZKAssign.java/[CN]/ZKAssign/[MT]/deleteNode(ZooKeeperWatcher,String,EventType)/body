{
  LOG.debug(zkw.prefix("Deleting existing unassigned " + "node for " + regionName + " that is in expected state "+ expectedState));
  String node=getNodeName(zkw,regionName);
  zkw.sync(node);
  Stat stat=new Stat();
  byte[] bytes=ZKUtil.getDataNoWatch(zkw,node,stat);
  if (bytes == null) {
    throw KeeperException.create(Code.NONODE);
  }
  RegionTransitionData data=RegionTransitionData.fromBytes(bytes);
  if (!data.getEventType().equals(expectedState)) {
    LOG.warn(zkw.prefix("Attempting to delete unassigned " + "node in " + expectedState + " state but node is in "+ data.getEventType()+ " state"));
    return false;
  }
  if (!ZKUtil.deleteNode(zkw,node,stat.getVersion())) {
    LOG.warn(zkw.prefix("Attempting to delete " + "unassigned node in " + expectedState + " state but after verifying state, we got a version mismatch"));
    return false;
  }
  LOG.debug(zkw.prefix("Successfully deleted unassigned node for region " + regionName + " in expected state "+ expectedState));
  return true;
}
