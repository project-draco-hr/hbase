{
  super.setUp();
  HTableDescriptor htd=new HTableDescriptor(getName());
  htd.addFamily(new HColumnDescriptor(FAMILIES[0]));
  htd.addFamily(new HColumnDescriptor(FAMILIES[1]));
  htd.addFamily(new HColumnDescriptor(FAMILIES_1[0]));
  htd.addFamily(new HColumnDescriptor(FAMILIES_1[1]));
  htd.addFamily(new HColumnDescriptor(NEW_FAMILIES[0]));
  htd.addFamily(new HColumnDescriptor(NEW_FAMILIES[1]));
  htd.addFamily(new HColumnDescriptor(FAMILIES_1[1]));
  HRegionInfo info=new HRegionInfo(htd.getName(),null,null,false);
  this.region=HRegion.createHRegion(info,this.testDir,this.conf,htd);
  for (  byte[] ROW : ROWS_ONE) {
    Put p=new Put(ROW);
    p.setWriteToWAL(false);
    for (    byte[] QUALIFIER : QUALIFIERS_ONE) {
      p.add(FAMILIES[0],QUALIFIER,VALUES[0]);
    }
    this.region.put(p);
  }
  for (  byte[] ROW : ROWS_TWO) {
    Put p=new Put(ROW);
    p.setWriteToWAL(false);
    for (    byte[] QUALIFIER : QUALIFIERS_TWO) {
      p.add(FAMILIES[1],QUALIFIER,VALUES[1]);
    }
    this.region.put(p);
  }
  this.region.flushcache();
  for (  byte[] ROW : ROWS_ONE) {
    Put p=new Put(ROW);
    p.setWriteToWAL(false);
    for (    byte[] QUALIFIER : QUALIFIERS_ONE) {
      p.add(FAMILIES[1],QUALIFIER,VALUES[0]);
    }
    this.region.put(p);
  }
  for (  byte[] ROW : ROWS_TWO) {
    Put p=new Put(ROW);
    p.setWriteToWAL(false);
    for (    byte[] QUALIFIER : QUALIFIERS_TWO) {
      p.add(FAMILIES[0],QUALIFIER,VALUES[1]);
    }
    this.region.put(p);
  }
  for (  byte[] ROW : ROWS_ONE) {
    Delete d=new Delete(ROW);
    d.deleteColumns(FAMILIES[0],QUALIFIERS_ONE[1]);
    d.deleteColumns(FAMILIES[1],QUALIFIERS_ONE[1]);
    this.region.delete(d,null,false);
  }
  for (  byte[] ROW : ROWS_TWO) {
    Delete d=new Delete(ROW);
    d.deleteColumns(FAMILIES[0],QUALIFIERS_TWO[1]);
    d.deleteColumns(FAMILIES[1],QUALIFIERS_TWO[1]);
    this.region.delete(d,null,false);
  }
  colsPerRow-=2;
  for (  byte[] QUALIFIER : QUALIFIERS_ONE) {
    Delete d=new Delete(ROWS_ONE[1]);
    d.deleteColumns(FAMILIES[0],QUALIFIER);
    d.deleteColumns(FAMILIES[1],QUALIFIER);
    this.region.delete(d,null,false);
  }
  for (  byte[] QUALIFIER : QUALIFIERS_TWO) {
    Delete d=new Delete(ROWS_TWO[1]);
    d.deleteColumns(FAMILIES[0],QUALIFIER);
    d.deleteColumns(FAMILIES[1],QUALIFIER);
    this.region.delete(d,null,false);
  }
  numRows-=2;
}
