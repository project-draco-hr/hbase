{
  Scan scan=new Scan();
  scan.addColumn(family,qualifier);
  int sumResult=0;
  InternalScanner scanner=((RegionCoprocessorEnvironment)getEnvironment()).getRegion().getScanner(scan);
  try {
    List<KeyValue> curVals=new ArrayList<KeyValue>();
    boolean done=false;
    do {
      curVals.clear();
      done=scanner.next(curVals);
      KeyValue kv=curVals.get(0);
      sumResult+=Bytes.toInt(kv.getBuffer(),kv.getValueOffset());
    }
 while (done);
  }
  finally {
    scanner.close();
  }
  return sumResult;
}
