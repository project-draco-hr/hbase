{
  FileSystem fs=hfofDir.getFileSystem(getConf());
  if (!fs.exists(hfofDir)) {
    throw new FileNotFoundException("HFileOutputFormat dir " + hfofDir + " not found");
  }
  FileStatus[] familyDirStatuses=fs.listStatus(hfofDir);
  if (familyDirStatuses == null) {
    throw new FileNotFoundException("No families found in " + hfofDir);
  }
  for (  FileStatus stat : familyDirStatuses) {
    if (!stat.isDir()) {
      LOG.warn("Skipping non-directory " + stat.getPath());
      continue;
    }
    Path familyDir=stat.getPath();
    if (familyDir.getName().startsWith("_"))     continue;
    byte[] family=familyDir.getName().getBytes();
    Path[] hfiles=FileUtil.stat2Paths(fs.listStatus(familyDir));
    for (    Path hfile : hfiles) {
      if (hfile.getName().startsWith("_"))       continue;
      ret.add(new LoadQueueItem(family,hfile));
    }
  }
}
