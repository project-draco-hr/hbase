{
  Configuration conf=HBaseConfiguration.create();
  FileSystem fs=FileSystem.get(conf);
  init(getName(),conf);
  int storeFileNum=4;
  for (int i=1; i <= storeFileNum; i++) {
    LOG.info("Adding some data for the store file #" + i);
    this.store.add(new KeyValue(row,family,qf1,i,(byte[])null));
    this.store.add(new KeyValue(row,family,qf2,i,(byte[])null));
    this.store.add(new KeyValue(row,family,qf3,i,(byte[])null));
    flush(i);
  }
  long lowestTimeStampFromStore=Store.getLowestTimestamp(store.getStorefiles());
  long lowestTimeStampFromFS=getLowestTimeStampFromFS(fs,store.getStorefiles());
  assertEquals(lowestTimeStampFromStore,lowestTimeStampFromFS);
  store.compact(store.requestCompaction());
  lowestTimeStampFromStore=Store.getLowestTimestamp(store.getStorefiles());
  lowestTimeStampFromFS=getLowestTimeStampFromFS(fs,store.getStorefiles());
  assertEquals(lowestTimeStampFromStore,lowestTimeStampFromFS);
}
