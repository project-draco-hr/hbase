{
  if (authenticator == null) {
    String className=conf.get(AUTHENTICATOR_KEY,HBCAuthenticator.class.getCanonicalName());
    try {
      Class<?> c=getClass().getClassLoader().loadClass(className);
      if (className.endsWith(HBCAuthenticator.class.getName()) || className.endsWith(HTableAuthenticator.class.getName()) || className.endsWith(JDBCAuthenticator.class.getName())) {
        Constructor<?> cons=c.getConstructor(Configuration.class);
        authenticator=(Authenticator)cons.newInstance(new Object[]{conf});
      }
 else       if (className.endsWith(ZooKeeperAuthenticator.class.getName())) {
        Constructor<?> cons=c.getConstructor(Configuration.class,ZooKeeperWrapper.class);
        authenticator=(Authenticator)cons.newInstance(new Object[]{conf,wrapper});
      }
 else {
        authenticator=(Authenticator)c.newInstance();
      }
    }
 catch (    Exception e) {
      LOG.error(StringUtils.stringifyException(e));
    }
    if (authenticator == null) {
      authenticator=new HBCAuthenticator(conf);
    }
  }
  return authenticator;
}
