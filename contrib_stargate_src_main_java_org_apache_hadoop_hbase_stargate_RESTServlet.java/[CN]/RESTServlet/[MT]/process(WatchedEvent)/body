{
  LOG.debug(("ZooKeeper.Watcher event " + event.getType() + " with path "+ event.getPath()));
  if (event.getState() == KeeperState.Expired || (event.getType().equals(EventType.NodeDeleted) && event.getPath().equals(znode))) {
    wrapper.close();
    wrapper=null;
    while (!stopping.get())     try {
      wrapper=initZooKeeperWrapper();
      break;
    }
 catch (    IOException e) {
      LOG.error(StringUtils.stringifyException(e));
      try {
        Thread.sleep(10 * 1000);
      }
 catch (      InterruptedException ex) {
      }
    }
  }
}
