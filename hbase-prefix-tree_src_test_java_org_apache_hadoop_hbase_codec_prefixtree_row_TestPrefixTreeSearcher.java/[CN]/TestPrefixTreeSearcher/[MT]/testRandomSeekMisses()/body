{
  CellSearcher searcher=null;
  List<Integer> rowStartIndexes=rows.getRowStartIndexes();
  try {
    searcher=DecoderFactory.checkOut(block,true);
    for (int i=0; i < rows.getInputs().size(); ++i) {
      KeyValue kv=rows.getInputs().get(i);
      KeyValue inputNextRow=KeyValueUtil.createFirstKeyInNextRow(kv);
      CellScannerPosition position=searcher.positionAtOrBefore(inputNextRow);
      boolean isFirstInRow=rowStartIndexes.contains(i);
      if (isFirstInRow) {
        int rowIndex=rowStartIndexes.indexOf(i);
        if (rowIndex < rowStartIndexes.size() - 1) {
          Assert.assertEquals(CellScannerPosition.BEFORE,position);
        }
      }
      KeyValue inputPreviousKv=KeyValueUtil.previousKey(kv);
      boolean hit=searcher.positionAt(inputPreviousKv);
      Assert.assertFalse(hit);
      position=searcher.positionAtOrAfter(inputPreviousKv);
      if (CollectionUtils.isLastIndex(rows.getInputs(),i)) {
        Assert.assertTrue(CellScannerPosition.AFTER_LAST == position);
      }
 else {
        Assert.assertTrue(CellScannerPosition.AFTER == position);
        Assert.assertEquals(rows.getInputs().get(i + 1),searcher.current());
      }
    }
  }
  finally {
    DecoderFactory.checkIn(searcher);
  }
}
