{
  this.conf.setInt("dfs.blocksize",1024 * 1024);
  this.conf.setInt("hbase.regionserver.flushlogentries",1);
  conf.setBoolean("dfs.support.append",true);
  conf.setInt("heartbeat.recheck.interval",5000);
  conf.setInt("dfs.heartbeat.interval",1);
  conf.setInt("dfs.socket.timeout",5000);
  conf.setInt("ipc.client.connect.max.retries",1);
  conf.setInt("dfs.client.block.recovery.retries",1);
  cluster=new MiniDFSCluster(conf,3,true,(String[])null);
  this.conf.set(HConstants.HBASE_DIR,this.cluster.getFileSystem().getHomeDirectory().toString());
  super.setUp();
  this.dir=new Path("/hbase",getName());
  if (fs.exists(dir)) {
    fs.delete(dir,true);
  }
  this.oldLogDir=new Path(this.dir,HConstants.HREGION_OLDLOGDIR_NAME);
}
