{
  this.fileStatus=fileStatus;
  Path p=fileStatus.getPath();
  if (HFileLink.isHFileLink(p)) {
    this.reference=null;
    this.link=new HFileLink(conf,p);
    LOG.debug("Store file " + p + " is a link");
  }
 else   if (isReference(p)) {
    this.reference=Reference.read(fs,p);
    Path referencePath=getReferredToFile(p);
    if (HFileLink.isHFileLink(referencePath)) {
      this.link=new HFileLink(conf,referencePath);
    }
 else {
      this.link=null;
    }
    LOG.debug("Store file " + p + " is a "+ reference.getFileRegion()+ " reference to "+ referencePath);
  }
 else   if (isHFile(p)) {
    this.reference=null;
    this.link=null;
  }
 else {
    throw new IOException("path=" + p + " doesn't look like a valid StoreFile");
  }
}
