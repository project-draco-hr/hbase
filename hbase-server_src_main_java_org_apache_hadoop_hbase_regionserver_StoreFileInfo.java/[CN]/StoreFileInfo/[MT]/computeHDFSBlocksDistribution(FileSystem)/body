{
  FileStatus status;
  if (this.reference != null) {
    if (this.link != null) {
      status=link.getFileStatus(fs);
    }
 else {
      Path referencePath=getReferredToFile(this.getPath());
      status=fs.getFileStatus(referencePath);
    }
    return computeRefFileHDFSBlockDistribution(fs,reference,status);
  }
 else {
    if (this.link != null) {
      status=link.getFileStatus(fs);
    }
 else {
      status=this.fileStatus;
    }
    return FSUtils.computeHDFSBlocksDistribution(fs,status,0,status.getLen());
  }
}
