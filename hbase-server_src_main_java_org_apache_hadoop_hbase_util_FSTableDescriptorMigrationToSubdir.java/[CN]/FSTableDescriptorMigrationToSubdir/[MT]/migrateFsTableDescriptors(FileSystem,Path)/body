{
  Path snapshotsDir=SnapshotDescriptionUtils.getSnapshotsDir(rootDir);
  if (fs.exists(snapshotsDir)) {
    LOG.info("Migrating snapshots");
    FileStatus[] snapshots=fs.listStatus(snapshotsDir,new SnapshotDescriptionUtils.CompletedSnaphotDirectoriesFilter(fs));
    for (    FileStatus snapshot : snapshots) {
      migrateTable(fs,snapshot.getPath());
    }
  }
  LOG.info("Migrating user tables");
  List<Path> userTableDirs=FSUtils.getTableDirs(fs,rootDir);
  for (  Path userTableDir : userTableDirs) {
    migrateTable(fs,userTableDir);
  }
  LOG.info("Migrating system tables");
  migrateTableIfExists(fs,rootDir,HConstants.ROOT_TABLE_NAME);
  migrateTableIfExists(fs,rootDir,HConstants.META_TABLE_NAME);
}
