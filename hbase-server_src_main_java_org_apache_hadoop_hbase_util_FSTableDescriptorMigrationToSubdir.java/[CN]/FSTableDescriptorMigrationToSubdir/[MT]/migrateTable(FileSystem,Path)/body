{
  FileStatus oldTableStatus=FSTableDescriptors.getCurrentTableInfoStatus(fs,tableDir,true);
  if (oldTableStatus == null) {
    LOG.debug("No table info file to migrate for " + tableDir);
    return;
  }
  Path tableInfoDir=new Path(tableDir,FSTableDescriptors.TABLEINFO_DIR);
  boolean removedExistingSubdir=FSUtils.deleteDirectory(fs,tableInfoDir);
  if (removedExistingSubdir) {
    LOG.info("Removed existing subdir at: " + tableInfoDir);
  }
  boolean createdSubdir=fs.mkdirs(tableInfoDir);
  if (!createdSubdir) {
    throw new IOException("Unable to create new table info directory: " + tableInfoDir);
  }
  Path oldTableInfoPath=oldTableStatus.getPath();
  Path newTableInfoPath=new Path(tableInfoDir,oldTableInfoPath.getName());
  boolean renamedInfoFile=fs.rename(oldTableInfoPath,newTableInfoPath);
  if (!renamedInfoFile) {
    throw new IOException("Failed to move table info file from old location: " + oldTableInfoPath + " to new location: "+ newTableInfoPath);
  }
  LOG.info("Migrated table info from: " + oldTableInfoPath + " to new location: "+ newTableInfoPath);
}
