{
  AssignmentManager am=this.masterServices.getAssignmentManager();
  long waitTime=server.getConfiguration().getLong("hbase.master.wait.on.region",5 * 60 * 1000);
  for (  HRegionInfo region : regions) {
    long done=System.currentTimeMillis() + waitTime;
    while (System.currentTimeMillis() < done) {
      AssignmentManager.RegionState rs=am.isRegionInTransition(region);
      if (rs == null)       break;
      Threads.sleep(waitingTimeForEvents);
      LOG.debug("Waiting on  region to clear regions in transition; " + rs);
    }
    if (am.isRegionInTransition(region) != null) {
      throw new IOException("Waited hbase.master.wait.on.region (" + waitTime + "ms) for region to leave region "+ region.getRegionNameAsString()+ " in transitions");
    }
    LOG.debug("Deleting region " + region.getRegionNameAsString() + " from META and FS");
    MetaEditor.deleteRegion(this.server.getCatalogTracker(),region);
    this.masterServices.getMasterFileSystem().deleteRegion(region);
  }
  this.masterServices.getMasterFileSystem().deleteTable(tableName);
  am.getZKTable().setEnabledTable(Bytes.toString(tableName));
}
