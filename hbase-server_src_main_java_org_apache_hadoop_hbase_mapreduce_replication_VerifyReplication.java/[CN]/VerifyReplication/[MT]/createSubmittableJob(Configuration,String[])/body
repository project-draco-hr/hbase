{
  if (!doCommandLine(args)) {
    return null;
  }
  if (!conf.getBoolean(HConstants.REPLICATION_ENABLE_KEY,HConstants.REPLICATION_ENABLE_DEFAULT)) {
    throw new IOException("Replication needs to be enabled to verify it.");
  }
  conf.set(NAME + ".peerId",peerId);
  conf.set(NAME + ".tableName",tableName);
  conf.setLong(NAME + ".startTime",startTime);
  conf.setLong(NAME + ".endTime",endTime);
  if (families != null) {
    conf.set(NAME + ".families",families);
  }
  Job job=new Job(conf,NAME + "_" + tableName);
  job.setJarByClass(VerifyReplication.class);
  Scan scan=new Scan();
  if (startTime != 0) {
    scan.setTimeRange(startTime,endTime == 0 ? HConstants.LATEST_TIMESTAMP : endTime);
  }
  if (families != null) {
    String[] fams=families.split(",");
    for (    String fam : fams) {
      scan.addFamily(Bytes.toBytes(fam));
    }
  }
  TableMapReduceUtil.initTableMapperJob(tableName,scan,Verifier.class,null,null,job);
  job.setOutputFormatClass(NullOutputFormat.class);
  job.setNumReduceTasks(0);
  return job;
}
