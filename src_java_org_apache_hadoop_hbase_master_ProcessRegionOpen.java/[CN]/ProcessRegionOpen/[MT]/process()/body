{
  Boolean result=new RetryableMetaOperation<Boolean>(this.metaRegion,this.master){
    private final RegionHistorian historian=RegionHistorian.getInstance();
    public Boolean call() throws IOException {
      LOG.info(regionInfo.getRegionNameAsString() + " open on " + serverAddress.toString());
      if (!metaRegionAvailable()) {
        return true;
      }
      LOG.info("updating row " + regionInfo.getRegionNameAsString() + " in region "+ Bytes.toString(metaRegionName)+ " with startcode "+ Bytes.toLong(startCode)+ " and server "+ serverAddress.toString());
      BatchUpdate b=new BatchUpdate(regionInfo.getRegionName());
      b.put(COL_SERVER,Bytes.toBytes(serverAddress.toString()));
      b.put(COL_STARTCODE,startCode);
      server.batchUpdate(metaRegionName,b,-1L);
      if (!this.historian.isOnline()) {
        this.historian.online(this.master.getConfiguration());
      }
      this.historian.addRegionOpen(regionInfo,serverAddress);
      if (isMetaTable) {
        MetaRegion m=new MetaRegion(new HServerAddress(serverAddress),regionInfo.getRegionName(),regionInfo.getStartKey());
        if (!master.regionManager.isInitialMetaScanComplete()) {
          LOG.debug("Adding " + m.toString() + " to regions to scan");
          master.regionManager.addMetaRegionToScan(m);
        }
 else {
          LOG.debug("Adding to onlineMetaRegions: " + m.toString());
          master.regionManager.putMetaRegionOnline(m);
          master.regionManager.metaScannerThread.interrupt();
        }
      }
      master.regionManager.noLongerPending(regionInfo.getRegionName());
      return true;
    }
  }
.doWithRetries();
  return result == null ? true : result;
}
