{
  String procName=proc.getName();
  String reachedNode=zkProc.getReachedBarrierNode(procName);
  LOG.debug("Creating reached barrier zk node:" + reachedNode);
  try {
    ZKUtil.createWithParents(zkProc.getWatcher(),reachedNode);
    for (    String node : nodeNames) {
      String znode=ZKUtil.joinZNode(reachedNode,node);
      if (ZKUtil.watchAndCheckExists(zkProc.getWatcher(),znode)) {
        byte[] dataFromMember=ZKUtil.getData(zkProc.getWatcher(),znode);
        if (!ProtobufUtil.isPBMagicPrefix(dataFromMember)) {
          throw new IOException("Failed to get data from finished node or data is illegally formatted: " + znode);
        }
 else {
          dataFromMember=Arrays.copyOfRange(dataFromMember,ProtobufUtil.lengthOfPBMagic(),dataFromMember.length);
          coordinator.memberFinishedBarrier(procName,node,dataFromMember);
        }
      }
    }
  }
 catch (  KeeperException e) {
    throw new IOException("Failed while creating reached node:" + reachedNode,e);
  }
catch (  InterruptedException e) {
    throw new InterruptedIOException("Interrupted while creating reached node:" + reachedNode);
  }
}
