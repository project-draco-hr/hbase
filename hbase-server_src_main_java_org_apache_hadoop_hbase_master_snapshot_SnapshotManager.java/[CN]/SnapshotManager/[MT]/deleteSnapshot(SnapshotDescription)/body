{
  MasterCoprocessorHost cpHost=master.getMasterCoprocessorHost();
  if (cpHost != null) {
    cpHost.preDeleteSnapshot(snapshot);
  }
  if (!isSnapshotCompleted(snapshot)) {
    throw new SnapshotDoesNotExistException(snapshot);
  }
  String snapshotName=snapshot.getName();
  LOG.debug("Deleting snapshot: " + snapshotName);
  MasterFileSystem fs=master.getMasterFileSystem();
  Path snapshotDir=SnapshotDescriptionUtils.getCompletedSnapshotDir(snapshotName,rootDir);
  if (!fs.getFileSystem().delete(snapshotDir,true)) {
    throw new HBaseSnapshotException("Failed to delete snapshot directory: " + snapshotDir);
  }
  if (cpHost != null) {
    cpHost.postDeleteSnapshot(snapshot);
  }
}
