{
  if (expected == null) {
    throw new UnknownSnapshotException("No snapshot name passed in request, can't figure out which snapshot you want to check.");
  }
  TakeSnapshotHandler handler=getTakeSnapshotHandler(expected);
  if (handler == null) {
    if (!isSnapshotCompleted(expected)) {
      throw new UnknownSnapshotException("Snapshot:" + expected.getName() + " is not currently running or one of the known completed snapshots.");
    }
    return true;
  }
  try {
    handler.rethrowException();
  }
 catch (  ForeignException e) {
    throw new HBaseSnapshotException("Snapshot error from RS",e,expected);
  }
  if (handler.isFinished()) {
    LOG.debug("Snapshot '" + expected.getName() + "' has completed, notifying client.");
    return true;
  }
 else   if (LOG.isDebugEnabled()) {
    LOG.debug("Sentinel isn't finished with snapshot '" + expected.getName() + "'!");
  }
  return false;
}
