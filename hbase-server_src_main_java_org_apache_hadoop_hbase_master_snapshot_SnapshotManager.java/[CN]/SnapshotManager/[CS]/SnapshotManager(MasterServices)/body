{
  this.master=master;
  Configuration conf=master.getConfiguration();
  this.wakeFrequency=conf.getInt(SNAPSHOT_WAKE_MILLIS_KEY,SNAPSHOT_WAKE_MILLIS_DEFAULT);
  this.rootDir=master.getMasterFileSystem().getRootDir();
  this.executorService=master.getExecutorService();
  checkSnapshotSupport(master.getConfiguration(),master.getMasterFileSystem());
  resetTempDir();
}
