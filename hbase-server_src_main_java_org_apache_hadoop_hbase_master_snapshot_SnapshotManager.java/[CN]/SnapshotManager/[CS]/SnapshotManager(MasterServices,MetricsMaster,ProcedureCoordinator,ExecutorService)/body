{
  this.master=master;
  this.metricsMaster=metricsMaster;
  checkSnapshotSupport(master.getConfiguration(),master.getMasterFileSystem());
  this.wakeFrequency=master.getConfiguration().getInt(SNAPSHOT_WAKE_MILLIS_KEY,SNAPSHOT_WAKE_MILLIS_DEFAULT);
  this.coordinator=coordinator;
  this.rootDir=master.getMasterFileSystem().getRootDir();
  this.executorService=pool;
  resetTempDir();
}
