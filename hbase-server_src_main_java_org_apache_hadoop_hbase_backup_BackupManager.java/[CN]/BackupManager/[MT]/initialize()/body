{
  String ongoingBackupId=this.getOngoingBackupId();
  if (ongoingBackupId != null) {
    LOG.info("There is a ongoing backup " + ongoingBackupId + ". Can not launch new backup until no ongoing backup remains.");
    throw new BackupException("There is ongoing backup.");
  }
  int nrThreads=this.conf.getInt("hbase.backup.threads.max",1);
  ThreadFactoryBuilder builder=new ThreadFactoryBuilder();
  builder.setNameFormat("BackupHandler-%1$d");
  this.pool=new ThreadPoolExecutor(nrThreads,nrThreads,60,TimeUnit.SECONDS,new LinkedBlockingQueue<Runnable>(),builder.build());
  ((ThreadPoolExecutor)pool).allowCoreThreadTimeOut(true);
}
