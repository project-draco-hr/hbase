{
  if (targetRootDir == null) {
    throw new BackupException("Wrong backup request parameter: target backup root directory");
  }
  if (type.equals(BackupRestoreConstants.BACKUP_TYPE_FULL) && tablelist == null) {
    HTableDescriptor[] htds=null;
    try (Connection conn=ConnectionFactory.createConnection(conf);HBaseAdmin hbadmin=(HBaseAdmin)conn.getAdmin()){
      htds=hbadmin.listTables();
    }
 catch (    Exception e) {
      throw new BackupException(e);
    }
    if (htds == null) {
      throw new BackupException("No table exists for full backup of all tables.");
    }
 else {
      StringBuilder sb=new StringBuilder();
      for (      HTableDescriptor hTableDescriptor : htds) {
        sb.append(hTableDescriptor.getNameAsString() + BackupRestoreConstants.TABLENAME_DELIMITER_IN_COMMAND);
      }
      sb.deleteCharAt(sb.lastIndexOf(BackupRestoreConstants.TABLENAME_DELIMITER_IN_COMMAND));
      tablelist=sb.toString();
      LOG.info("Full backup all the tables available in the cluster: " + tablelist);
    }
  }
  return new BackupContext(backupId,type,tablelist.split(BackupRestoreConstants.TABLENAME_DELIMITER_IN_COMMAND),targetRootDir,snapshot);
}
