{
  HBaseAdmin admin=new HBaseAdmin(conf);
  HTableDescriptor htd=new HTableDescriptor(getName());
  Text tableName=new Text(getName());
  Text[] colKeys=new Text[(LAST_COLKEY - FIRST_COLKEY) + 1];
  for (char i=0; i < colKeys.length; i++) {
    colKeys[i]=new Text(new String(new char[]{(char)(FIRST_COLKEY + i),':'}));
    htd.addFamily(new HColumnDescriptor(colKeys[i].toString()));
  }
  admin.createTable(htd);
  assertTrue("Table with name " + tableName + " created successfully.",admin.tableExists(tableName));
  assertTrue("Master is running.",admin.isMasterRunning());
  HTable table=new HTable(conf,tableName);
  for (char i=FIRST_ROWKEY; i <= LAST_ROWKEY; i++) {
    Text rowKey=new Text(new String(new char[]{i}));
    long lockID=table.startUpdate(rowKey);
    for (char j=0; j < colKeys.length; j++) {
      table.put(lockID,colKeys[j],(i >= FIRST_BAD_RANGE_ROWKEY && i <= LAST_BAD_RANGE_ROWKEY) ? BAD_BYTES : GOOD_BYTES);
    }
    table.commit(lockID);
  }
  regExpFilterTest(table,colKeys);
  rowFilterSetTest(table,colKeys);
}
