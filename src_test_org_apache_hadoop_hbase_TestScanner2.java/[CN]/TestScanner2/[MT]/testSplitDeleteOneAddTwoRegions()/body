{
  HClient client=new HClient(this.conf);
  client.createTable(new HTableDescriptor(getName()));
  List<HRegionInfo> regions=scan(client,HConstants.META_TABLE_NAME);
  assertEquals("Expected one region",regions.size(),1);
  HRegionInfo region=regions.get(0);
  assertTrue("Expected region named for test",region.regionName.toString().startsWith(getName()));
  HRegion.removeRegionFromMETA(client,HConstants.META_TABLE_NAME,region.regionName);
  HTableDescriptor desc=region.tableDesc;
  Path homedir=new Path(getName());
  List<HRegion> newRegions=new ArrayList<HRegion>(2);
  newRegions.add(HRegion.createHRegion(new HRegionInfo(2L,desc,null,new Text("midway")),homedir,this.conf,null));
  newRegions.add(HRegion.createHRegion(new HRegionInfo(3L,desc,new Text("midway"),null),homedir,this.conf,null));
  for (  HRegion r : newRegions) {
    HRegion.addRegionToMETA(client,HConstants.META_TABLE_NAME,r,this.cluster.getHMasterAddress(),-1L);
  }
  regions=scan(client,HConstants.META_TABLE_NAME);
  assertEquals("Should be two regions only",2,regions.size());
}
