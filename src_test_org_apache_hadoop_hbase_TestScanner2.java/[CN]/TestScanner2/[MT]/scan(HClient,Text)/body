{
  List<HRegionInfo> regions=new ArrayList<HRegionInfo>();
  HRegionInterface regionServer=null;
  long scannerId=-1L;
  try {
    client.openTable(table);
    HClient.RegionLocation rl=client.getRegionLocation(table);
    regionServer=client.getHRegionConnection(rl.serverAddress);
    scannerId=regionServer.openScanner(rl.regionInfo.regionName,HMaster.METACOLUMNS,new Text());
    while (true) {
      TreeMap<Text,byte[]> results=new TreeMap<Text,byte[]>();
      KeyedData[] values=regionServer.next(scannerId);
      if (values.length == 0) {
        break;
      }
      for (int i=0; i < values.length; i++) {
        byte[] bytes=new byte[values[i].getData().getSize()];
        System.arraycopy(values[i].getData().get(),0,bytes,0,bytes.length);
        results.put(values[i].getKey().getColumn(),bytes);
      }
      HRegionInfo info=HRegion.getRegionInfo(results);
      String serverName=HRegion.getServerName(results);
      long startCode=HRegion.getStartCode(results);
      LOG.info(Thread.currentThread().getName() + " scanner: " + Long.valueOf(scannerId)+ ": regioninfo: {"+ info.toString()+ "}, server: "+ serverName+ ", startCode: "+ startCode);
      regions.add(info);
    }
  }
  finally {
    try {
      if (scannerId != -1L) {
        if (regionServer != null) {
          regionServer.close(scannerId);
        }
      }
    }
 catch (    IOException e) {
      LOG.error(e);
    }
  }
  return regions;
}
