{
  byte[] row=Bytes.toBytes("testrow");
  byte[] fam=Bytes.toBytes("testfamily");
  byte[] qf1=Bytes.toBytes("testqualifier1");
  byte[] qf2=Bytes.toBytes("testqualifier2");
  byte[] qf3=Bytes.toBytes("testqualifier3");
  byte[] qf4=Bytes.toBytes("testqualifier4");
  byte[] qf5=Bytes.toBytes("testqualifier5");
  byte[] val=Bytes.toBytes("testval");
  Get get=new Get(row);
  NavigableSet<byte[]> columns=new TreeSet<byte[]>(Bytes.BYTES_COMPARATOR);
  columns.add(qf2);
  columns.add(qf4);
  long ttl=Long.MAX_VALUE;
  QueryMatcher matcher=new QueryMatcher(get,row,fam,columns,ttl,KeyValue.KEY_COMPARATOR,1);
  memcache.add(new KeyValue(row,fam,qf1,val));
  memcache.add(new KeyValue(row,fam,qf2,val));
  memcache.add(new KeyValue(row,fam,qf3,val));
  memcache.snapshot();
  assertEquals(3,memcache.snapshot.size());
  assertEquals(0,memcache.memcache.size());
  memcache.add(new KeyValue(row,fam,qf4,val));
  memcache.add(new KeyValue(row,fam,qf5,val));
  assertEquals(2,memcache.memcache.size());
  List<KeyValue> result=new ArrayList<KeyValue>();
  boolean res=memcache.get(matcher,result);
  assertEquals(true,res);
}
