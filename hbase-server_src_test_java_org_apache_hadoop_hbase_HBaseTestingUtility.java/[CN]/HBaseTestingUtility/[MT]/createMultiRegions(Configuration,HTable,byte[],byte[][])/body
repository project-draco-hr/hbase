{
  Arrays.sort(startKeys,Bytes.BYTES_COMPARATOR);
  HTable meta=new HTable(c,TableName.META_TABLE_NAME);
  HTableDescriptor htd=table.getTableDescriptor();
  if (!htd.hasFamily(columnFamily)) {
    HColumnDescriptor hcd=new HColumnDescriptor(columnFamily);
    htd.addFamily(hcd);
  }
  List<byte[]> rows=getMetaTableRows(htd.getTableName());
  String regionToDeleteInFS=table.getRegionsInRange(Bytes.toBytes(""),Bytes.toBytes("")).get(0).getRegionInfo().getEncodedName();
  List<HRegionInfo> newRegions=new ArrayList<HRegionInfo>(startKeys.length);
  int count=0;
  for (int i=0; i < startKeys.length; i++) {
    int j=(i + 1) % startKeys.length;
    HRegionInfo hri=new HRegionInfo(table.getName(),startKeys[i],startKeys[j]);
    MetaEditor.addRegionToMeta(meta,hri);
    newRegions.add(hri);
    count++;
  }
  for (  byte[] row : rows) {
    LOG.info("createMultiRegions: deleting meta row -> " + Bytes.toStringBinary(row));
    meta.delete(new Delete(row));
  }
  Path tableDir=new Path(getDefaultRootDirPath().toString() + System.getProperty("file.separator") + htd.getTableName()+ System.getProperty("file.separator")+ regionToDeleteInFS);
  FileSystem.get(c).delete(tableDir);
  HConnection conn=table.getConnection();
  conn.clearRegionCache();
  HBaseAdmin admin=getHBaseAdmin();
  if (admin.isTableEnabled(table.getTableName())) {
    for (    HRegionInfo hri : newRegions) {
      admin.assign(hri.getRegionName());
    }
  }
  meta.close();
  return count;
}
