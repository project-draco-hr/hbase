{
  if (this.zkCluster != null) {
    throw new IOException("Cluster already running at " + dir);
  }
  this.passedZkCluster=false;
  this.zkCluster=new MiniZooKeeperCluster(this.getConfiguration());
  int clientPort=this.zkCluster.startup(dir,zooKeeperServerNum);
  this.conf.set(HConstants.ZOOKEEPER_CLIENT_PORT,Integer.toString(clientPort));
  return this.zkCluster;
}
