{
  if (dataTestDirOnTestFS != null) {
    LOG.warn("Data test on test fs dir already setup in " + dataTestDirOnTestFS.toString());
    return;
  }
  FileSystem fs=getTestFileSystem();
  if (fs.getUri().getScheme().equals(fs.getLocal(conf).getUri().getScheme())) {
    if (dataTestDir == null) {
      setupDataTestDir();
    }
    dataTestDirOnTestFS=new Path(dataTestDir.getAbsolutePath());
  }
 else {
    Path base=getBaseTestDirOnTestFS();
    String randomStr=UUID.randomUUID().toString();
    dataTestDirOnTestFS=new Path(base,randomStr);
    fs.deleteOnExit(dataTestDirOnTestFS);
  }
}
