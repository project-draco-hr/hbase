{
  TableName tableName=TableName.valueOf(table);
  long startWait=System.currentTimeMillis();
  waitTableAvailable(admin,table,timeoutMillis);
  while (!admin.isTableEnabled(tableName)) {
    assertTrue("Timed out waiting for table to become available and enabled " + Bytes.toStringBinary(table),System.currentTimeMillis() - startWait < timeoutMillis);
    Thread.sleep(200);
  }
  try {
    Canary.sniff(admin,tableName);
  }
 catch (  Exception e) {
    throw new IOException(e);
  }
}
