{
  utility.startMiniZKCluster();
  zkWrapper=ZooKeeperWrapper.createInstance(conf,"cluster1");
  String unassignedZNode=zkWrapper.getRegionInTransitionZNode();
  zkWrapper.createZNodeIfNotExists(unassignedZNode);
  byte[] data=null;
  HBaseEventType hbEventType=HBaseEventType.RS2ZK_REGION_OPENED;
  try {
    data=Writables.getBytes(new RegionTransitionEventData(hbEventType,HMaster.MASTER));
  }
 catch (  IOException e) {
    LOG.error("Error creating event data for " + hbEventType,e);
  }
  zkWrapper.createUnassignedRegion(HRegionInfo.ROOT_REGIONINFO.getEncodedName(),data);
  zkWrapper.createUnassignedRegion(HRegionInfo.FIRST_META_REGIONINFO.getEncodedName(),data);
  LOG.debug("Created UNASSIGNED zNode for ROOT and META regions in state " + HBaseEventType.M2ZK_REGION_OFFLINE);
  LOG.info("Starting HBase cluster...");
  utility.startMiniCluster(2);
  utility.createTable(TABLENAME,FAMILIES);
  LOG.info("Created a table, waiting for table to be available...");
  utility.waitTableAvailable(TABLENAME,60 * 1000);
  LOG.info("Master deleted unassgined region and started up successfully.");
}
