{
  long now=EnvironmentEdgeManager.currentTimeMillis();
  AuthenticationKey secretKey=currentKey;
  identifier.setKeyId(secretKey.getKeyId());
  identifier.setIssueDate(now);
  identifier.setExpirationDate(now + tokenMaxLifetime);
  identifier.setSequenceNumber(tokenSeq.getAndIncrement());
  return createPassword(WritableUtils.toByteArray(identifier),secretKey.getKey());
}
