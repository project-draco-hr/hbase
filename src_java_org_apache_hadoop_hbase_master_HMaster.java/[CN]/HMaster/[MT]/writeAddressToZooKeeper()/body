{
  while (true) {
    zkMasterAddressWatcher.waitForMasterAddressAvailability();
    if (this.shutdownRequested.get()) {
      return;
    }
 else     if (zooKeeperWrapper.writeMasterAddress(address)) {
      zooKeeperWrapper.setClusterState(true);
      return;
    }
  }
}
