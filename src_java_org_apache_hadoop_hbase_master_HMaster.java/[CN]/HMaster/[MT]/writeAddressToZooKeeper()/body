{
  while (true) {
    zkMasterAddressWatcher.waitForMasterAddressAvailability();
    if (zooKeeperWrapper.writeMasterAddress(address)) {
      return;
    }
  }
}
