{
  String tableName=newRegion.getTableDesc().getNameAsString();
  MetaRegion m=regionManager.getFirstMetaRegionForRegion(newRegion);
  byte[] metaRegionName=m.getRegionName();
  HRegionInterface srvr=connection.getHRegionConnection(m.getServer());
  byte[] firstRowInTable=Bytes.toBytes(tableName + ",,");
  Scan scan=new Scan(firstRowInTable);
  scan.addColumn(CATALOG_FAMILY,REGIONINFO_QUALIFIER);
  long scannerid=srvr.openScanner(metaRegionName,scan);
  try {
    Result data=srvr.next(scannerid);
    if (data != null && data.size() > 0) {
      HRegionInfo info=Writables.getHRegionInfo(data.getValue(CATALOG_FAMILY,REGIONINFO_QUALIFIER));
      if (info.getTableDesc().getNameAsString().equals(tableName)) {
        throw new TableExistsException(tableName);
      }
    }
  }
  finally {
    srvr.close(scannerid);
  }
  regionManager.createRegion(newRegion,srvr,metaRegionName);
}
