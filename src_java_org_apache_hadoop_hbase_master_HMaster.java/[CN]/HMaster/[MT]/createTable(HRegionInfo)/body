{
  Text tableName=newRegion.getTableDesc().getName();
  if (tableInCreation.contains(tableName)) {
    throw new TableExistsException("Table " + tableName + " in process "+ "of being created");
  }
  tableInCreation.add(tableName);
  try {
    MetaRegion m=regionManager.getFirstMetaRegionForRegion(newRegion);
    Text metaRegionName=m.getRegionName();
    HRegionInterface srvr=connection.getHRegionConnection(m.getServer());
    long scannerid=srvr.openScanner(metaRegionName,COL_REGIONINFO_ARRAY,tableName,System.currentTimeMillis(),null);
    try {
      HbaseMapWritable data=srvr.next(scannerid);
      if (data != null && data.size() > 0) {
        for (        Writable k : data.keySet()) {
          if (HRegionInfo.getTableNameFromRegionName(((HStoreKey)k).getRow()).equals(tableName)) {
            throw new TableExistsException(tableName.toString());
          }
        }
      }
    }
  finally {
      srvr.close(scannerid);
    }
    regionManager.createRegion(newRegion,srvr,metaRegionName);
  }
  finally {
    tableInCreation.remove(newRegion.getTableDesc().getName());
  }
}
