{
  Set<MetaRegion> regions=regionManager.getMetaRegionsForTable(tableName);
  for (  MetaRegion m : regions) {
    byte[] firstRowInTable=Bytes.toBytes(Bytes.toString(tableName) + ",,");
    byte[] metaRegionName=m.getRegionName();
    HRegionInterface srvr=connection.getHRegionConnection(m.getServer());
    long scannerid=srvr.openScanner(metaRegionName,new byte[][]{COL_REGIONINFO,COL_SERVER},firstRowInTable,LATEST_TIMESTAMP,null);
    try {
      while (true) {
        RowResult data=srvr.next(scannerid);
        if (data == null || data.size() <= 0)         break;
        HRegionInfo info=Writables.getHRegionInfo(data.get(COL_REGIONINFO));
        if (Bytes.compareTo(info.getTableDesc().getName(),tableName) == 0) {
          if ((Bytes.compareTo(info.getStartKey(),rowKey) >= 0) && (Bytes.compareTo(info.getEndKey(),rowKey) < 0)) {
            Cell cell=data.get(COL_SERVER);
            if (cell != null) {
              HServerAddress server=new HServerAddress(Bytes.toString(cell.getValue()));
              return new Pair<HRegionInfo,HServerAddress>(info,server);
            }
          }
        }
 else {
          break;
        }
      }
    }
  finally {
      srvr.close(scannerid);
    }
  }
  return null;
}
