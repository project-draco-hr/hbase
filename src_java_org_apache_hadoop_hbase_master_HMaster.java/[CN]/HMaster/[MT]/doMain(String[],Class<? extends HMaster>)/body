{
  if (args.length < 1) {
    printUsageAndExit();
  }
  HBaseConfiguration conf=new HBaseConfiguration();
  final String addressArgKey="--bind=";
  for (  String cmd : args) {
    if (cmd.startsWith(addressArgKey)) {
      conf.set(MASTER_ADDRESS,cmd.substring(addressArgKey.length()));
      continue;
    }
    if (cmd.equals("start")) {
      try {
        RuntimeMXBean runtime=ManagementFactory.getRuntimeMXBean();
        if (runtime != null) {
          LOG.info("vmName=" + runtime.getVmName() + ", vmVendor="+ runtime.getVmVendor()+ ", vmVersion="+ runtime.getVmVersion());
          LOG.info("vmInputArguments=" + runtime.getInputArguments());
        }
        if (LocalHBaseCluster.isLocal(conf)) {
          (new LocalHBaseCluster(conf)).startup();
        }
 else {
          Constructor<? extends HMaster> c=masterClass.getConstructor(HBaseConfiguration.class);
          HMaster master=c.newInstance(conf);
          master.start();
        }
      }
 catch (      Throwable t) {
        LOG.error("Can not start master",t);
        System.exit(-1);
      }
      break;
    }
    if (cmd.equals("stop")) {
      HBaseAdmin adm=null;
      try {
        adm=new HBaseAdmin(conf);
      }
 catch (      MasterNotRunningException e) {
        LOG.error("master is not running");
        System.exit(0);
      }
      try {
        adm.shutdown();
      }
 catch (      Throwable t) {
        LOG.error("Can not stop master",t);
        System.exit(-1);
      }
      break;
    }
    printUsageAndExit();
  }
}
