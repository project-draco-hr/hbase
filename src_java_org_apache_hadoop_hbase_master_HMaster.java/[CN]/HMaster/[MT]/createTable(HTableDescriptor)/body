{
  if (!isMasterRunning()) {
    throw new MasterNotRunningException();
  }
  HRegionInfo newRegion=new HRegionInfo(desc,null,null);
  for (int tries=0; tries < this.numRetries; tries++) {
    try {
      if (!this.regionManager.areAllMetaRegionsOnline()) {
        throw new NotAllMetaRegionsOnlineException();
      }
      if (!this.serverManager.canAssignUserRegions()) {
        throw new IOException("not enough servers to create table yet");
      }
      createTable(newRegion);
      LOG.info("created table " + desc.getNameAsString());
      break;
    }
 catch (    TableExistsException e) {
      throw e;
    }
catch (    IOException e) {
      if (tries == this.numRetries - 1) {
        throw RemoteExceptionHandler.checkIOException(e);
      }
      this.sleeper.sleep();
    }
  }
}
