{
  FSUtils.waitOnSafeMode(c,c.getInt(THREAD_WAKE_FREQUENCY,10 * 1000));
  if (!fs.exists(rd)) {
    fs.mkdirs(rd);
    FSUtils.setVersion(fs,rd);
  }
 else {
    FSUtils.checkVersion(fs,rd,true);
  }
  if (!FSUtils.rootRegionExists(fs,rd)) {
    bootstrap(rd,c);
  }
  return rd;
}
