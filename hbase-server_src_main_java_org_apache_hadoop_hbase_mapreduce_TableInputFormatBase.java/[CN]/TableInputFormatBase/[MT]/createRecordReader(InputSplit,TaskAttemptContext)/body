{
  if (table == null) {
    throw new IOException("Cannot create a record reader because of a" + " previous error. Please look at the previous logs lines from" + " the task's full log for more details.");
  }
  TableSplit tSplit=(TableSplit)split;
  LOG.info("Input split length: " + StringUtils.humanReadableInt(tSplit.getLength()) + " bytes.");
  TableRecordReader trr=this.tableRecordReader;
  if (trr == null) {
    trr=new TableRecordReader();
  }
  Scan sc=new Scan(this.scan);
  sc.setStartRow(tSplit.getStartRow());
  sc.setStopRow(tSplit.getEndRow());
  trr.setScan(sc);
  trr.setTable(table);
  return trr;
}
