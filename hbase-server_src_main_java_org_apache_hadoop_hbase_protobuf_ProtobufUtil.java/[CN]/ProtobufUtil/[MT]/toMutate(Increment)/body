{
  Mutate.Builder builder=Mutate.newBuilder();
  builder.setRow(ByteString.copyFrom(increment.getRow()));
  builder.setMutateType(MutateType.INCREMENT);
  builder.setWriteToWAL(increment.getWriteToWAL());
  TimeRange timeRange=increment.getTimeRange();
  if (!timeRange.isAllTime()) {
    HBaseProtos.TimeRange.Builder timeRangeBuilder=HBaseProtos.TimeRange.newBuilder();
    timeRangeBuilder.setFrom(timeRange.getMin());
    timeRangeBuilder.setTo(timeRange.getMax());
    builder.setTimeRange(timeRangeBuilder.build());
  }
  ColumnValue.Builder columnBuilder=ColumnValue.newBuilder();
  QualifierValue.Builder valueBuilder=QualifierValue.newBuilder();
  for (  Map.Entry<byte[],NavigableMap<byte[],Long>> family : increment.getFamilyMap().entrySet()) {
    columnBuilder.setFamily(ByteString.copyFrom(family.getKey()));
    columnBuilder.clearQualifierValue();
    NavigableMap<byte[],Long> values=family.getValue();
    if (values != null && values.size() > 0) {
      for (      Map.Entry<byte[],Long> value : values.entrySet()) {
        valueBuilder.setQualifier(ByteString.copyFrom(value.getKey()));
        valueBuilder.setValue(ByteString.copyFrom(Bytes.toBytes(value.getValue().longValue())));
        columnBuilder.addQualifierValue(valueBuilder.build());
      }
    }
    builder.addColumnValue(columnBuilder.build());
  }
  return builder.build();
}
