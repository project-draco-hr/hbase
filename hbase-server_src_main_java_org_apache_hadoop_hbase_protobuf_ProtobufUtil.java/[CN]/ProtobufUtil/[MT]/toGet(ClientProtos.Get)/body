{
  if (proto == null)   return null;
  byte[] row=proto.getRow().toByteArray();
  RowLock rowLock=null;
  if (proto.hasLockId()) {
    rowLock=new RowLock(proto.getLockId());
  }
  Get get=new Get(row,rowLock);
  if (proto.hasCacheBlocks()) {
    get.setCacheBlocks(proto.getCacheBlocks());
  }
  if (proto.hasMaxVersions()) {
    get.setMaxVersions(proto.getMaxVersions());
  }
  if (proto.hasStoreLimit()) {
    get.setMaxResultsPerColumnFamily(proto.getStoreLimit());
  }
  if (proto.hasStoreOffset()) {
    get.setRowOffsetPerColumnFamily(proto.getStoreOffset());
  }
  if (proto.hasTimeRange()) {
    HBaseProtos.TimeRange timeRange=proto.getTimeRange();
    long minStamp=0;
    long maxStamp=Long.MAX_VALUE;
    if (timeRange.hasFrom()) {
      minStamp=timeRange.getFrom();
    }
    if (timeRange.hasTo()) {
      maxStamp=timeRange.getTo();
    }
    get.setTimeRange(minStamp,maxStamp);
  }
  if (proto.hasFilter()) {
    HBaseProtos.Filter filter=proto.getFilter();
    get.setFilter(ProtobufUtil.toFilter(filter));
  }
  for (  NameBytesPair attribute : proto.getAttributeList()) {
    get.setAttribute(attribute.getName(),attribute.getValue().toByteArray());
  }
  if (proto.getColumnCount() > 0) {
    for (    Column column : proto.getColumnList()) {
      byte[] family=column.getFamily().toByteArray();
      if (column.getQualifierCount() > 0) {
        for (        ByteString qualifier : column.getQualifierList()) {
          get.addColumn(family,qualifier.toByteArray());
        }
      }
 else {
        get.addFamily(family);
      }
    }
  }
  return get;
}
