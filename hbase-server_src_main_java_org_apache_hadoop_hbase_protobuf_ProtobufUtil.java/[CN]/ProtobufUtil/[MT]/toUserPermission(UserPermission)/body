{
  AccessControlProtos.Permission.Builder permissionBuilder=AccessControlProtos.Permission.newBuilder();
  for (  Permission.Action a : perm.getActions()) {
    permissionBuilder.addAction(toPermissionAction(a));
  }
  if (perm.hasTable()) {
    permissionBuilder.setTable(ByteString.copyFrom(perm.getTable()));
  }
  if (perm.hasFamily()) {
    permissionBuilder.setFamily(ByteString.copyFrom(perm.getFamily()));
  }
  if (perm.hasQualifier()) {
    permissionBuilder.setQualifier(ByteString.copyFrom(perm.getQualifier()));
  }
  return AccessControlProtos.UserPermission.newBuilder().setUser(ByteString.copyFrom(perm.getUser())).setPermission(permissionBuilder).build();
}
