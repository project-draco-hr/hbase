{
  HBaseFsck fsck=new HBaseFsck(conf,exec);
  fsck.connect();
  fsck.setDisplayFullReport();
  fsck.setTimeLag(0);
  fsck.setFixAssignments(fixAssignments);
  fsck.setFixMeta(fixMeta);
  fsck.setFixHdfsHoles(fixHdfsHoles);
  fsck.setFixHdfsOverlaps(fixHdfsOverlaps);
  fsck.setFixHdfsOrphans(fixHdfsOrphans);
  fsck.setFixTableOrphans(fixTableOrphans);
  fsck.setFixVersionFile(fixVersionFile);
  fsck.setFixReferenceFiles(fixReferenceFiles);
  if (table != null) {
    fsck.includeTable(table);
  }
  fsck.onlineHbck();
  return fsck;
}
