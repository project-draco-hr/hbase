{
  if (regionFinder != null) {
    List<ServerName> topLocalServers=regionFinder.getTopBlockLocations(regions[region]);
    int leastLoadedServerIndex=-1;
    int load=Integer.MAX_VALUE;
    for (    ServerName sn : topLocalServers) {
      if (!serversToIndex.containsKey(sn.getHostAndPort())) {
        continue;
      }
      int index=serversToIndex.get(sn.getHostAndPort());
      if (regionsPerServer[index] == null) {
        continue;
      }
      int tempLoad=regionsPerServer[index].length;
      if (tempLoad <= load) {
        leastLoadedServerIndex=index;
        load=tempLoad;
      }
    }
    return leastLoadedServerIndex;
  }
 else {
    return -1;
  }
}
