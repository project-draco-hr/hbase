{
switch (action.type) {
case NULL:
    break;
case ASSIGN_REGION:
  AssignRegionAction ar=(AssignRegionAction)action;
regionsPerServer[ar.server]=addRegion(regionsPerServer[ar.server],ar.region);
regionMoved(ar.region,-1,ar.server);
break;
case MOVE_REGION:
MoveRegionAction mra=(MoveRegionAction)action;
regionsPerServer[mra.fromServer]=removeRegion(regionsPerServer[mra.fromServer],mra.region);
regionsPerServer[mra.toServer]=addRegion(regionsPerServer[mra.toServer],mra.region);
regionMoved(mra.region,mra.fromServer,mra.toServer);
break;
case SWAP_REGIONS:
SwapRegionsAction a=(SwapRegionsAction)action;
regionsPerServer[a.fromServer]=replaceRegion(regionsPerServer[a.fromServer],a.fromRegion,a.toRegion);
regionsPerServer[a.toServer]=replaceRegion(regionsPerServer[a.toServer],a.toRegion,a.fromRegion);
regionMoved(a.fromRegion,a.fromServer,a.toServer);
regionMoved(a.toRegion,a.toServer,a.fromServer);
break;
default :
throw new RuntimeException("Uknown action:" + action.type);
}
}
