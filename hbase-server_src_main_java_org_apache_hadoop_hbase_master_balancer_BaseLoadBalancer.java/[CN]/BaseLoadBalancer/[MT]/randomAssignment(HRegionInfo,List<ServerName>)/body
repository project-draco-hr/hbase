{
  metricsBalancer.incrMiscInvocations();
  if (!excludedServers.isEmpty() && servers != null) {
    servers.removeAll(excludedServers);
  }
  if (servers == null || servers.isEmpty()) {
    LOG.warn("Wanted to do random assignment but no servers to assign to");
    return null;
  }
  int numServers=servers.size();
  if (numServers == 1)   return servers.get(0);
  if (shouldBeOnMaster(regionInfo) && servers.contains(masterServerName)) {
    return masterServerName;
  }
  int i=RANDOM.nextInt(numServers);
  ServerName sn=servers.get(i);
  if (sn.equals(masterServerName)) {
    i=(i == 0 ? 1 : i - 1);
    sn=servers.get(i);
  }
  return sn;
}
