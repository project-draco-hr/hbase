{
  super.setUp();
  localfs=(conf.get("fs.default.name","file:///").compareTo("file::///") == 0);
  try {
    this.fs=FileSystem.get(conf);
  }
 catch (  IOException e) {
    LOG.fatal("error getting file system",e);
    throw e;
  }
  try {
    if (localfs) {
      this.testDir=getUnitTestdir(getName());
      if (fs.exists(testDir)) {
        fs.delete(testDir);
      }
    }
 else {
      this.testDir=this.fs.makeQualified(new Path(conf.get(HConstants.HBASE_DIR)));
    }
  }
 catch (  Exception e) {
    LOG.fatal("error during setup",e);
    throw e;
  }
}
