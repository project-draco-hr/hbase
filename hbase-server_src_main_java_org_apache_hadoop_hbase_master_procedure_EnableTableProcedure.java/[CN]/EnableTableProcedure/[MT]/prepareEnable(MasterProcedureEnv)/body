{
  boolean canTableBeEnabled=true;
  if (!MetaTableAccessor.tableExists(env.getMasterServices().getConnection(),tableName)) {
    setFailure("master-enable-table",new TableNotFoundException(tableName));
    canTableBeEnabled=false;
  }
 else   if (!skipTableStateCheck) {
    TableStateManager tsm=env.getMasterServices().getAssignmentManager().getTableStateManager();
    if (!tsm.getTableState(tableName).equals(TableState.State.DISABLED)) {
      LOG.info("Table " + tableName + " isn't disabled; skipping enable");
      setFailure("master-enable-table",new TableNotDisabledException(this.tableName));
      canTableBeEnabled=false;
    }
  }
  ProcedurePrepareLatch.releaseLatch(syncLatch,this);
  return canTableBeEnabled;
}
