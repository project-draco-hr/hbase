{
  RegionCoprocessorEnvironment env=(RegionCoprocessorEnvironment)getEnvironment();
  SortedSet<byte[]> rowsToLock=new TreeSet<byte[]>(Bytes.BYTES_COMPARATOR);
  HRegionInfo regionInfo=env.getRegion().getRegionInfo();
  for (  Mutation m : mutations) {
    if (!HRegion.rowIsInRange(regionInfo,m.getRow())) {
      String msg="Requested row out of range '" + Bytes.toStringBinary(m.getRow()) + "'";
      if (rowsToLock.isEmpty()) {
        throw new WrongRegionException(msg);
      }
 else {
        throw new DoNotRetryIOException(msg);
      }
    }
    rowsToLock.add(m.getRow());
  }
  env.getRegion().mutateRowsWithLocks(mutations,rowsToLock);
}
