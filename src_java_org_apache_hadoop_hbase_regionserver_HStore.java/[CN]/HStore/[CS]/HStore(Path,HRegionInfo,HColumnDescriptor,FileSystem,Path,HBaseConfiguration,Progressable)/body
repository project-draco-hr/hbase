{
  this.basedir=basedir;
  this.info=info;
  this.family=family;
  this.fs=fs;
  this.conf=conf;
  this.ttl=family.getTimeToLive();
  if (ttl != HConstants.FOREVER) {
    this.ttl*=1000;
  }
  this.memcache=new Memcache(this.ttl,info);
  this.compactionDir=HRegion.getCompactionDir(basedir);
  this.storeName=Bytes.toBytes(this.info.getEncodedName() + "/" + Bytes.toString(this.family.getName()));
  this.storeNameStr=Bytes.toString(this.storeName);
  this.compactionThreshold=conf.getInt("hbase.hstore.compactionThreshold",3);
  long maxFileSize=info.getTableDesc().getMaxFileSize();
  if (maxFileSize == HConstants.DEFAULT_MAX_FILE_SIZE) {
    maxFileSize=conf.getLong("hbase.hregion.max.filesize",HConstants.DEFAULT_MAX_FILE_SIZE);
  }
  this.desiredMaxFileSize=maxFileSize;
  this.majorCompactionTime=conf.getLong(HConstants.MAJOR_COMPACTION_PERIOD,86400000);
  if (family.getValue(HConstants.MAJOR_COMPACTION_PERIOD) != null) {
    String strCompactionTime=family.getValue(HConstants.MAJOR_COMPACTION_PERIOD);
    this.majorCompactionTime=(new Long(strCompactionTime)).longValue();
  }
  this.maxFilesToCompact=conf.getInt("hbase.hstore.compaction.max",10);
  this.storeSize=0L;
  if (family.getCompression() == HColumnDescriptor.CompressionType.BLOCK) {
    this.compression=SequenceFile.CompressionType.BLOCK;
  }
 else   if (family.getCompression() == HColumnDescriptor.CompressionType.RECORD) {
    this.compression=SequenceFile.CompressionType.RECORD;
  }
 else {
    this.compression=SequenceFile.CompressionType.NONE;
  }
  Path mapdir=checkdir(HStoreFile.getMapDir(basedir,info.getEncodedName(),family.getName()));
  Path infodir=checkdir(HStoreFile.getInfoDir(basedir,info.getEncodedName(),family.getName()));
  this.maxSeqId=-1L;
  this.storefiles.putAll(loadHStoreFiles(infodir,mapdir));
  if (LOG.isDebugEnabled() && this.storefiles.size() > 0) {
    LOG.debug("Loaded " + this.storefiles.size() + " file(s) in hstore "+ Bytes.toString(this.storeName)+ ", max sequence id "+ this.maxSeqId);
  }
  runReconstructionLog(reconstructionLog,this.maxSeqId,reporter);
  setupReaders();
}
