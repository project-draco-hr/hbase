{
  boolean result=false;
  Path mapdir=HStoreFile.getMapDir(this.basedir,this.info.getEncodedName(),this.family.getName());
  long lowTimestamp=getLowestTimestamp(fs,mapdir);
  if (lowTimestamp < (System.currentTimeMillis() - this.majorCompactionTime) && lowTimestamp > 0l) {
    long elapsedTime=System.currentTimeMillis() - lowTimestamp;
    if (filesToCompact != null && filesToCompact.size() == 1 && filesToCompact.get(0).isMajorCompaction() && (this.ttl == HConstants.FOREVER || elapsedTime < this.ttl)) {
      if (LOG.isDebugEnabled()) {
        LOG.debug("Skipping major compaction because only one (major) " + "compacted file only and elapsedTime " + elapsedTime + " is < ttl="+ this.ttl);
      }
    }
 else {
      if (LOG.isDebugEnabled()) {
        LOG.debug("Major compaction triggered on store: " + this.storeNameStr + ". Time since last major compaction: "+ ((System.currentTimeMillis() - lowTimestamp) / 1000)+ " seconds");
      }
      result=true;
    }
  }
  return result;
}
