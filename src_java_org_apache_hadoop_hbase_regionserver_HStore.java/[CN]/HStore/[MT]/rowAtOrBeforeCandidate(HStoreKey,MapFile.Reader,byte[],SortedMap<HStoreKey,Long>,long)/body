{
  HStoreKey finalKey=getFinalKey(map);
  HStoreKey searchKey=null;
  if (Bytes.compareTo(finalKey.getRow(),row) < 0) {
    searchKey=finalKey;
  }
 else {
    searchKey=new HStoreKey(row);
    if (searchKey.compareTo(startKey) < 0) {
      searchKey=startKey;
    }
  }
  rowAtOrBeforeCandidate(map,searchKey,candidateKeys,now);
}
