{
  HStoreKey startKey=new HStoreKey();
  ImmutableBytesWritable startValue=new ImmutableBytesWritable();
synchronized (map) {
    map.reset();
    if (!map.next(startKey,startValue)) {
      return;
    }
    startKey.setHRegionInfo(this.info);
    if (HStoreKey.compareTwoRowKeys(this.info,startKey.getRow(),row) > 0) {
      return;
    }
    long now=System.currentTimeMillis();
    if (candidateKeys.isEmpty()) {
      rowAtOrBeforeCandidate(startKey,map,row,candidateKeys,deletes,now);
    }
 else {
      rowAtOrBeforeWithCandidates(startKey,map,row,candidateKeys,deletes,now);
    }
  }
}
