{
  Path filterFile=new Path(filterDir,BLOOMFILTER_FILE_NAME);
  Filter bloomFilter=null;
  if (fs.exists(filterFile)) {
    if (LOG.isDebugEnabled()) {
      LOG.debug("loading bloom filter for " + this.storeNameStr);
    }
    BloomFilterDescriptor.BloomFilterType type=family.getBloomFilter().getType();
switch (type) {
case BLOOMFILTER:
      bloomFilter=new BloomFilter();
    break;
case COUNTING_BLOOMFILTER:
  bloomFilter=new CountingBloomFilter();
break;
case RETOUCHED_BLOOMFILTER:
bloomFilter=new RetouchedBloomFilter();
break;
default :
throw new IllegalArgumentException("unknown bloom filter type: " + type);
}
FSDataInputStream in=fs.open(filterFile);
try {
bloomFilter.readFields(in);
}
  finally {
fs.close();
}
}
 else {
if (LOG.isDebugEnabled()) {
LOG.debug("creating bloom filter for " + this.storeNameStr);
}
BloomFilterDescriptor.BloomFilterType type=family.getBloomFilter().getType();
switch (type) {
case BLOOMFILTER:
bloomFilter=new BloomFilter(family.getBloomFilter().getVectorSize(),family.getBloomFilter().getNbHash());
break;
case COUNTING_BLOOMFILTER:
bloomFilter=new CountingBloomFilter(family.getBloomFilter().getVectorSize(),family.getBloomFilter().getNbHash());
break;
case RETOUCHED_BLOOMFILTER:
bloomFilter=new RetouchedBloomFilter(family.getBloomFilter().getVectorSize(),family.getBloomFilter().getNbHash());
}
}
return bloomFilter;
}
