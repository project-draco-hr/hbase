{
  if (event.getType().equals(EventType.NodeDeleted)) {
    LOG.info(server + " znode expired");
    serverAddressToServerInfo.remove(serverAddress);
    HServerInfo info=serversToServerInfo.remove(server);
    if (info != null) {
      String serverName=HServerInfo.getServerName(info);
      HServerLoad load=serversToLoad.remove(serverName);
      if (load != null) {
synchronized (loadToServers) {
          Set<String> servers=loadToServers.get(load);
          if (servers != null) {
            servers.remove(serverName);
            if (servers.size() > 0)             loadToServers.put(load,servers);
 else             loadToServers.remove(load);
          }
        }
      }
      deadServers.add(server);
      master.queue(new ProcessServerShutdown(master,info));
    }
synchronized (serversToServerInfo) {
      serversToServerInfo.notifyAll();
    }
  }
}
