{
  int cnt=0;
  MemStoreCompactorIterator iterator=new MemStoreCompactorIterator(versionedList.getStoreSegments(),compactingMemStore.getComparator(),compactionKVMax,compactingMemStore.getStore());
  try {
    while (iterator.next() != null) {
      cnt++;
    }
  }
  finally {
    iterator.close();
  }
  return cnt;
}
