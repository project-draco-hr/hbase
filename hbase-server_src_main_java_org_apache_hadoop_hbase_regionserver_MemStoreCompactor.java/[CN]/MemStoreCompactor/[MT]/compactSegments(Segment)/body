{
  List<Cell> kvs=new ArrayList<Cell>();
  int compactionKVMax=compactingMemStore.getConfiguration().getInt(HConstants.COMPACTION_KV_MAX,HConstants.COMPACTION_KV_MAX_DEFAULT);
  ScannerContext scannerContext=ScannerContext.newBuilder().setBatchLimit(compactionKVMax).build();
  boolean hasMore;
  do {
    hasMore=compactingScanner.next(kvs,scannerContext);
    if (!kvs.isEmpty()) {
      for (      Cell c : kvs) {
        Cell newKV=result.maybeCloneWithAllocator(c);
        result.internalAdd(newKV);
      }
      kvs.clear();
    }
  }
 while (hasMore && (!isInterrupted.get()));
}
