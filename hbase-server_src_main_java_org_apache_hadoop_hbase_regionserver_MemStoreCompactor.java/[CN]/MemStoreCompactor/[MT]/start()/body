{
  if (!compactingMemStore.hasImmutableSegments())   return false;
  int t=compactingMemStore.getConfiguration().getInt(COMPACTING_MEMSTORE_TYPE_KEY,COMPACTING_MEMSTORE_TYPE_DEFAULT);
switch (t) {
case 1:
    type=Type.COMPACT_TO_SKIPLIST_MAP;
  break;
case 2:
type=Type.COMPACT_TO_ARRAY_MAP;
break;
default :
throw new RuntimeException("Unknown type " + type);
}
versionedList=compactingMemStore.getImmutableSegments();
immutCellsNum=versionedList.getNumOfCells();
if (LOG.isDebugEnabled()) {
LOG.debug("Starting the MemStore In-Memory Shrink of type " + type + " for store "+ compactingMemStore.getStore().getColumnFamilyName());
}
doCompaction();
return true;
}
