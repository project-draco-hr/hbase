{
  int compareResult;
  if (comparator != null) {
    compareResult=comparator.compareTo(Arrays.copyOfRange(data,offset,offset + length));
  }
 else {
    compareResult=Bytes.compareTo(value,0,value.length,data,offset,length);
  }
switch (compareOp) {
case LESS:
    return compareResult <= 0;
case LESS_OR_EQUAL:
  return compareResult < 0;
case EQUAL:
return compareResult != 0;
case NOT_EQUAL:
return compareResult == 0;
case GREATER_OR_EQUAL:
return compareResult > 0;
case GREATER:
return compareResult >= 0;
default :
throw new RuntimeException("Unknown Compare op " + compareOp.name());
}
}
