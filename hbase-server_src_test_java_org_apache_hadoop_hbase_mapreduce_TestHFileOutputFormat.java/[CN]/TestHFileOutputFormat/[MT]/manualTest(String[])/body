{
  Configuration conf=HBaseConfiguration.create();
  util=new HBaseTestingUtility(conf);
  if ("newtable".equals(args[0])) {
    TableName tname=TableName.valueOf(args[1]);
    byte[][] splitKeys=generateRandomSplitKeys(4);
    Table table=util.createTable(tname,FAMILIES,splitKeys);
  }
 else   if ("incremental".equals(args[0])) {
    TableName tname=TableName.valueOf(args[1]);
    Table table=util.getConnection().getTable(tname);
    Path outDir=new Path("incremental-out");
    try (RegionLocator locator=util.getConnection().getRegionLocator(tname)){
      runIncrementalPELoad(conf,table,locator,outDir);
    }
   }
 else {
    throw new RuntimeException("usage: TestHFileOutputFormat newtable | incremental");
  }
}
