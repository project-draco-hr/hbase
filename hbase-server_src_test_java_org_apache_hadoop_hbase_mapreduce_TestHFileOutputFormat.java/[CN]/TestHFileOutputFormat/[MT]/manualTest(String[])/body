{
  Configuration conf=HBaseConfiguration.create();
  util=new HBaseTestingUtility(conf);
  if ("newtable".equals(args[0])) {
    TableName tname=TableName.valueOf(args[1]);
    byte[][] splitKeys=generateRandomSplitKeys(4);
    HTable table=util.createTable(tname,FAMILIES,splitKeys);
  }
 else   if ("incremental".equals(args[0])) {
    TableName tname=TableName.valueOf(args[1]);
    HTable table=(HTable)util.getConnection().getTable(tname);
    Path outDir=new Path("incremental-out");
    runIncrementalPELoad(conf,table,outDir);
  }
 else {
    throw new RuntimeException("usage: TestHFileOutputFormat newtable | incremental");
  }
}
