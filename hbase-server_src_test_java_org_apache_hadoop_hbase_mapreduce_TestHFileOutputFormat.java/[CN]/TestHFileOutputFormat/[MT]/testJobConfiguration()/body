{
  Configuration conf=new Configuration(this.util.getConfiguration());
  conf.set("hbase.fs.tmp.dir",util.getDataTestDir("testJobConfiguration").toString());
  Job job=new Job(conf);
  job.setWorkingDirectory(util.getDataTestDir("testJobConfiguration"));
  HTableDescriptor tableDescriptor=Mockito.mock(HTableDescriptor.class);
  RegionLocator regionLocator=Mockito.mock(RegionLocator.class);
  setupMockStartKeys(regionLocator);
  setupMockTableName(regionLocator);
  HFileOutputFormat2.configureIncrementalLoad(job,tableDescriptor,regionLocator);
  assertEquals(job.getNumReduceTasks(),4);
}
