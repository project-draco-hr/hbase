{
  String fullpath=ZKUtil.joinZNode(this.queuesZNode,regionserverZnode);
  try {
    List<String> clusters=ZKUtil.listChildrenNoWatch(this.zookeeper,fullpath);
    for (    String cluster : clusters) {
      if (cluster.equals(RS_LOCK_ZNODE)) {
        continue;
      }
      String fullClusterPath=ZKUtil.joinZNode(fullpath,cluster);
      ZKUtil.deleteNodeRecursively(this.zookeeper,fullClusterPath);
    }
    ZKUtil.deleteNodeRecursively(this.zookeeper,fullpath);
  }
 catch (  KeeperException e) {
    if (e instanceof KeeperException.NoNodeException || e instanceof KeeperException.NotEmptyException) {
      if (e.getPath().equals(fullpath)) {
        return;
      }
    }
    this.abortable.abort("Failed to delete replication queues for region server: " + regionserverZnode,e);
  }
}
