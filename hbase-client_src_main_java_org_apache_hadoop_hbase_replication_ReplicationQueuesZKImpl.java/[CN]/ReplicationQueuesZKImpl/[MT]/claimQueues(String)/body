{
  SortedMap<String,SortedSet<String>> newQueues=new TreeMap<String,SortedSet<String>>();
  if (ZKUtil.joinZNode(this.queuesZNode,regionserverZnode).equals(this.myQueuesZnode)) {
    LOG.warn("An attempt was made to claim our own queues on region server " + regionserverZnode);
    return newQueues;
  }
  if (conf.getBoolean(HConstants.ZOOKEEPER_USEMULTI,true)) {
    LOG.info("Atomically moving " + regionserverZnode + "'s hlogs to my queue");
    newQueues=copyQueuesFromRSUsingMulti(regionserverZnode);
  }
 else {
    LOG.info("Moving " + regionserverZnode + "'s hlogs to my queue");
    if (!lockOtherRS(regionserverZnode)) {
      return newQueues;
    }
    newQueues=copyQueuesFromRS(regionserverZnode);
    deleteAnotherRSQueues(regionserverZnode);
  }
  return newQueues;
}
