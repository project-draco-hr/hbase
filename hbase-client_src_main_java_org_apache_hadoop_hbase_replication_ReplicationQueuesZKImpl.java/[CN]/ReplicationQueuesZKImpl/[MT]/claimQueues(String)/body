{
  SortedMap<String,SortedSet<String>> newQueues=new TreeMap<String,SortedSet<String>>();
  if (conf.getBoolean(HConstants.ZOOKEEPER_USEMULTI,true)) {
    LOG.info("Atomically moving " + regionserverZnode + "'s hlogs to my queue");
    newQueues=copyQueuesFromRSUsingMulti(regionserverZnode);
  }
 else {
    LOG.info("Moving " + regionserverZnode + "'s hlogs to my queue");
    if (!lockOtherRS(regionserverZnode)) {
      return newQueues;
    }
    newQueues=copyQueuesFromRS(regionserverZnode);
    deleteAnotherRSQueues(regionserverZnode);
  }
  return newQueues;
}
