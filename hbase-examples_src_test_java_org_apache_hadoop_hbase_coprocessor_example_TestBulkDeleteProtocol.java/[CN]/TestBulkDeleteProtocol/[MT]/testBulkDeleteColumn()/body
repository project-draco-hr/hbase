{
  byte[] tableName=Bytes.toBytes("testBulkDeleteColumn");
  Table ht=createTable(tableName);
  List<Put> puts=new ArrayList<Put>(100);
  for (int j=0; j < 100; j++) {
    byte[] rowkey=Bytes.toBytes(j);
    String value=(j % 10 == 0) ? "v1" : "v2";
    puts.add(createPut(rowkey,value));
  }
  ht.put(puts);
  Scan scan=new Scan();
  scan.addColumn(FAMILY1,QUALIFIER2);
  long noOfRowsDeleted=invokeBulkDeleteProtocol(tableName,scan,500,DeleteType.COLUMN,null);
  assertEquals(100,noOfRowsDeleted);
  int rows=0;
  for (  Result result : ht.getScanner(new Scan())) {
    assertEquals(2,result.getFamilyMap(FAMILY1).size());
    assertTrue(result.getColumnCells(FAMILY1,QUALIFIER2).isEmpty());
    assertEquals(1,result.getColumnCells(FAMILY1,QUALIFIER1).size());
    assertEquals(1,result.getColumnCells(FAMILY1,QUALIFIER3).size());
    rows++;
  }
  assertEquals(100,rows);
  ht.close();
}
