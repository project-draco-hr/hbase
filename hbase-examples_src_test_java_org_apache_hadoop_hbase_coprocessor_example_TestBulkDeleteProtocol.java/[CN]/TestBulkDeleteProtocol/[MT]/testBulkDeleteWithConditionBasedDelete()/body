{
  byte[] tableName=Bytes.toBytes("testBulkDeleteWithConditionBasedDelete");
  Table ht=createTable(tableName);
  List<Put> puts=new ArrayList<Put>(100);
  for (int j=0; j < 100; j++) {
    byte[] rowkey=Bytes.toBytes(j);
    String value=(j % 10 == 0) ? "v1" : "v2";
    puts.add(createPut(rowkey,value));
  }
  ht.put(puts);
  Scan scan=new Scan();
  FilterList fl=new FilterList(Operator.MUST_PASS_ALL);
  SingleColumnValueFilter scvf=new SingleColumnValueFilter(FAMILY1,QUALIFIER3,CompareOp.EQUAL,Bytes.toBytes("v1"));
  fl.addFilter(scvf);
  scan.setFilter(fl);
  long noOfRowsDeleted=invokeBulkDeleteProtocol(tableName,scan,500,DeleteType.ROW,null);
  assertEquals(10,noOfRowsDeleted);
  int rows=0;
  for (  Result result : ht.getScanner(new Scan())) {
    rows++;
  }
  assertEquals(90,rows);
  ht.close();
}
