{
  byte[] tableName=Bytes.toBytes("testBulkDeleteEndpoint");
  HTable ht=createTable(tableName);
  List<Put> puts=new ArrayList<Put>(100);
  for (int j=0; j < 100; j++) {
    byte[] rowkey=Bytes.toBytes(j);
    puts.add(createPut(rowkey,"v1"));
  }
  ht.put(puts);
  long noOfRowsDeleted=invokeBulkDeleteProtocol(tableName,new Scan(),5,DeleteType.ROW,null);
  assertEquals(100,noOfRowsDeleted);
  int rows=0;
  for (  Result result : ht.getScanner(new Scan())) {
    rows++;
  }
  assertEquals(0,rows);
  ht.close();
}
