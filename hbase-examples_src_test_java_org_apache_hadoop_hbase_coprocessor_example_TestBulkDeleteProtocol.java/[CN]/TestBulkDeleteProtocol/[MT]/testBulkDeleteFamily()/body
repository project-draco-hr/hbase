{
  TableName tableName=TableName.valueOf("testBulkDeleteFamily");
  HTableDescriptor htd=new HTableDescriptor(tableName);
  htd.addFamily(new HColumnDescriptor(FAMILY1));
  htd.addFamily(new HColumnDescriptor(FAMILY2));
  TEST_UTIL.getHBaseAdmin().createTable(htd,Bytes.toBytes(0),Bytes.toBytes(120),5);
  Table ht=TEST_UTIL.getConnection().getTable(tableName);
  List<Put> puts=new ArrayList<Put>(100);
  for (int j=0; j < 100; j++) {
    Put put=new Put(Bytes.toBytes(j));
    put.add(FAMILY1,QUALIFIER1,"v1".getBytes());
    put.add(FAMILY2,QUALIFIER2,"v2".getBytes());
    puts.add(put);
  }
  ht.put(puts);
  Scan scan=new Scan();
  scan.addFamily(FAMILY1);
  long noOfRowsDeleted=invokeBulkDeleteProtocol(tableName,scan,500,DeleteType.FAMILY,null);
  assertEquals(100,noOfRowsDeleted);
  int rows=0;
  for (  Result result : ht.getScanner(new Scan())) {
    assertTrue(result.getFamilyMap(FAMILY1).isEmpty());
    assertEquals(1,result.getColumnCells(FAMILY2,QUALIFIER2).size());
    rows++;
  }
  assertEquals(100,rows);
  ht.close();
}
