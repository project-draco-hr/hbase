{
  Scan scan=new Scan();
  if (startrow != null)   scan.setStartRow(startrow);
  if (startrow == null) {
    int caching=connection.getConfiguration().getInt(HConstants.HBASE_META_SCANNER_CACHING,100);
    scan.setCaching(caching);
  }
  scan.addFamily(HConstants.CATALOG_FAMILY);
  Table metaTable=getMetaHTable(connection);
  ResultScanner scanner=null;
  try {
    scanner=metaTable.getScanner(scan);
    Result data;
    while ((data=scanner.next()) != null) {
      if (data.isEmpty())       continue;
      if (!visitor.visit(data))       break;
    }
  }
  finally {
    if (scanner != null)     scanner.close();
    metaTable.close();
  }
}
