{
  if (connection == null || connection.isClosed()) {
    throw new NullPointerException("No connection");
  }
  if (connection instanceof ClusterConnection) {
    if (((ClusterConnection)connection).isManaged()) {
      return new HTable(TableName.META_TABLE_NAME,connection);
    }
  }
  return connection.getTable(TableName.META_TABLE_NAME);
}
