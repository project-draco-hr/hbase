{
  KeyValue kv=new KeyValue(ROW,COLUMN_FAMILY,COLUMN_QUALIFIER,VAL_2);
  assertTrue("basicFilter1",filter.filterKeyValue(kv) == Filter.ReturnCode.INCLUDE);
  byte[] buffer=kv.getBuffer();
  Cell c=new ByteBufferedCellImpl(ByteBuffer.wrap(buffer),0,buffer.length);
  assertTrue("basicFilter1",filter.filterKeyValue(c) == Filter.ReturnCode.INCLUDE);
  kv=new KeyValue(ROW,COLUMN_FAMILY,COLUMN_QUALIFIER,VAL_3);
  assertTrue("basicFilter2",filter.filterKeyValue(kv) == Filter.ReturnCode.INCLUDE);
  buffer=kv.getBuffer();
  c=new ByteBufferedCellImpl(ByteBuffer.wrap(buffer),0,buffer.length);
  assertTrue("basicFilter2",filter.filterKeyValue(c) == Filter.ReturnCode.INCLUDE);
  kv=new KeyValue(ROW,COLUMN_FAMILY,COLUMN_QUALIFIER,VAL_4);
  assertTrue("basicFilter3",filter.filterKeyValue(kv) == Filter.ReturnCode.INCLUDE);
  buffer=kv.getBuffer();
  c=new ByteBufferedCellImpl(ByteBuffer.wrap(buffer),0,buffer.length);
  assertTrue("basicFilter3",filter.filterKeyValue(c) == Filter.ReturnCode.INCLUDE);
  assertFalse("basicFilterNotNull",filter.filterRow());
  filter.reset();
  kv=new KeyValue(ROW,COLUMN_FAMILY,COLUMN_QUALIFIER,VAL_1);
  assertTrue("basicFilter4",filter.filterKeyValue(kv) == Filter.ReturnCode.NEXT_ROW);
  buffer=kv.getBuffer();
  c=new ByteBufferedCellImpl(ByteBuffer.wrap(buffer),0,buffer.length);
  assertTrue("basicFilter4",filter.filterKeyValue(c) == Filter.ReturnCode.NEXT_ROW);
  kv=new KeyValue(ROW,COLUMN_FAMILY,COLUMN_QUALIFIER,VAL_2);
  assertTrue("basicFilter4",filter.filterKeyValue(kv) == Filter.ReturnCode.NEXT_ROW);
  buffer=kv.getBuffer();
  c=new ByteBufferedCellImpl(ByteBuffer.wrap(buffer),0,buffer.length);
  assertTrue("basicFilter4",filter.filterKeyValue(c) == Filter.ReturnCode.NEXT_ROW);
  assertFalse("basicFilterAllRemaining",filter.filterAllRemaining());
  assertTrue("basicFilterNotNull",filter.filterRow());
  filter.reset();
  filter.setLatestVersionOnly(false);
  kv=new KeyValue(ROW,COLUMN_FAMILY,COLUMN_QUALIFIER,VAL_1);
  assertTrue("basicFilter5",filter.filterKeyValue(kv) == Filter.ReturnCode.INCLUDE);
  buffer=kv.getBuffer();
  c=new ByteBufferedCellImpl(ByteBuffer.wrap(buffer),0,buffer.length);
  assertTrue("basicFilter5",filter.filterKeyValue(c) == Filter.ReturnCode.INCLUDE);
  kv=new KeyValue(ROW,COLUMN_FAMILY,COLUMN_QUALIFIER,VAL_2);
  assertTrue("basicFilter5",filter.filterKeyValue(kv) == Filter.ReturnCode.INCLUDE);
  buffer=kv.getBuffer();
  c=new ByteBufferedCellImpl(ByteBuffer.wrap(buffer),0,buffer.length);
  assertTrue("basicFilter5",filter.filterKeyValue(c) == Filter.ReturnCode.INCLUDE);
  assertFalse("basicFilterNotNull",filter.filterRow());
}
