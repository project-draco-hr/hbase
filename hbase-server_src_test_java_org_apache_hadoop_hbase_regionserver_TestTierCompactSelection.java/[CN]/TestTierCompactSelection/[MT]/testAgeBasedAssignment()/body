{
  conf.setLong(strPrefix + strSchema + "Tier.0.MaxAgeInDisk",10L);
  conf.setLong(strPrefix + strSchema + "Tier.1.MaxAgeInDisk",100L);
  conf.setLong(strPrefix + strSchema + "Tier.2.MaxAgeInDisk",1000L);
  conf.setLong(strPrefix + strSchema + "Tier.0.MaxSize",Long.MAX_VALUE);
  conf.setLong(strPrefix + strSchema + "Tier.1.MaxSize",Long.MAX_VALUE);
  conf.setLong(strPrefix + strSchema + "Tier.2.MaxSize",Long.MAX_VALUE);
  compactEquals(sfCreate(toArrayList(151,30,13,12,11),toArrayList(8,5,4,2,1)));
  compactEquals(sfCreate(toArrayList(12,11,8,3,1),toArrayList(8,5,4,2,1)),8,3,1);
  compactEquals(sfCreate(toArrayList(251,70,13,12,11),toArrayList(80,50,40,20,11)),70,13,12,11);
  compactEquals(sfCreate(toArrayList(251,70,13,12,11),toArrayList(800,500,400,200,110)),13,12,11);
  compactEquals(sfCreate(toArrayList(251,70,13,12,11),toArrayList(8000,5000,4000,2000,1100)));
  compactEquals(sfCreate(toArrayList(500,93,92,91,90,89,88,87,86,85,84,83,82,81,80),toArrayList(5094,5093,5092,5091,5090,5089,5088,5087,5086,5085,5084,5083,5082,5081,5080)),93,92,91,90,89);
  compactEquals(sfCreate(toArrayList(999,110,100,12,11),toArrayList(90,80,50,4,1)),110,100);
  compactEquals(sfCreate(toArrayList(999,110,100,12,11),toArrayList(900,800,500,40,1)),110,100,12);
  compactEquals(sfCreate(toArrayList(999,110,100,12,13,11),toArrayList(900,800,500,40,30,1)),12,13);
  conf.setBoolean(strPrefix + strSchema + "IsRecentFirstOrder",false);
  compactEquals(sfCreate(toArrayList(999,110,100,12,13,11),toArrayList(900,800,500,40,30,1)),110,100,12,13);
  compactEquals(sfCreate(toArrayList(999,800,110,100,12,13,11),toArrayList(9000,800,50,40,8,3,1)),110,100);
  compactEquals(sfCreate(toArrayList(999,800,110,100,12,13,11),toArrayList(0,0,0,40,8,3,1)),999,800,110,100);
  compactEquals(sfCreate(toArrayList(1002,1001,999,800,700,12,13,11),toArrayList(900,80,50,40,30,20,4,2)),999,800,700,12);
}
