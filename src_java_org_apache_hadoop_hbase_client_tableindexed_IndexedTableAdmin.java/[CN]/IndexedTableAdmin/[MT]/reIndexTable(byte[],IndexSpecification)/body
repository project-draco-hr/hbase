{
  HTable baseTable=new HTable(baseTableName);
  HTable indexTable=new HTable(indexSpec.getIndexedTableName(baseTableName));
  for (  RowResult rowResult : baseTable.getScanner(indexSpec.getAllColumns())) {
    SortedMap<byte[],byte[]> columnValues=new TreeMap<byte[],byte[]>(Bytes.BYTES_COMPARATOR);
    for (    Entry<byte[],Cell> entry : rowResult.entrySet()) {
      columnValues.put(entry.getKey(),entry.getValue().getValue());
    }
    if (IndexMaintenanceUtils.doesApplyToIndex(indexSpec,columnValues)) {
      BatchUpdate indexUpdate=IndexMaintenanceUtils.createIndexUpdate(indexSpec,rowResult.getRow(),columnValues);
      indexTable.commit(indexUpdate);
    }
  }
}
