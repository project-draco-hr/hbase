{
  ArrayList<StoreFile> results=new ArrayList<StoreFile>();
  FileStatus files[]=FSUtils.listStatus(this.fs,this.homedir,null);
  for (int i=0; files != null && i < files.length; i++) {
    if (files[i].isDir()) {
      continue;
    }
    Path p=files[i].getPath();
    if (this.fs.getFileStatus(p).getLen() <= 0) {
      LOG.warn("Skipping " + p + " because its empty. HBASE-646 DATA LOSS?");
      continue;
    }
    StoreFile curfile=new StoreFile(fs,p,this.conf,this.cacheConf,this.family.getBloomFilterType());
    passSchemaMetricsTo(curfile);
    curfile.createReader();
    long length=curfile.getReader().length();
    this.storeSize+=length;
    this.totalUncompressedBytes+=curfile.getReader().getTotalUncompressedBytes();
    if (LOG.isDebugEnabled()) {
      LOG.debug("loaded " + curfile.toStringDetailed());
    }
    results.add(curfile);
  }
  return results;
}
