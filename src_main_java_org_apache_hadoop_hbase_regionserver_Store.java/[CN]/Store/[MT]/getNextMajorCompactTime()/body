{
  long ret=conf.getLong(HConstants.MAJOR_COMPACTION_PERIOD,1000 * 60 * 60* 24);
  if (family.getValue(HConstants.MAJOR_COMPACTION_PERIOD) != null) {
    String strCompactionTime=family.getValue(HConstants.MAJOR_COMPACTION_PERIOD);
    ret=(new Long(strCompactionTime)).longValue();
  }
  if (ret > 0) {
    long jitter=conf.getLong("hbase.hregion.majorcompaction.jitter",1000 * 60 * 60* 4);
    if (jitter > 0) {
      ret+=jitter - Math.round(jitter * 2 * Math.random());
    }
  }
  return ret;
}
