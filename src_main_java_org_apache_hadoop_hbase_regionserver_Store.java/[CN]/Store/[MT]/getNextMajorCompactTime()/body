{
  long ret=conf.getLong(HConstants.MAJOR_COMPACTION_PERIOD,1000 * 60 * 60* 24);
  if (family.getValue(HConstants.MAJOR_COMPACTION_PERIOD) != null) {
    String strCompactionTime=family.getValue(HConstants.MAJOR_COMPACTION_PERIOD);
    ret=(new Long(strCompactionTime)).longValue();
  }
  if (ret > 0) {
    double jitterPct=conf.getFloat("hbase.hregion.majorcompaction.jitter",0.20F);
    if (jitterPct > 0) {
      long jitter=Math.round(ret * jitterPct);
      ret+=jitter - Math.round(2L * jitter * Math.random());
    }
  }
  return ret;
}
