{
  GetClosestRowBeforeTracker state=new GetClosestRowBeforeTracker(this.comparator,kv,this.ttl,this.region.getRegionInfo().isMetaRegion());
  this.lock.readLock().lock();
  try {
    this.memstore.getRowKeyAtOrBefore(state);
    for (    StoreFile sf : Iterables.reverse(storefiles)) {
      rowAtOrBeforeFromStoreFile(sf,state);
    }
    return state.getCandidate();
  }
  finally {
    this.lock.readLock().unlock();
  }
}
