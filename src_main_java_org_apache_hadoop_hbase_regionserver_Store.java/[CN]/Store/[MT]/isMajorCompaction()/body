{
  for (  StoreFile sf : this.storefiles) {
    if (sf.getReader() == null) {
      LOG.debug("StoreFile " + sf + " has null Reader");
      return false;
    }
  }
  List<StoreFile> candidates=new ArrayList<StoreFile>(this.storefiles);
  int pos=0;
  while (pos < candidates.size() && candidates.get(pos).getReader().length() > this.maxCompactSize && !candidates.get(pos).isReference())   ++pos;
  candidates.subList(0,pos).clear();
  return isMajorCompaction(candidates);
}
