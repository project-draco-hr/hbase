{
  long ttlToUse=this.minVersions > 0 ? Long.MAX_VALUE : this.ttl;
  KeyValue kv=new KeyValue(row,HConstants.LATEST_TIMESTAMP);
  GetClosestRowBeforeTracker state=new GetClosestRowBeforeTracker(this.comparator,kv,ttlToUse,this.region.getRegionInfo().isMetaRegion());
  this.lock.readLock().lock();
  try {
    this.memstore.getRowKeyAtOrBefore(state);
    for (    StoreFile sf : Iterables.reverse(storefiles)) {
      rowAtOrBeforeFromStoreFile(sf,state);
    }
    return state.getCandidate();
  }
  finally {
    this.lock.readLock().unlock();
  }
}
