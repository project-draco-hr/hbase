{
  HFile.Reader reader=null;
  try {
    LOG.info("Validating hfile at " + srcPath + " for inclusion in "+ "store "+ this+ " region "+ this.region);
    reader=HFile.createReader(srcPath.getFileSystem(conf),srcPath,cacheConf);
    reader.loadFileInfo();
    byte[] firstKey=reader.getFirstRowKey();
    byte[] lk=reader.getLastKey();
    byte[] lastKey=(lk == null) ? null : KeyValue.createKeyValueFromKey(lk).getRow();
    LOG.debug("HFile bounds: first=" + Bytes.toStringBinary(firstKey) + " last="+ Bytes.toStringBinary(lastKey));
    LOG.debug("Region bounds: first=" + Bytes.toStringBinary(region.getStartKey()) + " last="+ Bytes.toStringBinary(region.getEndKey()));
    HRegionInfo hri=region.getRegionInfo();
    if (!hri.containsRange(firstKey,lastKey)) {
      throw new WrongRegionException("Bulk load file " + srcPath.toString() + " does not fit inside region "+ this.region);
    }
  }
  finally {
    if (reader != null)     reader.close();
  }
}
