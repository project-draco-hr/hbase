{
  Path srcPath=new Path(srcPathStr);
  FileSystem srcFs=srcPath.getFileSystem(conf);
  if (!srcFs.equals(fs)) {
    LOG.info("File " + srcPath + " on different filesystem than "+ "destination store - moving to this filesystem.");
    Path tmpPath=getTmpPath();
    FileUtil.copy(srcFs,srcPath,fs,tmpPath,false,conf);
    LOG.info("Copied to temporary path on dst filesystem: " + tmpPath);
    srcPath=tmpPath;
  }
  Path dstPath=StoreFile.getRandomFilename(fs,homedir);
  LOG.debug("Renaming bulk load file " + srcPath + " to "+ dstPath);
  StoreFile.rename(fs,srcPath,dstPath);
  StoreFile sf=new StoreFile(fs,dstPath,this.conf,this.cacheConf,this.family.getBloomFilterType());
  sf.createReader();
  LOG.info("Moved hfile " + srcPath + " into store directory "+ homedir+ " - updating store file list.");
  this.lock.writeLock().lock();
  try {
    ArrayList<StoreFile> newFiles=new ArrayList<StoreFile>(storefiles);
    newFiles.add(sf);
    this.storefiles=sortAndClone(newFiles);
  }
  finally {
    this.lock.writeLock().unlock();
  }
  notifyChangedReadersObservers();
  LOG.info("Successfully loaded store file " + srcPath + " into store "+ this+ " (new location: "+ dstPath+ ")");
}
