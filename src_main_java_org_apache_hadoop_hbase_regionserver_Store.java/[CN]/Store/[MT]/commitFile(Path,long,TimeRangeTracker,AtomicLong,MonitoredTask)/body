{
  String fileName=path.getName();
  Path dstPath=new Path(homedir,fileName);
  validateStoreFile(path);
  String msg="Renaming flushed file at " + path + " to "+ dstPath;
  LOG.debug(msg);
  status.setStatus("Flushing " + this + ": "+ msg);
  if (!fs.rename(path,dstPath)) {
    LOG.warn("Unable to rename " + path + " to "+ dstPath);
  }
  status.setStatus("Flushing " + this + ": reopening flushed file");
  StoreFile sf=new StoreFile(this.fs,dstPath,this.conf,this.cacheConf,this.family.getBloomFilterType());
  StoreFile.Reader r=sf.createReader();
  this.storeSize+=r.length();
  this.totalUncompressedBytes+=r.getTotalUncompressedBytes();
  HRegion.incrNumericPersistentMetric("cf." + this.toString() + ".flushSize",flushedSize.longValue());
  if (LOG.isInfoEnabled()) {
    LOG.info("Added " + sf + ", entries="+ r.getEntries()+ ", sequenceid="+ logCacheFlushId+ ", filesize="+ StringUtils.humanReadableInt(r.length()));
  }
  return sf;
}
