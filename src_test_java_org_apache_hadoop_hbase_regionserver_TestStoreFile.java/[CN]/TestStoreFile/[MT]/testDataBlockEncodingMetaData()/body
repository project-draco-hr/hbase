{
  Path dir=new Path(new Path(this.testDir,"regionname"),"familyname");
  Path path=new Path(dir,"1234567890");
  DataBlockEncoding dataBlockEncoderAlgo=DataBlockEncoding.FAST_DIFF;
  HFileDataBlockEncoder dataBlockEncoder=new HFileDataBlockEncoderImpl(dataBlockEncoderAlgo,dataBlockEncoderAlgo);
  cacheConf=new CacheConfig(conf);
  StoreFile.Writer writer=new StoreFile.Writer(fs,path,HFile.DEFAULT_BLOCKSIZE,HFile.DEFAULT_COMPRESSION_ALGORITHM,dataBlockEncoder,conf,cacheConf,KeyValue.COMPARATOR,StoreFile.BloomType.NONE,2000);
  writer.close();
  StoreFile storeFile=new StoreFile(fs,writer.getPath(),conf,cacheConf,BloomType.NONE,dataBlockEncoder);
  StoreFile.Reader reader=storeFile.createReader();
  Map<byte[],byte[]> fileInfo=reader.loadFileInfo();
  byte[] value=fileInfo.get(StoreFile.DATA_BLOCK_ENCODING);
  assertEquals(dataBlockEncoderAlgo.getNameInBytes(),value);
}
