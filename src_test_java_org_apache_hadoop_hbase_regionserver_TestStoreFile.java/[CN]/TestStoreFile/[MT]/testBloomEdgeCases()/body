{
  float err=(float)0.005;
  FileSystem fs=FileSystem.getLocal(conf);
  Path f=new Path(ROOT_DIR,getName());
  conf.setFloat(StoreFile.IO_STOREFILE_BLOOM_ERROR_RATE,err);
  conf.setBoolean(StoreFile.IO_STOREFILE_BLOOM_ENABLED,true);
  conf.setInt(StoreFile.IO_STOREFILE_BLOOM_MAX_KEYS,1000);
  StoreFile.Writer writer=new StoreFile.Writer(fs,f,StoreFile.DEFAULT_BLOCKSIZE_SMALL,HFile.DEFAULT_COMPRESSION_ALGORITHM,conf,KeyValue.COMPARATOR,StoreFile.BloomType.ROW,2000);
  assertFalse(writer.hasBloom());
  writer.close();
  fs.delete(f,true);
  conf.setInt(StoreFile.IO_STOREFILE_BLOOM_MAX_KEYS,Integer.MAX_VALUE);
  writer=new StoreFile.Writer(fs,f,StoreFile.DEFAULT_BLOCKSIZE_SMALL,HFile.DEFAULT_COMPRESSION_ALGORITHM,conf,KeyValue.COMPARATOR,StoreFile.BloomType.ROW,Integer.MAX_VALUE);
  assertFalse(writer.hasBloom());
  writer.close();
  fs.delete(f,true);
}
