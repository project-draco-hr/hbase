{
  if (!getTableName().isSystemTable()) {
    final MasterFileSystem mfs=env.getMasterServices().getMasterFileSystem();
    SnapshotManifest manifest=SnapshotManifest.open(env.getMasterConfiguration(),mfs.getFileSystem(),SnapshotDescriptionUtils.getCompletedSnapshotDir(snapshot,mfs.getRootDir()),snapshot);
    ProcedureSyncWait.getMasterQuotaManager(env).checkNamespaceTableAndRegionQuota(getTableName(),manifest.getRegionManifestsMap().size());
  }
  final MasterCoprocessorHost cpHost=env.getMasterCoprocessorHost();
  if (cpHost != null) {
    user.doAs(new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        cpHost.preCreateTableHandler(hTableDescriptor,null);
        return null;
      }
    }
);
  }
}
