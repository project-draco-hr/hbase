{
  Integer milliSecInMin=60000;
  Integer previousMillis=this.conf.getInt("hbase.rpc.timeout",0);
  Integer numberOfFilesInDir=multipleTables ? hBackupFS.getMaxNumberOfFilesInSubDir(tableArchivePath) : hBackupFS.getNumberOfFilesInDir(tableArchivePath);
  Integer calculatedMillis=numberOfFilesInDir * milliSecInMin;
  Integer resultMillis=Math.max(calculatedMillis,previousMillis);
  if (resultMillis > previousMillis) {
    LOG.info("Setting configuration for restore with LoadIncrementalHFile: " + "hbase.rpc.timeout to " + calculatedMillis / milliSecInMin + " minutes, to handle the number of files in backup " + tableArchivePath);
    this.conf.setInt("hbase.rpc.timeout",resultMillis);
  }
  LoadIncrementalHFiles loader=null;
  try {
    loader=new LoadIncrementalHFiles(this.conf);
  }
 catch (  Exception e1) {
    throw new IOException(e1);
  }
  return loader;
}
