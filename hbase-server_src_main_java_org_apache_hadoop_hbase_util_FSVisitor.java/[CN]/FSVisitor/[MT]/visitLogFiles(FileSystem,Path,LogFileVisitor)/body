{
  Path logsDir=new Path(rootDir,HConstants.HREGION_LOGDIR_NAME);
  FileStatus[] logServerDirs=FSUtils.listStatus(fs,logsDir);
  if (logServerDirs == null) {
    if (LOG.isTraceEnabled()) {
      LOG.trace("No logs under directory:" + logsDir);
    }
    return;
  }
  for (  FileStatus serverLogs : logServerDirs) {
    String serverName=serverLogs.getPath().getName();
    FileStatus[] wals=FSUtils.listStatus(fs,serverLogs.getPath());
    if (wals == null) {
      if (LOG.isTraceEnabled()) {
        LOG.trace("No wals found for server: " + serverName + ", skipping.");
      }
      continue;
    }
    for (    FileStatus walRef : wals) {
      visitor.logFile(serverName,walRef.getPath().getName());
    }
  }
}
