{
  if (filter != null && filter.filterAllRemaining()) {
    return MatchCode.DONE_SCAN;
  }
  int ret=this.rowComparator.compareRows(row,this.rowOffset,this.rowLength,cell.getRowArray(),cell.getRowOffset(),cell.getRowLength());
  if (!this.isReversed) {
    if (ret <= -1) {
      return MatchCode.DONE;
    }
 else     if (ret >= 1) {
      return MatchCode.SEEK_NEXT_ROW;
    }
  }
 else {
    if (ret <= -1) {
      return MatchCode.SEEK_NEXT_ROW;
    }
 else     if (ret >= 1) {
      return MatchCode.DONE;
    }
  }
  if (this.stickyNextRow)   return MatchCode.SEEK_NEXT_ROW;
  if (this.columns.done()) {
    stickyNextRow=true;
    return MatchCode.SEEK_NEXT_ROW;
  }
  int qualifierOffset=cell.getQualifierOffset();
  int qualifierLength=cell.getQualifierLength();
  long timestamp=cell.getTimestamp();
  if (columns.isDone(timestamp)) {
    return columns.getNextRowOrNextColumn(cell.getQualifierArray(),qualifierOffset,qualifierLength);
  }
  byte typeByte=cell.getTypeByte();
  long mvccVersion=cell.getMvccVersion();
  if (CellUtil.isDelete(cell)) {
    if (keepDeletedCells == KeepDeletedCells.FALSE || (keepDeletedCells == KeepDeletedCells.TTL && timestamp < ttl)) {
      boolean includeDeleteMarker=seePastDeleteMarkers ? tr.withinTimeRange(timestamp) : tr.withinOrAfterTimeRange(timestamp);
      if (includeDeleteMarker && mvccVersion <= maxReadPointToTrackVersions) {
        this.deletes.add(cell);
      }
    }
    if ((!isUserScan) && timeToPurgeDeletes > 0 && (EnvironmentEdgeManager.currentTime() - timestamp) <= timeToPurgeDeletes) {
      return MatchCode.INCLUDE;
    }
 else     if (retainDeletesInOutput || mvccVersion > maxReadPointToTrackVersions) {
      if (!isUserScan) {
        return MatchCode.INCLUDE;
      }
    }
 else     if (keepDeletedCells == KeepDeletedCells.TRUE || (keepDeletedCells == KeepDeletedCells.TTL && timestamp >= ttl)) {
      if (timestamp < earliestPutTs) {
        return columns.getNextRowOrNextColumn(cell.getQualifierArray(),qualifierOffset,qualifierLength);
      }
    }
 else {
      return MatchCode.SKIP;
    }
  }
 else   if (!this.deletes.isEmpty()) {
    DeleteResult deleteResult=deletes.isDeleted(cell);
switch (deleteResult) {
case FAMILY_DELETED:
case COLUMN_DELETED:
      return columns.getNextRowOrNextColumn(cell.getQualifierArray(),qualifierOffset,qualifierLength);
case VERSION_DELETED:
case FAMILY_VERSION_DELETED:
    return MatchCode.SKIP;
case NOT_DELETED:
  break;
default :
throw new RuntimeException("UNEXPECTED");
}
}
int timestampComparison=tr.compare(timestamp);
if (timestampComparison >= 1) {
return MatchCode.SKIP;
}
 else if (timestampComparison <= -1) {
return columns.getNextRowOrNextColumn(cell.getQualifierArray(),qualifierOffset,qualifierLength);
}
MatchCode colChecker=columns.checkColumn(cell.getQualifierArray(),qualifierOffset,qualifierLength,typeByte);
if (colChecker == MatchCode.INCLUDE) {
ReturnCode filterResponse=ReturnCode.SKIP;
if (filter != null) {
filterResponse=filter.filterKeyValue(cell);
switch (filterResponse) {
case SKIP:
return MatchCode.SKIP;
case NEXT_COL:
return columns.getNextRowOrNextColumn(cell.getQualifierArray(),qualifierOffset,qualifierLength);
case NEXT_ROW:
stickyNextRow=true;
return MatchCode.SEEK_NEXT_ROW;
case SEEK_NEXT_USING_HINT:
return MatchCode.SEEK_NEXT_USING_HINT;
default :
break;
}
}
colChecker=columns.checkVersions(cell.getQualifierArray(),qualifierOffset,qualifierLength,timestamp,typeByte,mvccVersion > maxReadPointToTrackVersions);
stickyNextRow=colChecker == MatchCode.INCLUDE_AND_SEEK_NEXT_ROW ? true : stickyNextRow;
return (filterResponse == ReturnCode.INCLUDE_AND_NEXT_COL && colChecker == MatchCode.INCLUDE) ? MatchCode.INCLUDE_AND_SEEK_NEXT_COL : colChecker;
}
stickyNextRow=(colChecker == MatchCode.SEEK_NEXT_ROW) ? true : stickyNextRow;
return colChecker;
}
