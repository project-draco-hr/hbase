{
  HFile.checkFormatVersion(majorVersion);
  BlockType.TRAILER.readAndCheck(inputStream);
  fileInfoOffset=inputStream.readLong();
  loadOnOpenDataOffset=inputStream.readLong();
  dataIndexCount=inputStream.readInt();
  if (majorVersion == 1) {
    inputStream.readLong();
  }
 else {
    uncompressedDataIndexSize=inputStream.readLong();
  }
  metaIndexCount=inputStream.readInt();
  totalUncompressedBytes=inputStream.readLong();
  entryCount=majorVersion == 1 ? inputStream.readInt() : inputStream.readLong();
  compressionCodec=Compression.Algorithm.values()[inputStream.readInt()];
  if (majorVersion > 1) {
    numDataIndexLevels=inputStream.readInt();
    firstDataBlockOffset=inputStream.readLong();
    lastDataBlockOffset=inputStream.readLong();
    comparatorClassName=Bytes.readStringFixedSize(inputStream,MAX_COMPARATOR_NAME_LENGTH);
  }
  int version=inputStream.readInt();
  expectMajorVersion(extractMajorVersion(version));
  expectMinorVersion(extractMinorVersion(version));
}
