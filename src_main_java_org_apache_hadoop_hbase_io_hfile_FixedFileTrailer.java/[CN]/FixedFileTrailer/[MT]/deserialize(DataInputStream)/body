{
  HFile.checkFormatVersion(version);
  BlockType.TRAILER.readAndCheck(inputStream);
  fileInfoOffset=inputStream.readLong();
  loadOnOpenDataOffset=inputStream.readLong();
  dataIndexCount=inputStream.readInt();
  if (version == 1) {
    inputStream.readLong();
  }
 else {
    uncompressedDataIndexSize=inputStream.readLong();
  }
  metaIndexCount=inputStream.readInt();
  totalUncompressedBytes=inputStream.readLong();
  entryCount=version == 1 ? inputStream.readInt() : inputStream.readLong();
  compressionCodec=Compression.Algorithm.values()[inputStream.readInt()];
  if (version > 1) {
    numDataIndexLevels=inputStream.readInt();
    firstDataBlockOffset=inputStream.readLong();
    lastDataBlockOffset=inputStream.readLong();
    comparatorClassName=Bytes.readStringFixedSize(inputStream,MAX_COMPARATOR_NAME_LENGTH);
  }
  expectVersion(inputStream.readInt());
}
