{
  if (shouldCloseConnection.get()) {
    return;
  }
  try {
    if (LOG.isDebugEnabled())     LOG.debug(getName() + " sending #" + call.id);
    RpcRequestHeader.Builder builder=RPCProtos.RpcRequestHeader.newBuilder();
    builder.setCallId(call.id);
    DataOutputBuffer d=new DataOutputBuffer();
    builder.build().writeDelimitedTo(d);
    call.param.write(d);
synchronized (this.out) {
      this.out.writeInt(d.getLength());
      this.out.write(d.getData(),0,d.getLength());
      this.out.flush();
    }
  }
 catch (  IOException e) {
    markClosed(e);
  }
}
