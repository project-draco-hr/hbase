{
  Configuration conf=new Configuration(UTIL.getConfiguration());
  conf.set(RpcControllerFactory.CUSTOM_CONTROLLER_CONF_KEY,StaticRpcControllerFactory.class.getName());
  TableName name=TableName.valueOf("testcustomcontroller");
  UTIL.createTable(name,fam1).close();
  conf.setInt(HConstants.HBASE_RPC_TIMEOUT_KEY,HConstants.DEFAULT_HBASE_RPC_TIMEOUT + 1);
  Connection connection=ConnectionFactory.createConnection(conf);
  Table table=connection.getTable(name);
  table.setAutoFlushTo(false);
  byte[] row=Bytes.toBytes("row");
  Put p=new Put(row);
  p.add(fam1,fam1,Bytes.toBytes("val0"));
  table.put(p);
  table.flushCommits();
  Integer counter=1;
  counter=verifyCount(counter);
  Delete d=new Delete(row);
  d.deleteColumn(fam1,fam1);
  table.delete(d);
  counter=verifyCount(counter);
  Put p2=new Put(row);
  p2.add(fam1,Bytes.toBytes("qual"),Bytes.toBytes("val1"));
  table.batch(Lists.newArrayList(p,p2),new Object[2]);
  counter=verifyCount(counter);
  Append append=new Append(row);
  append.add(fam1,fam1,Bytes.toBytes("val2"));
  table.append(append);
  counter=verifyCount(counter);
  Get g=new Get(row);
  table.get(g);
  counter=verifyCount(counter);
  ResultScanner scan=table.getScanner(fam1);
  scan.next();
  scan.close();
  counter=verifyCount(counter);
  Get g2=new Get(row);
  table.get(Lists.newArrayList(g,g2));
  counter=verifyCount(counter);
  Scan scanInfo=new Scan(row);
  scanInfo.setSmall(true);
  counter=doScan(table,scanInfo,counter);
  scanInfo.setReversed(true);
  counter=doScan(table,scanInfo,counter);
  scanInfo.setSmall(false);
  counter=doScan(table,scanInfo,counter);
  table.close();
  connection.close();
}
