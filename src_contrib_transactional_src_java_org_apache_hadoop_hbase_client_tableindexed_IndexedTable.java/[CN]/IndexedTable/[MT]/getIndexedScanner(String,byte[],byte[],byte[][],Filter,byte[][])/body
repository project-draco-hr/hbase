{
  IndexSpecification indexSpec=this.indexedTableDescriptor.getIndex(indexId);
  if (indexSpec == null) {
    throw new IndexNotFoundException("Index " + indexId + " not defined in table "+ super.getTableDescriptor().getNameAsString());
  }
  verifyIndexColumns(indexColumns,indexSpec);
  HTable indexTable=indexIdToTable.get(indexId);
  byte[][] allIndexColumns;
  if (indexColumns != null) {
    allIndexColumns=new byte[indexColumns.length + 1][];
    System.arraycopy(indexColumns,0,allIndexColumns,0,indexColumns.length);
    allIndexColumns[indexColumns.length]=INDEX_BASE_ROW_COLUMN;
  }
 else {
    byte[][] allColumns=indexSpec.getAllColumns();
    allIndexColumns=new byte[allColumns.length + 1][];
    System.arraycopy(allColumns,0,allIndexColumns,0,allColumns.length);
    allIndexColumns[allColumns.length]=INDEX_BASE_ROW_COLUMN;
  }
  Scan indexScan=new Scan();
  indexScan.setFilter(indexFilter);
  indexScan.addColumns(allIndexColumns);
  if (indexStartRow != null) {
    indexScan.setStartRow(indexStartRow);
  }
  if (indexStopRow != null) {
    indexScan.setStopRow(indexStopRow);
  }
  ResultScanner indexScanner=indexTable.getScanner(indexScan);
  return new ScannerWrapper(indexScanner,baseColumns);
}
