{
  EnvironmentEdge edge=new EnvironmentEdge(){
    @Override public long currentTimeMillis(){
      return 0;
    }
  }
;
  EnvironmentEdgeManagerTestHelper.injectEdge(edge);
  SnapshotDescription.Builder builder=SnapshotDescription.newBuilder();
  builder.setName("snapshot");
  builder.setTable("table");
  Configuration conf=new Configuration(false);
  conf.setLong(SnapshotDescriptionUtils.TIMESTAMP_SNAPSHOT_SPLIT_POINT_ADDITION,1);
  SnapshotDescription desc=SnapshotDescriptionUtils.validate(builder.build(),conf);
  assertEquals("Description creation time wasn't set correctly",1,desc.getCreationTime());
  edge=new EnvironmentEdge(){
    @Override public long currentTimeMillis(){
      return 2;
    }
  }
;
  EnvironmentEdgeManagerTestHelper.injectEdge(edge);
  builder.setType(Type.GLOBAL);
  desc=SnapshotDescriptionUtils.validate(builder.build(),conf);
  assertEquals("Description creation time wasn't set correctly",2,desc.getCreationTime());
  builder.setCreationTime(10);
  desc=SnapshotDescriptionUtils.validate(builder.build(),conf);
  assertEquals("Description creation time wasn't set correctly",10,desc.getCreationTime());
  try {
    SnapshotDescriptionUtils.validate(SnapshotDescription.newBuilder().setName("fail").build(),conf);
    fail("Snapshot was considered valid without a table name");
  }
 catch (  IllegalArgumentException e) {
    LOG.debug("Correctly failed when snapshot doesn't have a tablename");
  }
}
