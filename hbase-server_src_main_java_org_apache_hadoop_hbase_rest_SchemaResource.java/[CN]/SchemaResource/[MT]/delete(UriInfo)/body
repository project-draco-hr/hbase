{
  if (LOG.isDebugEnabled()) {
    LOG.debug("DELETE " + uriInfo.getAbsolutePath());
  }
  servlet.getMetrics().incrementRequests(1);
  try {
    HBaseAdmin admin=servlet.getAdmin();
    boolean success=false;
    for (int i=0; i < 10; i++)     try {
      admin.disableTable(tableResource.getName());
      success=true;
      break;
    }
 catch (    IOException e) {
    }
    if (!success) {
      throw new IOException("could not disable table");
    }
    admin.deleteTable(tableResource.getName());
    servlet.getMetrics().incrementSucessfulDeleteRequests(1);
    return Response.ok().build();
  }
 catch (  TableNotFoundException e) {
    servlet.getMetrics().incrementFailedDeleteRequests(1);
    return Response.status(Response.Status.NOT_FOUND).type(MIMETYPE_TEXT).entity("Not found" + CRLF).build();
  }
catch (  IOException e) {
    servlet.getMetrics().incrementFailedDeleteRequests(1);
    return Response.status(Response.Status.SERVICE_UNAVAILABLE).type(MIMETYPE_TEXT).entity("Unavailable" + CRLF).build();
  }
}
