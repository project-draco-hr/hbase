{
  if (servlet.isReadOnly()) {
    throw new WebApplicationException(Response.Status.FORBIDDEN);
  }
  try {
    HTableDescriptor htd=admin.getTableDescriptor(name);
    admin.disableTable(name);
    try {
      for (      ColumnSchemaModel family : model.getColumns()) {
        HColumnDescriptor hcd=new HColumnDescriptor(family.getName());
        for (        Map.Entry<QName,Object> e : family.getAny().entrySet()) {
          hcd.setValue(e.getKey().getLocalPart(),e.getValue().toString());
        }
        if (htd.hasFamily(hcd.getName())) {
          admin.modifyColumn(name,hcd);
        }
 else {
          admin.addColumn(name,hcd);
        }
      }
    }
 catch (    IOException e) {
      throw new WebApplicationException(e,Response.Status.INTERNAL_SERVER_ERROR);
    }
 finally {
      admin.enableTable(tableResource.getName());
    }
    servlet.getMetrics().incrementSucessfulPutRequests(1);
    return Response.ok().build();
  }
 catch (  IOException e) {
    throw new WebApplicationException(e,Response.Status.SERVICE_UNAVAILABLE);
  }
}
