{
  boolean tableExists=false;
  byte[] tableNameMetaStart=Bytes.toBytes(Bytes.toString(tableName) + ",,");
  Scan scan=new Scan(tableNameMetaStart).addFamily(CATALOG_FAMILY);
  long scannerId=server.openScanner(m.getRegionName(),scan);
  List<byte[]> emptyRows=new ArrayList<byte[]>();
  try {
    while (true) {
      Result values=server.next(scannerId);
      if (values == null || values.isEmpty()) {
        break;
      }
      HRegionInfo info=this.master.getHRegionInfo(values.getRow(),values);
      if (info == null) {
        emptyRows.add(values.getRow());
        LOG.error(Bytes.toString(CATALOG_FAMILY) + ":" + Bytes.toString(REGIONINFO_QUALIFIER)+ " not found on "+ Bytes.toString(values.getRow()));
        continue;
      }
      String serverAddress=Bytes.toString(values.getValue(CATALOG_FAMILY,SERVER_QUALIFIER));
      long startCode=Bytes.toLong(values.getValue(CATALOG_FAMILY,STARTCODE_QUALIFIER));
      String serverName=null;
      if (serverAddress != null && serverAddress.length() > 0) {
        serverName=HServerInfo.getServerName(serverAddress,startCode);
      }
      if (Bytes.compareTo(info.getTableDesc().getName(),tableName) > 0) {
        break;
      }
      tableExists=true;
      if (!isBeingServed(serverName) || !isEnabled(info)) {
        unservedRegions.add(info);
      }
      processScanItem(serverName,info);
    }
  }
  finally {
    if (scannerId != -1L) {
      try {
        server.close(scannerId);
      }
 catch (      IOException e) {
        e=RemoteExceptionHandler.checkIOException(e);
        LOG.error("closing scanner",e);
      }
    }
    scannerId=-1L;
  }
  if (emptyRows.size() > 0) {
    LOG.warn("Found " + emptyRows.size() + " rows with empty HRegionInfo while scanning meta region "+ Bytes.toString(m.getRegionName()));
    master.deleteEmptyMetaRows(server,m.getRegionName(),emptyRows);
  }
  if (!tableExists) {
    throw new TableNotFoundException(Bytes.toString(tableName));
  }
  postProcessMeta(m,server);
  unservedRegions.clear();
  return Boolean.TRUE;
}
