{
  boolean tableExists=false;
  long scannerId=server.openScanner(m.getRegionName(),COLUMN_FAMILY_ARRAY,tableName,HConstants.LATEST_TIMESTAMP,null);
  List<Text> emptyRows=new ArrayList<Text>();
  try {
    while (true) {
      RowResult values=server.next(scannerId);
      if (values == null || values.size() == 0) {
        break;
      }
      HRegionInfo info=this.master.getHRegionInfo(values.getRow(),values);
      if (info == null) {
        emptyRows.add(values.getRow());
        LOG.error(COL_REGIONINFO + " not found on " + values.getRow());
        continue;
      }
      String serverName=Writables.cellToString(values.get(COL_SERVER));
      long startCode=Writables.cellToLong(values.get(COL_STARTCODE));
      if (info.getTableDesc().getName().compareTo(tableName) > 0) {
        break;
      }
      tableExists=true;
      if (!isBeingServed(serverName,startCode)) {
        unservedRegions.add(info);
      }
      processScanItem(serverName,startCode,info);
    }
  }
  finally {
    if (scannerId != -1L) {
      try {
        server.close(scannerId);
      }
 catch (      IOException e) {
        e=RemoteExceptionHandler.checkIOException(e);
        LOG.error("closing scanner",e);
      }
    }
    scannerId=-1L;
  }
  if (emptyRows.size() > 0) {
    LOG.warn("Found " + emptyRows.size() + " rows with empty HRegionInfo while scanning meta region "+ m.getRegionName());
    master.deleteEmptyMetaRows(server,m.getRegionName(),emptyRows);
  }
  if (!tableExists) {
    throw new TableNotFoundException(tableName + " does not exist");
  }
  postProcessMeta(m,server);
  unservedRegions.clear();
  return true;
}
