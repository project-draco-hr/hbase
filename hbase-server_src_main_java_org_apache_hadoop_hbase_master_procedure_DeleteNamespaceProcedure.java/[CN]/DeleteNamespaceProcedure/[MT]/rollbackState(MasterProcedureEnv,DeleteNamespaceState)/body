{
  if (isTraceEnabled()) {
    LOG.trace(this + " rollback state=" + state);
  }
  try {
switch (state) {
case DELETE_NAMESPACE_REMOVE_NAMESPACE_QUOTA:
      rollbacRemoveNamespaceQuota(env);
    break;
case DELETE_NAMESPACE_DELETE_DIRECTORIES:
  rollbackDeleteDirectory(env);
break;
case DELETE_NAMESPACE_REMOVE_FROM_ZK:
undoRemoveFromZKNamespaceManager(env);
break;
case DELETE_NAMESPACE_DELETE_FROM_NS_TABLE:
undoDeleteFromNSTable(env);
break;
case DELETE_NAMESPACE_PREPARE:
break;
default :
throw new UnsupportedOperationException(this + " unhandled state=" + state);
}
}
 catch (IOException e) {
LOG.warn("Failed rollback attempt step " + state + " for deleting the namespace "+ namespaceName,e);
throw e;
}
}
