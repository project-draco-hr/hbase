{
  HBaseClient client=clients.get(factory);
  if (client == null) {
    Class<? extends HBaseClient> hbaseClientClass=(Class<? extends HBaseClient>)conf.getClass(HConstants.HBASECLIENT_IMPL,HBaseClient.class);
    try {
      Constructor<? extends HBaseClient> cst=hbaseClientClass.getConstructor(Configuration.class,SocketFactory.class);
      client=cst.newInstance(conf,factory);
    }
 catch (    InvocationTargetException e) {
      throw new RuntimeException(e);
    }
catch (    InstantiationException e) {
      throw new RuntimeException(e);
    }
catch (    IllegalAccessException e) {
      throw new RuntimeException(e);
    }
catch (    NoSuchMethodException e) {
      throw new RuntimeException("No matching constructor in " + hbaseClientClass.getName(),e);
    }
    clients.put(factory,client);
  }
 else {
    client.incCount();
  }
  return client;
}
