{
  this.master=master;
  Configuration c=master.getConfiguration();
  this.nobalancingCount=c.getInt("hbase.regions.nobalancing.count",4);
  int metaRescanInterval=c.getInt("hbase.master.meta.thread.rescanfrequency",60 * 1000);
  this.minimumServerCount=c.getInt("hbase.regions.server.count.min",0);
  this.serverMonitorThread=new ServerMonitor(metaRescanInterval,this.master.getShutdownRequested());
  String n=Thread.currentThread().getName();
  Threads.setDaemonThreadRunning(this.serverMonitorThread,n + ".serverMonitor");
  this.logCleaner=new LogsCleaner(c.getInt("hbase.master.meta.thread.rescanfrequency",60 * 1000),this.master.getShutdownRequested(),c,master.getFileSystem(),master.getOldLogDir());
  Threads.setDaemonThreadRunning(logCleaner,n + ".oldLogCleaner");
}
