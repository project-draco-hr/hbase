{
  this.master=master;
  this.services=services;
  Configuration c=master.getConfiguration();
  int metaRescanInterval=c.getInt("hbase.master.meta.thread.rescanfrequency",60 * 1000);
  this.minimumServerCount=c.getInt("hbase.regions.server.count.min",1);
  this.metrics=new MasterMetrics(master.getServerName());
  this.serverMonitorThread=new ServerMonitor(metaRescanInterval,master);
  String n=Thread.currentThread().getName();
  Threads.setDaemonThreadRunning(this.serverMonitorThread,n + ".serverMonitor");
  this.logCleaner=new LogCleaner(c.getInt("hbase.master.meta.thread.rescanfrequency",60 * 1000),master,c,this.services.getMasterFileSystem().getFileSystem(),this.services.getMasterFileSystem().getOldLogDir());
  Threads.setDaemonThreadRunning(logCleaner,n + ".oldLogCleaner");
}
