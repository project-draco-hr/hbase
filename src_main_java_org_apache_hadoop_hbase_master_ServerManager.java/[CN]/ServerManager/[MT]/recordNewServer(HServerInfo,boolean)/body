{
  HServerLoad load=useInfoLoad ? info.getLoad() : new HServerLoad();
  String serverName=info.getServerName();
  info.setLoad(load);
  Watcher watcher=new ServerExpirer(new HServerInfo(info));
  this.master.getZooKeeperWrapper().updateRSLocationGetWatch(info,watcher);
  this.serversToServerInfo.put(serverName,info);
  this.serversToLoad.put(serverName,load);
synchronized (this.loadToServers) {
    Set<String> servers=this.loadToServers.get(load);
    if (servers == null) {
      servers=new HashSet<String>();
    }
    servers.add(serverName);
    this.loadToServers.put(load,servers);
  }
}
