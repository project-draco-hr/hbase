{
  String serverName=hsi.getServerName();
  HServerInfo info=this.onlineServers.get(serverName);
  if (info == null) {
    LOG.warn("Received expiration of " + hsi.getServerName() + " but server is not currently online");
    return;
  }
  if (this.deadservers.contains(serverName)) {
    LOG.warn("Received expiration of " + hsi.getServerName() + " but server shutdown is already in progress");
    return;
  }
  this.deadservers.add(serverName);
  this.onlineServers.remove(serverName);
  this.serverConnections.remove(serverName);
  if (this.clusterShutdown) {
    LOG.info("Cluster shutdown set; " + hsi.getServerName() + " expired; onlineServers="+ this.onlineServers.size());
    if (this.onlineServers.isEmpty()) {
      master.stop("Cluster shutdown set; onlineServer=0");
    }
    return;
  }
  CatalogTracker ct=this.master.getCatalogTracker();
  boolean carryingRoot;
  try {
    HServerAddress address=ct.getRootLocation();
    carryingRoot=address != null && hsi.getServerAddress().equals(address);
  }
 catch (  InterruptedException e) {
    Thread.currentThread().interrupt();
    LOG.info("Interrupted");
    return;
  }
  HServerAddress address=ct.getMetaLocation();
  boolean carryingMeta=address != null && hsi.getServerAddress().equals(address);
  if (carryingRoot || carryingMeta) {
    this.services.getExecutorService().submit(new MetaServerShutdownHandler(this.master,this.services,this.deadservers,info,carryingRoot,carryingMeta));
  }
 else {
    this.services.getExecutorService().submit(new ServerShutdownHandler(this.master,this.services,this.deadservers,info));
  }
  LOG.debug("Added=" + serverName + " to dead servers, submitted shutdown handler to be executed, root="+ carryingRoot+ ", meta="+ carryingMeta);
}
