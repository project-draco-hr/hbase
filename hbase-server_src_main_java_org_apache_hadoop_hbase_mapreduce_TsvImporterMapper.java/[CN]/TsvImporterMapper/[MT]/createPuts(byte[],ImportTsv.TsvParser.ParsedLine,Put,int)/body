{
  KeyValue kv=null;
  if (hfileOutPath == null) {
    kv=new KeyValue(lineBytes,parsed.getRowKeyOffset(),parsed.getRowKeyLength(),parser.getFamily(i),0,parser.getFamily(i).length,parser.getQualifier(i),0,parser.getQualifier(i).length,ts,KeyValue.Type.Put,lineBytes,parsed.getColumnOffset(i),parsed.getColumnLength(i));
    if (cellVisibilityExpr != null) {
      put.setCellVisibility(new CellVisibility(cellVisibilityExpr));
    }
  }
 else {
    kv=labelExpander.createKVFromCellVisibilityExpr(parsed.getRowKeyOffset(),parsed.getRowKeyLength(),parser.getFamily(i),0,parser.getFamily(i).length,parser.getQualifier(i),0,parser.getQualifier(i).length,ts,KeyValue.Type.Put,lineBytes,parsed.getColumnOffset(i),parsed.getColumnLength(i),cellVisibilityExpr);
  }
  put.add(kv);
  return kv;
}
