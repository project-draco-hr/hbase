{
  HRegionInfo info=region.regionInfo;
  this.homedir=getStoreHomedir(basedir,info.getEncodedName(),family.getName());
  this.region=region;
  this.family=family;
  this.fs=fs;
  this.conf=conf;
  this.blockcache=family.isBlockCacheEnabled();
  this.blocksize=family.getBlocksize();
  this.compression=family.getCompression();
  this.comparator=info.getComparator();
  this.comparatorIgnoringType=this.comparator.getComparatorIgnoringType();
  this.ttl=family.getTimeToLive();
  if (ttl == HConstants.FOREVER) {
    ttl=Long.MAX_VALUE;
  }
 else   if (ttl == -1) {
    ttl=Long.MAX_VALUE;
  }
 else {
    this.ttl*=1000;
  }
  this.memstore=new MemStore(this.comparator);
  this.regionCompactionDir=new Path(HRegion.getCompactionDir(basedir),Integer.toString(info.getEncodedName()));
  this.storeName=this.family.getName();
  this.storeNameStr=Bytes.toString(this.storeName);
  this.compactionThreshold=conf.getInt("hbase.hstore.compactionThreshold",3);
  this.inMemory=family.isInMemory();
  long maxFileSize=info.getTableDesc().getMaxFileSize();
  if (maxFileSize == HConstants.DEFAULT_MAX_FILE_SIZE) {
    maxFileSize=conf.getLong("hbase.hregion.max.filesize",HConstants.DEFAULT_MAX_FILE_SIZE);
  }
  this.desiredMaxFileSize=maxFileSize;
  this.majorCompactionTime=conf.getLong(HConstants.MAJOR_COMPACTION_PERIOD,86400000);
  if (family.getValue(HConstants.MAJOR_COMPACTION_PERIOD) != null) {
    String strCompactionTime=family.getValue(HConstants.MAJOR_COMPACTION_PERIOD);
    this.majorCompactionTime=(new Long(strCompactionTime)).longValue();
  }
  this.maxFilesToCompact=conf.getInt("hbase.hstore.compaction.max",10);
  this.storefiles.putAll(loadStoreFiles());
  long newId=runReconstructionLog(reconstructionLog,this.maxSeqId,reporter);
  if (newId != -1) {
    this.maxSeqId=newId;
  }
}
