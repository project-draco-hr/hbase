{
  KeyValue firstCandidateKey=candidates.first();
  KeyValue search=null;
  if (this.comparator.compareRows(firstCandidateKey,targetkey) < 0) {
    search=targetkey;
  }
 else {
    search=firstCandidateKey;
  }
  Reader r=f.getReader();
  if (r == null) {
    LOG.warn("StoreFile " + f + " has a null Reader");
    return;
  }
  HFileScanner scanner=r.getScanner();
  int result=scanner.seekTo(search.getBuffer(),search.getKeyOffset(),search.getKeyLength());
  if (result < 0) {
    return;
  }
  do {
    KeyValue kv=scanner.getKeyValue();
    if (this.comparator.matchingRows(kv,targetkey)) {
      handleKey(kv,now,deletes,candidates);
    }
 else     if (this.comparator.compareRows(kv,targetkey) > 0) {
      break;
    }
 else {
      handleKey(kv,now,deletes,candidates);
    }
  }
 while (scanner.next());
}
