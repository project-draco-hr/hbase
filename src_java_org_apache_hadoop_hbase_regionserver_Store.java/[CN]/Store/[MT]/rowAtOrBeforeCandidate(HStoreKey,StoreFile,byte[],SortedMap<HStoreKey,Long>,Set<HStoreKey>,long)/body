{
  HStoreKey finalKey=HStoreKey.create(f.getReader().getLastKey());
  HStoreKey searchKey=null;
  if (HStoreKey.compareTwoRowKeys(finalKey.getRow(),row) < 0) {
    searchKey=finalKey;
  }
 else {
    searchKey=new HStoreKey(row);
    if (searchKey.compareTo(startKey) < 0) {
      searchKey=startKey;
    }
  }
  rowAtOrBeforeCandidate(f,searchKey,candidateKeys,deletes,now);
}
