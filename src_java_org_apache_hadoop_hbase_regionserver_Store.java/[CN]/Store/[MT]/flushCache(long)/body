{
  ConcurrentSkipListMap<KeyValue,?> cache=this.memstore.getSnapshot();
  StoreFile sf=internalFlushCache(cache,logCacheFlushId);
  if (sf == null) {
    return false;
  }
  int size=updateStorefiles(logCacheFlushId,sf,cache);
  return size >= this.compactionThreshold;
}
