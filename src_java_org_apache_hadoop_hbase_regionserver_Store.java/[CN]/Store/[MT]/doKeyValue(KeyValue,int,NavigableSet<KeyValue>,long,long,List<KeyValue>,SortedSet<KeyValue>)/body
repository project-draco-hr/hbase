{
  boolean hasEnough=false;
  if (!kv.isDeleteType()) {
    if (notExpiredAndNotInDeletes(ttl,kv,now,deletes)) {
      if (!keyvalues.contains(kv)) {
        keyvalues.add(kv);
        if (hasEnoughVersions(versions,keyvalues)) {
          hasEnough=true;
        }
      }
    }
 else {
      if (set != null) {
        expiredOrDeleted(set,kv);
      }
    }
  }
 else {
    deletes.add(kv);
  }
  return hasEnough;
}
