{
  kvList=new ArrayList<KeyValue>();
  for (  Put put : puts) {
    for (    List<KeyValue> putKVs : put.getFamilyMap().values()) {
      kvList.addAll(putKVs);
    }
  }
  Collections.sort(kvList,new Comparator<KeyValue>(){
    /** 
 * We want to honor the order of the puts in the case where multiple have the same timestamp.
 * @param o1
 * @param o2
 * @return
 */
    public int compare(    KeyValue o1,    KeyValue o2){
      int result=KeyValue.COMPARATOR.compare(o1,o2);
      if (result != 0) {
        return result;
      }
      if (o1 == o2) {
        return 0;
      }
      int put1Number=getPutNumber(o1);
      int put2Number=getPutNumber(o2);
      return put2Number - put1Number;
    }
  }
);
  iterator=kvList.iterator();
}
