{
  this.fs=fs;
  this.path=p;
  this.cacheConf=cacheConf;
  if (isReference(p)) {
    this.reference=Reference.read(fs,p);
    this.referencePath=getReferredToFile(this.path);
  }
  if (BloomFilterFactory.isGeneralBloomEnabled(conf)) {
    this.cfBloomType=cfBloomType;
  }
 else {
    LOG.info("Ignoring bloom filter check for file " + path + ": "+ "cfBloomType="+ cfBloomType+ " (disabled in config)");
    this.cfBloomType=BloomType.NONE;
  }
  FileStatus[] stats=FSUtils.listStatus(fs,p,null);
  if (stats != null && stats.length == 1) {
    this.modificationTimeStamp=stats[0].getModificationTime();
  }
 else {
    this.modificationTimeStamp=0;
  }
  SchemaMetrics.configureGlobally(conf);
}
