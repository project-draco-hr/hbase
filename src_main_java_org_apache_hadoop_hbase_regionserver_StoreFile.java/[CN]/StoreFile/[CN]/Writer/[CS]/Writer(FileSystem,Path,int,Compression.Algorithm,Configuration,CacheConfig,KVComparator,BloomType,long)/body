{
  writer=HFile.getWriterFactory(conf,cacheConf).createWriter(fs,path,blocksize,compress,comparator.getRawComparator());
  this.kvComparator=comparator;
  bloomFilterWriter=BloomFilterFactory.createBloomAtWrite(conf,cacheConf,bloomType,(int)Math.min(maxKeys,Integer.MAX_VALUE),writer);
  if (bloomFilterWriter != null) {
    this.bloomType=bloomType;
    LOG.info("Bloom filter type for " + path + ": "+ this.bloomType+ ", "+ bloomFilterWriter.getClass().getSimpleName());
  }
 else {
    this.bloomType=BloomType.NONE;
  }
}
