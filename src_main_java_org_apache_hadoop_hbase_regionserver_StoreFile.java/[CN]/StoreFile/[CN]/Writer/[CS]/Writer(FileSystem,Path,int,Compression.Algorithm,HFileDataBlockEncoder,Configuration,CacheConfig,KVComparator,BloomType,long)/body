{
  this.dataBlockEncoder=dataBlockEncoder != null ? dataBlockEncoder : new NoOpDataBlockEncoder();
  writer=HFile.getWriterFactory(conf,cacheConf).createWriter(fs,path,blocksize,compress,this.dataBlockEncoder,comparator.getRawComparator());
  this.kvComparator=comparator;
  generalBloomFilterWriter=BloomFilterFactory.createGeneralBloomAtWrite(conf,cacheConf,bloomType,(int)Math.min(maxKeys,Integer.MAX_VALUE),writer);
  if (generalBloomFilterWriter != null) {
    this.bloomType=bloomType;
    LOG.info("Bloom filter type for " + path + ": "+ this.bloomType+ ", "+ generalBloomFilterWriter.getClass().getSimpleName());
  }
 else {
    this.bloomType=BloomType.NONE;
  }
  if (this.bloomType != BloomType.ROWCOL) {
    this.deleteFamilyBloomFilterWriter=BloomFilterFactory.createDeleteBloomAtWrite(conf,cacheConf,(int)Math.min(maxKeys,Integer.MAX_VALUE),writer);
  }
 else {
    deleteFamilyBloomFilterWriter=null;
  }
  if (deleteFamilyBloomFilterWriter != null) {
    LOG.info("Delete Family Bloom filter type for " + path + ": "+ deleteFamilyBloomFilterWriter.getClass().getSimpleName());
  }
}
