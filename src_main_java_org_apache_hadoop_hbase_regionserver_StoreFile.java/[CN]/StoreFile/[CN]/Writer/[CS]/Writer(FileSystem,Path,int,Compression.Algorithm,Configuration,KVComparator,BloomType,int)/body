{
  writer=new HFile.Writer(fs,path,blocksize,compress,comparator.getRawComparator());
  this.kvComparator=comparator;
  if (bloomType != BloomType.NONE && conf != null) {
    float err=conf.getFloat(IO_STOREFILE_BLOOM_ERROR_RATE,(float)0.01);
    if (bloomType == BloomType.ROWCOL) {
      err/=2;
    }
    int maxFold=conf.getInt(IO_STOREFILE_BLOOM_MAX_FOLD,7);
    this.bloomFilter=new ByteBloomFilter(maxKeys,err,Hash.getHashType(conf),maxFold);
    this.bloomFilter.allocBloom();
    this.bloomType=bloomType;
  }
 else {
    this.bloomFilter=null;
    this.bloomType=BloomType.NONE;
  }
}
