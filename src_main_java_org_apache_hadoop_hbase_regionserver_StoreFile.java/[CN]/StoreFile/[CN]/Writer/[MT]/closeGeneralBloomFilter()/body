{
  boolean hasGeneralBloom=closeBloomFilter(generalBloomFilterWriter);
  if (hasGeneralBloom) {
    writer.addGeneralBloomFilter(generalBloomFilterWriter);
    writer.appendFileInfo(BLOOM_FILTER_TYPE_KEY,Bytes.toBytes(bloomType.toString()));
    if (lastBloomKey != null) {
      writer.appendFileInfo(LAST_BLOOM_KEY,Arrays.copyOfRange(lastBloomKey,lastBloomKeyOffset,lastBloomKeyOffset + lastBloomKeyLen));
    }
  }
  return hasGeneralBloom;
}
