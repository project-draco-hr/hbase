{
  if (this.bloomFilter != null && this.bloomFilter.getKeyCount() > 0) {
    bloomFilter.compactBloom();
    if (this.bloomFilter.getMaxKeys() > 0) {
      int b=this.bloomFilter.getByteSize();
      int k=this.bloomFilter.getKeyCount();
      int m=this.bloomFilter.getMaxKeys();
      StoreFile.LOG.info("Bloom added to HFile (" + getPath() + "): "+ StringUtils.humanReadableInt(b)+ ", "+ k+ "/"+ m+ " ("+ NumberFormat.getPercentInstance().format(((double)k) / ((double)m))+ ")");
    }
    writer.appendMetaBlock(BLOOM_FILTER_META_KEY,bloomFilter.getMetaWriter());
    writer.appendMetaBlock(BLOOM_FILTER_DATA_KEY,bloomFilter.getDataWriter());
    writer.appendFileInfo(BLOOM_FILTER_TYPE_KEY,Bytes.toBytes(bloomType.toString()));
  }
  writer.close();
}
