{
  if (this.bloomFilter == null || !scan.isGetScan()) {
    return true;
  }
  byte[] row=scan.getStartRow();
  byte[] key;
switch (this.bloomFilterType) {
case ROW:
    key=row;
  break;
case ROWCOL:
if (columns != null && columns.size() == 1) {
  byte[] col=columns.first();
  key=Bytes.add(row,col);
  break;
}
default :
return true;
}
try {
ByteBuffer bloom=reader.getMetaBlock(BLOOM_FILTER_DATA_KEY,true);
if (bloom != null) {
if (this.bloomFilterType == BloomType.ROWCOL) {
return this.bloomFilter.contains(key,bloom) || this.bloomFilter.contains(row,bloom);
}
 else {
return this.bloomFilter.contains(key,bloom);
}
}
}
 catch (IOException e) {
LOG.error("Error reading bloom filter data -- proceeding without",e);
setBloomFilterFaulty();
}
catch (IllegalArgumentException e) {
LOG.error("Bad bloom filter data -- proceeding without",e);
setBloomFilterFaulty();
}
return true;
}
