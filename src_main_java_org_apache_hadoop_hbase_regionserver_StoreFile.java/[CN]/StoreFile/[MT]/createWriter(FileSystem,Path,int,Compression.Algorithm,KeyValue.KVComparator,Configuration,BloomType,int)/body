{
  if (!fs.exists(dir)) {
    fs.mkdirs(dir);
  }
  Path path=getUniqueFile(fs,dir);
  if (conf == null || !conf.getBoolean("io.hfile.bloom.enabled",true)) {
    bloomType=BloomType.NONE;
  }
  return new StoreFile.Writer(fs,path,blocksize,algorithm == null ? HFile.DEFAULT_COMPRESSION_ALGORITHM : algorithm,conf,c == null ? KeyValue.COMPARATOR : c,bloomType,maxKeySize);
}
