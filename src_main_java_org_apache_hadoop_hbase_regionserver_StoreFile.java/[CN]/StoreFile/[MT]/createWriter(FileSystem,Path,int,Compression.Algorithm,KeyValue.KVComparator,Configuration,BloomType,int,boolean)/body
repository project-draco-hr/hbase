{
  if (!fs.exists(dir)) {
    fs.mkdirs(dir);
  }
  Path path=getUniqueFile(fs,dir);
  if (conf == null || !conf.getBoolean(IO_STOREFILE_BLOOM_ENABLED,true)) {
    bloomType=BloomType.NONE;
  }
  return new Writer(fs,path,blocksize,algorithm == null ? HFile.DEFAULT_COMPRESSION_ALGORITHM : algorithm,conf,c == null ? KeyValue.COMPARATOR : c,bloomType,maxKeySize,cacheOnWrite);
}
