{
  if (!fs.getFileStatus(dir).isDir()) {
    throw new IOException("Expecting " + dir.toString() + " to be a directory");
  }
  return fs.getFileStatus(dir).isDir() ? getRandomFilename(fs,dir) : dir;
}
