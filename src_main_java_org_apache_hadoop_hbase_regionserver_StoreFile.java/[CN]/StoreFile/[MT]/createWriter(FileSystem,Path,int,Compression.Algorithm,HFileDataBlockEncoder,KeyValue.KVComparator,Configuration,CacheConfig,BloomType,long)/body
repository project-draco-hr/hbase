{
  if (!fs.exists(dir)) {
    fs.mkdirs(dir);
  }
  Path path=getUniqueFile(fs,dir);
  if (!BloomFilterFactory.isGeneralBloomEnabled(conf)) {
    bloomType=BloomType.NONE;
  }
  return new Writer(fs,path,blocksize,algorithm == null ? HFile.DEFAULT_COMPRESSION_ALGORITHM : algorithm,dataBlockEncoder,conf,cacheConf,c == null ? KeyValue.COMPARATOR : c,bloomType,maxKeyCount);
}
