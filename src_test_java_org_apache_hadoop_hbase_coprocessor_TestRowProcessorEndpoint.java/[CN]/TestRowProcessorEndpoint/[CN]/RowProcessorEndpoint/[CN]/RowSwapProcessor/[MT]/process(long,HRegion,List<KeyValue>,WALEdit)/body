{
  List<KeyValue> kvs1=new ArrayList<KeyValue>();
  List<KeyValue> kvs2=new ArrayList<KeyValue>();
  doScan(region,new Scan(row1,row1),kvs1);
  doScan(region,new Scan(row2,row2),kvs2);
  if (swapped) {
    assertEquals(rowSize,kvs2.size());
    assertEquals(row2Size,kvs1.size());
  }
 else {
    assertEquals(rowSize,kvs1.size());
    assertEquals(row2Size,kvs2.size());
  }
  swapped=!swapped;
  List<List<KeyValue>> kvs=new ArrayList<List<KeyValue>>();
  kvs.add(kvs1);
  kvs.add(kvs2);
  byte[][] rows=new byte[][]{row1,row2};
  for (int i=0; i < kvs.size(); ++i) {
    for (    KeyValue kv : kvs.get(i)) {
      KeyValue kvDelete=new KeyValue(rows[i],kv.getFamily(),kv.getQualifier(),kv.getTimestamp(),KeyValue.Type.Delete);
      KeyValue kvAdd=new KeyValue(rows[1 - i],kv.getFamily(),kv.getQualifier(),now,kv.getValue());
      mutations.add(kvDelete);
      walEdit.add(kvDelete);
      mutations.add(kvAdd);
      walEdit.add(kvAdd);
    }
  }
}
