{
  List<KeyValue> kvs=new ArrayList<KeyValue>();
  Scan scan=new Scan(row,row);
  scan.addColumn(FAM,COUNTER);
  doScan(region,scan,kvs);
  counter=kvs.size() == 0 ? 0 : Bytes.toInt(kvs.iterator().next().getValue());
  assertEquals(expectedCounter,counter);
  counter+=1;
  expectedCounter+=1;
  KeyValue kv=new KeyValue(row,FAM,COUNTER,now,Bytes.toBytes(counter));
  mutations.add(kv);
  walEdit.add(kv);
  KeyValue metaKv=new KeyValue(row,HLog.METAFAMILY,Bytes.toBytes("I just increment counter"),Bytes.toBytes(counter));
  walEdit.add(metaKv);
}
