{
  if (isFamilyDir(fs,path)) {
    Path regionDir=path.getParent();
    Path tableDir=regionDir.getParent();
    HTableDescriptor htd=FSTableDescriptors.getTableDescriptor(fs,tableDir);
    HRegion region=loadRegion(fs,conf,htd,regionDir);
    compactStoreFiles(region,path,compactOnce);
  }
 else   if (isRegionDir(fs,path)) {
    Path tableDir=path.getParent();
    HTableDescriptor htd=FSTableDescriptors.getTableDescriptor(fs,tableDir);
    compactRegion(htd,path,compactOnce);
  }
 else   if (isTableDir(fs,path)) {
    compactTable(path,compactOnce);
  }
 else {
    throw new IOException("Specified path is not a table, region or family directory. path=" + path);
  }
}
