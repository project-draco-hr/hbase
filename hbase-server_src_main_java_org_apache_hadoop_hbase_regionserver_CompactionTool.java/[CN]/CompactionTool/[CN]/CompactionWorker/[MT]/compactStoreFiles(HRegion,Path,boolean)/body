{
  LOG.info("Compact table=" + region.getTableDesc().getNameAsString() + " region="+ region.getRegionNameAsString()+ " family="+ familyDir.getName());
  HStore store=getStore(region,familyDir);
  do {
    CompactionContext compaction=store.requestCompaction();
    if (compaction == null)     break;
    List<StoreFile> storeFiles=store.compact(compaction);
    if (storeFiles != null && !storeFiles.isEmpty()) {
      if (keepCompactedFiles && deleteCompacted) {
        for (        StoreFile storeFile : storeFiles) {
          fs.delete(storeFile.getPath(),false);
        }
      }
    }
  }
 while (store.needsCompaction() && !compactOnce);
}
