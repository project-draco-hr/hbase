{
  LOG.info("Compact table=" + region.getTableDesc().getNameAsString() + " region="+ region.getRegionNameAsString()+ " family="+ familyDir.getName());
  HStore store=getStore(region,familyDir);
  do {
    CompactionRequest cr=store.requestCompaction();
    StoreFile storeFile=store.compact(cr);
    if (storeFile != null) {
      if (keepCompactedFiles && deleteCompacted) {
        fs.delete(storeFile.getPath(),false);
      }
    }
  }
 while (store.needsCompaction() && !compactOnce);
}
