{
  this.rss=rss;
  ZooKeeperWatcher zkw=rss.getZooKeeper();
  String nodeName=rss.getServerName().toString();
  this.memberRpcs=new ZKProcedureMemberRpcs(zkw,SnapshotManager.ONLINE_SNAPSHOT_CONTROLLER_DESCRIPTION,nodeName);
  Configuration conf=rss.getConfiguration();
  long wakeMillis=conf.getLong(SNAPSHOT_REQUEST_WAKE_MILLIS_KEY,SNAPSHOT_REQUEST_WAKE_MILLIS_DEFAULT);
  long keepAlive=conf.getLong(SNAPSHOT_TIMEOUT_MILLIS_KEY,SNAPSHOT_TIMEOUT_MILLIS_DEFAULT);
  int opThreads=conf.getInt(SNAPSHOT_REQUEST_THREADS_KEY,SNAPSHOT_REQUEST_THREADS_DEFAULT);
  ThreadPoolExecutor pool=ProcedureMember.defaultPool(wakeMillis,keepAlive,opThreads,nodeName);
  this.member=new ProcedureMember(memberRpcs,pool,new SnapshotSubprocedureBuilder());
  taskManager=new SnapshotSubprocedurePool(rss,conf);
}
