{
  user.runAs(new PrivilegedExceptionAction<Object>(){
    public Object run() throws IOException, InterruptedException {
      closeConnection();
      if (shouldAuthenticateOverKrb()) {
        if (currRetries < maxRetries) {
          LOG.debug("Exception encountered while connecting to " + "the server : " + ex);
          if (UserGroupInformation.isLoginKeytabBased()) {
            UserGroupInformation.getLoginUser().reloginFromKeytab();
          }
 else {
            UserGroupInformation.getLoginUser().reloginFromTicketCache();
          }
          disposeSasl();
          Thread.sleep((rand.nextInt(reloginMaxBackoff) + 1));
          return null;
        }
 else {
          String msg="Couldn't setup connection for " + UserGroupInformation.getLoginUser().getUserName() + " to "+ serverPrincipal;
          LOG.warn(msg);
          throw (IOException)new IOException(msg).initCause(ex);
        }
      }
 else {
        LOG.warn("Exception encountered while connecting to " + "the server : " + ex);
      }
      if (ex instanceof RemoteException)       throw (RemoteException)ex;
      throw new IOException(ex);
    }
  }
);
}
