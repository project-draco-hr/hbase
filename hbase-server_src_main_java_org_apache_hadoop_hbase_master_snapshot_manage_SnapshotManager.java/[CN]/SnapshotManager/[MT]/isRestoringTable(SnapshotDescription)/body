{
  if (!isSnapshotCompleted(snapshot)) {
    throw new UnknownSnapshotException("Snapshot:" + snapshot.getName() + " is not one of the known completed snapshots.");
  }
  SnapshotSentinel sentinel=getRestoreSnapshotSentinel(snapshot.getTable());
  if (sentinel == null) {
    return false;
  }
  if (!sentinel.getSnapshot().getName().equals(snapshot.getName())) {
    return false;
  }
  LOG.debug("Verify snapshot=" + snapshot.getName() + " against="+ sentinel.getSnapshot().getName()+ " table="+ snapshot.getTable());
  ForeignException e=sentinel.getExceptionIfFailed();
  if (e != null)   throw e;
  if (sentinel.isFinished()) {
    LOG.debug("Restore snapshot=" + snapshot + " has completed. Notifying the client.");
    return false;
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("Sentinel is not yet finished with restoring snapshot=" + snapshot);
  }
  return true;
}
