{
  this.conf=conf;
  this.deleteOnExit=deleteOnExit;
  this.shutdownDFS=false;
  if (miniHdfsFilesystem) {
    try {
      this.cluster=new MiniDFSCluster(this.conf,2,format,(String[])null);
      this.fs=cluster.getFileSystem();
      this.shutdownDFS=true;
    }
 catch (    IOException e) {
      StaticTestEnvironment.shutdownDfs(cluster);
      throw e;
    }
  }
 else {
    this.cluster=null;
    this.fs=FileSystem.get(conf);
  }
  init(nRegionNodes);
}
