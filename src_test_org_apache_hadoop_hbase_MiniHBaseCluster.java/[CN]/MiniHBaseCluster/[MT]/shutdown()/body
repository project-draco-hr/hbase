{
  LOG.info("Shutting down the HBase Cluster");
  for (  HRegionServer hsr : this.regionServers) {
    hsr.stop();
  }
  if (master != null) {
    master.shutdown();
  }
  for (  Thread t : this.regionThreads) {
    if (t.isAlive()) {
      try {
        t.join();
      }
 catch (      InterruptedException e) {
      }
    }
  }
  if (masterThread != null) {
    try {
      masterThread.join();
    }
 catch (    InterruptedException e) {
    }
  }
  LOG.info("HBase Cluster shutdown complete");
  if (cluster != null) {
    LOG.info("Shutting down Mini DFS cluster");
    cluster.shutdown();
  }
  if (deleteOnExit) {
    deleteFile(new File(System.getProperty(StaticTestEnvironment.TEST_DIRECTORY_KEY),"dfs"));
  }
}
