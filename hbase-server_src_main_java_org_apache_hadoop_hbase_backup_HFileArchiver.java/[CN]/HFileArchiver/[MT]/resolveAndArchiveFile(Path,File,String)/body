{
  String filename=currentFile.getName();
  Path archiveFile=new Path(archiveDir,filename);
  FileSystem fs=currentFile.getFileSystem();
  if (fs.exists(archiveFile)) {
    if (LOG.isDebugEnabled()) {
      LOG.debug("File:" + archiveFile + " already exists in archive, moving to "+ "timestamped backup and overwriting current.");
    }
    Path backedupArchiveFile=new Path(archiveDir,filename + SEPARATOR + archiveStartTime);
    if (!fs.rename(archiveFile,backedupArchiveFile)) {
      LOG.error("Could not rename archive file to backup: " + backedupArchiveFile + ", deleting existing file in favor of newer.");
      if (!fs.delete(archiveFile,false)) {
        throw new IOException("Couldn't delete existing archive file (" + archiveFile + ") or rename it to the backup file ("+ backedupArchiveFile+ ")to make room for similarly named file.");
      }
    }
    LOG.debug("Backed up archive file from: " + archiveFile);
  }
  LOG.debug("No existing file in archive for:" + archiveFile + ", free to archive original file.");
  if (currentFile.moveAndClose(archiveFile)) {
    LOG.error("Failed to archive file:" + currentFile);
    return false;
  }
 else   if (LOG.isDebugEnabled()) {
    LOG.debug("Finished archiving file from: " + currentFile + ", to: "+ archiveFile);
  }
  return true;
}
