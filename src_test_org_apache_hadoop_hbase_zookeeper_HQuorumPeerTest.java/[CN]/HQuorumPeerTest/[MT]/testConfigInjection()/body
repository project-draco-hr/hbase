{
  String s="tickTime=2000\n" + "initLimit=10\n" + "syncLimit=5\n"+ "dataDir=${hbase.tmp.dir}/zookeeper\n"+ "clientPort=2181\n"+ "server.0=${hbase.master.hostname}:2888:3888\n";
  InputStream is=new ByteArrayInputStream(s.getBytes());
  Properties properties=HQuorumPeer.parseConfig(is);
  String userName=System.getProperty("user.name");
  String dataDir="/tmp/hbase-" + userName + "/zookeeper";
  assertEquals(Integer.valueOf(2000),Integer.valueOf(properties.getProperty("tickTime")));
  assertEquals(Integer.valueOf(10),Integer.valueOf(properties.getProperty("initLimit")));
  assertEquals(Integer.valueOf(5),Integer.valueOf(properties.getProperty("syncLimit")));
  assertEquals(dataDir,properties.get("dataDir"));
  assertEquals(Integer.valueOf(2181),Integer.valueOf(properties.getProperty("clientPort")));
  assertEquals("localhost:2888:3888",properties.get("server.0"));
  QuorumPeerConfig.parseProperties(properties);
  int tickTime=QuorumPeerConfig.getTickTime();
  assertEquals(2000,tickTime);
  int initLimit=QuorumPeerConfig.getInitLimit();
  assertEquals(10,initLimit);
  int syncLimit=QuorumPeerConfig.getSyncLimit();
  assertEquals(5,syncLimit);
  assertEquals(dataDir,ServerConfig.getDataDir());
  assertEquals(2181,ServerConfig.getClientPort());
  Map<Long,QuorumServer> servers=QuorumPeerConfig.getServers();
  assertEquals(1,servers.size());
  assertTrue(servers.containsKey(Long.valueOf(0)));
  QuorumServer server=servers.get(Long.valueOf(0));
  assertEquals("localhost",server.addr.getHostName());
  System.setProperty("hbase.master.hostname","foo.bar");
  is=new ByteArrayInputStream(s.getBytes());
  properties=HQuorumPeer.parseConfig(is);
  assertEquals("foo.bar:2888:3888",properties.get("server.0"));
  QuorumPeerConfig.parseProperties(properties);
  servers=QuorumPeerConfig.getServers();
  server=servers.get(Long.valueOf(0));
  assertEquals("foo.bar",server.addr.getHostName());
  System.setProperty("hbase.master.hostname","local");
  is=new ByteArrayInputStream(s.getBytes());
  properties=HQuorumPeer.parseConfig(is);
  assertEquals("localhost:2888:3888",properties.get("server.0"));
  QuorumPeerConfig.parseProperties(properties);
  servers=QuorumPeerConfig.getServers();
  server=servers.get(Long.valueOf(0));
  assertEquals("localhost",server.addr.getHostName());
}
