{
  byte[] t10=Bytes.toBytes("010");
  byte[] t20=Bytes.toBytes("020");
  byte[] t30=Bytes.toBytes("030");
  byte[] t35=Bytes.toBytes("035");
  byte[] t40=Bytes.toBytes("040");
  memstore.add(getKV(t10,"t10 bytes".getBytes()));
  memstore.add(getKV(t20,"t20 bytes".getBytes()));
  memstore.add(getKV(t30,"t30 bytes".getBytes()));
  memstore.add(getKV(t35,"t35 bytes".getBytes()));
  memstore.add(getDeleteKV(t35));
  memstore.add(getKV(t40,"t40 bytes".getBytes()));
  NavigableSet<KeyValue> results=null;
  results=new TreeSet<KeyValue>(this.memstore.comparator.getComparatorIgnoringType());
  KeyValue t15=new KeyValue(Bytes.toBytes("015"),System.currentTimeMillis());
  memstore.getRowKeyAtOrBefore(t15,results);
  KeyValue kv=results.last();
  assertTrue(KeyValue.COMPARATOR.compareRows(kv,t10) == 0);
  results=new TreeSet<KeyValue>(this.memstore.comparator.getComparatorIgnoringType());
  memstore.getRowKeyAtOrBefore(new KeyValue(t20,System.currentTimeMillis()),results);
  assertTrue(KeyValue.COMPARATOR.compareRows(results.last(),t20) == 0);
  results=new TreeSet<KeyValue>(this.memstore.comparator.getComparatorIgnoringType());
  memstore.getRowKeyAtOrBefore(new KeyValue(t30,System.currentTimeMillis()),results);
  assertTrue(KeyValue.COMPARATOR.compareRows(results.last(),t30) == 0);
  results=new TreeSet<KeyValue>(this.memstore.comparator.getComparatorIgnoringType());
  byte[] t38=Bytes.toBytes("038");
  memstore.getRowKeyAtOrBefore(new KeyValue(t38,System.currentTimeMillis()),results);
  assertTrue(KeyValue.COMPARATOR.compareRows(results.last(),t30) == 0);
  results=new TreeSet<KeyValue>(this.memstore.comparator.getComparatorIgnoringType());
  byte[] t50=Bytes.toBytes("050");
  memstore.getRowKeyAtOrBefore(new KeyValue(t50,System.currentTimeMillis()),results);
  assertTrue(KeyValue.COMPARATOR.compareRows(results.last(),t40) == 0);
}
