{
  if (args.length != 2)   usage();
  try {
    DistributedFileSystem dfs=openConnection(args[0]);
    dfs.delete(path,false);
    HFile.Writer writer=new HFile.Writer(dfs,path,HFile.DEFAULT_BLOCKSIZE,args[1],null);
    writer.append(Bytes.toBytes("testkey"),Bytes.toBytes("testval"));
    writer.appendFileInfo(Bytes.toBytes("infokey"),Bytes.toBytes("infoval"));
    writer.close();
    HFile.Reader reader=new HFile.Reader(dfs,path,null,false,false);
    reader.loadFileInfo();
    byte[] key=reader.getFirstKey();
    boolean rc=Bytes.toString(key).equals("testkey");
    reader.close();
    dfs.delete(path,false);
    closeConnection(dfs);
    if (rc)     System.exit(0);
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
  System.out.println("FAILED");
  System.exit(1);
}
