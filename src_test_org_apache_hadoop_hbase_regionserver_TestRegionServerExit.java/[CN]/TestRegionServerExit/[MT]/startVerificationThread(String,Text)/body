{
  Runnable runnable=new Runnable(){
    public void run(){
      try {
        HTable t=new HTable(conf,HConstants.META_TABLE_NAME);
        Scanner s=t.getScanner(HConstants.COLUMN_FAMILY_ARRAY,new Text());
        s.close();
      }
 catch (      IOException e) {
        LOG.fatal("could not re-open meta table because",e);
        fail();
      }
      Scanner scanner=null;
      try {
        scanner=table.getScanner(HConstants.COLUMN_FAMILY_ARRAY,new Text());
        LOG.info("Obtained scanner " + scanner);
        HStoreKey key=new HStoreKey();
        TreeMap<Text,byte[]> results=new TreeMap<Text,byte[]>();
        for (        RowResult r : scanner) {
          assertTrue(r.getRow().equals(row));
          assertEquals(1,r.size());
          byte[] bytes=r.get(HConstants.COLUMN_FAMILY).getValue();
          assertNotNull(bytes);
          assertTrue(tableName.equals(new String(bytes,HConstants.UTF8_ENCODING)));
        }
        LOG.info("Success!");
      }
 catch (      Exception e) {
        e.printStackTrace();
        fail();
      }
 finally {
        if (scanner != null) {
          LOG.info("Closing scanner " + scanner);
          scanner.close();
        }
      }
    }
  }
;
  return new Thread(runnable);
}
