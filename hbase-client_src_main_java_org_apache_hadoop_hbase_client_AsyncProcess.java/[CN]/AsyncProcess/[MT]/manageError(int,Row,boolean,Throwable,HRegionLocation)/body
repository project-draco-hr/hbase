{
  if (canRetry && throwable != null && throwable instanceof DoNotRetryIOException) {
    canRetry=false;
  }
  byte[] region=null;
  if (canRetry && callback != null) {
    region=location == null ? null : location.getRegionInfo().getEncodedNameAsBytes();
    canRetry=callback.retriableFailure(originalIndex,row,region,throwable);
  }
  if (!canRetry) {
    if (callback != null) {
      if (region == null && location != null) {
        region=location.getRegionInfo().getEncodedNameAsBytes();
      }
      callback.failure(originalIndex,region,row,throwable);
    }
    errors.add(throwable,row,location);
    this.hasError.set(true);
  }
  return canRetry;
}
