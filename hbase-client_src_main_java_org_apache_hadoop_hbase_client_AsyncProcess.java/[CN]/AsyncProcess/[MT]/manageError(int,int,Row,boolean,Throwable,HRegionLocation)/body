{
  if (canRetry) {
    if (numAttempt >= numTries || (throwable != null && throwable instanceof DoNotRetryIOException)) {
      canRetry=false;
    }
  }
  byte[] region=location == null ? null : location.getRegionInfo().getEncodedNameAsBytes();
  if (canRetry && callback != null) {
    canRetry=callback.retriableFailure(originalIndex,row,region,throwable);
  }
  if (canRetry) {
    if (LOG.isTraceEnabled()) {
      retriedErrors.add(throwable,row,location);
    }
  }
 else {
    if (callback != null) {
      callback.failure(originalIndex,region,row,throwable);
    }
    this.hasError.set(true);
    errors.add(throwable,row,location);
  }
  return canRetry;
}
