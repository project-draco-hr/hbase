{
  long lastLog=EnvironmentEdgeManager.currentTimeMillis();
  long currentTasksDone=this.tasksDone.get();
  while ((tasksSent.get() - currentTasksDone) > max) {
    long now=EnvironmentEdgeManager.currentTimeMillis();
    if (now > lastLog + 10000) {
      lastLog=now;
      LOG.info(": Waiting for the global number of running tasks to be equals or less than " + max + ", tasksSent="+ tasksSent.get()+ ", tasksDone="+ tasksDone.get()+ ", currentTasksDone="+ currentTasksDone+ ", tableName="+ tableName);
    }
    waitForNextTaskDone(currentTasksDone);
    currentTasksDone=this.tasksDone.get();
  }
}
