{
  long lastLog=0;
  long currentTasksDone=this.tasksDone.get();
  while ((tasksSent.get() - currentTasksDone) > max) {
    long now=EnvironmentEdgeManager.currentTimeMillis();
    if (now > lastLog + 5000) {
      lastLog=now;
      LOG.info(Bytes.toString(tableName) + ": Waiting for the global number of tasks to be equals or less than " + max+ ", currently it's "+ this.tasksDone.get());
    }
    waitForNextTaskDone(currentTasksDone);
    currentTasksDone=this.tasksDone.get();
  }
  return currentTasksDone;
}
