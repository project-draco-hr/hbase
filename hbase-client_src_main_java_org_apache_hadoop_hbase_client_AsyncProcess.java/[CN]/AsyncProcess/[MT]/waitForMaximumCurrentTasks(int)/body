{
  long lastLog=EnvironmentEdgeManager.currentTimeMillis();
  long currentTasksDone=this.tasksDone.get();
  while ((tasksSent.get() - currentTasksDone) > max) {
    long now=EnvironmentEdgeManager.currentTimeMillis();
    if (now > lastLog + 10000) {
      lastLog=now;
      LOG.info("#" + id + ", waiting for some tasks to finish. Expected max="+ max+ ", tasksSent="+ tasksSent.get()+ ", tasksDone="+ tasksDone.get()+ ", currentTasksDone="+ currentTasksDone+ ", retries="+ retriesCnt.get()+ " hasError="+ hasError()+ ", tableName="+ tableName);
    }
    waitForNextTaskDone(currentTasksDone);
    currentTasksDone=this.tasksDone.get();
  }
}
