{
  if (row == null)   throw new IllegalArgumentException("#" + id + ", row cannot be null");
  RegionLocations loc=hConnection.locateRegionAll(tableName,row.getRow());
  if (loc == null || (checkPrimary && (loc.isEmpty() || loc.getDefaultRegionLocation() == null))) {
    throw new IOException("#" + id + ", no location found, aborting submit for"+ " tableName="+ tableName+ " rowkey="+ Arrays.toString(row.getRow()));
  }
  return loc;
}
