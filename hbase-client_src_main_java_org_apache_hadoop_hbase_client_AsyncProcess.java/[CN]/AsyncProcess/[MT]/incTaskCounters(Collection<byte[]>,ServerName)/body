{
  tasksSent.incrementAndGet();
  AtomicInteger serverCnt=taskCounterPerServer.get(sn);
  if (serverCnt == null) {
    taskCounterPerServer.putIfAbsent(sn,new AtomicInteger());
    serverCnt=taskCounterPerServer.get(sn);
  }
  serverCnt.incrementAndGet();
  for (  byte[] regBytes : regions) {
    String encodedRegionName=HRegionInfo.encodeRegionName(regBytes);
    AtomicInteger regionCnt=taskCounterPerRegion.get(encodedRegionName);
    if (regionCnt == null) {
      taskCounterPerRegion.putIfAbsent(encodedRegionName,new AtomicInteger());
      regionCnt=taskCounterPerRegion.get(encodedRegionName);
    }
    regionCnt.incrementAndGet();
  }
}
