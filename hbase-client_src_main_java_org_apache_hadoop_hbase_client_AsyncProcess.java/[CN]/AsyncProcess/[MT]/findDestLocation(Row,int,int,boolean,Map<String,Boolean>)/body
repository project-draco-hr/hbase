{
  if (row == null) {
    throw new IllegalArgumentException("row cannot be null");
  }
  HRegionLocation loc=null;
  IOException locationException=null;
  try {
    loc=hConnection.locateRegion(this.tableName,row.getRow());
    if (loc == null) {
      locationException=new IOException("No location found, aborting submit for" + " tableName=" + tableName + " rowkey="+ Arrays.toString(row.getRow()));
    }
  }
 catch (  IOException e) {
    locationException=e;
  }
  if (locationException != null) {
    manageError(numAttempt,posInList,row,false,locationException,null);
    return null;
  }
  if (force) {
    return loc;
  }
  String regionName=loc.getRegionInfo().getEncodedName();
  Boolean addIt=regionStatus.get(regionName);
  if (addIt == null) {
    addIt=canTakeNewOperations(regionName);
    regionStatus.put(regionName,addIt);
  }
  return addIt ? loc : null;
}
