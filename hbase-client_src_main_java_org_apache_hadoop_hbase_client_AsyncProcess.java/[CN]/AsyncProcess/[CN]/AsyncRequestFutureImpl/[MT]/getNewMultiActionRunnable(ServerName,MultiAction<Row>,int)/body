{
  if (AsyncProcess.this.connection.getStatisticsTracker() == null) {
    if (connection.getConnectionMetrics() != null) {
      connection.getConnectionMetrics().incrNormalRunners();
    }
    return Collections.singletonList(Trace.wrap("AsyncProcess.sendMultiAction",new SingleServerRequestRunnable(multiAction,numAttempt,server,callsInProgress)));
  }
  Map<Long,DelayingRunner> actions=new HashMap<Long,DelayingRunner>(multiAction.size());
  for (  Map.Entry<byte[],List<Action<Row>>> e : multiAction.actions.entrySet()) {
    Long backoff=getBackoff(server,e.getKey());
    DelayingRunner runner=actions.get(backoff);
    if (runner == null) {
      actions.put(backoff,new DelayingRunner(backoff,e));
    }
 else {
      runner.add(e);
    }
  }
  List<Runnable> toReturn=new ArrayList<Runnable>(actions.size());
  for (  DelayingRunner runner : actions.values()) {
    String traceText="AsyncProcess.sendMultiAction";
    Runnable runnable=new SingleServerRequestRunnable(runner.getActions(),numAttempt,server,callsInProgress);
    if (runner.getSleepTime() > 0) {
      runner.setRunner(runnable);
      traceText="AsyncProcess.clientBackoff.sendMultiAction";
      runnable=runner;
      if (connection.getConnectionMetrics() != null) {
        connection.getConnectionMetrics().incrDelayRunners();
        connection.getConnectionMetrics().updateDelayInterval(runner.getSleepTime());
      }
    }
 else {
      if (connection.getConnectionMetrics() != null) {
        connection.getConnectionMetrics().incrNormalRunners();
      }
    }
    runnable=Trace.wrap(traceText,runnable);
    toReturn.add(runnable);
  }
  return toReturn;
}
