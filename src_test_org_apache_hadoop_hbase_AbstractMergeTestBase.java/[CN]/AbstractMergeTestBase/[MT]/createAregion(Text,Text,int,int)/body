{
  HRegion region=createNewHRegion(dir,conf,desc,startKey,endKey);
  System.out.println("created region " + region.getRegionName());
  HRegionIncommon r=new HRegionIncommon(region);
  for (int i=firstRow; i < firstRow + nrows; i++) {
    long lockid=r.startUpdate(new Text("row_" + String.format("%1$05d",i)));
    r.put(lockid,COLUMN_NAME,value.get());
    r.commit(lockid,System.currentTimeMillis());
    if (i % 10000 == 0) {
      System.out.println("Flushing write #" + i);
      r.flushcache();
    }
  }
  System.out.println("Rolling log...");
  region.log.rollWriter();
  region.compactIfNeeded();
  region.close();
  region.getLog().closeAndDelete();
  region.getRegionInfo().setOffline(true);
  return region;
}
