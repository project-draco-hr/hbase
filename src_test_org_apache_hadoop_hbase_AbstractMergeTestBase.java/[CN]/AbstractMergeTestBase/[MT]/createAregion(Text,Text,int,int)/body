{
  HRegion region=createNewHRegion(fs,dir,conf,desc,rand.nextLong(),startKey,endKey);
  System.out.println("created region " + region.getRegionName());
  for (int i=firstRow; i < firstRow + nrows; i++) {
    long lockid=region.startUpdate(new Text("row_" + String.format("%1$05d",i)));
    region.put(lockid,COLUMN_NAME,value);
    region.commit(lockid);
    if (i % 10000 == 0) {
      System.out.println("Flushing write #" + i);
      region.flushcache(false);
    }
  }
  System.out.println("Rolling log...");
  region.log.rollWriter();
  region.compactStores();
  region.close();
  region.getLog().closeAndDelete();
  region.getRegionInfo().offLine=true;
  return region;
}
