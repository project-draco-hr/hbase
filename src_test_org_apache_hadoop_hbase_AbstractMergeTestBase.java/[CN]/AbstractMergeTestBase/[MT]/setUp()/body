{
  conf.setLong("hbase.hregion.max.filesize",64L * 1024L * 1024L);
  dfsCluster=new MiniDFSCluster(conf,2,true,(String[])null);
  this.conf.set(HConstants.HBASE_DIR,this.dfsCluster.getFileSystem().getHomeDirectory().toString());
  super.setUp();
  try {
    Text row_70001=new Text("row_70001");
    Text row_80001=new Text("row_80001");
    HRegion[] regions={createAregion(null,row_70001,1,70000),createAregion(row_70001,row_80001,70001,10000),createAregion(row_80001,null,80001,10000)};
    HRegion root=HRegion.createHRegion(HRegionInfo.rootRegionInfo,testDir,this.conf);
    HRegion meta=HRegion.createHRegion(HRegionInfo.firstMetaRegionInfo,testDir,this.conf);
    HRegion.addRegionToMETA(root,meta);
    for (int i=0; i < regions.length; i++) {
      HRegion.addRegionToMETA(meta,regions[i]);
    }
    root.close();
    root.getLog().closeAndDelete();
    meta.close();
    meta.getLog().closeAndDelete();
  }
 catch (  Exception e) {
    StaticTestEnvironment.shutdownDfs(dfsCluster);
    throw e;
  }
}
