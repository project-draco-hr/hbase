{
  this.server=server;
  this.conf=this.server.getConfiguration();
  this.replication=isReplication(this.conf);
  if (replication) {
    this.zkHelper=new ReplicationZookeeper(server,this.replicating);
    this.replicationMaster=zkHelper.isReplicationMaster();
    this.replicationManager=this.replicationMaster ? new ReplicationSourceManager(zkHelper,conf,this.server,fs,this.replicating,logDir,oldLogDir) : null;
  }
 else {
    this.replicationManager=null;
    this.zkHelper=null;
  }
}
