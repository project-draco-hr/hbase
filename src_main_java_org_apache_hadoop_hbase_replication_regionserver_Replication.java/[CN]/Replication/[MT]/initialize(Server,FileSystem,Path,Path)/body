{
  this.server=server;
  this.conf=this.server.getConfiguration();
  this.replication=isReplication(this.conf);
  if (replication) {
    try {
      this.zkHelper=new ReplicationZookeeper(server,this.replicating);
    }
 catch (    KeeperException ke) {
      throw new IOException("Failed replication handler create",ke);
    }
    this.replicationManager=new ReplicationSourceManager(zkHelper,conf,this.server,fs,this.replicating,logDir,oldLogDir);
  }
 else {
    this.replicationManager=null;
    this.zkHelper=null;
  }
}
