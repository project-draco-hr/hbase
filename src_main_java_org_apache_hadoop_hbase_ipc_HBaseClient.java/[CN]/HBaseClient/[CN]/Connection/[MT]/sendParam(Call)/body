{
  if (shouldCloseConnection.get()) {
    return;
  }
  try {
    if (LOG.isDebugEnabled())     LOG.debug(getName() + " sending #" + call.id);
    RpcRequest.Builder builder=RPCProtos.RpcRequest.newBuilder();
    builder.setCallId(call.id);
    Invocation invocation=(Invocation)call.param;
    DataOutputBuffer d=new DataOutputBuffer();
    invocation.write(d);
    builder.setRequest(ByteString.copyFrom(d.getData()));
synchronized (this.out) {
      RpcRequest obj=builder.build();
      this.out.writeInt(obj.getSerializedSize());
      obj.writeTo(DataOutputOutputStream.constructOutputStream(this.out));
      this.out.flush();
    }
  }
 catch (  IOException e) {
    markClosed(e);
  }
}
