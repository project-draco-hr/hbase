{
  try {
    Stat stat=this.watcher.getZooKeeper().setData(currentTask,TaskState.TASK_OWNED.get(serverName),currentVersion);
    if (stat == null) {
      return (false);
    }
    currentVersion=stat.getVersion();
    if (LOG.isDebugEnabled()) {
      LOG.debug("hearbeat for path " + currentTask + " successful, version = "+ currentVersion);
    }
    tot_wkr_task_heartbeat.incrementAndGet();
    return (true);
  }
 catch (  KeeperException e) {
    LOG.warn("failed to assert ownership for " + currentTask,e);
  }
catch (  InterruptedException e1) {
    LOG.warn("Interrupted while trying to assert ownership of " + currentTask + " "+ StringUtils.stringifyException(e1));
    Thread.currentThread().interrupt();
  }
  tot_wkr_task_heartbeat_failed.incrementAndGet();
  return (false);
}
