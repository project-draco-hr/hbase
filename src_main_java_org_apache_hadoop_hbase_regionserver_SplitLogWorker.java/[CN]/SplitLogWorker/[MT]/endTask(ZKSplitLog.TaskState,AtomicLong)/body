{
  String path=currentTask;
  currentTask=null;
  try {
    if (ZKUtil.setData(this.watcher,path,ts.get(serverName),currentVersion)) {
      LOG.info("successfully transitioned task " + path + " to final state "+ ts);
      ctr.incrementAndGet();
      return;
    }
    LOG.warn("failed to transistion task " + path + " to end state "+ ts+ " because of version mismatch ");
  }
 catch (  KeeperException.BadVersionException bve) {
    LOG.warn("transisition task " + path + " to "+ ts+ " failed because of version mismatch",bve);
  }
catch (  KeeperException.NoNodeException e) {
    LOG.fatal("logic error - end task " + path + " "+ ts+ " failed because task doesn't exist",e);
  }
catch (  KeeperException e) {
    LOG.warn("failed to end task, " + path + " "+ ts,e);
  }
  tot_wkr_final_transistion_failed.incrementAndGet();
  return;
}
