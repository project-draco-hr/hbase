{
  if (!this.getAllPeerIds().contains(id)) {
    throw new IllegalArgumentException("peer " + id + " doesn't exist");
  }
  String peerStateZNode=getPeerStateNode(id);
  try {
    return ReplicationPeer.isStateEnabled(ZKUtil.getData(this.zookeeper,peerStateZNode));
  }
 catch (  KeeperException e) {
    throw new ReplicationException(e);
  }
catch (  DeserializationException e) {
    throw new ReplicationException(e);
  }
catch (  InterruptedException e) {
    throw new ReplicationException(e);
  }
}
