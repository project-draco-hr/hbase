{
  try {
    if (peerExists(id)) {
      throw new IllegalArgumentException("Cannot add a peer with id=" + id + " because that id already exists.");
    }
    ZKUtil.createWithParents(this.zookeeper,this.peersZNode);
    ZKUtil.createAndWatch(this.zookeeper,ZKUtil.joinZNode(this.peersZNode,id),toByteArray(clusterKey));
    ZKUtil.createNodeIfNotExistsAndWatch(this.zookeeper,getPeerStateNode(id),ENABLED_ZNODE_BYTES);
    String tableCFsStr=(tableCFs == null) ? "" : tableCFs;
    ZKUtil.createNodeIfNotExistsAndWatch(this.zookeeper,getTableCFsNode(id),Bytes.toBytes(tableCFsStr));
  }
 catch (  KeeperException e) {
    throw new ReplicationException("Could not add peer with id=" + id + ", clusterKey="+ clusterKey,e);
  }
}
