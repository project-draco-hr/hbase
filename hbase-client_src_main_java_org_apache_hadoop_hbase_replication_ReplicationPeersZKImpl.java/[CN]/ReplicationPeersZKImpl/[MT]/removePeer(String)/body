{
  try {
    if (!peerExists(id)) {
      throw new IllegalArgumentException("Cannot remove peer with id=" + id + " because that id does not exist.");
    }
    ZKUtil.deleteNodeRecursively(this.zookeeper,ZKUtil.joinZNode(this.peersZNode,id));
    String peerId=ZKUtil.joinZNode(this.hfileRefsZNode,id);
    try {
      LOG.info("Removing peer " + peerId + " from hfile reference queue.");
      ZKUtil.deleteNodeRecursively(this.zookeeper,peerId);
    }
 catch (    NoNodeException e) {
      LOG.info("Did not find node " + peerId + " to delete.",e);
    }
  }
 catch (  KeeperException e) {
    throw new ReplicationException("Could not remove peer with id=" + id,e);
  }
}
