{
  Configuration peerConf=getPeerConf(peerId);
  if (peerConf == null) {
    return null;
  }
  if (this.ourClusterKey.equals(ZKUtil.getZooKeeperClusterKey(peerConf))) {
    LOG.debug("Not connecting to " + peerId + " because it's us");
    return null;
  }
  ReplicationPeer peer=new ReplicationPeer(peerConf,peerId,ZKUtil.getZooKeeperClusterKey(peerConf));
  try {
    peer.startStateTracker(this.zookeeper,this.getPeerStateNode(peerId));
  }
 catch (  KeeperException e) {
    throw new ReplicationException("Error starting the peer state tracker for peerId=" + peerId,e);
  }
  peer.getZkw().registerListener(new PeerRegionServerListener(peer));
  return peer;
}
