{
  Pair<ReplicationPeerConfig,Configuration> pair=getPeerConf(peerId);
  if (pair == null) {
    return null;
  }
  Configuration peerConf=pair.getSecond();
  ReplicationPeerZKImpl peer=new ReplicationPeerZKImpl(peerConf,peerId,pair.getFirst());
  try {
    peer.startStateTracker(this.zookeeper,this.getPeerStateNode(peerId));
  }
 catch (  KeeperException e) {
    throw new ReplicationException("Error starting the peer state tracker for peerId=" + peerId,e);
  }
  try {
    peer.startTableCFsTracker(this.zookeeper,this.getTableCFsNode(peerId));
  }
 catch (  KeeperException e) {
    throw new ReplicationException("Error starting the peer tableCFs tracker for peerId=" + peerId,e);
  }
  return peer;
}
