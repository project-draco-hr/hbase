{
  if (this.getCounter == null) {
    return;
  }
  byte[] serializedMetrics=currentScan.getAttribute(Scan.SCAN_ATTRIBUTES_METRICS_DATA);
  if (serializedMetrics == null || serializedMetrics.length == 0) {
    return;
  }
  ScanMetrics scanMetrics=ProtobufUtil.toScanMetrics(serializedMetrics);
  try {
    for (    Map.Entry<String,Long> entry : scanMetrics.getMetricsMap().entrySet()) {
      Counter ct=(Counter)this.getCounter.invoke(context,HBASE_COUNTER_GROUP_NAME,entry.getKey());
      ct.increment(entry.getValue());
    }
    ((Counter)this.getCounter.invoke(context,HBASE_COUNTER_GROUP_NAME,"NUM_SCANNER_RESTARTS")).increment(numRestarts);
  }
 catch (  Exception e) {
    LOG.debug("can't update counter." + StringUtils.stringifyException(e));
  }
}
