{
  HTableDescriptor tableDescriptor=admin.getTableDescriptor(tableName);
  HColumnDescriptor[] columnDescriptors=tableDescriptor.getColumnFamilies();
  if (columnDescriptors == null || columnDescriptors.length == 0) {
    return;
  }
  Algorithm[] possibleAlgos=Algorithm.values();
  Algorithm algo=possibleAlgos[random.nextInt(possibleAlgos.length)];
  LOG.debug("Performing action: Changing compression algorithms on " + tableName.getNameAsString() + " to "+ algo);
  for (  HColumnDescriptor descriptor : columnDescriptors) {
    if (random.nextBoolean()) {
      descriptor.setCompactionCompressionType(algo);
    }
 else {
      descriptor.setCompressionType(algo);
    }
  }
  admin.modifyTable(tableName,tableDescriptor);
}
