{
  Runnable runnable=new Runnable(){
    public void run(){
      try {
        HTable t=new HTable(conf,HConstants.META_TABLE_NAME);
        HScannerInterface s=t.obtainScanner(HConstants.COLUMN_FAMILY_ARRAY,new Text());
        s.close();
      }
 catch (      IOException e) {
        LOG.fatal("could not re-open meta table because",e);
        fail();
      }
      HScannerInterface scanner=null;
      try {
        scanner=table.obtainScanner(HConstants.COLUMN_FAMILY_ARRAY,new Text());
        LOG.info("Obtained scanner " + scanner);
        HStoreKey key=new HStoreKey();
        TreeMap<Text,byte[]> results=new TreeMap<Text,byte[]>();
        while (scanner.next(key,results)) {
          assertTrue(key.getRow().equals(row));
          assertEquals(1,results.size());
          byte[] bytes=results.get(HConstants.COLUMN_FAMILY);
          assertNotNull(bytes);
          assertTrue(tableName.equals(new String(bytes,HConstants.UTF8_ENCODING)));
        }
        LOG.info("Success!");
      }
 catch (      IOException e) {
        e.printStackTrace();
      }
 finally {
        if (scanner != null) {
          LOG.info("Closing scanner " + scanner);
          try {
            scanner.close();
          }
 catch (          IOException e) {
            e.printStackTrace();
          }
        }
      }
    }
  }
;
  return new Thread(runnable);
}
