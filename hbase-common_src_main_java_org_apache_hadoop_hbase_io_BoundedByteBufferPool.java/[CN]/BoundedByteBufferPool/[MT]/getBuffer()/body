{
  Key key=this.buffers.isEmpty() ? null : this.buffers.firstKey();
  ByteBuffer bb=null;
  if (key == null) {
    bb=ByteBuffer.allocate(this.runningAverage);
  }
 else {
    bb=this.buffers.remove(key);
    if (bb == null)     throw new IllegalStateException();
    bb.clear();
    this.totalReservoirCapacity-=bb.capacity();
  }
  if (LOG.isTraceEnabled()) {
    LOG.trace("runningAverage=" + this.runningAverage + ", totalCapacity="+ this.totalReservoirCapacity+ ", count="+ this.buffers.size());
  }
  return bb;
}
