{
  HLog log=new HLog(fs,dir,this.conf,null);
  TransactionalHLogManager logMangaer=new TransactionalHLogManager(log,fs,regionInfo,conf);
  long transaction1Id=1;
  long transaction2Id=2;
  logMangaer.writeStartToLog(transaction1Id);
  BatchUpdate update1=new BatchUpdate(row1);
  update1.put(col,val1);
  logMangaer.writeUpdateToLog(transaction1Id,update1);
  logMangaer.writeStartToLog(transaction2Id);
  BatchUpdate update2=new BatchUpdate(row2);
  update2.put(col,val2);
  logMangaer.writeUpdateToLog(transaction2Id,update2);
  logMangaer.writeAbortToLog(transaction2Id);
  BatchUpdate update3=new BatchUpdate(row3);
  update3.put(col,val3);
  logMangaer.writeUpdateToLog(transaction1Id,update3);
  logMangaer.writeCommitToLog(transaction1Id);
  log.close();
  Path filename=log.computeFilename(log.getFilenum());
  Map<Long,List<BatchUpdate>> commits=logMangaer.getCommitsFromLog(filename,-1,null);
  assertEquals(1,commits.size());
  assertEquals(2,commits.get(transaction1Id).size());
}
