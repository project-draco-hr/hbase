{
  ScopeWALEntryFilter filter=new ScopeWALEntryFilter();
  Entry userEntry=createEntry(a,b);
  Entry userEntryA=createEntry(a);
  Entry userEntryB=createEntry(b);
  Entry userEntryEmpty=createEntry();
  assertEquals(null,filter.filter(userEntry));
  TreeMap<byte[],Integer> scopes=new TreeMap<byte[],Integer>(Bytes.BYTES_COMPARATOR);
  userEntry=createEntry(a,b);
  userEntry.getKey().setScopes(scopes);
  assertEquals(null,filter.filter(userEntry));
  scopes=new TreeMap<byte[],Integer>(Bytes.BYTES_COMPARATOR);
  scopes.put(c,HConstants.REPLICATION_SCOPE_GLOBAL);
  userEntry=createEntry(a,b);
  userEntry.getKey().setScopes(scopes);
  assertEquals(userEntryEmpty,filter.filter(userEntry));
  scopes=new TreeMap<byte[],Integer>(Bytes.BYTES_COMPARATOR);
  scopes.put(a,HConstants.REPLICATION_SCOPE_LOCAL);
  userEntry=createEntry(a,b);
  userEntry.getKey().setScopes(scopes);
  assertEquals(userEntryEmpty,filter.filter(userEntry));
  scopes.put(b,HConstants.REPLICATION_SCOPE_LOCAL);
  assertEquals(userEntryEmpty,filter.filter(userEntry));
  scopes=new TreeMap<byte[],Integer>(Bytes.BYTES_COMPARATOR);
  scopes.put(a,HConstants.REPLICATION_SCOPE_GLOBAL);
  userEntry=createEntry(a,b);
  userEntry.getKey().setScopes(scopes);
  assertEquals(userEntryA,filter.filter(userEntry));
  scopes.put(b,HConstants.REPLICATION_SCOPE_LOCAL);
  assertEquals(userEntryA,filter.filter(userEntry));
  scopes=new TreeMap<byte[],Integer>(Bytes.BYTES_COMPARATOR);
  scopes.put(b,HConstants.REPLICATION_SCOPE_GLOBAL);
  userEntry=createEntry(a,b);
  userEntry.getKey().setScopes(scopes);
  assertEquals(userEntryB,filter.filter(userEntry));
  scopes.put(a,HConstants.REPLICATION_SCOPE_LOCAL);
  assertEquals(userEntryB,filter.filter(userEntry));
  scopes=new TreeMap<byte[],Integer>(Bytes.BYTES_COMPARATOR);
  scopes.put(b,HConstants.REPLICATION_SCOPE_GLOBAL);
  userEntry=createEntry(a,b);
  userEntry.getKey().setScopes(scopes);
  assertEquals(userEntryB,filter.filter(userEntry));
  scopes.put(a,HConstants.REPLICATION_SCOPE_LOCAL);
  assertEquals(userEntryB,filter.filter(userEntry));
}
