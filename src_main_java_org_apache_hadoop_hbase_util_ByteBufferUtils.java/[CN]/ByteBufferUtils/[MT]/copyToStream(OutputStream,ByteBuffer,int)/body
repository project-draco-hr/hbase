{
  if (buffer.hasArray()) {
    out.write(buffer.array(),buffer.arrayOffset() + buffer.position(),length);
    skip(buffer,length);
  }
 else {
    for (int i=0; i < length; ++i) {
      out.write(buffer.get());
    }
  }
  return length;
}
