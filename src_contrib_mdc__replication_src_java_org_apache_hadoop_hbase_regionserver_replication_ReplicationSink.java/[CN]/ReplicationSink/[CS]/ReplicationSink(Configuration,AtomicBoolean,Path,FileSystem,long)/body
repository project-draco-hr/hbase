{
  this.conf=conf;
  this.pool=new HTablePool(this.conf,10);
  this.stop=stopper;
  this.fs=fs;
  this.path=path;
  long blocksize=conf.getLong("hbase.regionserver.hlog.blocksize",this.fs.getDefaultBlockSize());
  float multi=conf.getFloat("hbase.regionserver.logroll.multiplier",0.95f);
  this.logrollsize=(long)(blocksize * multi);
  this.threadWakeFrequency=threadWakeFrequency;
  rollLog();
}
