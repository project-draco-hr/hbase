{
  final Server server=new MockServer(HTU);
  final MockRegionServerServices rss=new MockRegionServerServices();
  rss.setFileSystem(HTU.getTestFileSystem());
  HTableDescriptor htd=TEST_HTD;
  HRegionInfo hri=TEST_HRI;
  OpenRegion(server,rss,htd,hri);
  int versionOfClosingNode=ZKAssign.createNodeClosing(server.getZooKeeper(),hri,server.getServerName());
  CloseRegionHandler handler=new CloseRegionHandler(server,rss,hri,false,true,versionOfClosingNode);
  handler.process();
  RegionTransitionData data=ZKAssign.getData(server.getZooKeeper(),hri.getEncodedName());
  assertTrue(EventType.RS_ZK_REGION_CLOSED == data.getEventType());
}
