{
  boolean replicationForBulkLoadDataEnabled=conf.getBoolean(HConstants.REPLICATION_BULKLOAD_ENABLE_KEY,HConstants.REPLICATION_BULKLOAD_ENABLE_DEFAULT);
  for (  String id : this.replicationPeers.getPeerIds()) {
    addSource(id);
    if (replicationForBulkLoadDataEnabled) {
      this.replicationQueues.addPeerToHFileRefs(id);
    }
  }
  List<String> currentReplicators=this.replicationQueues.getListOfReplicators();
  if (currentReplicators == null || currentReplicators.size() == 0) {
    return;
  }
  List<String> otherRegionServers=replicationTracker.getListOfRegionServers();
  LOG.info("Current list of replicators: " + currentReplicators + " other RSs: "+ otherRegionServers);
  for (  String rs : currentReplicators) {
    if (!otherRegionServers.contains(rs)) {
      transferQueues(rs);
    }
  }
}
