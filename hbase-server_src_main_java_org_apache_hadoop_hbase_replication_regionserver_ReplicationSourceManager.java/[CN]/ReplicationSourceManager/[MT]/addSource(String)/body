{
  ReplicationSourceInterface src=getReplicationSource(this.conf,this.fs,this,stopper,id);
synchronized (this.hlogsById) {
    this.sources.add(src);
    this.hlogsById.put(id,new TreeSet<String>());
    if (this.latestPath != null) {
      String name=this.latestPath.getName();
      this.hlogsById.get(id).add(name);
      try {
        this.zkHelper.addLogToList(name,src.getPeerClusterZnode());
      }
 catch (      KeeperException ke) {
        String message="Cannot add log to zk for" + " replication when creating a new source";
        stopper.stop(message);
        throw new IOException(message,ke);
      }
      src.enqueueLog(this.latestPath);
    }
  }
  src.startup();
  return src;
}
