{
  LOG.info("Closing the following queue " + id + ", currently have "+ sources.size()+ " and another "+ oldsources.size()+ " that were recovered");
  String terminateMessage="Replication stream was removed by a user";
  List<ReplicationSourceInterface> srcToRemove=new ArrayList<ReplicationSourceInterface>();
  List<ReplicationSourceInterface> oldSourcesToDelete=new ArrayList<ReplicationSourceInterface>();
  for (  ReplicationSourceInterface src : oldsources) {
    if (id.equals(src.getPeerClusterId())) {
      oldSourcesToDelete.add(src);
    }
  }
  for (  ReplicationSourceInterface src : oldSourcesToDelete) {
    src.terminate(terminateMessage);
    closeRecoveredQueue((src));
  }
  LOG.info("Number of deleted recovered sources for " + id + ": "+ oldSourcesToDelete.size());
synchronized (this.replicationPeers) {
    for (    ReplicationSourceInterface src : this.sources) {
      if (id.equals(src.getPeerClusterId())) {
        srcToRemove.add(src);
      }
    }
    if (srcToRemove.size() == 0) {
      LOG.error("The queue we wanted to close is missing " + id);
      return;
    }
    for (    ReplicationSourceInterface toRemove : srcToRemove) {
      toRemove.terminate(terminateMessage);
      this.sources.remove(toRemove);
    }
    deleteSource(id,true);
  }
}
