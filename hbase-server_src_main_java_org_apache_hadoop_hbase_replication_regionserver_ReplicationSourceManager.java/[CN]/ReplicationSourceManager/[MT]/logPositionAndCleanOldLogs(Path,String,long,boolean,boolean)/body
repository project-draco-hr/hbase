{
  String key=log.getName();
  this.zkHelper.writeReplicationStatus(key,id,position);
  if (holdLogInZK) {
    return;
  }
synchronized (this.hlogsById) {
    SortedSet<String> hlogs=this.hlogsById.get(id);
    if (!queueRecovered && !hlogs.first().equals(key)) {
      SortedSet<String> hlogSet=hlogs.headSet(key);
      for (      String hlog : hlogSet) {
        this.zkHelper.removeLogFromList(hlog,id);
      }
      hlogSet.clear();
    }
  }
}
