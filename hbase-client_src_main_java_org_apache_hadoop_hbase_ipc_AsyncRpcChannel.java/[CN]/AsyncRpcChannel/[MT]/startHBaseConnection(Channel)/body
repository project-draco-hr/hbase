{
  ch.pipeline().addLast("frameDecoder",new LengthFieldBasedFrameDecoder(Integer.MAX_VALUE,0,4,0,4));
  ch.pipeline().addLast(new AsyncServerResponseHandler(this));
  try {
    writeChannelHeader(ch).addListener(new GenericFutureListener<ChannelFuture>(){
      @Override public void operationComplete(      ChannelFuture future) throws Exception {
        if (!future.isSuccess()) {
          close(future.cause());
          return;
        }
        for (        AsyncCall call : calls.values()) {
          writeRequest(call);
        }
      }
    }
);
  }
 catch (  IOException e) {
    close(e);
  }
}
