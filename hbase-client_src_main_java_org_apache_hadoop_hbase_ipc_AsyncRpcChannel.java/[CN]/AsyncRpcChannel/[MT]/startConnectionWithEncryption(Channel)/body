{
  ch.pipeline().addFirst("beforeUnwrapDecoder",new LengthFieldBasedFrameDecoder(Integer.MAX_VALUE,0,4,0,0));
  ch.pipeline().addLast("afterUnwrapDecoder",new LengthFieldBasedFrameDecoder(Integer.MAX_VALUE,0,4,0,4));
  ch.pipeline().addLast(new AsyncServerResponseHandler(this));
  List<AsyncCall> callsToWrite;
synchronized (pendingCalls) {
    connected=true;
    callsToWrite=new ArrayList<AsyncCall>(pendingCalls.values());
  }
  for (  AsyncCall call : callsToWrite) {
    writeRequest(call);
  }
}
