{
  HTableDescriptor htd=new HTableDescriptor(TableName.valueOf(tableName));
  htd.setReadOnly(isReadOnly);
  for (  byte[] family : families) {
    HColumnDescriptor hcd=new HColumnDescriptor(family);
    hcd.setMaxVersions(Integer.MAX_VALUE);
    htd.addFamily(hcd);
  }
  htd.setDurability(durability);
  HRegionInfo info=new HRegionInfo(htd.getTableName(),startKey,stopKey,false);
  Path path=new Path(DIR + callingMethod);
  FileSystem fs=FileSystem.get(conf);
  if (fs.exists(path)) {
    if (!fs.delete(path,true)) {
      throw new IOException("Failed delete of " + path);
    }
  }
  return HRegion.createHRegion(info,path,conf,htd,hlog);
}
