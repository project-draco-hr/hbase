{
  this.region=initHRegion(tableName,getName(),conf,fam1);
  try {
    EnvironmentEdgeManagerTestHelper.injectEdge(new IncrementingEnvironmentEdge());
    Put put=new Put(row);
    put.add(fam1,qual1,value1);
    region.put(put);
    region.delete(delete);
    put=new Put(row);
    put.add(fam1,qual1,value2);
    region.put(put);
    Get get=new Get(row);
    get.addColumn(fam1,qual1);
    Result r=region.get(get);
    assertEquals(1,r.size());
    assertByteEquals(value2,r.getValue(fam1,qual1));
    Scan scan=new Scan(row);
    scan.addColumn(fam1,qual1);
    InternalScanner s=region.getScanner(scan);
    List<Cell> results=new ArrayList<Cell>();
    assertEquals(false,s.next(results));
    assertEquals(1,results.size());
    Cell kv=results.get(0);
    assertByteEquals(value2,CellUtil.getValueArray(kv));
    assertByteEquals(fam1,CellUtil.getFamilyArray(kv));
    assertByteEquals(qual1,CellUtil.getQualifierArray(kv));
    assertByteEquals(row,CellUtil.getRowArray(kv));
  }
  finally {
    HRegion.closeHRegion(this.region);
    this.region=null;
  }
}
