{
  String method="testCompactionAffectedByScanners";
  byte[] tableName=Bytes.toBytes(method);
  byte[] family=Bytes.toBytes("family");
  this.region=initHRegion(tableName,method,conf,family);
  Put put=new Put(Bytes.toBytes("r1"));
  put.add(family,Bytes.toBytes("q1"),Bytes.toBytes("v1"));
  region.put(put);
  region.flushcache();
  Scan scan=new Scan();
  scan.setMaxVersions(3);
  RegionScanner scanner1=region.getScanner(scan);
  Delete delete=new Delete(Bytes.toBytes("r1"));
  region.delete(delete,false);
  region.flushcache();
  RegionScanner scanner2=region.getScanner(scan);
  List<KeyValue> results=new ArrayList<KeyValue>();
  System.out.println("Smallest read point:" + region.getSmallestReadPoint());
  region.compactStores(true);
  RegionScanner scanner3=region.getScanner(scan);
  scanner1.next(results);
  System.out.println(results);
  assertEquals(1,results.size());
  results.clear();
  scanner2.next(results);
  System.out.println(results);
  assertEquals(0,results.size());
  results.clear();
  scanner3.next(results);
  System.out.println(results);
  assertEquals(0,results.size());
}
