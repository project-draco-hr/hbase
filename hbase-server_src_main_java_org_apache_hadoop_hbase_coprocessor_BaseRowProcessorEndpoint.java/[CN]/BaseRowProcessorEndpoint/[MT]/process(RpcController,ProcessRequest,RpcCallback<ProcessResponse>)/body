{
  ProcessResponse resultProto=null;
  try {
    RowProcessor<S,T> processor=constructRowProcessorFromRequest(request);
    HRegion region=env.getRegion();
    region.processRowsWithLocks(processor);
    T result=processor.getResult();
    ProcessResponse.Builder b=ProcessResponse.newBuilder();
    b.setRowProcessorResult(result.toByteString());
    resultProto=b.build();
  }
 catch (  Exception e) {
    ResponseConverter.setControllerException(controller,new IOException(e));
  }
  done.run(resultProto);
}
