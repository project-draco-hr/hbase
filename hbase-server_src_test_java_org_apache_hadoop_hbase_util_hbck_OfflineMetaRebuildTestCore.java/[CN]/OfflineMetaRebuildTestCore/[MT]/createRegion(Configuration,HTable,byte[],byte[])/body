{
  HTable meta=new HTable(conf,HConstants.META_TABLE_NAME);
  HTableDescriptor htd=htbl.getTableDescriptor();
  HRegionInfo hri=new HRegionInfo(htbl.getTableName(),startKey,endKey);
  LOG.info("manually adding regioninfo and hdfs data: " + hri.toString());
  Path rootDir=new Path(conf.get(HConstants.HBASE_DIR));
  FileSystem fs=rootDir.getFileSystem(conf);
  Path p=new Path(rootDir + "/" + htd.getNameAsString(),hri.getEncodedName());
  fs.mkdirs(p);
  Path riPath=new Path(p,HRegion.REGIONINFO_FILE);
  FSDataOutputStream out=fs.create(riPath);
  out.write(hri.toDelimitedByteArray());
  out.close();
  Put put=new Put(hri.getRegionName());
  put.add(HConstants.CATALOG_FAMILY,HConstants.REGIONINFO_QUALIFIER,Writables.getBytes(hri));
  meta.put(put);
  meta.flushCommits();
  return hri;
}
