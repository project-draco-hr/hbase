{
  long period=Long.MAX_VALUE;
  Path snapshotDir=SnapshotDescriptionUtils.getSnapshotsDir(rootDir);
  SnapshotFileCache cache=new SnapshotFileCache(fs,rootDir,period,10000000,"test-snapshot-file-cache-refresh",new SnapshotFileCache.SnapshotFileInspector(){
    public Collection<String> filesUnderSnapshot(    final Path snapshotDir) throws IOException {
      return SnapshotReferenceUtil.getHLogNames(fs,snapshotDir);
    }
  }
);
  Path snapshot=new Path(snapshotDir,"snapshot");
  Path region=new Path(snapshot,"7e91021");
  Path family=new Path(region,"fam");
  Path file1=new Path(family,"file1");
  fs.create(file1);
  Path logs=TakeSnapshotUtils.getSnapshotHLogsDir(snapshot,"server");
  Path log=new Path(logs,"me.hbase.com%2C58939%2C1350424310315.1350424315552");
  fs.create(log);
  FSUtils.logFileSystemState(fs,rootDir,LOG);
  assertFalse("Cache found '" + file1 + "', but it shouldn't have.",cache.contains(file1.getName()));
  assertTrue("Cache didn't find:" + log,cache.contains(log.getName()));
}
