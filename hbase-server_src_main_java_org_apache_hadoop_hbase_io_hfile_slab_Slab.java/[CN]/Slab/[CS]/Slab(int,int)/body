{
  buffers=new LinkedBlockingQueue<ByteBuffer>();
  slabs=new ConcurrentLinkedQueue<ByteBuffer>();
  this.blockSize=blockSize;
  this.numBlocks=numBlocks;
  this.heapSize=ClassSize.estimateBase(this.getClass(),false);
  int maxBlocksPerSlab=Integer.MAX_VALUE / blockSize;
  int maxSlabSize=maxBlocksPerSlab * blockSize;
  int numFullSlabs=numBlocks / maxBlocksPerSlab;
  int partialSlabSize=(numBlocks % maxBlocksPerSlab) * blockSize;
  for (int i=0; i < numFullSlabs; i++) {
    allocateAndSlice(maxSlabSize,blockSize);
  }
  if (partialSlabSize > 0) {
    allocateAndSlice(partialSlabSize,blockSize);
  }
}
