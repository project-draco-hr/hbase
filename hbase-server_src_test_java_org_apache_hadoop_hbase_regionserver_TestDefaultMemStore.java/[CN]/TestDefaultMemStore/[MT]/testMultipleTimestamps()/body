{
  long[] timestamps=new long[]{20,10,5,1};
  Scan scan=new Scan();
  for (  long timestamp : timestamps)   addRows(memstore,timestamp);
  byte[] fam=Bytes.toBytes("fam");
  HColumnDescriptor hcd=mock(HColumnDescriptor.class);
  when(hcd.getName()).thenReturn(fam);
  Store store=mock(Store.class);
  when(store.getFamily()).thenReturn(hcd);
  scan.setColumnFamilyTimeRange(fam,0,2);
  assertTrue(memstore.shouldSeek(scan,store,Long.MIN_VALUE));
  scan.setColumnFamilyTimeRange(fam,20,82);
  assertTrue(memstore.shouldSeek(scan,store,Long.MIN_VALUE));
  scan.setColumnFamilyTimeRange(fam,10,20);
  assertTrue(memstore.shouldSeek(scan,store,Long.MIN_VALUE));
  scan.setColumnFamilyTimeRange(fam,8,12);
  assertTrue(memstore.shouldSeek(scan,store,Long.MIN_VALUE));
  scan.setColumnFamilyTimeRange(fam,28,42);
  assertTrue(!memstore.shouldSeek(scan,store,Long.MIN_VALUE));
}
