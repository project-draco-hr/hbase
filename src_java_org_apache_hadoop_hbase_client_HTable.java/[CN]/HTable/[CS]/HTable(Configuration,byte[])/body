{
  this.tableName=tableName;
  if (conf == null) {
    this.scannerTimeout=0;
    this.connection=null;
    return;
  }
  this.connection=HConnectionManager.getConnection(conf);
  this.scannerTimeout=conf.getInt("hbase.regionserver.lease.period",60 * 1000);
  this.configuration=conf;
  this.connection.locateRegion(tableName,HConstants.EMPTY_START_ROW);
  this.writeBufferSize=conf.getLong("hbase.client.write.buffer",2097152);
  this.autoFlush=true;
  this.currentWriteBufferSize=0;
  this.scannerCaching=conf.getInt("hbase.client.scanner.caching",1);
  this.maxScannerResultSize=conf.getLong(HConstants.HBASE_CLIENT_SCANNER_MAX_RESULT_SIZE_KEY,HConstants.DEFAULT_HBASE_CLIENT_SCANNER_MAX_RESULT_SIZE);
  this.maxKeyValueSize=conf.getInt("hbase.client.keyvalue.maxsize",-1);
}
