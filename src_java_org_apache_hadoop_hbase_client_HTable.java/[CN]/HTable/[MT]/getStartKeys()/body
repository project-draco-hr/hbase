{
  List<Text> keyList=new ArrayList<Text>();
  long scannerId=-1L;
  Text startRow=new Text(tableName.toString() + ",,999999999999999");
  HRegionLocation metaLocation=null;
  HRegionInterface server;
  do {
    try {
      metaLocation=connection.locateRegion(META_TABLE_NAME,startRow);
      server=connection.getHRegionConnection(metaLocation.getServerAddress());
      scannerId=server.openScanner(metaLocation.getRegionInfo().getRegionName(),new Text[]{COL_REGIONINFO},tableName,LATEST_TIMESTAMP,null);
      while (true) {
        RowResult values=server.next(scannerId);
        if (values == null || values.size() == 0) {
          break;
        }
        HRegionInfo info=new HRegionInfo();
        info=(HRegionInfo)Writables.getWritable(values.get(COL_REGIONINFO).getValue(),info);
        if (!info.getTableDesc().getName().equals(this.tableName)) {
          break;
        }
        if (info.isOffline() || info.isSplit()) {
          continue;
        }
 else {
          keyList.add(info.getStartKey());
        }
      }
      server.close(scannerId);
      startRow=metaLocation.getRegionInfo().getEndKey();
    }
 catch (    IOException e) {
      throw e;
    }
  }
 while (startRow.compareTo(EMPTY_START_ROW) != 0);
  Text[] arr=new Text[keyList.size()];
  for (int i=0; i < keyList.size(); i++) {
    arr[i]=keyList.get(i);
  }
  return arr;
}
