{
  HashMap<HRegionInfo,HServerAddress> regionMap=new HashMap<HRegionInfo,HServerAddress>();
  long scannerId=-1L;
  Text startRow=new Text(tableName.toString() + ",,999999999999999");
  HRegionLocation metaLocation=null;
  HRegionInterface server;
  do {
    try {
      metaLocation=connection.locateRegion(META_TABLE_NAME,startRow);
      server=connection.getHRegionConnection(metaLocation.getServerAddress());
      scannerId=server.openScanner(metaLocation.getRegionInfo().getRegionName(),new Text[]{COL_REGIONINFO},tableName,LATEST_TIMESTAMP,null);
      while (true) {
        RowResult values=server.next(scannerId);
        if (values == null || values.size() == 0) {
          break;
        }
        HRegionInfo info=new HRegionInfo();
        info=(HRegionInfo)Writables.getWritable(values.get(COL_REGIONINFO).getValue(),info);
        if (!info.getTableDesc().getName().equals(this.tableName)) {
          break;
        }
        if (info.isOffline() || info.isSplit()) {
          continue;
        }
        regionMap.put(info,metaLocation.getServerAddress());
      }
      server.close(scannerId);
      startRow=metaLocation.getRegionInfo().getEndKey();
    }
 catch (    IOException e) {
      throw e;
    }
  }
 while (startRow.compareTo(EMPTY_START_ROW) != 0);
  return regionMap;
}
