{
  final HashMap<HRegionInfo,HServerAddress> regionMap=new HashMap<HRegionInfo,HServerAddress>();
  MetaScannerVisitor visitor=new MetaScannerVisitor(){
    public boolean processRow(    @SuppressWarnings("unused") RowResult rowResult,    HRegionLocation metaLocation,    HRegionInfo hri){
      HRegionInfo info=new UnmodifyableHRegionInfo(hri);
      if (!(Bytes.equals(info.getTableDesc().getName(),getTableName()))) {
        return false;
      }
      if (!(info.isOffline() || info.isSplit())) {
        regionMap.put(info,metaLocation.getServerAddress());
      }
      return true;
    }
  }
;
  MetaScanner.metaScan(configuration,visitor,tableName);
  return regionMap;
}
