{
  Scan scan=filter == null ? new Scan(startRow) : filter instanceof WhileMatchRowFilter && ((WhileMatchRowFilter)filter).getInternalFilter() instanceof StopRowFilter ? new Scan(startRow,((StopRowFilter)((WhileMatchRowFilter)filter).getInternalFilter()).getStopRowKey()) : null;
  for (int i=0; i < columns.length; i++) {
    byte[][] splits=KeyValue.parseColumn(columns[i]);
    if (splits[1].length == 0) {
      scan.addFamily(splits[0]);
    }
 else {
      scan.addColumn(splits[0],splits[1]);
    }
  }
  OldClientScanner s=new OldClientScanner(new ClientScanner(scan));
  s.initialize();
  return s;
}
