{
  checkRowAndColumns(batchUpdate);
  if (rl != null) {
    batchUpdate.setRowLock(rl.getLockId());
  }
  writeBuffer.add(batchUpdate);
  currentWriteBufferSize+=batchUpdate.heapSize();
  if (autoFlush || currentWriteBufferSize > writeBufferSize) {
    flushCommits();
  }
}
