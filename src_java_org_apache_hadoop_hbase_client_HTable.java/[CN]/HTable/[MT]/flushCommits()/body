{
  int last=0;
  try {
    last=connection.processBatchOfRows(writeBuffer,tableName);
  }
  finally {
    writeBuffer.subList(0,last).clear();
    currentWriteBufferSize=0;
    for (int i=0; i < writeBuffer.size(); i++) {
      currentWriteBufferSize+=writeBuffer.get(i).heapSize();
    }
  }
}
