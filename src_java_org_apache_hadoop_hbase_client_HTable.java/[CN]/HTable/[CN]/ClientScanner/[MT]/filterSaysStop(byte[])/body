{
  if (scan.getStopRow().length > 0) {
    byte[] stopRow=scan.getStopRow();
    int cmp=Bytes.compareTo(stopRow,0,stopRow.length,endKey,0,endKey.length);
    if (cmp <= 0) {
      return true;
    }
  }
  if (!scan.hasFilter()) {
    return false;
  }
  if (scan.getFilter() != null) {
    scan.getFilter().filterRowKey(endKey,0,endKey.length);
    return scan.getFilter().filterAllRemaining();
  }
  if (scan.getOldFilter() != null) {
    scan.getOldFilter().filterRowKey(endKey,0,endKey.length);
    return scan.getOldFilter().filterAllRemaining();
  }
  return false;
}
