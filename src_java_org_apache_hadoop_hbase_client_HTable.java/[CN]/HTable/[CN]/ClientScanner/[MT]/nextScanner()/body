{
  if (this.callable != null) {
    this.callable.setClose();
    connection.getRegionServerWithRetries(callable);
    this.callable=null;
  }
  if (currentRegion != null) {
    if (LOG.isDebugEnabled()) {
      LOG.debug("Advancing forward from region " + currentRegion);
    }
    byte[] endKey=currentRegion.getEndKey();
    if (endKey == null || Bytes.equals(endKey,EMPTY_BYTE_ARRAY)) {
      close();
      return false;
    }
  }
  HRegionInfo oldRegion=this.currentRegion;
  byte[] localStartKey=oldRegion == null ? startRow : oldRegion.getEndKey();
  if (LOG.isDebugEnabled()) {
    LOG.debug("Advancing internal scanner to startKey at " + Bytes.toString(localStartKey));
  }
  try {
    callable=new ScannerCallable(connection,tableName,columns,localStartKey,scanTime,filter);
    connection.getRegionServerWithRetries(callable);
    currentRegion=callable.getHRegionInfo();
  }
 catch (  IOException e) {
    close();
    throw e;
  }
  return true;
}
