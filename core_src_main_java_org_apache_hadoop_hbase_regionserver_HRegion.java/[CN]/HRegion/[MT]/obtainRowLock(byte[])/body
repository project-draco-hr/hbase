{
  checkRow(row);
  splitsAndClosesLock.readLock().lock();
  try {
    if (this.closed.get()) {
      throw new NotServingRegionException("Region " + this + " closed");
    }
    Integer key=Bytes.mapKey(row);
synchronized (locksToRows) {
      while (locksToRows.containsKey(key)) {
        try {
          locksToRows.wait();
        }
 catch (        InterruptedException ie) {
        }
      }
      locksToRows.put(key,row);
      locksToRows.notifyAll();
      return key;
    }
  }
  finally {
    splitsAndClosesLock.readLock().unlock();
  }
}
