{
  checkReadOnly();
  checkResources();
  splitsAndClosesLock.readLock().lock();
  Integer lid=null;
  try {
    byte[] row=delete.getRow();
    lid=getLock(lockid,row);
    if (delete.getFamilyMap().isEmpty()) {
      for (      byte[] family : regionInfo.getTableDesc().getFamiliesKeys()) {
        delete.deleteFamily(family,delete.getTimeStamp());
      }
    }
 else {
      for (      byte[] family : delete.getFamilyMap().keySet()) {
        if (family == null) {
          throw new NoSuchColumnFamilyException("Empty family is invalid");
        }
        checkFamily(family);
      }
    }
    delete(delete.getFamilyMap(),writeToWAL);
  }
  finally {
    if (lockid == null)     releaseRowLock(lid);
    splitsAndClosesLock.readLock().unlock();
  }
}
