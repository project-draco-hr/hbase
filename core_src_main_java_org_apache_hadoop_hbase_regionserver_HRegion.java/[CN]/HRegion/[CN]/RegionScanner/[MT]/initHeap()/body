{
  List<KeyValueScanner> scanners=new ArrayList<KeyValueScanner>();
  if (extraScanners != null) {
    scanners.addAll(extraScanners);
  }
  for (  Map.Entry<byte[],NavigableSet<byte[]>> entry : theScan.getFamilyMap().entrySet()) {
    Store store=stores.get(entry.getKey());
    scanners.add(store.getScanner(theScan,entry.getValue()));
  }
  this.storeHeap=new KeyValueHeap(scanners.toArray(new KeyValueScanner[0]),comparator);
}
