{
  HTableDescriptor htd=createTableDescriptor(getName(),0,3,HConstants.FOREVER,true);
  HRegion region=createNewHRegion(htd,null,null);
  long ts=System.currentTimeMillis();
  Put p=new Put(T1,ts);
  p.add(c0,c0,T1);
  region.put(p);
  p=new Put(T1,ts + 2);
  p.add(c0,c0,T2);
  region.put(p);
  p=new Put(T1,ts + 4);
  p.add(c0,c0,T3);
  region.put(p);
  Delete d=new Delete(T1,ts + 1,null);
  region.delete(d,null,true);
  d=new Delete(T1,ts + 2,null);
  d.deleteColumn(c0,c0,ts + 2);
  region.delete(d,null,true);
  d=new Delete(T1,ts + 3,null);
  d.deleteColumns(c0,c0,ts + 3);
  region.delete(d,null,true);
  Scan s=new Scan();
  s.setRaw(true);
  s.setMaxVersions();
  InternalScanner scan=region.getScanner(s);
  List<KeyValue> kvs=new ArrayList<KeyValue>();
  scan.next(kvs);
  assertTrue(kvs.get(0).isDeleteFamily());
  assertEquals(kvs.get(1).getValue(),T3);
  assertTrue(kvs.get(2).isDelete());
  assertTrue(kvs.get(3).isDeleteType());
  assertEquals(kvs.get(4).getValue(),T2);
  assertEquals(kvs.get(5).getValue(),T1);
  HRegion.closeHRegion(region);
}
