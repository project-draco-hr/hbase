{
  Delete d=new Delete(tableName);
  byte[] key=null;
  if (perm.getFamily() != null && perm.getFamily().length > 0) {
    key=Bytes.toBytes(userName + ACL_KEY_DELIMITER + Bytes.toString(perm.getFamily()));
    if (perm.getQualifier() != null && perm.getQualifier().length > 0) {
      key=Bytes.toBytes(userName + ACL_KEY_DELIMITER + Bytes.toString(perm.getFamily())+ ACL_KEY_DELIMITER+ Bytes.toString(perm.getQualifier()));
    }
 else {
      key=Bytes.toBytes(userName + ACL_KEY_DELIMITER + Bytes.toString(perm.getFamily()));
    }
  }
 else {
    key=Bytes.toBytes(userName);
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("Removing permission for user '" + userName + "': "+ perm.toString());
  }
  d.deleteColumns(ACL_LIST_FAMILY,key);
  HTable acls=null;
  try {
    acls=new HTable(conf,ACL_TABLE_NAME);
    acls.delete(d);
  }
  finally {
    if (acls != null)     acls.close();
  }
}
