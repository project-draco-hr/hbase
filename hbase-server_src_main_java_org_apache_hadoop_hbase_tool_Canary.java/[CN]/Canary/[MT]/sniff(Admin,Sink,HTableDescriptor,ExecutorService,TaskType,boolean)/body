{
  if (LOG.isDebugEnabled()) {
    LOG.debug(String.format("reading list of regions for table %s",tableDesc.getTableName()));
  }
  Table table=null;
  try {
    table=admin.getConnection().getTable(tableDesc.getTableName());
  }
 catch (  TableNotFoundException e) {
    return new ArrayList<Future<Void>>();
  }
  List<RegionTask> tasks=new ArrayList<RegionTask>();
  try {
    List<HRegionInfo> hris=admin.getTableRegions(tableDesc.getTableName());
    if (hris != null) {
      for (      HRegionInfo region : hris) {
        tasks.add(new RegionTask(admin.getConnection(),region,sink,taskType,rawScanEnabled));
      }
    }
  }
  finally {
    table.close();
  }
  return executor.invokeAll(tasks);
}
