{
  boolean enabled=false;
  long start=EnvironmentEdgeManager.currentTimeMillis();
  for (int tries=0; tries < (this.numRetries * this.retryLongerMultiplier); tries++) {
    try {
      enabled=isTableEnabled(tableName);
    }
 catch (    TableNotFoundException tnfe) {
      enabled=false;
    }
    enabled=enabled && isTableAvailable(tableName);
    if (enabled) {
      break;
    }
    long sleep=getPauseTime(tries);
    if (LOG.isDebugEnabled()) {
      LOG.debug("Sleeping= " + sleep + "ms, waiting for all regions to be "+ "enabled in "+ tableName);
    }
    try {
      Thread.sleep(sleep);
    }
 catch (    InterruptedException e) {
      throw (InterruptedIOException)new InterruptedIOException("Interrupted").initCause(e);
    }
  }
  if (!enabled) {
    long msec=EnvironmentEdgeManager.currentTimeMillis() - start;
    throw new IOException("Table '" + tableName + "' not yet enabled, after "+ msec+ "ms.");
  }
}
