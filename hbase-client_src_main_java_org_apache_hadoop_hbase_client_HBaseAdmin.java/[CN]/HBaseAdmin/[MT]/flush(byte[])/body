{
  CatalogTracker ct=getCatalogTracker();
  try {
    Pair<HRegionInfo,ServerName> regionServerPair=getRegion(tableNameOrRegionName,ct);
    if (regionServerPair != null) {
      if (regionServerPair.getSecond() == null) {
        throw new NoServerForRegionException(Bytes.toStringBinary(tableNameOrRegionName));
      }
 else {
        flush(regionServerPair.getSecond(),regionServerPair.getFirst());
      }
    }
 else {
      final TableName tableName=checkTableExists(TableName.valueOf(tableNameOrRegionName),ct);
      if (isTableDisabled(tableName)) {
        LOG.info("Table is disabled: " + tableName.getNameAsString());
        return;
      }
      execProcedure("flush-table-proc",tableName.getNameAsString(),new HashMap<String,String>());
    }
  }
  finally {
    cleanupCatalogTracker(ct);
  }
}
