{
  waitForState(deadlineTs,new WaitForStateCallable(){
    @Override public boolean checkState(    int tries) throws IOException {
      boolean enabled;
      try {
        enabled=getAdmin().isTableEnabled(tableName);
      }
 catch (      TableNotFoundException tnfe) {
        return false;
      }
      return enabled && getAdmin().isTableAvailable(tableName);
    }
    @Override public void throwInterruptedException() throws InterruptedIOException {
      throw new InterruptedIOException("Interrupted when waiting for table to be enabled");
    }
    @Override public void throwTimeoutException(    long elapsedTime) throws TimeoutException {
      throw new TimeoutException("Table " + tableName + " not yet enabled after "+ elapsedTime+ "msec");
    }
  }
);
}
