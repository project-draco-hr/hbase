{
  HTablePool pool=new HTablePool(TEST_UTIL.getConfiguration(),4,getPoolType());
  HBaseAdmin admin=new HBaseAdmin(TEST_UTIL.getConfiguration());
  if (admin.tableExists(TABLENAME)) {
    admin.disableTable(TABLENAME);
    admin.deleteTable(TABLENAME);
  }
  HTableDescriptor tableDescriptor=new HTableDescriptor(TableName.valueOf(TABLENAME));
  tableDescriptor.addFamily(new HColumnDescriptor("randomFamily"));
  admin.createTable(tableDescriptor);
  Table[] tables=new Table[4];
  for (int i=0; i < 4; ++i) {
    tables[i]=pool.getTable(TABLENAME);
  }
  pool.closeTablePool(TABLENAME);
  for (int i=0; i < 4; ++i) {
    tables[i].close();
  }
  Assert.assertEquals(1,pool.getCurrentPoolSize(Bytes.toString(TABLENAME)));
  pool.closeTablePool(TABLENAME);
  Assert.assertEquals(0,pool.getCurrentPoolSize(Bytes.toString(TABLENAME)));
}
