{
  if (list.isEmpty()) {
    return 0;
  }
  if (list.size() > 1) {
    Collections.sort(list);
  }
  Batch b=new Batch(this){
    @SuppressWarnings("unchecked") @Override int doCall(    final List<? extends Row> currentList,    final byte[] row,    final byte[] tableName) throws IOException, RuntimeException {
      final List<Put> puts=(List<Put>)currentList;
      return getRegionServerWithRetries(new ServerCallable<Integer>(this.c,tableName,row){
        public Integer call() throws IOException {
          return server.put(location.getRegionInfo().getRegionName(),puts);
        }
      }
);
    }
  }
;
  return b.process(list,tableName);
}
