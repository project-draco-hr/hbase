{
  ZooKeeperWatcher zk;
  try {
    zk=getZooKeeperWatcher();
  }
 catch (  IOException e) {
    throw new ZooKeeperConnectionException(e);
  }
  HServerAddress rootRegionAddress=null;
  for (int tries=0; tries < numRetries; tries++) {
    int localTimeouts=0;
    while (rootRegionAddress == null && localTimeouts < numRetries) {
      try {
        rootRegionAddress=ZKUtil.getDataAsAddress(zk,zk.rootServerZNode);
      }
 catch (      KeeperException e) {
        LOG.error("Unexpected ZooKeeper error attempting to read the root " + "region server address");
        throw new IOException(e);
      }
      if (rootRegionAddress == null) {
        try {
          if (LOG.isDebugEnabled()) {
            LOG.debug("Sleeping " + getPauseTime(tries) + "ms, waiting for root region.");
          }
          Thread.sleep(getPauseTime(tries));
        }
 catch (        InterruptedException iex) {
        }
        localTimeouts++;
      }
    }
    if (rootRegionAddress == null) {
      throw new NoServerForRegionException("Timed out trying to locate root region");
    }
    try {
      HRegionInterface server=getHRegionConnection(rootRegionAddress);
      server.getRegionInfo(HRegionInfo.ROOT_REGIONINFO.getRegionName());
      if (LOG.isDebugEnabled()) {
        LOG.debug("Found ROOT at " + rootRegionAddress);
      }
      break;
    }
 catch (    Throwable t) {
      t=translateException(t);
      if (tries == numRetries - 1) {
        throw new NoServerForRegionException("Timed out trying to locate " + "root region because: " + t.getMessage());
      }
      try {
        if (LOG.isDebugEnabled()) {
          LOG.debug("Root region location changed. Sleeping.");
        }
        Thread.sleep(getPauseTime(tries));
        if (LOG.isDebugEnabled()) {
          LOG.debug("Wake. Retry finding root region.");
        }
      }
 catch (      InterruptedException iex) {
      }
    }
    rootRegionAddress=null;
  }
  if (rootRegionAddress == null) {
    throw new NoServerForRegionException("unable to locate root region server");
  }
  return new HRegionLocation(HRegionInfo.ROOT_REGIONINFO,rootRegionAddress);
}
