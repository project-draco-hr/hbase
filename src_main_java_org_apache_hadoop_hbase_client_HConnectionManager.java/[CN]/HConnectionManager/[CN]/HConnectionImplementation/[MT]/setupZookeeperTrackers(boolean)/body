{
  this.zooKeeper=getZooKeeperWatcher();
  this.masterAddressTracker=new MasterAddressTracker(this.zooKeeper,this);
  this.rootRegionTracker=new RootRegionTracker(this.zooKeeper,this);
  if (!this.masterAddressTracker.start(allowAbort)) {
    this.masterAddressTracker.stop();
    this.masterAddressTracker=null;
    this.zooKeeper=null;
    return false;
  }
  if (!this.rootRegionTracker.start(allowAbort)) {
    this.masterAddressTracker.stop();
    this.rootRegionTracker.stop();
    this.masterAddressTracker=null;
    this.rootRegionTracker=null;
    this.zooKeeper=null;
    return false;
  }
  this.clusterId=new ClusterId(this.zooKeeper,this);
  return true;
}
