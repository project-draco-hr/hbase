{
  final TreeSet<HTableDescriptor> uniqueTables=new TreeSet<HTableDescriptor>();
  MetaScannerVisitor visitor=new MetaScannerVisitor(){
    public boolean processRow(    Result result) throws IOException {
      try {
        byte[] value=result.getValue(HConstants.CATALOG_FAMILY,HConstants.REGIONINFO_QUALIFIER);
        HRegionInfo info=null;
        if (value != null) {
          info=Writables.getHRegionInfo(value);
        }
        if (info != null && info.getStartKey().length == 0) {
          uniqueTables.add(info.getTableDesc());
        }
        return true;
      }
 catch (      RuntimeException e) {
        LOG.error("Result=" + result);
        throw e;
      }
    }
  }
;
  MetaScanner.metaScan(conf,visitor);
  return uniqueTables.toArray(new HTableDescriptor[uniqueTables.size()]);
}
