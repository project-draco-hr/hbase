{
  final AtomicBoolean available=new AtomicBoolean(true);
  final AtomicInteger regionCount=new AtomicInteger(0);
  MetaScannerVisitor visitor=new MetaScannerVisitorBase(){
    @Override public boolean processRow(    Result row) throws IOException {
      byte[] value=row.getValue(HConstants.CATALOG_FAMILY,HConstants.REGIONINFO_QUALIFIER);
      HRegionInfo info=Writables.getHRegionInfoOrNull(value);
      if (info != null) {
        if (Bytes.equals(tableName,info.getTableName())) {
          value=row.getValue(HConstants.CATALOG_FAMILY,HConstants.SERVER_QUALIFIER);
          if (value == null) {
            available.set(false);
            return false;
          }
          regionCount.incrementAndGet();
        }
      }
      return true;
    }
  }
;
  MetaScanner.metaScan(conf,visitor);
  return available.get() && (regionCount.get() > 0);
}
