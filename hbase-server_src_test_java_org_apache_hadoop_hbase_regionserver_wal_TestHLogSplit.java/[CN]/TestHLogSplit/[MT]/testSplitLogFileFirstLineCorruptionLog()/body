{
  conf.setBoolean(HBASE_SKIP_ERRORS,true);
  generateHLogs(1,10,-1);
  FileStatus logfile=fs.listStatus(HLOGDIR)[0];
  corruptHLog(logfile.getPath(),Corruptions.INSERT_GARBAGE_ON_FIRST_LINE,true,fs);
  fs.initialize(fs.getUri(),conf);
  HLogSplitter.splitLogFile(HBASEDIR,logfile,fs,conf,reporter);
  HLogSplitter.finishSplitLogFile(HBASEDIR,OLDLOGDIR,logfile.getPath().toString(),conf);
  final Path corruptDir=new Path(conf.get(HConstants.HBASE_DIR),conf.get("hbase.regionserver.hlog.splitlog.corrupt.dir",".corrupt"));
  assertEquals(1,fs.listStatus(corruptDir).length);
}
