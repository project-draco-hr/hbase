{
  REGIONS.removeAll(REGIONS);
  for (int i=0; i < 100; i++) {
    REGIONS.add("region__" + i);
  }
  generateHLogs(1,100,-1);
  fs.initialize(fs.getUri(),conf);
  HLogSplitter.split(HBASEDIR,HLOGDIR,OLDLOGDIR,fs,conf);
  fs.rename(OLDLOGDIR,HLOGDIR);
  Path firstSplitPath=new Path(HBASEDIR,TABLE_NAME + ".first");
  Path splitPath=new Path(HBASEDIR,TABLE_NAME.getNameAsString());
  fs.rename(splitPath,firstSplitPath);
  fs.initialize(fs.getUri(),conf);
  HLogSplitter.split(HBASEDIR,HLOGDIR,OLDLOGDIR,fs,conf);
  assertEquals(0,compareHLogSplitDirs(firstSplitPath,splitPath));
}
