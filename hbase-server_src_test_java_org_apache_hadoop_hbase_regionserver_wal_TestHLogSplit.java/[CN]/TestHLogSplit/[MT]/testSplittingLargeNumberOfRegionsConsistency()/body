{
  REGIONS.removeAll(REGIONS);
  for (int i=0; i < 100; i++) {
    REGIONS.add("region__" + i);
  }
  generateHLogs(1,100,-1);
  fs.initialize(fs.getUri(),conf);
  HLogSplitter logSplitter=HLogSplitter.createLogSplitter(conf,HBASEDIR,HLOGDIR,OLDLOGDIR,fs);
  logSplitter.splitLog();
  fs.rename(OLDLOGDIR,HLOGDIR);
  Path firstSplitPath=new Path(HBASEDIR,Bytes.toString(TABLE_NAME) + ".first");
  Path splitPath=new Path(HBASEDIR,Bytes.toString(TABLE_NAME));
  fs.rename(splitPath,firstSplitPath);
  fs.initialize(fs.getUri(),conf);
  logSplitter=HLogSplitter.createLogSplitter(conf,HBASEDIR,HLOGDIR,OLDLOGDIR,fs);
  logSplitter.splitLog();
  assertEquals(0,compareHLogSplitDirs(firstSplitPath,splitPath));
}
