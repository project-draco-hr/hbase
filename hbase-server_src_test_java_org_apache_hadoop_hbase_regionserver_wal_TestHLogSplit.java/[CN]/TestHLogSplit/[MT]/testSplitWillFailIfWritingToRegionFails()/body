{
  HLog.Writer[] writer=generateHLogs(4);
  fs.initialize(fs.getUri(),conf);
  String region="break";
  Path regiondir=new Path(TABLEDIR,region);
  fs.mkdirs(regiondir);
  InstrumentedSequenceFileLogWriter.activateFailure=false;
  appendEntry(writer[4],TABLE_NAME,Bytes.toBytes(region),("r" + 999).getBytes(),FAMILY,QUALIFIER,VALUE,0);
  writer[4].close();
  try {
    InstrumentedSequenceFileLogWriter.activateFailure=true;
    HLogSplitter logSplitter=HLogSplitter.createLogSplitter(conf,HBASEDIR,HLOGDIR,OLDLOGDIR,fs);
    logSplitter.splitLog();
  }
 catch (  IOException e) {
    assertEquals("This exception is instrumented and should only be thrown for testing",e.getMessage());
    throw e;
  }
 finally {
    InstrumentedSequenceFileLogWriter.activateFailure=false;
  }
}
