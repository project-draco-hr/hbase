{
  FileStatus[] f1=fs.listStatus(p1);
  FileStatus[] f2=fs.listStatus(p2);
  assertNotNull("Path " + p1 + " doesn't exist",f1);
  assertNotNull("Path " + p2 + " doesn't exist",f2);
  System.out.println("Files in " + p1 + ": "+ Joiner.on(",").join(FileUtil.stat2Paths(f1)));
  System.out.println("Files in " + p2 + ": "+ Joiner.on(",").join(FileUtil.stat2Paths(f2)));
  assertEquals(f1.length,f2.length);
  for (int i=0; i < f1.length; i++) {
    Path rd1=HLogUtil.getRegionDirRecoveredEditsDir(f1[i].getPath());
    FileStatus[] rd1fs=fs.listStatus(rd1);
    assertEquals(1,rd1fs.length);
    Path rd2=HLogUtil.getRegionDirRecoveredEditsDir(f2[i].getPath());
    FileStatus[] rd2fs=fs.listStatus(rd2);
    assertEquals(1,rd2fs.length);
    if (!logsAreEqual(rd1fs[0].getPath(),rd2fs[0].getPath())) {
      return -1;
    }
  }
  return 0;
}
