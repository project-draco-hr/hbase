{
  makeRegionDirs(dfs,REGIONS);
  dfs.mkdirs(HLOGDIR);
  HLog.Writer[] ws=new HLog.Writer[writers];
  int seq=0;
  for (int i=0; i < writers; i++) {
    ws[i]=HLogFactory.createWriter(dfs,new Path(HLOGDIR,HLOG_FILE_PREFIX + i),dfs.getConf());
    for (int j=0; j < entries; j++) {
      int prefix=0;
      for (      String region : REGIONS) {
        String row_key=region + prefix++ + i+ j;
        appendEntry(ws[i],TABLE_NAME,region.getBytes(),row_key.getBytes(),FAMILY,QUALIFIER,VALUE,seq++);
      }
    }
    if (i != leaveOpen) {
      ws[i].close();
      LOG.info("Closing writer " + i);
    }
  }
  return ws;
}
