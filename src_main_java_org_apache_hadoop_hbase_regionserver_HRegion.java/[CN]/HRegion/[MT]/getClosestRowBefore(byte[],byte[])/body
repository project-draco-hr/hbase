{
  if (coprocessorHost != null) {
    Result result=new Result();
    if (coprocessorHost.preGetClosestRowBefore(row,family,result)) {
      return result;
    }
  }
  checkRow(row);
  startRegionOperation();
  try {
    Store store=getStore(family);
    KeyValue kv=new KeyValue(row,HConstants.LATEST_TIMESTAMP);
    KeyValue key=store.getRowKeyAtOrBefore(kv);
    Result result=null;
    if (key != null) {
      Get get=new Get(key.getRow());
      get.addFamily(family);
      result=get(get,null);
    }
    if (coprocessorHost != null) {
      coprocessorHost.postGetClosestRowBefore(row,family,result);
    }
    return result;
  }
  finally {
    closeRegionOperation();
  }
}
