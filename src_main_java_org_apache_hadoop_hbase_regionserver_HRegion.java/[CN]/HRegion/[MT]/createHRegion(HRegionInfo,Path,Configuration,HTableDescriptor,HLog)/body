{
  LOG.info("creating HRegion " + info.getTableNameAsString() + " HTD == "+ hTableDescriptor+ " RootDir = "+ rootDir+ " Table name == "+ info.getTableNameAsString());
  Path tableDir=HTableDescriptor.getTableDir(rootDir,info.getTableName());
  Path regionDir=HRegion.getRegionDir(tableDir,info.getEncodedName());
  FileSystem fs=FileSystem.get(conf);
  fs.mkdirs(regionDir);
  HLog effectiveHLog=hlog;
  if (hlog == null) {
    effectiveHLog=new HLog(fs,new Path(regionDir,HConstants.HREGION_LOGDIR_NAME),new Path(regionDir,HConstants.HREGION_OLDLOGDIR_NAME),conf);
  }
  HRegion region=HRegion.newHRegion(tableDir,effectiveHLog,fs,conf,info,hTableDescriptor,null);
  region.initialize();
  return region;
}
