{
  BatchOperationInProgress<Pair<Put,Integer>> batchOp=new BatchOperationInProgress<Pair<Put,Integer>>(putsAndLocks);
  while (!batchOp.isDone()) {
    checkReadOnly();
    checkResources();
    long newSize;
    startRegionOperation();
    this.writeRequestsCount.increment();
    try {
      long addedSize=doMiniBatchPut(batchOp);
      newSize=this.addAndGetGlobalMemstoreSize(addedSize);
    }
  finally {
      closeRegionOperation();
    }
    if (isFlushSize(newSize)) {
      requestFlush();
    }
  }
  return batchOp.retCodes;
}
