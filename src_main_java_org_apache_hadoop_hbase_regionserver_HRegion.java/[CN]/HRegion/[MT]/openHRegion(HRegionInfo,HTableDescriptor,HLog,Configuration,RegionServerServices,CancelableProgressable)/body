{
  if (LOG.isDebugEnabled()) {
    LOG.debug("Opening region: " + info);
  }
  if (info == null) {
    throw new NullPointerException("Passed region info is null");
  }
  Path dir=HTableDescriptor.getTableDir(FSUtils.getRootDir(conf),info.getTableName());
  FileSystem fs=null;
  if (rsServices != null) {
    fs=rsServices.getFileSystem();
  }
  if (fs == null) {
    fs=FileSystem.get(conf);
  }
  HRegion r=HRegion.newHRegion(dir,wal,fs,conf,info,htd,rsServices);
  return r.openHRegion(reporter);
}
