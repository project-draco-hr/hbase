{
  while (!server.isStopRequested()) {
    while (!rollLog && !server.isStopRequested()) {
      long now=System.currentTimeMillis();
      if (this.lastLogRollTime + this.optionalLogRollInterval <= now) {
        rollLog=true;
        this.lastLogRollTime=now;
      }
 else {
synchronized (rollLock) {
          try {
            rollLock.wait(server.threadWakeFrequency);
          }
 catch (          InterruptedException e) {
            continue;
          }
        }
      }
    }
    if (!rollLog) {
      continue;
    }
synchronized (server.logRollerLock) {
      try {
        LOG.info("Rolling hlog. Number of entries: " + server.getLog().getNumEntries());
        server.getLog().rollWriter();
      }
 catch (      IOException ex) {
        LOG.error("Log rolling failed",RemoteExceptionHandler.checkIOException(ex));
        server.checkFileSystem();
      }
catch (      Exception ex) {
        LOG.error("Log rolling failed",ex);
        server.checkFileSystem();
      }
 finally {
        rollLog=false;
      }
    }
  }
}
