{
  resetConf();
  int count=4;
  loadData(count,rowNumPerFile);
  int rowNumPerRegion=count * rowNumPerFile;
  assertEquals("Before compaction: mob rows count",regionNum * rowNumPerRegion,countMobRows(hTable));
  assertEquals("Before compaction: mob file count",regionNum * count,countFiles(true,family1));
  assertEquals("Before compaction: del file count",0,countFiles(false,family1));
  MobFileCompactor compactor=new PartitionedMobFileCompactor(conf,fs,tableName,hcd1,pool);
  compactor.compact();
  assertEquals("After compaction: mob rows count",regionNum * rowNumPerRegion,countMobRows(hTable));
  assertEquals("After compaction: mob file count",regionNum,countFiles(true,family1));
  assertEquals("After compaction: del file count",0,countFiles(false,family1));
}
