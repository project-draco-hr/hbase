{
  HTable baseTable=new HTable(baseTableName);
  HTable indexTable=new HTable(indexSpec.getIndexedTableName(baseTableName));
  Scan baseScan=new Scan();
  for (  byte[] column : indexSpec.getAllColumns()) {
    byte[][] famQf=KeyValue.parseColumn(column);
    if (famQf.length == 1) {
      baseScan.addFamily(famQf[0]);
    }
 else {
      baseScan.addColumn(famQf[0],famQf[1]);
    }
  }
  for (  Result result : baseTable.getScanner(baseScan)) {
    SortedMap<byte[],byte[]> columnValues=new TreeMap<byte[],byte[]>(Bytes.BYTES_COMPARATOR);
    for (    KeyValue kv : result.sorted()) {
      columnValues.put(Bytes.add(kv.getFamily(),KeyValue.COLUMN_FAMILY_DELIM_ARRAY,kv.getQualifier()),kv.getValue());
    }
    if (IndexMaintenanceUtils.doesApplyToIndex(indexSpec,columnValues)) {
      Put indexUpdate=IndexMaintenanceUtils.createIndexUpdate(indexSpec,result.getRow(),columnValues);
      indexTable.put(indexUpdate);
    }
  }
}
