{
  WALKey key=new HLogKey(hri.getEncodedNameAsBytes(),hri.getTable(),System.currentTimeMillis(),mvcc);
  long trx=MultiVersionConcurrencyControl.NONE;
  try {
    trx=wal.append(htd,hri,key,edit,false);
    if (sync)     wal.sync(trx);
  }
  finally {
    MultiVersionConcurrencyControl.WriteEntry we=key.getWriteEntry();
    if (mvcc != null && we != null)     mvcc.complete(we);
  }
  return trx;
}
