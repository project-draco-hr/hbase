{
  super(fs,path,blocksize,compress,comparator.getRawComparator());
  this.kvComparator=comparator;
  if (bloomType != BloomType.NONE && conf != null) {
    float err=conf.getFloat("io.hfile.bloom.error.rate",(float)0.01);
    int maxFold=conf.getInt("io.hfile.bloom.max.fold",7);
    this.bloomFilter=new ByteBloomFilter(maxKeys,err,Hash.getHashType(conf),maxFold);
    this.bloomFilter.allocBloom();
    this.bloomType=bloomType;
  }
 else {
    this.bloomFilter=null;
    this.bloomType=BloomType.NONE;
  }
}
