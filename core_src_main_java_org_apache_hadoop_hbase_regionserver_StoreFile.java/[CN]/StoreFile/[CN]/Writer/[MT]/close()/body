{
  if (this.bloomFilter != null && this.bloomFilter.getKeyCount() > 0) {
    bloomFilter.finalize();
    if (this.bloomFilter.getMaxKeys() > 0) {
      int b=this.bloomFilter.getByteSize();
      int k=this.bloomFilter.getKeyCount();
      int m=this.bloomFilter.getMaxKeys();
      StoreFile.LOG.info("Bloom added to HFile.  " + b + "B, "+ k+ "/"+ m+ " ("+ NumberFormat.getPercentInstance().format(((double)k) / ((double)m))+ ")");
    }
    appendMetaBlock(BLOOM_FILTER_META_KEY,bloomFilter.getMetaWriter());
    appendMetaBlock(BLOOM_FILTER_DATA_KEY,bloomFilter.getDataWriter());
    appendFileInfo(BLOOM_FILTER_TYPE_KEY,Bytes.toBytes(bloomType.toString()));
  }
  super.close();
}
