{
  Table table=new HTable(UTIL.getConfiguration(),TEST_TABLE);
  List<Row> puts=constructPutRequests();
  table.batch(puts);
  HashSet<ServerName> regionservers=new HashSet<ServerName>();
  for (  byte[] k : KEYS) {
    HRegionLocation location=((HTable)table).getRegionLocation(k);
    regionservers.add(location.getServerName());
  }
  Field poolField=table.getClass().getDeclaredField("pool");
  poolField.setAccessible(true);
  ThreadPoolExecutor tExecutor=(ThreadPoolExecutor)poolField.get(table);
  assertEquals(regionservers.size(),tExecutor.getLargestPoolSize());
  table.close();
}
