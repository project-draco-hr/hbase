{
  LOG.info("before");
  if (UTIL.ensureSomeRegionServersAvailable(slaves)) {
    UTIL.getMiniHBaseCluster().getMaster().balance();
    final RegionStates regionStates=UTIL.getMiniHBaseCluster().getMaster().getAssignmentManager().getRegionStates();
    UTIL.waitFor(15 * 1000,new Predicate<Exception>(){
      @Override public boolean evaluate() throws Exception {
        return !regionStates.isRegionsInTransition();
      }
    }
);
  }
  LOG.info("before done");
}
