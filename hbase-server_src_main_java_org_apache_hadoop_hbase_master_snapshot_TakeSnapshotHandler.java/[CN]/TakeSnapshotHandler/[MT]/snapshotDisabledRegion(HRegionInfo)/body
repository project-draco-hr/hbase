{
  HRegionFileSystem regionFs=HRegionFileSystem.createRegionOnFileSystem(conf,fs,workingDir,regionInfo);
  monitor.rethrowException();
  Path regionDir=HRegion.getRegionDir(rootDir,regionInfo);
  Path snapshotRegionDir=regionFs.getRegionDir();
  new CopyRecoveredEditsTask(snapshot,monitor,fs,regionDir,snapshotRegionDir).call();
  monitor.rethrowException();
  status.setStatus("Completed copying recovered edits for offline snapshot of table: " + snapshotTable);
  new ReferenceRegionHFilesTask(snapshot,monitor,regionDir,fs,snapshotRegionDir).call();
  monitor.rethrowException();
  status.setStatus("Completed referencing HFiles for offline snapshot of table: " + snapshotTable);
}
