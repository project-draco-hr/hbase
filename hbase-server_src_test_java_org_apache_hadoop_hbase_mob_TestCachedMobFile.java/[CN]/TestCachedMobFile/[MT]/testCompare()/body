{
  String caseName=getName();
  FileSystem fs=FileSystem.get(conf);
  Path testDir=FSUtils.getRootDir(conf);
  Path outputDir1=new Path(new Path(testDir,TABLE),FAMILY1);
  HFileContext meta=new HFileContextBuilder().withBlockSize(8 * 1024).build();
  StoreFile.Writer writer1=new StoreFile.WriterBuilder(conf,cacheConf,fs).withOutputDir(outputDir1).withFileContext(meta).build();
  MobTestUtil.writeStoreFile(writer1,caseName);
  CachedMobFile cachedMobFile1=CachedMobFile.create(fs,writer1.getPath(),conf,cacheConf);
  Path outputDir2=new Path(new Path(testDir,TABLE),FAMILY2);
  StoreFile.Writer writer2=new StoreFile.WriterBuilder(conf,cacheConf,fs).withOutputDir(outputDir2).withFileContext(meta).build();
  MobTestUtil.writeStoreFile(writer2,caseName);
  CachedMobFile cachedMobFile2=CachedMobFile.create(fs,writer2.getPath(),conf,cacheConf);
  cachedMobFile1.access(1);
  cachedMobFile2.access(2);
  Assert.assertEquals(cachedMobFile1.compareTo(cachedMobFile2),1);
  Assert.assertEquals(cachedMobFile2.compareTo(cachedMobFile1),-1);
  Assert.assertEquals(cachedMobFile1.compareTo(cachedMobFile1),0);
}
