{
  if (this.master == null) {
    throw new MasterNotRunningException("master has been shut down");
  }
  HTableDescriptor.isLegalTableName(tableName);
  HRegionLocation firstMetaServer=getFirstMetaServerForTable(tableName);
  try {
    this.master.deleteTable(tableName);
  }
 catch (  RemoteException e) {
    throw RemoteExceptionHandler.decodeRemoteException(e);
  }
  final int batchCount=this.conf.getInt("hbase.admin.scanner.caching",10);
  HRegionInterface server=connection.getHRegionConnection(firstMetaServer.getServerAddress());
  HRegionInfo info=new HRegionInfo();
  for (int tries=0; tries < numRetries; tries++) {
    long scannerId=-1L;
    try {
      Scan scan=new Scan().addColumn(HConstants.CATALOG_FAMILY,HConstants.REGIONINFO_QUALIFIER);
      scannerId=server.openScanner(firstMetaServer.getRegionInfo().getRegionName(),scan);
      Result[] values=server.next(scannerId,batchCount);
      if (values == null || values.length == 0) {
        break;
      }
      boolean found=false;
      for (int i=0; i < values.length; i++) {
        Result r=values[i];
        NavigableMap<byte[],byte[]> infoValues=r.getFamilyMap(HConstants.CATALOG_FAMILY);
        for (        Map.Entry<byte[],byte[]> e : infoValues.entrySet()) {
          if (Bytes.equals(e.getKey(),HConstants.REGIONINFO_QUALIFIER)) {
            info=(HRegionInfo)Writables.getWritable(e.getValue(),info);
            if (Bytes.equals(info.getTableDesc().getName(),tableName)) {
              found=true;
            }
 else {
              found=false;
              break;
            }
          }
        }
      }
      if (!found) {
        break;
      }
    }
 catch (    IOException ex) {
      if (tries == numRetries - 1) {
        if (ex instanceof RemoteException) {
          ex=RemoteExceptionHandler.decodeRemoteException((RemoteException)ex);
        }
        throw ex;
      }
    }
 finally {
      if (scannerId != -1L) {
        try {
          server.close(scannerId);
        }
 catch (        Exception ex) {
          LOG.warn(ex);
        }
      }
    }
    try {
      Thread.sleep(getPauseTime(tries));
    }
 catch (    InterruptedException e) {
    }
  }
  HConnectionManager.deleteConnectionInfo(conf,false);
  LOG.info("Deleted " + Bytes.toString(tableName));
}
