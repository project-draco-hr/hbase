{
  HTable table;
  HBaseAdmin hBaseAdmin=TEST_UTIL.getHBaseAdmin();
  HColumnDescriptor colDesc=new HColumnDescriptor(fam);
  colDesc.setMaxVersions(5);
  HTableDescriptor desc=new HTableDescriptor(tableName);
  desc.addFamily(colDesc);
  hBaseAdmin.createTable(desc);
  table=new HTable(conf,tableName);
  Put put=new Put(Bytes.toBytes("row1"));
  put.add(fam,qual,123l,value);
  put.setCellVisibility(new CellVisibility(CONFIDENTIAL));
  table.put(put);
  put=new Put(Bytes.toBytes("row1"));
  put.add(fam,qual,124l,value);
  put.setCellVisibility(new CellVisibility("(" + CONFIDENTIAL + "&"+ PRIVATE+ ")|("+ TOPSECRET+ "&"+ SECRET+ ")"));
  table.put(put);
  put=new Put(Bytes.toBytes("row1"));
  put.add(fam,qual,125l,value);
  put.setCellVisibility(new CellVisibility(SECRET + "&" + TOPSECRET));
  table.put(put);
  put=new Put(Bytes.toBytes("row1"));
  put.add(fam,qual,126l,value);
  put.setCellVisibility(new CellVisibility("(" + CONFIDENTIAL + "&"+ PRIVATE+ ")|("+ TOPSECRET+ "&"+ SECRET+ ")"));
  table.put(put);
  put=new Put(Bytes.toBytes("row1"));
  put.add(fam,qual,127l,value);
  put.setCellVisibility(new CellVisibility("(" + CONFIDENTIAL + "&"+ PRIVATE+ ")|("+ TOPSECRET+ "&"+ SECRET+ ")"));
  table.put(put);
  TEST_UTIL.getHBaseAdmin().flush(tableName.getNameAsString());
  put=new Put(Bytes.toBytes("row2"));
  put.add(fam,qual,127l,value);
  put.setCellVisibility(new CellVisibility("(" + CONFIDENTIAL + "&"+ PRIVATE+ ")|("+ TOPSECRET+ "&"+ SECRET+ ")"));
  table.put(put);
  return table;
}
