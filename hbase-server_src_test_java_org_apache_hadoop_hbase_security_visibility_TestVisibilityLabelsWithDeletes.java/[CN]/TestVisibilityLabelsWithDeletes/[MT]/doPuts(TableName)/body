{
  Admin hBaseAdmin=TEST_UTIL.getHBaseAdmin();
  HColumnDescriptor colDesc=new HColumnDescriptor(fam);
  colDesc.setMaxVersions(5);
  HTableDescriptor desc=new HTableDescriptor(tableName);
  desc.addFamily(colDesc);
  hBaseAdmin.createTable(desc);
  List<Put> puts=new ArrayList<Put>();
  Put put=new Put(Bytes.toBytes("row1"));
  put.add(fam,qual,123l,value);
  put.setCellVisibility(new CellVisibility(CONFIDENTIAL));
  puts.add(put);
  put=new Put(Bytes.toBytes("row1"));
  put.add(fam,qual,124l,value);
  put.setCellVisibility(new CellVisibility("(" + CONFIDENTIAL + "&"+ PRIVATE+ ")|("+ TOPSECRET+ "&"+ SECRET+ ")"));
  puts.add(put);
  put=new Put(Bytes.toBytes("row1"));
  put.add(fam,qual,125l,value);
  put.setCellVisibility(new CellVisibility(SECRET + "&" + TOPSECRET));
  puts.add(put);
  put=new Put(Bytes.toBytes("row1"));
  put.add(fam,qual,126l,value);
  put.setCellVisibility(new CellVisibility("(" + CONFIDENTIAL + "&"+ PRIVATE+ ")|("+ TOPSECRET+ "&"+ SECRET+ ")"));
  puts.add(put);
  put=new Put(Bytes.toBytes("row1"));
  put.add(fam,qual,127l,value);
  put.setCellVisibility(new CellVisibility("(" + CONFIDENTIAL + "&"+ PRIVATE+ ")|("+ TOPSECRET+ "&"+ SECRET+ ")"));
  puts.add(put);
  TEST_UTIL.getHBaseAdmin().flush(tableName);
  put=new Put(Bytes.toBytes("row2"));
  put.add(fam,qual,127l,value);
  put.setCellVisibility(new CellVisibility("(" + CONFIDENTIAL + "&"+ PRIVATE+ ")|("+ TOPSECRET+ "&"+ SECRET+ ")"));
  puts.add(put);
  Table table=new HTable(conf,tableName);
  table.put(puts);
  return table;
}
