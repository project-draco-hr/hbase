{
  final TableName tableName=TableName.valueOf(TEST_NAME.getMethodName());
  Admin hBaseAdmin=TEST_UTIL.getHBaseAdmin();
  HColumnDescriptor colDesc=new HColumnDescriptor(fam);
  colDesc.setMaxVersions(5);
  HTableDescriptor desc=new HTableDescriptor(tableName);
  desc.addFamily(colDesc);
  hBaseAdmin.createTable(desc);
  Put p=new Put(Bytes.toBytes("row1"));
  p.addColumn(fam,qual,value);
  Table table=TEST_UTIL.getConnection().getTable(tableName);
  table.put(p);
  p=new Put(Bytes.toBytes("row1"));
  p.addColumn(fam,qual1,value);
  table.put(p);
  p=new Put(Bytes.toBytes("row2"));
  p.addColumn(fam,qual,value);
  table.put(p);
  p=new Put(Bytes.toBytes("row2"));
  p.addColumn(fam,qual1,value);
  table.put(p);
  Delete d=new Delete(Bytes.toBytes("row1"));
  table.delete(d);
  Get g=new Get(Bytes.toBytes("row1"));
  g.setMaxVersions();
  g.setAuthorizations(new Authorizations(SECRET,PRIVATE));
  Result result=table.get(g);
  assertEquals(0,result.rawCells().length);
  p=new Put(Bytes.toBytes("row1"));
  p.addColumn(fam,qual,value);
  table.put(p);
  result=table.get(g);
  assertEquals(1,result.rawCells().length);
}
