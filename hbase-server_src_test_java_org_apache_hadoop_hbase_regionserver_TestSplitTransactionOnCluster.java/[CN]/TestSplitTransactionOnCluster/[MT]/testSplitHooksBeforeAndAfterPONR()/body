{
  TableName firstTable=TableName.valueOf("testSplitHooksBeforeAndAfterPONR_1");
  TableName secondTable=TableName.valueOf("testSplitHooksBeforeAndAfterPONR_2");
  HTableDescriptor desc=new HTableDescriptor(firstTable);
  desc.addCoprocessor(MockedRegionObserver.class.getName());
  HColumnDescriptor hcd=new HColumnDescriptor("cf");
  desc.addFamily(hcd);
  admin.createTable(desc);
  desc=new HTableDescriptor(secondTable);
  hcd=new HColumnDescriptor("cf");
  desc.addFamily(hcd);
  admin.createTable(desc);
  List<HRegion> firstTableregions=cluster.getRegions(firstTable);
  List<HRegion> secondTableRegions=cluster.getRegions(secondTable);
  ServerName serverName=cluster.getServerHoldingRegion(firstTableregions.get(0).getRegionName());
  admin.move(secondTableRegions.get(0).getRegionInfo().getEncodedNameAsBytes(),Bytes.toBytes(serverName.getServerName()));
  Table table1=null;
  Table table2=null;
  try {
    table1=new HTable(TESTING_UTIL.getConfiguration(),firstTable);
    table2=new HTable(TESTING_UTIL.getConfiguration(),firstTable);
    insertData(firstTable,admin,table1);
    insertData(secondTable,admin,table2);
    admin.split(firstTable,"row2".getBytes());
    firstTableregions=cluster.getRegions(firstTable);
    while (firstTableregions.size() != 2) {
      Thread.sleep(1000);
      firstTableregions=cluster.getRegions(firstTable);
    }
    assertEquals("Number of regions after split should be 2.",2,firstTableregions.size());
    secondTableRegions=cluster.getRegions(secondTable);
    assertEquals("Number of regions after split should be 2.",2,secondTableRegions.size());
  }
  finally {
    if (table1 != null) {
      table1.close();
    }
    if (table2 != null) {
      table2.close();
    }
    TESTING_UTIL.deleteTable(firstTable);
    TESTING_UTIL.deleteTable(secondTable);
  }
}
