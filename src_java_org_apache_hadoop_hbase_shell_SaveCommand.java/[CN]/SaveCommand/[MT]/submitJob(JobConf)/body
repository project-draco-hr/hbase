{
  JobClient jc=new JobClient(job);
  boolean success=true;
  RunningJob running=null;
  try {
    running=jc.submitJob(job);
    String jobId=running.getJobID();
    while (!running.isComplete()) {
      try {
        Thread.sleep(5000);
      }
 catch (      InterruptedException e) {
      }
      running=jc.getJob(jobId);
    }
    success=running.isSuccessful();
  }
  finally {
    if (!success && (running != null)) {
      running.killJob();
    }
    jc.close();
  }
  return success;
}
