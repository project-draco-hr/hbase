{
  conf=HBaseConfiguration.create();
  conf.set("fs.defaultFS",conf.get(org.apache.hadoop.hbase.HConstants.HBASE_DIR));
  conf.set("fs.default.name",conf.get(org.apache.hadoop.hbase.HConstants.HBASE_DIR));
  SchemaMetrics.configureGlobally(conf);
  try {
    if (!parseOptions(args))     return 1;
  }
 catch (  IOException ex) {
    LOG.error("Error parsing command-line options",ex);
    return 1;
  }
catch (  ParseException ex) {
    LOG.error("Error parsing command-line options",ex);
    return 1;
  }
  for (  Path fileName : files) {
    try {
      processFile(fileName);
    }
 catch (    IOException ex) {
      LOG.error("Error reading " + fileName,ex);
    }
  }
  if (verbose || printKey) {
    System.out.println("Scanned kv count -> " + count);
  }
  return 0;
}
