{
  int count=0;
  try {
    if (this.version != 0) {
      byte[][] result=null;
      ParsedColumns parsedColumns=getColumns(admin,false);
      boolean multiple=parsedColumns.isMultiple() || this.version > 1;
      for (      Text column : parsedColumns.getColumns()) {
        if (count == 0) {
          formatter.header(multiple ? HEADER_COLUMN_CELL : null);
        }
        if (this.timestamp != 0) {
          result=table.get(this.rowKey,column,this.timestamp,this.version);
        }
 else {
          result=table.get(this.rowKey,column,this.version);
        }
        for (int ii=0; result != null && ii < result.length; ii++) {
          if (multiple) {
            formatter.row(new String[]{column.toString(),toString(column,result[ii])});
          }
 else {
            formatter.row(new String[]{toString(column,result[ii])});
          }
          count++;
        }
      }
    }
 else {
      for (      Map.Entry<Text,byte[]> e : table.getRow(this.rowKey).entrySet()) {
        if (count == 0) {
          formatter.header(isMultiple() ? HEADER_COLUMN_CELL : null);
        }
        Text key=e.getKey();
        String keyStr=key.toString();
        if (!this.columns.contains(STAR) && !this.columns.contains(keyStr)) {
          continue;
        }
        String cellData=toString(key,e.getValue());
        if (isMultiple()) {
          formatter.row(new String[]{key.toString(),cellData});
        }
 else {
          formatter.row(new String[]{cellData});
        }
        count++;
      }
    }
    if (count == 0 && Shell.HTML_OPTION != null) {
      formatter.header(isMultiple() ? HEADER_COLUMN_CELL : null);
    }
    formatter.footer();
  }
 catch (  IOException e) {
    e.printStackTrace();
  }
  return count;
}
