{
  HTable table=new HTable(util.getConfiguration(),TEST_TABLE);
  Map<byte[],String> results=table.coprocessorExec(PingProtocol.class,null,null,new Batch.Call<PingProtocol,String>(){
    public String call(    PingProtocol instance){
      return instance.ping();
    }
  }
);
  verifyRegionResults(table,results,ROW_A);
  verifyRegionResults(table,results,ROW_B);
  verifyRegionResults(table,results,ROW_C);
  results=table.coprocessorExec(PingProtocol.class,ROW_BC,null,new Batch.Call<PingProtocol,String>(){
    public String call(    PingProtocol instance){
      return instance.ping();
    }
  }
);
  HRegionLocation loc=table.getRegionLocation(ROW_A);
  assertNull("Should be missing region for row aaa (prior to start row)",results.get(loc.getRegionInfo().getRegionName()));
  verifyRegionResults(table,results,ROW_B);
  verifyRegionResults(table,results,ROW_C);
  results=table.coprocessorExec(PingProtocol.class,null,ROW_BC,new Batch.Call<PingProtocol,String>(){
    public String call(    PingProtocol instance){
      return instance.ping();
    }
  }
);
  verifyRegionResults(table,results,ROW_A);
  verifyRegionResults(table,results,ROW_B);
  loc=table.getRegionLocation(ROW_C);
  assertNull("Should be missing region for row ccc (past stop row)",results.get(loc.getRegionInfo().getRegionName()));
  results=table.coprocessorExec(PingProtocol.class,ROW_AB,ROW_BC,new Batch.Call<PingProtocol,String>(){
    public String call(    PingProtocol instance){
      return instance.ping();
    }
  }
);
  verifyRegionResults(table,results,ROW_A);
  verifyRegionResults(table,results,ROW_B);
  loc=table.getRegionLocation(ROW_C);
  assertNull("Should be missing region for row ccc (past stop row)",results.get(loc.getRegionInfo().getRegionName()));
  results=table.coprocessorExec(PingProtocol.class,ROW_B,ROW_BC,new Batch.Call<PingProtocol,String>(){
    public String call(    PingProtocol instance){
      return instance.ping();
    }
  }
);
  verifyRegionResults(table,results,ROW_B);
  loc=table.getRegionLocation(ROW_A);
  assertNull("Should be missing region for row aaa (prior to start)",results.get(loc.getRegionInfo().getRegionName()));
  loc=table.getRegionLocation(ROW_C);
  assertNull("Should be missing region for row ccc (past stop row)",results.get(loc.getRegionInfo().getRegionName()));
}
