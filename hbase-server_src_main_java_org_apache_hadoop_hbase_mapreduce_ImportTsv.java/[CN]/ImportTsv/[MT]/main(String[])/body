{
  Configuration conf=HBaseConfiguration.create();
  String[] otherArgs=new GenericOptionsParser(conf,args).getRemainingArgs();
  if (otherArgs.length < 2) {
    usage("Wrong number of arguments: " + otherArgs.length);
    System.exit(-1);
  }
  String columns[]=conf.getStrings(COLUMNS_CONF_KEY);
  if (columns == null) {
    usage("No columns specified. Please specify with -D" + COLUMNS_CONF_KEY + "=...");
    System.exit(-1);
  }
  int rowkeysFound=0;
  for (  String col : columns) {
    if (col.equals(TsvParser.ROWKEY_COLUMN_SPEC))     rowkeysFound++;
  }
  if (rowkeysFound != 1) {
    usage("Must specify exactly one column as " + TsvParser.ROWKEY_COLUMN_SPEC);
    System.exit(-1);
  }
  if (columns.length < 2) {
    usage("One or more columns in addition to the row key are required");
    System.exit(-1);
  }
  hbaseAdmin=new HBaseAdmin(conf);
  Job job=createSubmittableJob(conf,otherArgs);
  System.exit(job.waitForCompletion(true) ? 0 : 1);
}
