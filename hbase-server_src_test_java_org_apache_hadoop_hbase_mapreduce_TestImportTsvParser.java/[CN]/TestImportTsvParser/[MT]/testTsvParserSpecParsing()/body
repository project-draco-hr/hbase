{
  TsvParser parser;
  parser=new TsvParser("HBASE_ROW_KEY","\t");
  assertNull(parser.getFamily(0));
  assertNull(parser.getQualifier(0));
  assertEquals(0,parser.getRowKeyColumnIndex());
  assertFalse(parser.hasTimestamp());
  parser=new TsvParser("HBASE_ROW_KEY,col1:scol1","\t");
  assertNull(parser.getFamily(0));
  assertNull(parser.getQualifier(0));
  assertBytesEquals(Bytes.toBytes("col1"),parser.getFamily(1));
  assertBytesEquals(Bytes.toBytes("scol1"),parser.getQualifier(1));
  assertEquals(0,parser.getRowKeyColumnIndex());
  assertFalse(parser.hasTimestamp());
  parser=new TsvParser("HBASE_ROW_KEY,col1:scol1,col1:scol2","\t");
  assertNull(parser.getFamily(0));
  assertNull(parser.getQualifier(0));
  assertBytesEquals(Bytes.toBytes("col1"),parser.getFamily(1));
  assertBytesEquals(Bytes.toBytes("scol1"),parser.getQualifier(1));
  assertBytesEquals(Bytes.toBytes("col1"),parser.getFamily(2));
  assertBytesEquals(Bytes.toBytes("scol2"),parser.getQualifier(2));
  assertEquals(0,parser.getRowKeyColumnIndex());
  assertFalse(parser.hasTimestamp());
  parser=new TsvParser("HBASE_ROW_KEY,col1:scol1,HBASE_TS_KEY,col1:scol2","\t");
  assertNull(parser.getFamily(0));
  assertNull(parser.getQualifier(0));
  assertBytesEquals(Bytes.toBytes("col1"),parser.getFamily(1));
  assertBytesEquals(Bytes.toBytes("scol1"),parser.getQualifier(1));
  assertBytesEquals(Bytes.toBytes("col1"),parser.getFamily(3));
  assertBytesEquals(Bytes.toBytes("scol2"),parser.getQualifier(3));
  assertEquals(0,parser.getRowKeyColumnIndex());
  assertTrue(parser.hasTimestamp());
  assertEquals(2,parser.getTimestampKeyColumnIndex());
  parser=new TsvParser("HBASE_ROW_KEY,col1:scol1,HBASE_TS_KEY,col1:scol2,HBASE_ATTRIBUTES_KEY","\t");
  assertNull(parser.getFamily(0));
  assertNull(parser.getQualifier(0));
  assertBytesEquals(Bytes.toBytes("col1"),parser.getFamily(1));
  assertBytesEquals(Bytes.toBytes("scol1"),parser.getQualifier(1));
  assertBytesEquals(Bytes.toBytes("col1"),parser.getFamily(3));
  assertBytesEquals(Bytes.toBytes("scol2"),parser.getQualifier(3));
  assertEquals(0,parser.getRowKeyColumnIndex());
  assertTrue(parser.hasTimestamp());
  assertEquals(2,parser.getTimestampKeyColumnIndex());
  assertEquals(4,parser.getAttributesKeyColumnIndex());
  parser=new TsvParser("HBASE_ATTRIBUTES_KEY,col1:scol1,HBASE_TS_KEY,col1:scol2,HBASE_ROW_KEY","\t");
  assertNull(parser.getFamily(0));
  assertNull(parser.getQualifier(0));
  assertBytesEquals(Bytes.toBytes("col1"),parser.getFamily(1));
  assertBytesEquals(Bytes.toBytes("scol1"),parser.getQualifier(1));
  assertBytesEquals(Bytes.toBytes("col1"),parser.getFamily(3));
  assertBytesEquals(Bytes.toBytes("scol2"),parser.getQualifier(3));
  assertEquals(4,parser.getRowKeyColumnIndex());
  assertTrue(parser.hasTimestamp());
  assertEquals(2,parser.getTimestampKeyColumnIndex());
  assertEquals(0,parser.getAttributesKeyColumnIndex());
}
