{
  LOG.debug("testAllRegionsFlushed");
  Map<byte[],Long> oldestFlushingSeqNo=new HashMap<byte[],Long>();
  Map<byte[],Long> oldestUnFlushedSeqNo=new HashMap<byte[],Long>();
  Map<byte[],Long> seqNo=new HashMap<byte[],Long>();
  TableName t1=TableName.valueOf("t1");
  HRegionInfo hri1=new HRegionInfo(t1,HConstants.EMPTY_START_ROW,HConstants.EMPTY_END_ROW);
  final AtomicLong sequenceId1=new AtomicLong(1);
  assertTrue(FSHLog.areAllRegionsFlushed(seqNo,oldestFlushingSeqNo,oldestUnFlushedSeqNo));
  seqNo.put(hri1.getEncodedNameAsBytes(),sequenceId1.incrementAndGet());
  oldestUnFlushedSeqNo.put(hri1.getEncodedNameAsBytes(),sequenceId1.get());
  assertFalse(FSHLog.areAllRegionsFlushed(seqNo,oldestFlushingSeqNo,oldestUnFlushedSeqNo));
  oldestUnFlushedSeqNo.clear();
  oldestFlushingSeqNo.put(hri1.getEncodedNameAsBytes(),sequenceId1.get());
  assertFalse(FSHLog.areAllRegionsFlushed(seqNo,oldestFlushingSeqNo,oldestUnFlushedSeqNo));
  oldestFlushingSeqNo.clear();
  oldestUnFlushedSeqNo.clear();
  assertTrue(FSHLog.areAllRegionsFlushed(seqNo,oldestFlushingSeqNo,oldestUnFlushedSeqNo));
  oldestUnFlushedSeqNo.put(hri1.getEncodedNameAsBytes(),1000l);
  seqNo.put(hri1.getEncodedNameAsBytes(),1500l);
  assertFalse(FSHLog.areAllRegionsFlushed(seqNo,oldestFlushingSeqNo,oldestUnFlushedSeqNo));
  oldestFlushingSeqNo.put(hri1.getEncodedNameAsBytes(),1200l);
  oldestUnFlushedSeqNo.clear();
  seqNo.put(hri1.getEncodedNameAsBytes(),1199l);
  assertTrue(FSHLog.areAllRegionsFlushed(seqNo,oldestFlushingSeqNo,oldestUnFlushedSeqNo));
}
