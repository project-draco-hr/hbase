{
  if (!FSUtils.isPre020FileLayout(fs,FSUtils.getRootDir(conf))) {
    throw new IOException("Not a pre-0.20 filesystem");
  }
  if (fs.exists(dir)) {
    throw new IOException("Input exists -- please specify empty input dir");
  }
  FSDataOutputStream out=fs.create(new Path(dir,"mapfiles"));
  try {
    gathermapfiles(conf,fs,out);
  }
  finally {
    out.close();
  }
}
