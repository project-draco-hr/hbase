{
  if (args.length < 2) {
    System.err.println("ERROR: Wrong number of arguments: " + args.length);
    System.err.println("Usage: " + getClass().getSimpleName() + " <inputdir> <outputdir>");
    ToolRunner.printGenericCommandUsage(System.err);
    return -1;
  }
  Path input=new Path(args[0]);
  HBaseConfiguration conf=(HBaseConfiguration)getConf();
  FileSystem fs=FileSystem.get(conf);
  writeInputFiles(conf,fs,input);
  Job job=new Job(conf);
  job.setJarByClass(HStoreFileToStoreFile.class);
  job.setJobName(JOBNAME);
  job.setInputFormatClass(TextInputFormat.class);
  job.setMapperClass(Map.class);
  job.setNumReduceTasks(0);
  FileInputFormat.addInputPath(job,input);
  Path output=new Path(args[1]);
  FileOutputFormat.setOutputPath(job,output);
  return job.waitForCompletion(true) ? 0 : 1;
}
