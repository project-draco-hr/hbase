{
  Path outputPath=new Path(outputDir);
  UUID uuid=UUID.randomUUID();
  Path iterationOutput=new Path(outputPath,uuid.toString());
  Verify verify=new Verify();
  verify.setConf(getConf());
  int retCode=verify.run(iterationOutput,numReducers);
  if (retCode > 0) {
    throw new RuntimeException("Verify.run failed with return code: " + retCode);
  }
  if (!verify.verify(expectedNumNodes)) {
    try {
      HBaseFsck fsck=new HBaseFsck(getConf());
      HBaseFsck.setDisplayFullReport();
      fsck.connect();
      fsck.onlineHbck();
    }
 catch (    Throwable t) {
      LOG.error("Failed to run hbck",t);
    }
    return false;
  }
  LOG.info("Verify finished with succees. Total nodes=" + expectedNumNodes);
  return true;
}
