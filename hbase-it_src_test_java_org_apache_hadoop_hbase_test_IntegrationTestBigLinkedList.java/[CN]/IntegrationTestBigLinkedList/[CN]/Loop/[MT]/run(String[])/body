{
  if (args.length < 5) {
    System.err.println("Usage: Loop <num iterations> <num mappers> <num nodes per mapper> <output dir> <num reducers>");
    return 1;
  }
  LOG.info("Running Loop with args:" + Arrays.deepToString(args));
  int numIterations=Integer.parseInt(args[0]);
  int numMappers=Integer.parseInt(args[1]);
  long numNodes=Long.parseLong(args[2]);
  String outputDir=args[3];
  int numReducers=Integer.parseInt(args[4]);
  long expectedNumNodes=0;
  if (numIterations < 0) {
    numIterations=Integer.MAX_VALUE;
  }
  for (int i=0; i < numIterations; i++) {
    LOG.info("Starting iteration = " + i);
    runGenerator(numMappers,numNodes,outputDir);
    expectedNumNodes+=numMappers * numNodes;
    runVerify(outputDir,numReducers,expectedNumNodes);
  }
  return 0;
}
