{
  id=Bytes.toBytes(UUID.randomUUID().toString());
  Configuration conf=context.getConfiguration();
  table=new HTable(conf,getTableName(conf));
  table.setAutoFlush(false);
  table.setWriteBufferSize(4 * 1024 * 1024);
  this.width=context.getConfiguration().getInt(GENERATOR_WIDTH_KEY,WIDTH_DEFAULT);
  current=new byte[this.width][];
  int wrapMultiplier=context.getConfiguration().getInt(GENERATOR_WRAP_KEY,WRAP_DEFAULT);
  this.wrap=(long)wrapMultiplier * width;
  this.numNodes=context.getConfiguration().getLong(GENERATOR_NUM_ROWS_PER_MAP_KEY,(long)WIDTH_DEFAULT * WRAP_DEFAULT);
  if (this.numNodes < this.wrap) {
    this.wrap=this.numNodes;
  }
}
