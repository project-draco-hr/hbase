{
  LOG.info("Running Generator with numMappers=" + numMappers + ", numNodes="+ numNodes);
  createSchema();
  Job job=new Job(getConf());
  job.setJobName("Link Generator");
  job.setNumReduceTasks(0);
  job.setJarByClass(getClass());
  FileInputFormat.setInputPaths(job,tmpOutput);
  job.setInputFormatClass(OneFilePerMapperSFIF.class);
  job.setOutputKeyClass(NullWritable.class);
  job.setOutputValueClass(NullWritable.class);
  job.getConfiguration().setInt(GENERATOR_NUM_MAPPERS_KEY,numMappers);
  job.getConfiguration().setLong(GENERATOR_NUM_ROWS_PER_MAP_KEY,numNodes);
  job.setMapperClass(GeneratorMapper.class);
  job.setOutputFormatClass(NullOutputFormat.class);
  job.getConfiguration().setBoolean("mapred.map.tasks.speculative.execution",false);
  TableMapReduceUtil.addDependencyJars(job);
  TableMapReduceUtil.initCredentials(job);
  boolean success=job.waitForCompletion(true);
  return success ? 0 : 1;
}
