{
  int version=in.readByte();
  if (version > (int)SCAN_VERSION) {
    throw new IOException("version not supported");
  }
  this.startRow=Bytes.readByteArray(in);
  this.stopRow=Bytes.readByteArray(in);
  this.maxVersions=in.readInt();
  this.batch=in.readInt();
  if (version >= VERSION_WITH_PAGINATION) {
    this.storeLimit=in.readInt();
    this.storeOffset=in.readInt();
  }
  this.caching=in.readInt();
  this.cacheBlocks=in.readBoolean();
  if (in.readBoolean()) {
    this.filter=(Filter)createForName(Bytes.toString(Bytes.readByteArray(in)));
    this.filter.readFields(in);
  }
  this.tr=new TimeRange();
  tr.readFields(in);
  int numFamilies=in.readInt();
  this.familyMap=new TreeMap<byte[],NavigableSet<byte[]>>(Bytes.BYTES_COMPARATOR);
  for (int i=0; i < numFamilies; i++) {
    byte[] family=Bytes.readByteArray(in);
    int numColumns=in.readInt();
    TreeSet<byte[]> set=new TreeSet<byte[]>(Bytes.BYTES_COMPARATOR);
    for (int j=0; j < numColumns; j++) {
      byte[] qualifier=Bytes.readByteArray(in);
      set.add(qualifier);
    }
    this.familyMap.put(family,set);
  }
  if (version >= VERSION_WITH_ATTRIBUTES) {
    readAttributes(in);
  }
  if (version >= VERSION_WITH_RESULT_SIZE) {
    this.maxResultSize=in.readLong();
  }
}
