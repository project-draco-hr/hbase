{
  if (!conf.getBoolean(HConstants.REPLICATION_ENABLE_KEY,false)) {
    throw new RuntimeException("hbase.replication isn't true, please " + "enable it in order to use replication");
  }
  this.configuration=conf;
  this.connection=HConnectionManager.getConnection(conf);
  ZooKeeperWatcher zkw=this.connection.getZooKeeperWatcher();
  try {
    this.replicationZk=new ReplicationZookeeper(this.connection,conf,zkw);
  }
 catch (  KeeperException e) {
    throw new IOException("Unable setup the ZooKeeper connection",e);
  }
}
