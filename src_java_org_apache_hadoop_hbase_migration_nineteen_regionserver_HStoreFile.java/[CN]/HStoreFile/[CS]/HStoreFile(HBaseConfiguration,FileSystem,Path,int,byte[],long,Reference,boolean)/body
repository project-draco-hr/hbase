{
  this.conf=conf;
  this.fs=fs;
  this.basedir=basedir;
  this.encodedRegionName=encodedName;
  this.colFamily=colFamily;
  this.hri=null;
  long id=fileId;
  if (id == -1) {
    Path mapdir=HStoreFile.getMapDir(basedir,encodedRegionName,colFamily);
    Path testpath=null;
    do {
      id=Math.abs(rand.nextLong());
      testpath=new Path(mapdir,createHStoreFilename(id,-1));
    }
 while (fs.exists(testpath));
  }
  this.fileId=id;
  this.reference=ref;
  this.majorCompaction=mc;
}
