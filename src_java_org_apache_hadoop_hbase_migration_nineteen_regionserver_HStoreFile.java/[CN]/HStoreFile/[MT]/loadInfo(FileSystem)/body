{
  Path p=null;
  if (isReference()) {
    p=getInfoFilePath(reference.getEncodedRegionName(),this.reference.getFileId());
  }
 else {
    p=getInfoFilePath();
  }
  long length=filesystem.getFileStatus(p).getLen();
  boolean hasMoreThanSeqNum=length > (Byte.SIZE + Bytes.SIZEOF_LONG);
  DataInputStream in=new DataInputStream(filesystem.open(p));
  try {
    byte flag=in.readByte();
    if (flag == INFO_SEQ_NUM) {
      if (hasMoreThanSeqNum) {
        flag=in.readByte();
        if (flag == MAJOR_COMPACTION) {
          this.majorCompaction=in.readBoolean();
        }
      }
      return in.readLong();
    }
    throw new IOException("Cannot process log file: " + p);
  }
  finally {
    in.close();
  }
}
