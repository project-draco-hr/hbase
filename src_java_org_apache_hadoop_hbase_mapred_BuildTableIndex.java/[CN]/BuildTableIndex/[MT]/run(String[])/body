{
  if (args.length < 6) {
    printUsage("Too few arguments");
  }
  int numMapTasks=1;
  int numReduceTasks=1;
  String iconfFile=null;
  String indexDir=null;
  String tableName=null;
  StringBuffer columnNames=null;
  for (int i=0; i < args.length - 1; i++) {
    if ("-m".equals(args[i])) {
      numMapTasks=Integer.parseInt(args[++i]);
    }
 else     if ("-r".equals(args[i])) {
      numReduceTasks=Integer.parseInt(args[++i]);
    }
 else     if ("-indexConf".equals(args[i])) {
      iconfFile=args[++i];
    }
 else     if ("-indexDir".equals(args[i])) {
      indexDir=args[++i];
    }
 else     if ("-table".equals(args[i])) {
      tableName=args[++i];
    }
 else     if ("-columns".equals(args[i])) {
      columnNames=new StringBuffer(args[++i]);
      while (i + 1 < args.length && !args[i + 1].startsWith("-")) {
        columnNames.append(" ");
        columnNames.append(args[++i]);
      }
    }
 else {
      printUsage("Unsupported option " + args[i]);
    }
  }
  if (indexDir == null || tableName == null || columnNames == null) {
    printUsage("Index directory, table name and at least one column must " + "be specified");
  }
  Configuration conf=new HBaseConfiguration();
  if (iconfFile != null) {
    String content=readContent(iconfFile);
    IndexConfiguration iconf=new IndexConfiguration();
    iconf.addFromXML(content);
    conf.set("hbase.index.conf",content);
  }
  JobConf jobConf=createJob(conf,numMapTasks,numReduceTasks,indexDir,tableName,columnNames.toString());
  JobClient.runJob(jobConf);
}
