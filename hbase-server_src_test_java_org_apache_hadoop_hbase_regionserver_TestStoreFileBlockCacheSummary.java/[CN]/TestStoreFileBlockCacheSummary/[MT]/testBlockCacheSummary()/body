{
  HTable ht=TEST_UTIL.createTable(Bytes.toBytes(TEST_TABLE),FAMILY);
  addRows(ht,FAMILY);
  HTable ht2=TEST_UTIL.createTable(Bytes.toBytes(TEST_TABLE2),FAMILY);
  addRows(ht2,FAMILY);
  TEST_UTIL.flush();
  scan(ht,FAMILY);
  scan(ht2,FAMILY);
  BlockCache bc=new CacheConfig(TEST_UTIL.getConfiguration()).getBlockCache();
  List<BlockCacheColumnFamilySummary> bcs=bc.getBlockCacheColumnFamilySummaries(TEST_UTIL.getConfiguration());
  LOG.info("blockCacheSummary: " + bcs);
  assertTrue("blockCache summary has " + bcs.size() + " entries",bcs.size() >= 2);
  BlockCacheColumnFamilySummary e=bcs.get(bcs.size() - 2);
  assertEquals("table",TEST_TABLE,e.getTable());
  assertEquals("cf",TEST_CF,e.getColumnFamily());
  e=bcs.get(bcs.size() - 1);
  assertEquals("table",TEST_TABLE2,e.getTable());
  assertEquals("cf",TEST_CF,e.getColumnFamily());
  ht.close();
  ht2.close();
}
