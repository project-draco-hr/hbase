{
  if (server == null)   throw new NullPointerException("Passed server is null");
  int maximumAttempts=Math.max(1,master.getConfiguration().getInt("hbase.master.maximum.ping.server.attempts",10));
  for (int i=0; i < maximumAttempts; i++) {
    try {
      AdminService.BlockingInterface admin=getRsAdmin(server);
      if (admin != null) {
        ServerInfo info=ProtobufUtil.getServerInfo(admin);
        return info != null && info.hasServerName() && server.getStartcode() == info.getServerName().getStartCode();
      }
    }
 catch (    IOException ioe) {
      LOG.debug("Couldn't reach " + server + ", try="+ i+ " of "+ maximumAttempts,ioe);
    }
  }
  return false;
}
