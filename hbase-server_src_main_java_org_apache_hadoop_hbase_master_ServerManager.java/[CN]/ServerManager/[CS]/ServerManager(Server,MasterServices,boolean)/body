{
  this.master=master;
  this.services=services;
  Configuration c=master.getConfiguration();
  maxSkew=c.getLong("hbase.master.maxclockskew",30000);
  warningSkew=c.getLong("hbase.master.warningclockskew",10000);
  this.connection=connect ? (ClusterConnection)ConnectionFactory.createConnection(c) : null;
  int pingMaxAttempts=Math.max(1,master.getConfiguration().getInt("hbase.master.maximum.ping.server.attempts",10));
  int pingSleepInterval=Math.max(1,master.getConfiguration().getInt("hbase.master.ping.server.retry.sleep.interval",100));
  this.pingRetryCounterFactory=new RetryCounterFactory(pingMaxAttempts,pingSleepInterval);
}
