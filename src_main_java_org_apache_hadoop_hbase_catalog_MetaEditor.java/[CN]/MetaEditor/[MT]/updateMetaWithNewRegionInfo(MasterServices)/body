{
  final List<HTableDescriptor> htds=new ArrayList<HTableDescriptor>();
  Visitor v=new Visitor(){
    @Override public boolean visit(    Result r) throws IOException {
      if (r == null || r.isEmpty())       return true;
      HRegionInfo090x hrfm=getHRegionInfoForMigration(r);
      htds.add(hrfm.getTableDesc());
      masterServices.getMasterFileSystem().createTableDescriptor(hrfm.getTableDesc());
      HRegionInfo regionInfo=new HRegionInfo(hrfm);
      LOG.debug(" MetaEditor.updatemeta RegionInfo = " + regionInfo.toString() + " old HRI = "+ hrfm.toString());
      Put put=new Put(regionInfo.getRegionName());
      put.add(HConstants.CATALOG_FAMILY,HConstants.REGIONINFO_QUALIFIER,Writables.getBytes(regionInfo));
      masterServices.getCatalogTracker().waitForMetaServerConnectionDefault().put(CatalogTracker.META_REGION,put);
      LOG.info("Updated region " + regionInfo + " to META");
      return true;
    }
  }
;
  MetaReader.fullScan(masterServices.getCatalogTracker(),v);
  updateRootWithMetaMigrationStatus(masterServices.getCatalogTracker());
  return htds;
}
