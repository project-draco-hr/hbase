{
  final List<HTableDescriptor> htds=new ArrayList<HTableDescriptor>();
  Visitor v=new Visitor(){
    @Override public boolean visit(    Result r) throws IOException {
      if (r == null || r.isEmpty())       return true;
      HRegionInfo090x hrfm=getHRegionInfoForMigration(r);
      if (hrfm == null)       return true;
      htds.add(hrfm.getTableDesc());
      masterServices.getMasterFileSystem().createTableDescriptor(hrfm.getTableDesc());
      updateHRI(masterServices.getCatalogTracker().waitForRootServerConnectionDefault(),hrfm,CatalogTracker.ROOT_REGION);
      return true;
    }
  }
;
  MetaReader.fullScan(masterServices.getCatalogTracker().waitForRootServerConnectionDefault(),v,HRegionInfo.ROOT_REGIONINFO.getRegionName(),null);
  return htds;
}
