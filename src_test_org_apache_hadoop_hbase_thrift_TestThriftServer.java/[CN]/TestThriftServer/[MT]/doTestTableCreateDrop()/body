{
  ThriftServer.HBaseHandler handler=new ThriftServer.HBaseHandler();
  assertEquals(handler.getTableNames().size(),0);
  handler.createTable(tableAname,getColumnDescriptors());
  assertEquals(handler.getTableNames().size(),1);
  assertEquals(handler.getColumnDescriptors(tableAname).size(),2);
  assertTrue(handler.isTableEnabled(tableAname));
  handler.createTable(tableBname,new ArrayList<ColumnDescriptor>());
  assertEquals(handler.getTableNames().size(),2);
  handler.disableTable(tableBname);
  assertFalse(handler.isTableEnabled(tableBname));
  handler.deleteTable(tableBname);
  assertEquals(handler.getTableNames().size(),1);
  handler.disableTable(tableAname);
  assertFalse(handler.isTableEnabled(tableAname));
  handler.enableTable(tableAname);
  assertTrue(handler.isTableEnabled(tableAname));
  handler.disableTable(tableAname);
  handler.deleteTable(tableAname);
  List<ColumnDescriptor> cDescriptors=new ArrayList<ColumnDescriptor>();
  ColumnDescriptor badDescriptor=new ColumnDescriptor();
  badDescriptor.name=badColumnName;
  cDescriptors.add(badDescriptor);
  String message=null;
  try {
    handler.createTable(tableBname,cDescriptors);
  }
 catch (  IllegalArgument ia) {
    message=ia.message;
  }
  assertEquals("Family names must end in a colon: " + new String(badColumnName),message);
}
