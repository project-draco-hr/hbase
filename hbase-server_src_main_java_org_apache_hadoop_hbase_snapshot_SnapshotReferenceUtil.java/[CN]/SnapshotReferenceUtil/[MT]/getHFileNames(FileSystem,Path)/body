{
  final Set<String> names=new HashSet<String>();
  visitTableStoreFiles(fs,snapshotDir,new FSVisitor.StoreFileVisitor(){
    public void storeFile(    final String region,    final String family,    final String hfile) throws IOException {
      if (HFileLink.isHFileLink(hfile)) {
        names.add(HFileLink.getReferencedHFileName(hfile));
      }
 else {
        names.add(hfile);
      }
    }
  }
);
  return names;
}
