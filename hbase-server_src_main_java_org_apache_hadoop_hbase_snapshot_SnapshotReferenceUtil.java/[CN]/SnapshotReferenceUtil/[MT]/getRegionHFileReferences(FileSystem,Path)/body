{
  final Map<String,List<String>> familyFiles=new TreeMap<String,List<String>>();
  visitRegionStoreFiles(fs,snapshotRegionDir,new FSVisitor.StoreFileVisitor(){
    public void storeFile(    final String region,    final String family,    final String hfile) throws IOException {
      List<String> hfiles=familyFiles.get(family);
      if (hfiles == null) {
        hfiles=new LinkedList<String>();
        familyFiles.put(family,hfiles);
      }
      hfiles.add(hfile);
    }
  }
);
  return familyFiles;
}
