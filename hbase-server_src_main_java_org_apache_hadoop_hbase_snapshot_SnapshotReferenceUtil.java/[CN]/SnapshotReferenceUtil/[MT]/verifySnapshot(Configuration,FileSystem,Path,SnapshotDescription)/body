{
  final TableName table=TableName.valueOf(snapshotDesc.getTable());
  visitTableStoreFiles(fs,snapshotDir,new FSVisitor.StoreFileVisitor(){
    public void storeFile(    final String region,    final String family,    final String hfile) throws IOException {
      HFileLink link=HFileLink.create(conf,table,region,family,hfile);
      try {
        link.getFileStatus(fs);
      }
 catch (      FileNotFoundException e) {
        throw new CorruptedSnapshotException("Corrupted snapshot '" + snapshotDesc + "'",e);
      }
    }
  }
);
}
