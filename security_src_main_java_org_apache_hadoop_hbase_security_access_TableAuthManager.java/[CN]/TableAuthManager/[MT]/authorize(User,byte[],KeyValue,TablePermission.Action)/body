{
  List<TablePermission> userPerms=getUserPermissions(user.getShortName(),table);
  if (authorize(userPerms,table,kv,action)) {
    return true;
  }
  String[] groupNames=user.getGroupNames();
  if (groupNames != null) {
    for (    String group : groupNames) {
      List<TablePermission> groupPerms=getGroupPermissions(group,table);
      if (authorize(groupPerms,table,kv,action)) {
        return true;
      }
    }
  }
  return false;
}
