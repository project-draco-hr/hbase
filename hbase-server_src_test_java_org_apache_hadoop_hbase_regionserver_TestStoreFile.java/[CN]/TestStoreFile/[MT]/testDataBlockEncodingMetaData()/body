{
  Path dir=new Path(new Path(this.testDir,"7e0102"),"familyname");
  Path path=new Path(dir,"1234567890");
  DataBlockEncoding dataBlockEncoderAlgo=DataBlockEncoding.FAST_DIFF;
  HFileDataBlockEncoder dataBlockEncoder=new HFileDataBlockEncoderImpl(dataBlockEncoderAlgo,dataBlockEncoderAlgo);
  cacheConf=new CacheConfig(conf);
  StoreFile.Writer writer=new StoreFile.WriterBuilder(conf,cacheConf,fs,HConstants.DEFAULT_BLOCKSIZE).withFilePath(path).withDataBlockEncoder(dataBlockEncoder).withMaxKeyCount(2000).withChecksumType(CKTYPE).withBytesPerChecksum(CKBYTES).build();
  writer.close();
  StoreFile storeFile=new StoreFile(fs,writer.getPath(),conf,cacheConf,BloomType.NONE,dataBlockEncoder);
  StoreFile.Reader reader=storeFile.createReader();
  Map<byte[],byte[]> fileInfo=reader.loadFileInfo();
  byte[] value=fileInfo.get(HFileDataBlockEncoder.DATA_BLOCK_ENCODING);
  assertEquals(dataBlockEncoderAlgo.getNameInBytes(),value);
}
