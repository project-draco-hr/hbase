{
  Path f=new Path(ROOT_DIR,getName());
  HFileContext meta=new HFileContext();
  meta.setBlocksize(8 * 1024);
  StoreFile.Writer writer=new StoreFile.WriterBuilder(conf,cacheConf,this.fs).withFilePath(f).withFileContext(meta).build();
  writeStoreFile(writer);
  writer.close();
  StoreFile.Reader reader=new StoreFile.Reader(fs,f,cacheConf,DataBlockEncoding.NONE);
  KeyValue k=KeyValue.createFirstOnRow(HConstants.EMPTY_BYTE_ARRAY);
  StoreFileScanner s=reader.getStoreFileScanner(false,false);
  s.reseek(k);
  assertNotNull("Intial reseek should position at the beginning of the file",s.peek());
}
