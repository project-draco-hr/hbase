{
  Path f=new Path(ROOT_DIR,getName());
  HFileContext meta=new HFileContextBuilder().withBlockSize(8 * 1024).build();
  StoreFile.Writer writer=new StoreFile.WriterBuilder(conf,cacheConf,this.fs).withFilePath(f).withFileContext(meta).build();
  writeStoreFile(writer);
  writer.close();
  StoreFile.Reader reader=new StoreFile.Reader(fs,f,cacheConf,conf);
  KeyValue k=KeyValueUtil.createFirstOnRow(HConstants.EMPTY_BYTE_ARRAY);
  StoreFileScanner s=reader.getStoreFileScanner(false,false);
  s.reseek(k);
  assertNotNull("Intial reseek should position at the beginning of the file",s.peek());
}
