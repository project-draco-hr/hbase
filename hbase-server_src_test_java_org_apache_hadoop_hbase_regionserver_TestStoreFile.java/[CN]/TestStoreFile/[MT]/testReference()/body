{
  Path storedir=new Path(new Path(this.testDir,"regionname"),"familyname");
  Path dir=new Path(storedir,"1234567890");
  StoreFile.Writer writer=new StoreFile.WriterBuilder(conf,cacheConf,this.fs,8 * 1024).withOutputDir(dir).build();
  writeStoreFile(writer);
  StoreFile hsf=new StoreFile(this.fs,writer.getPath(),conf,cacheConf,BloomType.NONE,NoOpDataBlockEncoder.INSTANCE);
  StoreFile.Reader reader=hsf.createReader();
  KeyValue kv=KeyValue.createKeyValueFromKey(reader.midkey());
  byte[] midRow=kv.getRow();
  kv=KeyValue.createKeyValueFromKey(reader.getLastKey());
  byte[] finalRow=kv.getRow();
  Path refPath=StoreFile.split(fs,dir,hsf,midRow,true);
  StoreFile refHsf=new StoreFile(this.fs,refPath,conf,cacheConf,BloomType.NONE,NoOpDataBlockEncoder.INSTANCE);
  HFileScanner s=refHsf.createReader().getScanner(false,false);
  for (boolean first=true; (!s.isSeeked() && s.seekTo()) || s.next(); ) {
    ByteBuffer bb=s.getKey();
    kv=KeyValue.createKeyValueFromKey(bb);
    if (first) {
      assertTrue(Bytes.equals(kv.getRow(),midRow));
      first=false;
    }
  }
  assertTrue(Bytes.equals(kv.getRow(),finalRow));
}
