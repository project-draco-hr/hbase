{
  int numKVs=5 * numBlocks;
  List<KeyValue> kvs=new ArrayList<KeyValue>(numKVs);
  byte[] b=Bytes.toBytes("x");
  int totalSize=0;
  for (int i=numKVs; i > 0; i--) {
    KeyValue kv=new KeyValue(b,b,b,i,b);
    kvs.add(kv);
    totalSize+=kv.getLength() + 1;
  }
  int blockSize=totalSize / numBlocks;
  StoreFile.Writer writer=new StoreFile.WriterBuilder(conf,cacheConf,fs,blockSize).withFilePath(path).withMaxKeyCount(2000).withChecksumType(CKTYPE).withBytesPerChecksum(CKBYTES).build();
  kvs.remove(kvs.size() - 1);
  for (  KeyValue kv : kvs) {
    writer.append(kv);
  }
  writer.appendMetadata(0,false);
  writer.close();
  return writer;
}
