{
  int i=0;
  checkOpen();
  try {
    HRegion region=getRegion(regionName);
    this.cacheFlusher.reclaimMemcacheMemory();
    Integer[] locks=new Integer[b.length];
    for (int j=0; j < b.length; j++) {
      this.requestCount.incrementAndGet();
      validateValuesLength(b[j],region);
      locks[j]=getLockFromId(b[j].getRowLock());
    }
    i+=b.length - 1;
    region.batchUpdate(b,locks);
  }
 catch (  OutOfMemoryError error) {
    abort();
    LOG.fatal("Ran out of memory",error);
  }
catch (  WrongRegionException ex) {
    return i;
  }
catch (  NotServingRegionException ex) {
    return i;
  }
catch (  IOException e) {
    checkFileSystem();
    throw e;
  }
  return i;
}
