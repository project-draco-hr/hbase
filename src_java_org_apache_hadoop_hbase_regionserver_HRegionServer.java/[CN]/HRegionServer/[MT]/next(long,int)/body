{
  checkOpen();
  List<List<KeyValue>> results=new ArrayList<List<KeyValue>>();
  try {
    String scannerName=String.valueOf(scannerId);
    InternalScanner s=scanners.get(scannerName);
    if (s == null) {
      throw new UnknownScannerException("Name: " + scannerName);
    }
    this.leases.renewLease(scannerName);
    for (int i=0; i < nbRows; i++) {
      requestCount.incrementAndGet();
      List<KeyValue> values=new ArrayList<KeyValue>();
      while (s.next(values)) {
        if (!values.isEmpty()) {
          results.add(values);
          break;
        }
      }
    }
    return RowResult.createRowResultArray(results);
  }
 catch (  Throwable t) {
    throw convertThrowableToIOE(cleanup(t));
  }
}
