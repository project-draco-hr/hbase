{
  checkOpen();
  requestCount.incrementAndGet();
  ArrayList<RowResult> resultSets=new ArrayList<RowResult>();
  try {
    String scannerName=String.valueOf(scannerId);
    InternalScanner s=scanners.get(scannerName);
    if (s == null) {
      throw new UnknownScannerException("Name: " + scannerName);
    }
    this.leases.renewLease(scannerName);
    for (int i=0; i < nbRows; i++) {
      HbaseMapWritable<byte[],Cell> values=new HbaseMapWritable<byte[],Cell>();
      HStoreKey key=new HStoreKey();
      while (s.next(key,values)) {
        if (values.size() > 0) {
          resultSets.add(new RowResult(key.getRow(),values));
          break;
        }
      }
    }
    return resultSets.toArray(new RowResult[resultSets.size()]);
  }
 catch (  Throwable t) {
    throw convertThrowableToIOE(cleanup(t));
  }
}
