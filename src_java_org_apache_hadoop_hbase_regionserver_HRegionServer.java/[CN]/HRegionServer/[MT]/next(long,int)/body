{
  checkOpen();
  List<Result> results=new ArrayList<Result>();
  try {
    long start=System.currentTimeMillis();
    String scannerName=String.valueOf(scannerId);
    InternalScanner s=scanners.get(scannerName);
    if (s == null) {
      throw new UnknownScannerException("Name: " + scannerName);
    }
    this.leases.renewLease(scannerName);
    for (int i=0; i < nbRows; i++) {
      requestCount.incrementAndGet();
      List<KeyValue> values=new ArrayList<KeyValue>();
      boolean moreRows=s.next(values);
      if (!values.isEmpty()) {
        results.add(new Result(values));
      }
      if (!moreRows) {
        break;
      }
    }
    LOG.debug("Result[]next time: " + (System.currentTimeMillis() - start) + " (ms)");
    return results.toArray(new Result[0]);
  }
 catch (  Throwable t) {
    throw convertThrowableToIOE(cleanup(t));
  }
}
