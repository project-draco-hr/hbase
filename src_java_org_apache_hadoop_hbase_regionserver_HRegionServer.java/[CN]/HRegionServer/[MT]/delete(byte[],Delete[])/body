{
  int i=0;
  checkOpen();
  boolean isMetaRegion=false;
  try {
    boolean writeToWAL=true;
    this.cacheFlusher.reclaimMemStoreMemory();
    Integer[] locks=new Integer[deletes.length];
    HRegion region=getRegion(regionName);
    isMetaRegion=region.getRegionInfo().isMetaRegion();
    for (i=0; i < deletes.length; i++) {
      this.requestCount.incrementAndGet();
      locks[i]=getLockFromId(deletes[i].getLockId());
      region.delete(deletes[i],locks[i],writeToWAL);
    }
  }
 catch (  WrongRegionException ex) {
    LOG.debug("Batch deletes: " + i,ex);
    return i;
  }
catch (  NotServingRegionException ex) {
    return i;
  }
catch (  Throwable t) {
    throw convertThrowableToIOE(cleanup(t));
  }
  this.hlog.sync(isMetaRegion);
  return -1;
}
