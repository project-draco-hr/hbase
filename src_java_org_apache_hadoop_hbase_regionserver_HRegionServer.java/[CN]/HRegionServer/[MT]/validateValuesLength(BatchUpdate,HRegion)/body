{
  HTableDescriptor desc=region.getTableDesc();
  for (Iterator<BatchOperation> iter=batchUpdate.iterator(); iter.hasNext(); ) {
    BatchOperation operation=iter.next();
    int maxLength=desc.getFamily(HStoreKey.getFamily(operation.getColumn())).getMaxValueLength();
    if (operation.getValue() != null)     if (operation.getValue().length > maxLength) {
      throw new IOException("Value in column " + Bytes.toString(operation.getColumn()) + " is too long. "+ operation.getValue().length+ " instead of "+ maxLength);
    }
  }
}
