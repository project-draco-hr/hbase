{
  HTableDescriptor desc=region.getTableDesc();
  for (Iterator<BatchOperation> iter=batchUpdate.iterator(); iter.hasNext(); ) {
    BatchOperation operation=iter.next();
    if (operation.getValue() != null) {
      HColumnDescriptor fam=desc.getFamily(HStoreKey.getFamily(operation.getColumn()));
      if (fam != null) {
        int maxLength=fam.getMaxValueLength();
        if (operation.getValue().length > maxLength) {
          throw new IOException("Value in column " + Bytes.toString(operation.getColumn()) + " is too long. "+ operation.getValue().length+ " instead of "+ maxLength);
        }
      }
    }
  }
}
