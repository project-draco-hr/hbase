{
  abortRequested=false;
  stopRequested.set(false);
  shutdownHDFS.set(true);
  this.server=HBaseRPC.getServer(this,address.getBindAddress(),address.getPort(),conf.getInt("hbase.regionserver.handler.count",10),false,conf);
  this.server.setErrorHandler(this);
  this.serverInfo=new HServerInfo(new HServerAddress(new InetSocketAddress(address.getBindAddress(),this.server.getListenerAddress().getPort())),System.currentTimeMillis(),this.conf.getInt("hbase.regionserver.info.port",60030),machineName);
  if (this.serverInfo.getServerAddress() == null) {
    throw new NullPointerException("Server address cannot be null; " + "hbase-958 debugging");
  }
  reinitializeThreads();
  reinitializeZooKeeper();
  int nbBlocks=conf.getInt("hbase.regionserver.nbreservationblocks",4);
  for (int i=0; i < nbBlocks; i++) {
    reservedSpace.add(new byte[DEFAULT_SIZE_RESERVATION_BLOCK]);
  }
}
