{
  EventType type=event.getType();
  KeeperState state=event.getState();
  LOG.info("Got ZooKeeper event, state: " + state + ", type: "+ type+ ", path: "+ event.getPath());
  if (stopRequested.get()) {
    LOG.debug("Ignoring ZooKeeper event while shutting down");
    return;
  }
  if (state == KeeperState.Expired) {
    LOG.error("ZooKeeper session expired");
    restart();
  }
 else   if (type == EventType.NodeDeleted) {
    watchMasterAddress();
  }
 else   if (type == EventType.NodeCreated) {
    getMaster();
    watchMasterAddress();
  }
}
