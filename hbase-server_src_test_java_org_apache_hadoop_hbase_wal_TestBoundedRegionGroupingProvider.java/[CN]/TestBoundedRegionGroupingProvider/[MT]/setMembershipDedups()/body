{
  final int temp=conf.getInt(NUM_REGION_GROUPS,DEFAULT_NUM_REGION_GROUPS);
  WALFactory wals=null;
  try {
    conf.setInt(NUM_REGION_GROUPS,temp * 4);
    wals=new WALFactory(conf,null,currentTest.getMethodName());
    final Set<WAL> seen=new HashSet<WAL>(temp * 4);
    final Random random=new Random();
    int count=0;
    for (int i=0; i < temp * 8; i++) {
      final WAL maybeNewWAL=wals.getWAL(Bytes.toBytes(random.nextInt()));
      LOG.info("Iteration " + i + ", checking wal "+ maybeNewWAL);
      if (seen.add(maybeNewWAL)) {
        count++;
      }
    }
    assertEquals("received back a different number of WALs that are not equal() to each other " + "than the bound we placed.",temp * 4,count);
  }
  finally {
    if (wals != null) {
      wals.close();
    }
    conf.setInt(NUM_REGION_GROUPS,temp);
  }
}
