{
  LOG.info("TestTaskErr - cleanup task node once in ERR state");
  conf.setInt("hbase.splitlog.max.resubmit",0);
  slm=new SplitLogManager(zkw,conf,stopper,"dummy-master",null);
  slm.finishInitialization();
  TaskBatch batch=new TaskBatch();
  String tasknode=submitTaskAndWait(batch,"foo");
  ZKUtil.setData(zkw,tasknode,TaskState.TASK_ERR.get("worker"));
synchronized (batch) {
    while (batch.installed != batch.error) {
      batch.wait();
    }
  }
  waitForCounter(tot_mgr_task_deleted,0,1,1000);
  assertTrue(ZKUtil.checkExists(zkw,tasknode) == -1);
  conf.setInt("hbase.splitlog.max.resubmit",ZKSplitLog.DEFAULT_MAX_RESUBMIT);
}
