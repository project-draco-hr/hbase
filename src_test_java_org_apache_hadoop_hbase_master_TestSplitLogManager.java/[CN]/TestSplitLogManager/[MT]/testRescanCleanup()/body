{
  LOG.info("TestRescanCleanup - ensure RESCAN nodes are cleaned up");
  conf.setInt("hbase.splitlog.manager.timeout",1000);
  conf.setInt("hbase.splitlog.manager.timeoutmonitor.period",100);
  slm=new SplitLogManager(zkw,conf,stopper,"dummy-master",null);
  slm.finishInitialization();
  TaskBatch batch=new TaskBatch();
  String tasknode=submitTaskAndWait(batch,"foo/1");
  int version=ZKUtil.checkExists(zkw,tasknode);
  ZKUtil.setData(zkw,tasknode,TaskState.TASK_OWNED.get("worker1"));
  waitForCounter(tot_mgr_heartbeat,0,1,1000);
  waitForCounter(new Expr(){
    @Override public long eval(){
      return (tot_mgr_resubmit.get() + tot_mgr_resubmit_failed.get());
    }
  }
,0,1,5 * 60000);
  if (tot_mgr_resubmit_failed.get() == 0) {
    int version1=ZKUtil.checkExists(zkw,tasknode);
    assertTrue(version1 > version);
    byte[] taskstate=ZKUtil.getData(zkw,tasknode);
    assertTrue(Arrays.equals(TaskState.TASK_UNASSIGNED.get("dummy-master"),taskstate));
    waitForCounter(tot_mgr_rescan_deleted,0,1,1000);
  }
 else {
    LOG.warn("Could not run test. Lost ZK connection?");
  }
  return;
}
