{
  LOG.info("testDeadWorker");
  conf.setLong("hbase.splitlog.max.resubmit",0);
  slm=new SplitLogManager(zkw,conf,stopper,"dummy-master",null);
  slm.finishInitialization();
  TaskBatch batch=new TaskBatch();
  String tasknode=submitTaskAndWait(batch,"foo/1");
  int version=ZKUtil.checkExists(zkw,tasknode);
  ZKUtil.setData(zkw,tasknode,TaskState.TASK_OWNED.get("worker1"));
  waitForCounter(tot_mgr_heartbeat,0,1,1000);
  slm.handleDeadWorker("worker1");
  waitForCounter(tot_mgr_resubmit,0,1,1000);
  waitForCounter(tot_mgr_resubmit_dead_server_task,0,1,1000);
  int version1=ZKUtil.checkExists(zkw,tasknode);
  assertTrue(version1 > version);
  byte[] taskstate=ZKUtil.getData(zkw,tasknode);
  assertTrue(Arrays.equals(TaskState.TASK_UNASSIGNED.get("dummy-master"),taskstate));
  return;
}
