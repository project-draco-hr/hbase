{
  int kvsRolledback=0;
  for (int i=start; i < end; i++) {
    if (batchOp.retCodeDetails[i].getOperationStatusCode() != OperationStatusCode.SUCCESS) {
      continue;
    }
    Map<byte[],List<Cell>> familyMap=familyMaps[i];
    for (    Map.Entry<byte[],List<Cell>> e : familyMap.entrySet()) {
      byte[] family=e.getKey();
      List<Cell> cells=e.getValue();
      Store store=getStore(family);
      for (      Cell cell : cells) {
        store.rollback(KeyValueUtil.ensureKeyValue(cell));
        kvsRolledback++;
      }
    }
  }
  LOG.debug("rollbackMemstore rolled back " + kvsRolledback + " keyvalues from start:"+ start+ " to end:"+ end);
}
