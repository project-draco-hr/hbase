{
synchronized (writestate) {
    while (writestate.compacting > 0 || writestate.flushing) {
      LOG.debug("waiting for " + writestate.compacting + " compactions"+ (writestate.flushing ? " & cache flush" : "")+ " to complete for region "+ this);
      try {
        writestate.wait();
      }
 catch (      InterruptedException iex) {
        Thread.currentThread().interrupt();
      }
    }
  }
}
