{
  long size=0;
  boolean upsert=delta && store.getFamily().getMaxVersions() == 1;
  int count=cells.size();
  if (upsert) {
    size+=store.upsert(cells,getSmallestReadPoint());
  }
 else {
    for (int i=0; i < count; i++) {
      Cell cell=cells.get(i);
      if (cell.getSequenceId() == 0 || replay) {
        CellUtil.setSequenceId(cell,sequenceId);
      }
      size+=store.add(cell);
    }
  }
  return size;
}
