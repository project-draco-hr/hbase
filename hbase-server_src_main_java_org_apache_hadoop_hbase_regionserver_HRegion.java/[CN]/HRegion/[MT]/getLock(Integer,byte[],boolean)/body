{
  Integer lid=null;
  if (lockid == null) {
    lid=internalObtainRowLock(row,waitForLock);
  }
 else {
    if (!isRowLocked(lockid)) {
      throw new IOException("Invalid row lock");
    }
    lid=lockid;
  }
  return lid;
}
