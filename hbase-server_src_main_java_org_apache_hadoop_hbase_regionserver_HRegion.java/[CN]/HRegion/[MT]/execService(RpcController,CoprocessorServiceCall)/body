{
  String serviceName=call.getServiceName();
  String methodName=call.getMethodName();
  if (!coprocessorServiceHandlers.containsKey(serviceName)) {
    throw new UnknownProtocolException(null,"No registered coprocessor service found for name " + serviceName + " in region "+ Bytes.toStringBinary(getRegionName()));
  }
  Service service=coprocessorServiceHandlers.get(serviceName);
  Descriptors.ServiceDescriptor serviceDesc=service.getDescriptorForType();
  Descriptors.MethodDescriptor methodDesc=serviceDesc.findMethodByName(methodName);
  if (methodDesc == null) {
    throw new UnknownProtocolException(service.getClass(),"Unknown method " + methodName + " called on service "+ serviceName+ " in region "+ Bytes.toStringBinary(getRegionName()));
  }
  Message request=service.getRequestPrototype(methodDesc).newBuilderForType().mergeFrom(call.getRequest()).build();
  final Message.Builder responseBuilder=service.getResponsePrototype(methodDesc).newBuilderForType();
  service.callMethod(methodDesc,controller,request,new RpcCallback<Message>(){
    @Override public void run(    Message message){
      if (message != null) {
        responseBuilder.mergeFrom(message);
      }
    }
  }
);
  return responseBuilder.build();
}
