{
  if (timestampSlop == HConstants.LATEST_TIMESTAMP) {
    return;
  }
  long maxTs=now + timestampSlop;
  for (  List<Cell> kvs : familyMap.values()) {
    for (    Cell cell : kvs) {
      KeyValue kv=KeyValueUtil.ensureKeyValue(cell);
      if (!kv.isLatestTimestamp() && kv.getTimestamp() > maxTs) {
        throw new FailedSanityCheckException("Timestamp for KV out of range " + cell + " (too.new="+ timestampSlop+ ")");
      }
    }
  }
}
