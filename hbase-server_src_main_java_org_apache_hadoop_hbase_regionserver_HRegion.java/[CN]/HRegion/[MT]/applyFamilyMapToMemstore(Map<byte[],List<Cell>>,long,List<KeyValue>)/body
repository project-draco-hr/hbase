{
  long size=0;
  for (  Map.Entry<byte[],List<Cell>> e : familyMap.entrySet()) {
    byte[] family=e.getKey();
    List<Cell> cells=e.getValue();
    Store store=getStore(family);
    for (    Cell cell : cells) {
      KeyValue kv=KeyValueUtil.ensureKeyValue(cell);
      kv.setSequenceId(mvccNum);
      Pair<Long,Cell> ret=store.add(kv);
      size+=ret.getFirst();
      memstoreCells.add(KeyValueUtil.ensureKeyValue(ret.getSecond()));
    }
  }
  return size;
}
