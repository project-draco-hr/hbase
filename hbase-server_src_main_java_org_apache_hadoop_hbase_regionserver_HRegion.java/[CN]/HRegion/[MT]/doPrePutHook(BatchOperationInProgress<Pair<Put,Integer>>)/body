{
  WALEdit walEdit=new WALEdit();
  if (coprocessorHost != null) {
    for (int i=0; i < batchOp.operations.length; i++) {
      Pair<Put,Integer> nextPair=batchOp.operations[i];
      Put put=nextPair.getFirst();
      if (coprocessorHost.prePut(put,walEdit,put.getWriteToWAL())) {
        batchOp.retCodeDetails[i]=OperationStatus.SUCCESS;
      }
      if (!walEdit.isEmpty()) {
        batchOp.walEditsFromCoprocessors[i]=walEdit;
        walEdit=new WALEdit();
      }
    }
  }
}
