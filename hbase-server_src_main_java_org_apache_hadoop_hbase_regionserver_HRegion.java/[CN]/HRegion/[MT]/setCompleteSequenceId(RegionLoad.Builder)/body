{
  long lastFlushOpSeqIdLocal=this.lastFlushOpSeqId;
  byte[] encodedRegionName=this.getRegionInfo().getEncodedNameAsBytes();
  regionLoadBldr.clearStoreCompleteSequenceId();
  for (  byte[] familyName : this.stores.keySet()) {
    long oldestUnflushedSeqId=this.wal.getEarliestMemstoreSeqNum(encodedRegionName,familyName);
    regionLoadBldr.addStoreCompleteSequenceId(StoreSequenceId.newBuilder().setFamilyName(ByteString.copyFrom(familyName)).setSequenceId(oldestUnflushedSeqId < 0 ? lastFlushOpSeqIdLocal : oldestUnflushedSeqId - 1).build());
  }
  return regionLoadBldr.setCompleteSequenceId(this.maxFlushedSeqId);
}
