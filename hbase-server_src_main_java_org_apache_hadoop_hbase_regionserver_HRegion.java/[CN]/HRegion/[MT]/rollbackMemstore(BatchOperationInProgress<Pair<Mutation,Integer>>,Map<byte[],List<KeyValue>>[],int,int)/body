{
  int kvsRolledback=0;
  for (int i=start; i < end; i++) {
    if (batchOp.retCodeDetails[i].getOperationStatusCode() != OperationStatusCode.SUCCESS) {
      continue;
    }
    Map<byte[],List<KeyValue>> familyMap=familyMaps[i];
    for (    Map.Entry<byte[],List<KeyValue>> e : familyMap.entrySet()) {
      byte[] family=e.getKey();
      List<KeyValue> edits=e.getValue();
      HStore store=getStore(family);
      for (      KeyValue kv : edits) {
        store.rollback(kv);
        kvsRolledback++;
      }
    }
  }
  LOG.debug("rollbackMemstore rolled back " + kvsRolledback + " keyvalues from start:"+ start+ " to end:"+ end);
}
