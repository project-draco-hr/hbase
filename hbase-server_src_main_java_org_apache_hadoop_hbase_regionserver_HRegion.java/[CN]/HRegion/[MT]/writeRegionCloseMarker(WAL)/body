{
  Map<byte[],List<Path>> storeFiles=new TreeMap<byte[],List<Path>>(Bytes.BYTES_COMPARATOR);
  for (  Map.Entry<byte[],Store> entry : getStores().entrySet()) {
    Store store=entry.getValue();
    ArrayList<Path> storeFileNames=new ArrayList<Path>();
    for (    StoreFile storeFile : store.getStorefiles()) {
      storeFileNames.add(storeFile.getPath());
    }
    storeFiles.put(entry.getKey(),storeFileNames);
  }
  RegionEventDescriptor regionEventDesc=ProtobufUtil.toRegionEventDescriptor(RegionEventDescriptor.EventType.REGION_CLOSE,getRegionInfo(),getSequenceId().get(),getRegionServerServices().getServerName(),storeFiles);
  WALUtil.writeRegionEventMarker(wal,getTableDesc(),getRegionInfo(),regionEventDesc,getSequenceId());
}
