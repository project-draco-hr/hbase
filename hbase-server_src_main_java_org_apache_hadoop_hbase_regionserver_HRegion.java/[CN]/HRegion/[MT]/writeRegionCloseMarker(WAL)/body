{
  Map<byte[],List<Path>> storeFiles=new TreeMap<byte[],List<Path>>(Bytes.BYTES_COMPARATOR);
  for (  Store store : getStores()) {
    ArrayList<Path> storeFileNames=new ArrayList<Path>();
    for (    StoreFile storeFile : store.getStorefiles()) {
      storeFileNames.add(storeFile.getPath());
    }
    storeFiles.put(store.getFamily().getName(),storeFileNames);
  }
  RegionEventDescriptor regionEventDesc=ProtobufUtil.toRegionEventDescriptor(RegionEventDescriptor.EventType.REGION_CLOSE,getRegionInfo(),getSequenceId().get(),getRegionServerServices().getServerName(),storeFiles);
  WALUtil.writeRegionEventMarker(wal,getTableDesc(),getRegionInfo(),regionEventDesc,getSequenceId());
  if (this.fs.getFileSystem().exists(this.fs.getRegionDir())) {
    WALSplitter.writeRegionSequenceIdFile(this.fs.getFileSystem(),this.fs.getRegionDir(),getSequenceId().get(),0);
  }
}
