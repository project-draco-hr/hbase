{
switch (op) {
case INCREMENT:
case APPEND:
case GET:
case SCAN:
case SPLIT_REGION:
case MERGE_REGION:
    if (this.isRecovering()) {
      throw new RegionInRecoveryException(this.getRegionNameAsString() + " is recovering");
    }
  break;
default :
break;
}
if (op == Operation.MERGE_REGION || op == Operation.SPLIT_REGION) {
return;
}
if (this.closing.get()) {
throw new NotServingRegionException(getRegionNameAsString() + " is closing");
}
lock(lock.readLock());
if (this.closed.get()) {
lock.readLock().unlock();
throw new NotServingRegionException(getRegionNameAsString() + " is closed");
}
}
