{
  WALEdit walEdit=new WALEdit();
  if (coprocessorHost != null) {
    for (int i=0; i < batchOp.operations.length; i++) {
      Pair<Mutation,Integer> nextPair=batchOp.operations[i];
      Mutation m=nextPair.getFirst();
      if (m instanceof Put) {
        if (coprocessorHost.prePut((Put)m,walEdit,m.getWriteToWAL())) {
          batchOp.retCodeDetails[i]=OperationStatus.SUCCESS;
        }
      }
 else       if (m instanceof Delete) {
        if (coprocessorHost.preDelete((Delete)m,walEdit,m.getWriteToWAL())) {
          batchOp.retCodeDetails[i]=OperationStatus.SUCCESS;
        }
      }
 else {
        batchOp.retCodeDetails[i]=new OperationStatus(OperationStatusCode.FAILURE,"Put/Delete mutations only supported in batchMutate() now");
      }
      if (!walEdit.isEmpty()) {
        batchOp.walEditsFromCoprocessors[i]=walEdit;
        walEdit=new WALEdit();
      }
    }
  }
}
