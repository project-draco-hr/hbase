{
  HRegion region;
  String metaStr=Bytes.toString(HConstants.META_TABLE_NAME);
  if (p.getName().startsWith(metaStr)) {
    region=HRegion.newHRegion(p,log,fs,c,HRegionInfo.FIRST_META_REGIONINFO,HTableDescriptor.META_TABLEDESC,null);
  }
 else {
    throw new IOException("Not a known catalog table: " + p.toString());
  }
  try {
    region.initialize();
    if (majorCompact) {
      region.compactStores(true);
    }
 else {
      Scan scan=new Scan();
      RegionScanner scanner=region.getScanner(scan);
      try {
        List<KeyValue> kvs=new ArrayList<KeyValue>();
        boolean done;
        do {
          kvs.clear();
          done=scanner.next(kvs);
          if (kvs.size() > 0)           LOG.info(kvs);
        }
 while (done);
      }
  finally {
        scanner.close();
      }
    }
  }
  finally {
    region.close();
  }
}
