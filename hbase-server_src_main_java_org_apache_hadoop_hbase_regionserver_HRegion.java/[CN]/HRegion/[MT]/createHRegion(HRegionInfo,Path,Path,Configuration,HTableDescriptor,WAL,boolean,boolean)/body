{
  LOG.info("creating HRegion " + info.getTable().getNameAsString() + " HTD == "+ hTableDescriptor+ " RootDir = "+ rootDir+ " Table name == "+ info.getTable().getNameAsString());
  FileSystem fs=FileSystem.get(conf);
  HRegionFileSystem.createRegionOnFileSystem(conf,fs,tableDir,info);
  WAL effectiveWAL=wal;
  if (wal == null && !ignoreWAL) {
    Configuration confForWAL=new Configuration(conf);
    confForWAL.set(HConstants.HBASE_DIR,rootDir.toString());
    effectiveWAL=(new WALFactory(confForWAL,Collections.<WALActionsListener>singletonList(new MetricsWAL()),"hregion-" + RandomStringUtils.randomAscii(8))).getWAL(info.getEncodedNameAsBytes());
  }
  HRegion region=HRegion.newHRegion(tableDir,effectiveWAL,fs,conf,info,hTableDescriptor,null);
  if (initialize) {
    region.setSequenceId(region.initialize(null));
  }
  return region;
}
