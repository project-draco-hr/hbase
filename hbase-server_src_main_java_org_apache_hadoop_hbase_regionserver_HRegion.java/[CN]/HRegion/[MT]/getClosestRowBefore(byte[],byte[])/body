{
  if (coprocessorHost != null) {
    Result result=new Result();
    if (coprocessorHost.preGetClosestRowBefore(row,family,result)) {
      return result;
    }
  }
  checkRow(row,"getClosestRowBefore");
  startRegionOperation(Operation.GET);
  this.readRequestsCount.increment();
  try {
    Store store=getStore(family);
    KeyValue key=store.getRowKeyAtOrBefore(row);
    Result result=null;
    if (key != null) {
      Get get=new Get(key.getRow());
      get.addFamily(family);
      result=get(get);
    }
    if (coprocessorHost != null) {
      coprocessorHost.postGetClosestRowBefore(row,family,result);
    }
    return result;
  }
  finally {
    closeRegionOperation();
  }
}
