{
  if (!ownedByCurrentThread()) {
    throw new IllegalArgumentException("Lock held by thread: " + thread + " cannot be released by different thread: "+ Thread.currentThread());
  }
  lockCount--;
  if (lockCount == 0) {
    RowLockContext existingContext=lockedRows.remove(row);
    if (existingContext != this) {
      throw new RuntimeException("Internal row lock state inconsistent, should not happen, row: " + row);
    }
    latch.countDown();
  }
}
