{
  Cell nextKv;
  boolean moreCellsInRow=false;
  boolean tmpKeepProgress=scannerContext.getKeepProgress();
  LimitScope limitScope=LimitScope.BETWEEN_CELLS;
  do {
    scannerContext.setKeepProgress(true);
    heap.next(results,scannerContext);
    scannerContext.setKeepProgress(tmpKeepProgress);
    nextKv=heap.peek();
    moreCellsInRow=moreCellsInRow(nextKv,currentRow,offset,length);
    if (scannerContext.checkBatchLimit(limitScope)) {
      return scannerContext.setScannerState(NextState.BATCH_LIMIT_REACHED).hasMoreValues();
    }
 else     if (scannerContext.checkSizeLimit(limitScope)) {
      ScannerContext.NextState state=moreCellsInRow ? NextState.SIZE_LIMIT_REACHED_MID_ROW : NextState.SIZE_LIMIT_REACHED;
      return scannerContext.setScannerState(state).hasMoreValues();
    }
  }
 while (moreCellsInRow);
  return nextKv != null;
}
