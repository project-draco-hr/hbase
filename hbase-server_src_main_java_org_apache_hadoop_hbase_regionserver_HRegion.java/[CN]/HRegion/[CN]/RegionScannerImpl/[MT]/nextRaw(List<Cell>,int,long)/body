{
  if (storeHeap == null) {
    throw new UnknownScannerException("Scanner was closed");
  }
  NextState state;
  if (outResults.isEmpty()) {
    state=nextInternal(outResults,batchLimit,remainingResultSize);
  }
 else {
    List<Cell> tmpList=new ArrayList<Cell>();
    state=nextInternal(tmpList,batchLimit,remainingResultSize);
    outResults.addAll(tmpList);
  }
  if (!NextState.isValidState(state)) {
    throw new IOException("Invalid state returned from nextInternal. state:" + state);
  }
  if (!state.sizeLimitReached())   resetFilters();
  if (isFilterDoneInternal()) {
    state=NextState.makeState(NextState.State.NO_MORE_VALUES,state.getResultSize());
  }
  return state;
}
