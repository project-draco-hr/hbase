{
  MapFile.Reader in=new MapFile.Reader(fs,getMapFilePath().toString(),c);
  try {
    MapFile.Writer outA=new MapFile.Writer(c,fs,dstA.getMapFilePath().toString(),HStoreKey.class,ImmutableBytesWritable.class);
    try {
      MapFile.Writer outB=new MapFile.Writer(c,fs,dstB.getMapFilePath().toString(),HStoreKey.class,ImmutableBytesWritable.class);
      try {
        long count=0;
        HStoreKey readkey=new HStoreKey();
        ImmutableBytesWritable readval=new ImmutableBytesWritable();
        while (in.next(readkey,readval)) {
          if (readkey.getRow().compareTo(midKey) < 0) {
            outA.append(readkey,readval);
          }
 else {
            outB.append(readkey,readval);
          }
          if (LOG.isDebugEnabled()) {
            count++;
            if ((count % 10000) == 0) {
              LOG.debug("Write " + count + " records");
            }
          }
        }
      }
  finally {
        outB.close();
      }
    }
  finally {
      outA.close();
    }
  }
  finally {
    in.close();
  }
  long seqid=loadInfo(fs);
  dstA.writeInfo(fs,seqid);
  dstB.writeInfo(fs,seqid);
}
