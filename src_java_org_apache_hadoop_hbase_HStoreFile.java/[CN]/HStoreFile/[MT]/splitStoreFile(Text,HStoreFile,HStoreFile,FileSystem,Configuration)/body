{
  MapFile.Reader in=new MapFile.Reader(fs,getMapFilePath().toString(),conf);
  try {
    MapFile.Writer outA=new MapFile.Writer(conf,fs,dstA.getMapFilePath().toString(),HStoreKey.class,BytesWritable.class);
    try {
      MapFile.Writer outB=new MapFile.Writer(conf,fs,dstB.getMapFilePath().toString(),HStoreKey.class,BytesWritable.class);
      try {
        HStoreKey readkey=new HStoreKey();
        BytesWritable readval=new BytesWritable();
        while (in.next(readkey,readval)) {
          Text key=readkey.getRow();
          if (key.compareTo(midKey) < 0) {
            outA.append(readkey,readval);
          }
 else {
            outB.append(readkey,readval);
          }
        }
      }
  finally {
        outB.close();
      }
    }
  finally {
      outA.close();
    }
  }
  finally {
    in.close();
  }
  long seqid=loadInfo(fs);
  dstA.writeInfo(fs,seqid);
  dstB.writeInfo(fs,seqid);
}
