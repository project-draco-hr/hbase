{
  Path mapdir=HStoreFile.getMapDir(dir,encodedRegionName,colFamily);
  Path testpath1=null;
  Path testpath2=null;
  long fileId=-1;
  do {
    fileId=Math.abs(rand.nextLong());
    testpath1=new Path(mapdir,createHStoreFilename(fileId));
    testpath2=new Path(mapdir,createHStoreInfoFilename(fileId));
  }
 while (fs.exists(testpath1) || fs.exists(testpath2));
  return new HStoreFile(conf,dir,encodedRegionName,colFamily,fileId);
}
