{
  if (!blockCacheEnabled) {
    return super.createDataFileReader(fs,dataFile,conf);
  }
  LOG.info("Block Cache enabled");
  final int blockSize=conf.getInt("hbase.hstore.blockCache.blockSize",64 * 1024);
  return new SequenceFile.Reader(fs,dataFile,conf){
    @Override protected FSDataInputStream openFile(    FileSystem fs,    Path file,    int bufferSize,    long length) throws IOException {
      return new FSDataInputStream(new BlockFSInputStream(super.openFile(fs,file,bufferSize,length),length,blockSize));
    }
  }
;
}
