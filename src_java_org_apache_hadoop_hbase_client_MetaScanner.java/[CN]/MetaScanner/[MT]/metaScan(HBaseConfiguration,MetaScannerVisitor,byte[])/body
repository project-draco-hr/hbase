{
  HConnection connection=HConnectionManager.getConnection(configuration);
  byte[] startRow=tableName == null || tableName.length == 0 ? HConstants.EMPTY_START_ROW : HRegionInfo.createRegionName(tableName,null,ZEROES);
  do {
    ScannerCallable callable=new ScannerCallable(connection,META_TABLE_NAME,COLUMN_FAMILY_ARRAY,startRow,LATEST_TIMESTAMP,null);
    connection.getRegionServerWithRetries(callable);
    try {
      RowResult r=null;
      do {
        r=connection.getRegionServerWithRetries(callable);
        if (r == null || r.size() == 0) {
          break;
        }
      }
 while (visitor.processRow(r));
      startRow=callable.getHRegionInfo().getEndKey();
    }
  finally {
      callable.setClose();
      connection.getRegionServerWithRetries(callable);
    }
  }
 while (Bytes.compareTo(startRow,LAST_ROW) != 0);
}
