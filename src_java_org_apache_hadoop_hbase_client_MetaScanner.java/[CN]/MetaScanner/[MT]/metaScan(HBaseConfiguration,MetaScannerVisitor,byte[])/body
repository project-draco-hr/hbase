{
  HConnection connection=HConnectionManager.getConnection(configuration);
  byte[] startRow=tableName == null || tableName.length == 0 ? HConstants.EMPTY_START_ROW : HRegionInfo.createRegionName(tableName,null,ZEROES);
  ScannerCallable callable=null;
  do {
    callable=new ScannerCallable(connection,META_TABLE_NAME,COLUMN_FAMILY_ARRAY,startRow,LATEST_TIMESTAMP,null);
    connection.getRegionServerWithRetries(callable);
    try {
      RowResult r=null;
      do {
        RowResult[] rrs=connection.getRegionServerWithRetries(callable);
        if (rrs == null || rrs.length == 0 || rrs[0].size() == 0) {
          break;
        }
        r=rrs[0];
      }
 while (visitor.processRow(r));
      startRow=callable.getHRegionInfo().getEndKey();
    }
  finally {
      callable.setClose();
      connection.getRegionServerWithRetries(callable);
    }
  }
 while (HStoreKey.compareTwoRowKeys(callable.getHRegionInfo(),startRow,LAST_ROW) != 0);
}
