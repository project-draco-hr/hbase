{
  HConnection connection=HConnectionManager.getConnection(configuration);
  byte[] startRow=tableName == null || tableName.length == 0 ? HConstants.EMPTY_START_ROW : HRegionInfo.createRegionName(tableName,null,ZEROES);
  ScannerCallable callable=null;
  do {
    Scan scan=new Scan(startRow).addFamily(CATALOG_FAMILY);
    callable=new ScannerCallable(connection,META_TABLE_NAME,scan.getStartRow(),scan);
    connection.getRegionServerWithRetries(callable);
    try {
      Result r=null;
      do {
        Result[] rrs=connection.getRegionServerWithRetries(callable);
        if (rrs == null || rrs.length == 0 || rrs[0].size() == 0) {
          break;
        }
        r=rrs[0];
      }
 while (visitor.processRow(r));
      startRow=callable.getHRegionInfo().getEndKey();
    }
  finally {
      callable.setClose();
      connection.getRegionServerWithRetries(callable);
    }
  }
 while (Bytes.compareTo(startRow,LAST_ROW) != 0);
}
