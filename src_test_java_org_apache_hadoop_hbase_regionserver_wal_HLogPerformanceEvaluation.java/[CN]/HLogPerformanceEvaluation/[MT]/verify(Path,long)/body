{
  HLog.Reader reader=HLog.getReader(wal.getFileSystem(getConf()),wal,getConf());
  long previousSeqid=-1;
  long count=0;
  try {
    while (true) {
      Entry e=reader.next();
      if (e == null)       break;
      count++;
      long seqid=e.getKey().getLogSeqNum();
      if (previousSeqid >= seqid) {
        throw new IllegalStateException("wal=" + wal.getName() + ", previousSeqid="+ previousSeqid+ ", seqid="+ seqid);
      }
      previousSeqid=seqid;
    }
    if (count != editsCount)     throw new IllegalStateException("Expected=" + editsCount + ", found="+ count);
  }
  finally {
    reader.close();
  }
}
