{
  this(store,scan.getCacheBlocks(),scan,columns,scanInfo.getTtl(),scanInfo.getMinVersions(),readPt);
  if (columns != null && scan.isRaw()) {
    throw new DoNotRetryIOException("Cannot specify any column for a raw scan");
  }
  matcher=new ScanQueryMatcher(scan,scanInfo,columns,ScanType.USER_SCAN,Long.MAX_VALUE,HConstants.LATEST_TIMESTAMP,oldestUnexpiredTS);
  this.store.addChangedReaderObserver(this);
  List<KeyValueScanner> scanners=getScannersNoCompaction();
  InjectionHandler.processEvent(InjectionEvent.STORESCANNER_COMPACTION_RACE,new Object[]{StoreScannerCompactionRace.BEFORE_SEEK.ordinal()});
  if (explicitColumnQuery && lazySeekEnabledGlobally) {
    for (    KeyValueScanner scanner : scanners) {
      scanner.requestSeek(matcher.getStartKey(),false,true);
    }
  }
 else {
    if (!isParallelSeekEnabled) {
      for (      KeyValueScanner scanner : scanners) {
        scanner.seek(matcher.getStartKey());
      }
    }
 else {
      parallelSeek(scanners,matcher.getStartKey());
    }
  }
  this.storeLimit=scan.getMaxResultsPerColumnFamily();
  this.storeOffset=scan.getRowOffsetPerColumnFamily();
  heap=new KeyValueHeap(scanners,store.getComparator());
  InjectionHandler.processEvent(InjectionEvent.STORESCANNER_COMPACTION_RACE,new Object[]{StoreScannerCompactionRace.AFTER_SEEK.ordinal()});
}
