{
  this(store,scan.getCacheBlocks(),scan,columns,scanInfo.getTtl(),scanInfo.getMinVersions(),readPt);
  if (columns != null && scan.isRaw()) {
    throw new DoNotRetryIOException("Cannot specify any column for a raw scan");
  }
  matcher=new ScanQueryMatcher(scan,scanInfo,columns,ScanType.USER_SCAN,Long.MAX_VALUE,HConstants.LATEST_TIMESTAMP,oldestUnexpiredTS,now,store.getCoprocessorHost());
  this.store.addChangedReaderObserver(this);
  List<KeyValueScanner> scanners=getScannersNoCompaction();
  seekScanners(scanners,matcher.getStartKey(),explicitColumnQuery && lazySeekEnabledGlobally,isParallelSeekEnabled);
  this.storeLimit=scan.getMaxResultsPerColumnFamily();
  this.storeOffset=scan.getRowOffsetPerColumnFamily();
  resetKVHeap(scanners,store.getComparator());
}
