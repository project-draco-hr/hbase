{
  this(store,false,scan,null,scanInfo.getTtl(),scanInfo.getMinVersions(),((HStore)store).getHRegion().getReadpoint(IsolationLevel.READ_COMMITTED));
  if (dropDeletesFromRow == null) {
    matcher=new ScanQueryMatcher(scan,scanInfo,null,scanType,smallestReadPoint,earliestPutTs,oldestUnexpiredTS);
  }
 else {
    matcher=new ScanQueryMatcher(scan,scanInfo,null,smallestReadPoint,earliestPutTs,oldestUnexpiredTS,dropDeletesFromRow,dropDeletesToRow);
  }
  this.store.addChangedReaderObserver(this);
  scanners=selectScannersFrom(scanners);
  InjectionHandler.processEvent(InjectionEvent.STORESCANNER_COMPACTION_RACE,new Object[]{StoreScannerCompactionRace.BEFORE_SEEK.ordinal()});
  if (!isParallelSeekEnabled) {
    for (    KeyValueScanner scanner : scanners) {
      scanner.seek(matcher.getStartKey());
    }
  }
 else {
    parallelSeek(scanners,matcher.getStartKey());
  }
  heap=new KeyValueHeap(scanners,store.getComparator());
  InjectionHandler.processEvent(InjectionEvent.STORESCANNER_COMPACTION_RACE,new Object[]{StoreScannerCompactionRace.AFTER_SEEK.ordinal()});
}
