{
  super(conf,fs,dirName,compression,hri);
  this.dirName=dirName;
  this.fs=fs;
  if (filter) {
    BloomFilter f=null;
    try {
      f=new BloomFilter((int)Math.ceil((DEFAULT_NUMBER_OF_HASH_FUNCTIONS * (1.0 * nrows)) / Math.log(2.0)),(int)DEFAULT_NUMBER_OF_HASH_FUNCTIONS,Hash.getHashType(conf));
    }
 catch (    IllegalArgumentException e) {
      LOG.warn("Failed creating bloomfilter; proceeding without",e);
    }
    this.bloomFilter=f;
  }
 else {
    this.bloomFilter=null;
  }
}
