{
  os=new ByteArrayOutputStream(1 << 20);
  encoder=new PrefixTreeEncoder(os,includeMemstoreTS);
  inputKvs=rows.getInputs();
  for (  KeyValue kv : inputKvs) {
    encoder.write(kv);
  }
  encoder.flush();
  totalBytes=encoder.getTotalBytes();
  blockMetaWriter=encoder.getBlockMeta();
  outputBytes=os.toByteArray();
  buffer=ByteBuffer.wrap(outputBytes);
  blockMetaReader=new PrefixTreeBlockMeta(buffer);
  searcher=new PrefixTreeArraySearcher(blockMetaReader,blockMetaReader.getRowTreeDepth(),blockMetaReader.getMaxRowLength(),blockMetaReader.getMaxQualifierLength());
  searcher.initOnBlock(blockMetaReader,outputBytes,includeMemstoreTS);
}
