{
  MultiRequest.Builder builder=MultiRequest.newBuilder();
  RegionSpecifier region=buildRegionSpecifier(RegionSpecifierType.REGION_NAME,regionName);
  builder.setRegion(region);
  builder.setAtomic(true);
  for (  Mutation mutation : rowMutations.getMutations()) {
    MutateType mutateType=null;
    if (mutation instanceof Put) {
      mutateType=MutateType.PUT;
    }
 else     if (mutation instanceof Delete) {
      mutateType=MutateType.DELETE;
    }
 else {
      throw new DoNotRetryIOException("RowMutations supports only put and delete, not " + mutation.getClass().getName());
    }
    Mutate mutate=ProtobufUtil.toMutate(mutateType,mutation);
    builder.addAction(MultiAction.newBuilder().setMutate(mutate).build());
  }
  return builder.build();
}
