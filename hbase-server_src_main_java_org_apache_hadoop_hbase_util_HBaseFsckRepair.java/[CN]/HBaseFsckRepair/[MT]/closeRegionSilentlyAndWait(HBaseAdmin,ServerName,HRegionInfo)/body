{
  HConnection connection=admin.getConnection();
  AdminProtocol rs=connection.getAdmin(server.getHostname(),server.getPort());
  ProtobufUtil.closeRegion(rs,region.getRegionName(),false);
  long timeout=admin.getConfiguration().getLong("hbase.hbck.close.timeout",120000);
  long expiration=timeout + EnvironmentEdgeManager.currentTimeMillis();
  while (EnvironmentEdgeManager.currentTimeMillis() < expiration) {
    try {
      HRegionInfo rsRegion=ProtobufUtil.getRegionInfo(rs,region.getRegionName());
      if (rsRegion == null)       return;
    }
 catch (    IOException ioe) {
      return;
    }
    Thread.sleep(1000);
  }
  throw new IOException("Region " + region + " failed to close within"+ " timeout "+ timeout);
}
