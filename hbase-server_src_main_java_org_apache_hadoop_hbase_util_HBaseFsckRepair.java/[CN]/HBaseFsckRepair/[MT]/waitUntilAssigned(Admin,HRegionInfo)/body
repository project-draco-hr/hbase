{
  long timeout=admin.getConfiguration().getLong("hbase.hbck.assign.timeout",120000);
  long expiration=timeout + System.currentTimeMillis();
  while (System.currentTimeMillis() < expiration) {
    try {
      Map<String,RegionState> rits=admin.getClusterStatus().getRegionsInTransition();
      if (rits.keySet() != null && !rits.keySet().contains(region.getEncodedName())) {
        return;
      }
      LOG.info("Region still in transition, waiting for " + "it to become assigned: " + region);
    }
 catch (    IOException e) {
      LOG.warn("Exception when waiting for region to become assigned," + " retrying",e);
    }
    Thread.sleep(1000);
  }
  throw new IOException("Region " + region + " failed to move out of "+ "transition within timeout "+ timeout+ "ms");
}
