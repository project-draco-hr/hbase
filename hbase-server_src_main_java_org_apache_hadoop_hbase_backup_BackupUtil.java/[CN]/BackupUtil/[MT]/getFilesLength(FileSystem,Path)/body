{
  long totalLength=0;
  FileStatus[] files=FSUtils.listStatus(fs,dir);
  if (files != null) {
    for (    FileStatus fileStatus : files) {
      if (fileStatus.isDir()) {
        totalLength+=getFilesLength(fs,fileStatus.getPath());
      }
 else {
        totalLength+=fileStatus.getLen();
      }
    }
  }
  return totalLength;
}
