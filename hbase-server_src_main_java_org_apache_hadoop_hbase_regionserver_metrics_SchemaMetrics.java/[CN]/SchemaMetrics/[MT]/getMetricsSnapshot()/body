{
  Map<String,Long> metricsSnapshot=new TreeMap<String,Long>();
  for (  SchemaMetrics cfm : tableAndFamilyToMetrics.values()) {
    for (    String metricName : cfm.getAllMetricNames()) {
      long metricValue;
      if (isTimeVaryingKey(metricName)) {
        Pair<Long,Integer> totalAndCount=RegionMetricsStorage.getTimeVaryingMetric(stripTimeVaryingSuffix(metricName));
        metricValue=metricName.endsWith(TOTAL_SUFFIX) ? totalAndCount.getFirst() : totalAndCount.getSecond();
      }
 else {
        metricValue=RegionMetricsStorage.getNumericMetric(metricName);
      }
      metricsSnapshot.put(metricName,metricValue);
    }
  }
  return metricsSnapshot;
}
