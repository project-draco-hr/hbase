{
  if (families == null || families.isEmpty() || tableName == null || tableName.isEmpty()) {
    return "";
  }
  if (families.size() == 1) {
    return generateSchemaMetricsPrefix(tableName,Bytes.toString(families.iterator().next()));
  }
  tableName=getEffectiveTableName(tableName);
  List<byte[]> sortedFamilies=new ArrayList<byte[]>(families);
  Collections.sort(sortedFamilies,Bytes.BYTES_COMPARATOR);
  StringBuilder sb=new StringBuilder();
  int numCFsLeft=families.size();
  for (  byte[] family : sortedFamilies) {
    if (sb.length() > MAX_METRIC_PREFIX_LENGTH) {
      sb.append(MORE_CFS_OMITTED_STR);
      break;
    }
    --numCFsLeft;
    sb.append(Bytes.toString(family));
    if (numCFsLeft > 0) {
      sb.append("~");
    }
  }
  return SchemaMetrics.generateSchemaMetricsPrefix(tableName,sb.toString());
}
