{
  if (tableName == null) {
    tableName=UNKNOWN;
  }
  if (cfName == null) {
    cfName=UNKNOWN;
  }
  tableName=getEffectiveTableName(tableName);
  final String instanceKey=tableName + "\t" + cfName;
  SchemaMetrics schemaMetrics=tableAndFamilyToMetrics.get(instanceKey);
  if (schemaMetrics != null) {
    return schemaMetrics;
  }
  schemaMetrics=new SchemaMetrics(tableName,cfName);
  SchemaMetrics existingMetrics=tableAndFamilyToMetrics.putIfAbsent(instanceKey,schemaMetrics);
  return existingMetrics != null ? existingMetrics : schemaMetrics;
}
