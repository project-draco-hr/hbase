{
  if (this.server.isStopped()) {
    return;
  }
  CompactionRequest cr=s.requestCompaction();
  if (cr != null) {
    if (priority != NO_PRIORITY) {
      cr.setPriority(priority);
    }
    boolean addedToQueue=compactionQueue.add(cr);
    if (!addedToQueue) {
      LOG.error("Could not add request to compaction queue: " + cr);
      s.finishRequest(cr);
    }
 else     if (LOG.isDebugEnabled()) {
      LOG.debug("Compaction requested: " + cr + (why != null && !why.isEmpty() ? "; Because: " + why : "")+ "; Priority: "+ priority+ "; Compaction queue size: "+ compactionQueue.size());
    }
  }
}
