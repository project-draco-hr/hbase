{
  final long startTime=System.currentTimeMillis();
  SplitTransaction st=new SplitTransaction(parent,midKey);
  if (!st.prepare())   return;
  try {
    st.execute(this.server);
  }
 catch (  IOException ioe) {
    try {
      LOG.info("Running rollback of failed split of " + parent.getRegionNameAsString() + "; "+ ioe.getMessage());
      st.rollback(this.server);
      LOG.info("Successful rollback of failed split of " + parent.getRegionNameAsString());
    }
 catch (    RuntimeException e) {
      LOG.info("Failed rollback of failed split of " + parent.getRegionNameAsString() + " -- aborting server",e);
      this.server.abort("Failed split");
    }
    return;
  }
  this.server.reportSplit(parent.getRegionInfo(),st.getFirstDaughter(),st.getSecondDaughter());
  LOG.info("Region split, META updated, and report to master. Parent=" + parent.getRegionInfo() + ", new regions: "+ st.getFirstDaughter()+ ", "+ st.getSecondDaughter()+ ". Split took "+ StringUtils.formatTimeDiff(System.currentTimeMillis(),startTime));
}
