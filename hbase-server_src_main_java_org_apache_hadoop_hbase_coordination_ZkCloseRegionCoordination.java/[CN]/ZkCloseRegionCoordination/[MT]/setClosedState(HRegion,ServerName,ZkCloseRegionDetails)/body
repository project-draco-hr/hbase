{
  final int expectedVersion=zkCrd.getExpectedVersion();
  try {
    if (ZKAssign.transitionNodeClosed(watcher,region.getRegionInfo(),sn,expectedVersion) == FAILED_VERSION) {
      LOG.warn("Completed the CLOSE of a region but when transitioning from " + " CLOSING to CLOSED got a version mismatch, someone else clashed " + "so now unassigning");
      region.close();
      return false;
    }
  }
 catch (  NullPointerException e) {
    LOG.warn("NPE during close -- catching and continuing...",e);
    return false;
  }
catch (  KeeperException e) {
    LOG.error("Failed transitioning node from CLOSING to CLOSED",e);
    return false;
  }
catch (  IOException e) {
    LOG.error("Failed to close region after failing to transition",e);
    return false;
  }
  return true;
}
