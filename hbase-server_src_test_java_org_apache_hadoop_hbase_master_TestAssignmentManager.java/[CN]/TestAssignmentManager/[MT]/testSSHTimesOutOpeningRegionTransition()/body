{
  CatalogTracker ct=Mockito.mock(CatalogTracker.class);
  AssignmentManagerWithExtrasForTesting am=setUpMockedAssignmentManager(this.server,this.serverManager);
  RegionState state=new RegionState(REGIONINFO,State.OPENING,System.currentTimeMillis(),SERVERNAME_A);
  am.getRegionStates().regionsInTransition.put(REGIONINFO.getEncodedName(),state);
  am.regionPlans.put(REGIONINFO.getEncodedName(),new RegionPlan(REGIONINFO,SERVERNAME_B,SERVERNAME_A));
  am.getZKTable().setEnabledTable(REGIONINFO.getTableNameAsString());
  try {
    processServerShutdownHandler(ct,am,false);
    assertTrue("Transtion is timed out",state.getStamp() == 0);
  }
  finally {
    am.getRegionStates().regionsInTransition.remove(REGIONINFO.getEncodedName());
    am.regionPlans.remove(REGIONINFO.getEncodedName());
  }
}
