{
  List<ServerName> destServers=new ArrayList<ServerName>(1);
  destServers.add(SERVERNAME_A);
  Mockito.when(this.serverManager.createDestinationServersList()).thenReturn(destServers);
  Mockito.when(this.serverManager.isServerOnline(SERVERNAME_A)).thenReturn(true);
  HTU.getConfiguration().setInt(HConstants.MASTER_PORT,0);
  ConsensusProvider cp=ConsensusProviderFactory.getConsensusProvider(HTU.getConfiguration());
  Server server=new HMaster(HTU.getConfiguration(),cp);
  Whitebox.setInternalState(server,"serverManager",this.serverManager);
  AssignmentManagerWithExtrasForTesting am=setUpMockedAssignmentManager(server,this.serverManager);
  try {
    TableName tableName=TableName.valueOf("dummyTable");
    am.getZKTable().setEnablingTable(tableName);
    am.joinCluster();
    assertFalse("Table should not be present in zookeeper.",am.getZKTable().isTablePresent(tableName));
  }
  finally {
  }
}
