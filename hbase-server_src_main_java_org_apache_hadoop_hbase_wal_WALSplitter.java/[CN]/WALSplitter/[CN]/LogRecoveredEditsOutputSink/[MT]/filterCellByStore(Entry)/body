{
  Map<byte[],Long> maxSeqIdInStores=regionMaxSeqIdInStores.get(Bytes.toString(logEntry.getKey().getEncodedRegionName()));
  if (maxSeqIdInStores == null || maxSeqIdInStores.isEmpty()) {
    return;
  }
  List<Cell> skippedCells=new ArrayList<Cell>();
  for (  Cell cell : logEntry.getEdit().getCells()) {
    if (!CellUtil.matchingFamily(cell,WALEdit.METAFAMILY)) {
      byte[] family=CellUtil.cloneFamily(cell);
      Long maxSeqId=maxSeqIdInStores.get(family);
      LOG.info("CHANGE REMOVE " + Bytes.toString(family) + ", max="+ maxSeqId);
      if (maxSeqId != null && maxSeqId.longValue() >= logEntry.getKey().getLogSeqNum()) {
        skippedCells.add(cell);
      }
    }
  }
  if (!skippedCells.isEmpty()) {
    logEntry.getEdit().getCells().removeAll(skippedCells);
  }
}
