{
  try {
    long start=System.currentTimeMillis();
    table.put(put);
    totalOpTimeMs.addAndGet(System.currentTimeMillis() - start);
  }
 catch (  IOException e) {
    failedKeySet.add(keyBase);
    String exceptionInfo;
    if (e instanceof RetriesExhaustedWithDetailsException) {
      RetriesExhaustedWithDetailsException aggEx=(RetriesExhaustedWithDetailsException)e;
      exceptionInfo=aggEx.getExhaustiveDescription();
    }
 else {
      StringWriter stackWriter=new StringWriter();
      PrintWriter pw=new PrintWriter(stackWriter);
      e.printStackTrace(pw);
      pw.flush();
      exceptionInfo=StringUtils.stringifyException(e);
    }
    LOG.error("Failed to insert: " + keyBase + "; region information: "+ getRegionDebugInfoSafe(put.getRow())+ "; errors: "+ exceptionInfo);
  }
}
