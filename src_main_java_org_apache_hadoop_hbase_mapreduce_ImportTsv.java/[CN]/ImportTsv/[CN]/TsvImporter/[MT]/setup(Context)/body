{
  Configuration conf=context.getConfiguration();
  String separator=conf.get(SEPARATOR_CONF_KEY);
  if (separator == null) {
    separator=DEFAULT_SEPARATOR;
  }
 else {
    separator=new String(Base64.decode(separator));
  }
  parser=new TsvParser(conf.get(COLUMNS_CONF_KEY),separator);
  if (parser.getRowKeyColumnIndex() == -1) {
    throw new RuntimeException("No row key column specified");
  }
  ts=conf.getLong(TIMESTAMP_CONF_KEY,System.currentTimeMillis());
  skipBadLines=context.getConfiguration().getBoolean(SKIP_LINES_CONF_KEY,true);
  badLineCount=context.getCounter("ImportTsv","Bad Lines");
}
