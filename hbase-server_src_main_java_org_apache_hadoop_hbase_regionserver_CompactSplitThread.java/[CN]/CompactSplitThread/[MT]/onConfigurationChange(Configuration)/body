{
  int largeThreads=Math.max(1,newConf.getInt(LARGE_COMPACTION_THREADS,LARGE_COMPACTION_THREADS_DEFAULT));
  if (this.longCompactions.getCorePoolSize() != largeThreads) {
    LOG.info("Changing the value of " + LARGE_COMPACTION_THREADS + " from "+ this.longCompactions.getCorePoolSize()+ " to "+ largeThreads);
    this.longCompactions.setMaximumPoolSize(largeThreads);
    this.longCompactions.setCorePoolSize(largeThreads);
  }
  int smallThreads=newConf.getInt(SMALL_COMPACTION_THREADS,SMALL_COMPACTION_THREADS_DEFAULT);
  if (this.shortCompactions.getCorePoolSize() != smallThreads) {
    LOG.info("Changing the value of " + SMALL_COMPACTION_THREADS + " from "+ this.shortCompactions.getCorePoolSize()+ " to "+ smallThreads);
    this.shortCompactions.setMaximumPoolSize(smallThreads);
    this.shortCompactions.setCorePoolSize(smallThreads);
  }
  int splitThreads=newConf.getInt(SPLIT_THREADS,SPLIT_THREADS_DEFAULT);
  if (this.splits.getCorePoolSize() != splitThreads) {
    LOG.info("Changing the value of " + SPLIT_THREADS + " from "+ this.splits.getCorePoolSize()+ " to "+ splitThreads);
    this.splits.setMaximumPoolSize(smallThreads);
    this.splits.setCorePoolSize(smallThreads);
  }
  int mergeThreads=newConf.getInt(MERGE_THREADS,MERGE_THREADS_DEFAULT);
  if (this.mergePool.getCorePoolSize() != mergeThreads) {
    LOG.info("Changing the value of " + MERGE_THREADS + " from "+ this.mergePool.getCorePoolSize()+ " to "+ mergeThreads);
    this.mergePool.setMaximumPoolSize(smallThreads);
    this.mergePool.setCorePoolSize(smallThreads);
  }
  this.conf.reloadConfiguration();
}
