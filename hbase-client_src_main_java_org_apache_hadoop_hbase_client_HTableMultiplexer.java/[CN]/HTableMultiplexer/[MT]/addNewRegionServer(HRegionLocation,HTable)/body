{
  LinkedBlockingQueue<PutStatus> queue=serverToBufferQueueMap.get(addr);
  if (queue == null) {
    queue=new LinkedBlockingQueue<PutStatus>(perRegionServerBufferQueueSize);
    serverToBufferQueueMap.put(addr,queue);
    HTableFlushWorker worker=new HTableFlushWorker(conf,addr,this,queue,htable);
    this.serverToFlushWorkerMap.put(addr,worker);
    String name="HTableFlushWorker-" + addr.getHostnamePort() + "-"+ (poolID++);
    Thread t=new Thread(worker,name);
    t.setDaemon(true);
    t.start();
  }
  return queue;
}
