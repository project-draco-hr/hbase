{
  Configuration conf=getConf();
  String rootDir=image.getRootDir();
  LOG.debug("Image root dir " + rootDir);
  String backupId=image.getBackupId();
  HBackupFileSystem hFS=new HBackupFileSystem(conf,new Path(rootDir),backupId);
  RestoreUtil restoreTool=new RestoreUtil(conf,hFS);
  BackupManifest manifest=hFS.getManifest(sTable);
  Path tableBackupPath=hFS.getTableBackupPath(sTable);
  boolean converted=false;
  if (manifest.getType().equals(BackupRestoreConstants.BACKUP_TYPE_FULL) || converted) {
    LOG.info("Restoring '" + sTable + "' to '"+ tTable+ "' from "+ (converted ? "converted" : "full")+ " backup image "+ tableBackupPath.toString());
    restoreTool.fullRestoreTable(tableBackupPath,sTable,tTable,converted);
  }
 else {
    String logBackupDir=HBackupFileSystem.getLogBackupDir(image.getRootDir(),image.getBackupId());
    LOG.info("Restoring '" + sTable + "' to '"+ tTable+ "' from incremental backup image "+ logBackupDir);
    restoreTool.incrementalRestoreTable(logBackupDir,new String[]{sTable},new String[]{tTable});
  }
  LOG.info(sTable + " has been successfully restored to " + tTable);
}
