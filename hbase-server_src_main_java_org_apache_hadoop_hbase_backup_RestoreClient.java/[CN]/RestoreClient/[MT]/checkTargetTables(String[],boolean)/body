{
  ArrayList<String> existTableList=new ArrayList<String>();
  ArrayList<String> disabledTableList=new ArrayList<String>();
  HBaseAdmin admin=null;
  Connection conn=null;
  try {
    conn=ConnectionFactory.createConnection(conf);
    admin=(HBaseAdmin)conn.getAdmin();
    for (    String tableName : tTableArray) {
      if (admin.tableExists(TableName.valueOf(tableName))) {
        existTableList.add(tableName);
        if (admin.isTableDisabled(TableName.valueOf(tableName))) {
          disabledTableList.add(tableName);
        }
      }
 else {
        LOG.info("HBase table " + tableName + " does not exist. It will be create during backup process");
      }
    }
  }
  finally {
    if (admin != null) {
      admin.close();
    }
    if (conn != null) {
      conn.close();
    }
  }
  if (existTableList.size() > 0) {
    if (!isOverwrite) {
      LOG.error("Existing table found in the restore target, please add \"-overwrite\" " + "option in the command if you mean to restore to these existing tables");
      LOG.info("Existing table list in restore target: " + existTableList);
      throw new IOException("Existing table found in target while no \"-overwrite\" " + "option found");
    }
 else {
      if (disabledTableList.size() > 0) {
        LOG.error("Found offline table in the restore target, " + "please enable them before restore with \"-overwrite\" option");
        LOG.info("Offline table list in restore target: " + disabledTableList);
        throw new IOException("Found offline table in the target when restore with \"-overwrite\" option");
      }
    }
  }
}
