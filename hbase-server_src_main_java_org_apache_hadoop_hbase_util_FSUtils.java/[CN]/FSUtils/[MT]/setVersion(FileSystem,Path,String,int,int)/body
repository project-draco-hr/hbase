{
  Path versionFile=new Path(rootdir,HConstants.VERSION_FILE_NAME);
  while (true) {
    try {
      FSDataOutputStream s=fs.create(versionFile);
      s.write(toVersionByteArray(version));
      s.close();
      LOG.debug("Created version file at " + rootdir.toString() + " with version="+ version);
      return;
    }
 catch (    IOException e) {
      if (retries > 0) {
        LOG.warn("Unable to create version file at " + rootdir.toString() + ", retrying",e);
        fs.delete(versionFile,false);
        try {
          if (wait > 0) {
            Thread.sleep(wait);
          }
        }
 catch (        InterruptedException ex) {
        }
        retries--;
      }
 else {
        throw e;
      }
    }
  }
}
