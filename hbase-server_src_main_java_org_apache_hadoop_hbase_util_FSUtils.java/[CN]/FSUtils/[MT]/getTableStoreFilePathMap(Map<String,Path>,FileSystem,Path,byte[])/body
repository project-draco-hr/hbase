{
  if (map == null) {
    map=new HashMap<String,Path>();
  }
  Path tableDir=new Path(hbaseRootDir,Bytes.toString(tablename));
  PathFilter df=new BlackListDirFilter(fs,HConstants.HBASE_NON_TABLE_DIRS);
  FileStatus[] regionDirs=fs.listStatus(tableDir);
  for (  FileStatus regionDir : regionDirs) {
    Path dd=regionDir.getPath();
    if (dd.getName().equals(HConstants.HREGION_COMPACTIONDIR_NAME)) {
      continue;
    }
    FileStatus[] familyDirs=fs.listStatus(dd,df);
    for (    FileStatus familyDir : familyDirs) {
      Path family=familyDir.getPath();
      FileStatus[] familyStatus=fs.listStatus(family);
      for (      FileStatus sfStatus : familyStatus) {
        Path sf=sfStatus.getPath();
        map.put(sf.getName(),sf);
      }
    }
  }
  return map;
}
