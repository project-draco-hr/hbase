{
  Map<String,Path> map=new HashMap<String,Path>();
  DirFilter df=new DirFilter(fs);
  FileStatus[] tableDirs=fs.listStatus(hbaseRootDir,df);
  for (  FileStatus tableDir : tableDirs) {
    Path d=tableDir.getPath();
    if (HConstants.HBASE_NON_TABLE_DIRS.contains(d.getName())) {
      continue;
    }
    FileStatus[] regionDirs=fs.listStatus(d,df);
    for (    FileStatus regionDir : regionDirs) {
      Path dd=regionDir.getPath();
      if (dd.getName().equals(HConstants.HREGION_COMPACTIONDIR_NAME)) {
        continue;
      }
      FileStatus[] familyDirs=fs.listStatus(dd,df);
      for (      FileStatus familyDir : familyDirs) {
        Path family=familyDir.getPath();
        FileStatus[] familyStatus=fs.listStatus(family);
        for (        FileStatus sfStatus : familyStatus) {
          Path sf=sfStatus.getPath();
          map.put(sf.getName(),sf);
        }
      }
    }
  }
  return map;
}
