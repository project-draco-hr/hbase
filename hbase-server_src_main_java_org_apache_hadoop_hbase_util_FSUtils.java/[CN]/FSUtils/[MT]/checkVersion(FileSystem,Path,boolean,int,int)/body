{
  String version=getVersion(fs,rootdir);
  if (version == null) {
    if (!rootRegionExists(fs,rootdir)) {
      setVersion(fs,rootdir,wait,retries);
      return;
    }
  }
 else   if (version.compareTo(HConstants.FILE_SYSTEM_VERSION) == 0)   return;
  String msg="File system needs to be upgraded." + "  You have version " + version + " and I want version "+ HConstants.FILE_SYSTEM_VERSION+ ".  Run the '${HBASE_HOME}/bin/hbase migrate' script.";
  if (message) {
    System.out.println("WARNING! " + msg);
  }
  throw new FileSystemVersionException(msg);
}
