{
  if (map == null) {
    map=new HashMap<String,Path>();
  }
  Path tableDir=FSUtils.getTableDir(hbaseRootDir,tableName);
  PathFilter familyFilter=new FamilyDirFilter(fs);
  FileStatus[] regionDirs=fs.listStatus(tableDir,new RegionDirFilter(fs));
  for (  FileStatus regionDir : regionDirs) {
    if (null != errors) {
      errors.progress();
    }
    Path dd=regionDir.getPath();
    FileStatus[] familyDirs=fs.listStatus(dd,familyFilter);
    for (    FileStatus familyDir : familyDirs) {
      if (null != errors) {
        errors.progress();
      }
      Path family=familyDir.getPath();
      if (family.getName().equals(HConstants.RECOVERED_EDITS_DIR)) {
        continue;
      }
      FileStatus[] familyStatus=fs.listStatus(family);
      for (      FileStatus sfStatus : familyStatus) {
        if (null != errors) {
          errors.progress();
        }
        Path sf=sfStatus.getPath();
        map.put(sf.getName(),sf);
      }
    }
  }
  return map;
}
