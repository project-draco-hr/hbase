{
  if (!isMasterRunning()) {
    throw new MasterNotRunningException();
  }
  String namespace=hTableDescriptor.getTableName().getNamespaceAsString();
  if (getNamespaceDescriptor(namespace) == null) {
    throw new ConstraintException("Namespace " + namespace + " does not exist");
  }
  HRegionInfo[] newRegions=getHRegionInfos(hTableDescriptor,splitKeys);
  checkInitialized();
  checkCompression(hTableDescriptor);
  if (cpHost != null) {
    cpHost.preCreateTable(hTableDescriptor,newRegions);
  }
  LOG.info(getClientIdAuditPrefix() + " create " + hTableDescriptor);
  this.executorService.submit(new CreateTableHandler(this,this.fileSystemManager,hTableDescriptor,conf,newRegions,this).prepare());
  if (cpHost != null) {
    cpHost.postCreateTable(hTableDescriptor,newRegions);
  }
}
