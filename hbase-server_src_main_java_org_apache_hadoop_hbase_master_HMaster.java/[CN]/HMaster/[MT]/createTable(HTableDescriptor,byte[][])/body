{
  if (isStopped()) {
    throw new MasterNotRunningException();
  }
  String namespace=hTableDescriptor.getTableName().getNamespaceAsString();
  ensureNamespaceExists(namespace);
  HRegionInfo[] newRegions=ModifyRegionUtils.createHRegionInfos(hTableDescriptor,splitKeys);
  checkInitialized();
  sanityCheckTableDescriptor(hTableDescriptor);
  this.quotaManager.checkNamespaceTableAndRegionQuota(hTableDescriptor.getTableName(),newRegions.length);
  if (cpHost != null) {
    cpHost.preCreateTable(hTableDescriptor,newRegions);
  }
  LOG.info(getClientIdAuditPrefix() + " create " + hTableDescriptor);
  ProcedurePrepareLatch latch=ProcedurePrepareLatch.createLatch();
  long procId=this.procedureExecutor.submitProcedure(new CreateTableProcedure(procedureExecutor.getEnvironment(),hTableDescriptor,newRegions,latch));
  latch.await();
  if (cpHost != null) {
    cpHost.postCreateTable(hTableDescriptor,newRegions);
  }
  return procId;
}
