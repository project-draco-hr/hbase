{
  GetTableDescriptorsResponse.Builder builder=GetTableDescriptorsResponse.newBuilder();
  if (req.getTableNamesCount() == 0) {
    Map<String,HTableDescriptor> descriptors=null;
    try {
      descriptors=this.tableDescriptors.getAll();
    }
 catch (    IOException e) {
      LOG.warn("Failed getting all descriptors",e);
    }
    if (descriptors != null) {
      for (      HTableDescriptor htd : descriptors.values()) {
        builder.addTableSchema(htd.convert());
      }
    }
  }
 else {
    for (    String s : req.getTableNamesList()) {
      HTableDescriptor htd=null;
      try {
        htd=this.tableDescriptors.get(s);
      }
 catch (      IOException e) {
        LOG.warn("Failed getting descriptor for " + s,e);
      }
      if (htd == null)       continue;
      builder.addTableSchema(htd.convert());
    }
  }
  return builder.build();
}
