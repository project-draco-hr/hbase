{
  final List<HTableDescriptor> descriptors=new ArrayList<HTableDescriptor>();
  boolean bypass=false;
  if (cpHost != null) {
    bypass=cpHost.preGetTableDescriptors(tableNameList,descriptors,regex);
  }
  if (!bypass) {
    if (tableNameList == null || tableNameList.size() == 0) {
      Collection<HTableDescriptor> htds;
      if (namespace != null && namespace.length() > 0) {
        htds=tableDescriptors.getByNamespace(namespace).values();
      }
 else {
        htds=tableDescriptors.getAll().values();
      }
      for (      HTableDescriptor desc : htds) {
        if (includeSysTables || !desc.getTableName().isSystemTable()) {
          descriptors.add(desc);
        }
      }
    }
 else {
      for (      TableName s : tableNameList) {
        HTableDescriptor desc=tableDescriptors.get(s);
        if (desc != null) {
          descriptors.add(desc);
        }
      }
    }
    if (regex != null) {
      filterTablesByRegex(descriptors,Pattern.compile(regex));
    }
    if (cpHost != null) {
      cpHost.postGetTableDescriptors(tableNameList,descriptors,regex);
    }
  }
  return descriptors;
}
