{
  final Map<HRegionInfo,Result> offlineSplitParents=new HashMap<HRegionInfo,Result>();
  MetaReader.Visitor visitor=new MetaReader.Visitor(){
    @Override public boolean visit(    Result r) throws IOException {
      if (r == null || r.isEmpty())       return true;
      HRegionInfo info=HRegionInfo.getHRegionInfo(r);
      if (info == null)       return true;
      if (info.isOffline() && info.isSplit()) {
        offlineSplitParents.put(info,r);
      }
      return true;
    }
  }
;
  MetaReader.fullScan(this.catalogTracker,visitor);
  int fixups=0;
  for (  Map.Entry<HRegionInfo,Result> e : offlineSplitParents.entrySet()) {
    ServerName sn=HRegionInfo.getServerName(e.getValue());
    if (!serverManager.isServerDead(sn)) {
      fixups+=ServerShutdownHandler.fixupDaughters(e.getValue(),assignmentManager,catalogTracker);
    }
  }
  if (fixups != 0) {
    LOG.info("Scanned the catalog and fixed up " + fixups + " missing daughter region(s)");
  }
}
