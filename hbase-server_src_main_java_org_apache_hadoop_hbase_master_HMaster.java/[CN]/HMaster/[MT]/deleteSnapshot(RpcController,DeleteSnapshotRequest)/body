{
  try {
    if (!isSnapshotCompleted(request.getSnapshot())) {
      throw new SnapshotDoesNotExistException(request.getSnapshot());
    }
    String snapshotName=request.getSnapshot().getName();
    LOG.debug("Deleting snapshot: " + snapshotName);
    Path snapshotDir=SnapshotDescriptionUtils.getCompletedSnapshotDir(snapshotName,this.getMasterFileSystem().getRootDir());
    if (!this.getMasterFileSystem().getFileSystem().delete(snapshotDir,true)) {
      throw new ServiceException("Failed to delete snapshot directory: " + snapshotDir);
    }
    return DeleteSnapshotResponse.newBuilder().build();
  }
 catch (  IOException e) {
    throw new ServiceException(e);
  }
}
