{
  if (!conf.getBoolean("hbase.master.infoserver.redirect",true)) {
    return;
  }
  int infoPort=conf.getInt("hbase.master.info.port.orig",HConstants.DEFAULT_MASTER_INFOPORT);
  if (infoPort < 0 || infoServer == null) {
    return;
  }
  RedirectServlet.regionServerInfoPort=infoServer.getPort();
  masterJettyServer=new org.mortbay.jetty.Server();
  Connector connector=new SelectChannelConnector();
  connector.setHost(conf.get("hbase.master.info.bindAddress","0.0.0.0"));
  connector.setPort(infoPort);
  masterJettyServer.addConnector(connector);
  masterJettyServer.setStopAtShutdown(true);
  Context context=new Context(masterJettyServer,"/",Context.NO_SESSIONS);
  context.addServlet(RedirectServlet.class,"/*");
  try {
    masterJettyServer.start();
  }
 catch (  Exception e) {
    throw new IOException("Failed to start redirecting jetty server",e);
  }
}
