{
  if (controller instanceof PayloadCarryingRpcController) {
    PayloadCarryingRpcController pcrc=(PayloadCarryingRpcController)controller;
    CellScanner cellScanner=pcrc.cellScanner();
    List<Cell> list=null;
    if (cellScanner != null) {
      list=new ArrayList<>();
      try {
        while (cellScanner.advance()) {
          list.add(cellScanner.current());
        }
      }
 catch (      IOException e) {
        throw new ServiceException(e);
      }
    }
    cellScanner=CellUtil.createCellScanner(list);
    ((PayloadCarryingRpcController)controller).setCellScanner(cellScanner);
  }
  return EchoResponseProto.newBuilder().setMessage(request.getMessage()).build();
}
