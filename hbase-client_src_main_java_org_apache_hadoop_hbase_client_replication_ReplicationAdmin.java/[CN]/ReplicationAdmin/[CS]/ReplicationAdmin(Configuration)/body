{
  if (!conf.getBoolean(HConstants.REPLICATION_ENABLE_KEY,HConstants.REPLICATION_ENABLE_DEFAULT)) {
    throw new RuntimeException("hbase.replication isn't true, please " + "enable it in order to use replication");
  }
  this.connection=ConnectionFactory.createConnection(conf);
  zkw=createZooKeeperWatcher();
  try {
    this.replicationPeers=ReplicationFactory.getReplicationPeers(zkw,conf,this.connection);
    this.replicationPeers.init();
    this.replicationQueuesClient=ReplicationFactory.getReplicationQueuesClient(zkw,conf,this.connection);
    this.replicationQueuesClient.init();
  }
 catch (  ReplicationException e) {
    throw new IOException("Error initializing the replication admin client.",e);
  }
}
