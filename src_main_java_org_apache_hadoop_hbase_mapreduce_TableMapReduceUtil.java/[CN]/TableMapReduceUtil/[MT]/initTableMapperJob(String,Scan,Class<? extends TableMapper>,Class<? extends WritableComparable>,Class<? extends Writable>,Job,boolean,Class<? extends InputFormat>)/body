{
  job.setInputFormatClass(inputFormatClass);
  if (outputValueClass != null)   job.setMapOutputValueClass(outputValueClass);
  if (outputKeyClass != null)   job.setMapOutputKeyClass(outputKeyClass);
  job.setMapperClass(mapper);
  HBaseConfiguration.addHbaseResources(job.getConfiguration());
  job.getConfiguration().set(TableInputFormat.INPUT_TABLE,table);
  job.getConfiguration().set(TableInputFormat.SCAN,convertScanToString(scan));
  if (addDependencyJars) {
    addDependencyJars(job);
  }
}
