{
  Path storeFileParentDir=new Path(HBaseTestingUtility.getTestDir(),"test_cache_on_write");
  StoreFile.Writer sfw=StoreFile.createWriter(fs,storeFileParentDir,DATA_BLOCK_SIZE,compress,KeyValue.COMPARATOR,conf,cacheConf,StoreFile.BloomType.ROWCOL,NUM_KV);
  final int rowLen=32;
  for (int i=0; i < NUM_KV; ++i) {
    byte[] k=TestHFileWriterV2.randomOrderedKey(rand,i);
    byte[] v=TestHFileWriterV2.randomValue(rand);
    int cfLen=rand.nextInt(k.length - rowLen + 1);
    KeyValue kv=new KeyValue(k,0,rowLen,k,rowLen,cfLen,k,rowLen + cfLen,k.length - rowLen - cfLen,rand.nextLong(),generateKeyType(rand),v,0,v.length);
    sfw.append(kv);
  }
  sfw.close();
  storeFilePath=sfw.getPath();
}
