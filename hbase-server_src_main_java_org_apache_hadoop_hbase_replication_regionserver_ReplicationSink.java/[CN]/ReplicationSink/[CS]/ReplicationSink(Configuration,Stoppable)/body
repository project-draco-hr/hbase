{
  this.conf=HBaseConfiguration.create(conf);
  decorateConf();
  this.metrics=new ReplicationSinkMetrics();
  this.sharedHtableCon=HConnectionManager.createConnection(this.conf);
  this.sharedThreadPool=new ThreadPoolExecutor(1,conf.getInt("hbase.htable.threads.max",Integer.MAX_VALUE),conf.getLong("hbase.htable.threads.keepalivetime",60),TimeUnit.SECONDS,new SynchronousQueue<Runnable>(),new DaemonThreadFactory("hbase-repl"));
  ((ThreadPoolExecutor)this.sharedThreadPool).allowCoreThreadTimeOut(true);
}
