{
  if (this.generalBloomFilterWriter != null) {
    if (this.bloomContext == null) {
switch (bloomType) {
case ROW:
        bloomContext=new RowBloomContext(generalBloomFilterWriter);
      break;
case ROWCOL:
    bloomContext=new RowColBloomContext(generalBloomFilterWriter);
  break;
default :
throw new IOException("Invalid Bloom filter type: " + bloomType + " (ROW or ROWCOL expected)");
}
}
bloomContext.writeBloom(cell);
}
}
