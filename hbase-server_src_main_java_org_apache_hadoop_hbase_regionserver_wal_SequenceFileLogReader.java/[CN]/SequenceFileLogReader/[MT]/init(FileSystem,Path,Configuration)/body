{
  this.conf=conf;
  this.path=path;
  reader=new WALReader(fs,path,conf);
  boolean compression=reader.isWALCompressionEnabled();
  if (compression) {
    try {
      if (compressionContext == null) {
        compressionContext=new CompressionContext(LRUDictionary.class);
      }
 else {
        compressionContext.clear();
      }
    }
 catch (    Exception e) {
      throw new IOException("Failed to initialize CompressionContext",e);
    }
  }
}
