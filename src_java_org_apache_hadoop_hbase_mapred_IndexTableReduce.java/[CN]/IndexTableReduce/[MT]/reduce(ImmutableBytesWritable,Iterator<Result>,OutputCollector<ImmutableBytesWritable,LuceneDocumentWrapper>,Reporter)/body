{
  Document doc=null;
  while (values.hasNext()) {
    Result r=values.next();
    if (doc == null) {
      doc=new Document();
      Field keyField=new Field(indexConf.getRowkeyName(),Bytes.toString(key.get(),key.getOffset(),key.getLength()),Field.Store.YES,Field.Index.NOT_ANALYZED);
      keyField.setOmitNorms(true);
      doc.add(keyField);
    }
    for (    KeyValue kv : r.list()) {
      String column=Bytes.toString(KeyValue.makeColumn(kv.getFamily(),kv.getQualifier()));
      byte[] columnValue=kv.getValue();
      Field.Store store=indexConf.isStore(column) ? Field.Store.YES : Field.Store.NO;
      Field.Index index=indexConf.isIndex(column) ? (indexConf.isTokenize(column) ? Field.Index.ANALYZED : Field.Index.NOT_ANALYZED) : Field.Index.NO;
      Field field=new Field(column,Bytes.toString(columnValue),store,index);
      field.setBoost(indexConf.getBoost(column));
      field.setOmitNorms(indexConf.isOmitNorms(column));
      doc.add(field);
    }
  }
  output.collect(key,new LuceneDocumentWrapper(doc));
}
