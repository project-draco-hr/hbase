{
  if (!values.hasNext()) {
    return;
  }
  Document doc=new Document();
  Field keyField=new Field(indexConf.getRowkeyName(),Bytes.toString(key.get(),key.getOffset(),key.getLength()),Field.Store.YES,Field.Index.UN_TOKENIZED);
  keyField.setOmitNorms(true);
  doc.add(keyField);
  while (values.hasNext()) {
    RowResult value=values.next();
    for (    Map.Entry<byte[],Cell> entry : value.entrySet()) {
      String column=Bytes.toString(entry.getKey());
      byte[] columnValue=entry.getValue().getValue();
      Field.Store store=indexConf.isStore(column) ? Field.Store.YES : Field.Store.NO;
      Field.Index index=indexConf.isIndex(column) ? (indexConf.isTokenize(column) ? Field.Index.TOKENIZED : Field.Index.UN_TOKENIZED) : Field.Index.NO;
      Field field=new Field(column,Bytes.toString(columnValue),store,index);
      field.setBoost(indexConf.getBoost(column));
      field.setOmitNorms(indexConf.isOmitNorms(column));
      doc.add(field);
    }
  }
  output.collect(key,new LuceneDocumentWrapper(doc));
}
