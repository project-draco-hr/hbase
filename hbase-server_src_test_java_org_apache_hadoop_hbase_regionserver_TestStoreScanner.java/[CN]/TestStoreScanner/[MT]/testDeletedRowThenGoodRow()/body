{
  KeyValue[] kvs=new KeyValue[]{KeyValueTestUtil.create("R1","cf","a",1,KeyValue.Type.Put,"dont-care"),KeyValueTestUtil.create("R1","cf","a",1,KeyValue.Type.Delete,"dont-care"),KeyValueTestUtil.create("R2","cf","a",20,KeyValue.Type.Put,"dont-care")};
  List<KeyValueScanner> scanners=scanFixture(kvs);
  Scan scanSpec=new Scan(Bytes.toBytes("R1"));
  StoreScanner scan=new StoreScanner(scanSpec,scanInfo,scanType,getCols("a"),scanners);
  List<Cell> results=new ArrayList<Cell>();
  assertEquals(true,NextState.hasMoreValues(scan.next(results)));
  assertEquals(0,results.size());
  assertEquals(true,NextState.hasMoreValues(scan.next(results)));
  assertEquals(1,results.size());
  assertEquals(kvs[2],results.get(0));
  assertEquals(false,NextState.hasMoreValues(scan.next(results)));
}
