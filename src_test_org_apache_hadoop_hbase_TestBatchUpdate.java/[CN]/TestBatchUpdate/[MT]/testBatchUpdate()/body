{
  try {
    table.commitBatch(-1L);
  }
 catch (  IllegalStateException e) {
  }
catch (  Exception e) {
    e.printStackTrace();
    fail();
  }
  long lockid=table.startBatchUpdate(new Text("row1"));
  try {
    try {
      @SuppressWarnings("unused") long dummy=table.startUpdate(new Text("row2"));
    }
 catch (    IllegalStateException e) {
    }
catch (    Exception e) {
      e.printStackTrace();
      fail();
    }
    table.put(lockid,CONTENTS,value);
    table.delete(lockid,CONTENTS);
    table.commitBatch(lockid);
    lockid=table.startBatchUpdate(new Text("row2"));
    table.put(lockid,CONTENTS,value);
    table.commit(lockid);
    Text[] columns={CONTENTS};
    HScannerInterface scanner=table.obtainScanner(columns,new Text());
    HStoreKey key=new HStoreKey();
    TreeMap<Text,byte[]> results=new TreeMap<Text,byte[]>();
    while (scanner.next(key,results)) {
      for (      Map.Entry<Text,byte[]> e : results.entrySet()) {
        System.out.println(key + ": row: " + e.getKey()+ " value: "+ new String(e.getValue()));
      }
    }
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail();
  }
}
