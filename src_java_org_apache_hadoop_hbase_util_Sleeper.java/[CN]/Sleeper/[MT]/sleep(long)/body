{
  if (this.stop.get()) {
    return;
  }
  long now=System.currentTimeMillis();
  long waitTime=this.period - (now - startTime);
  if (waitTime > this.period) {
    LOG.warn("Calculated wait time > " + this.period + "; setting to this.period: "+ System.currentTimeMillis()+ ", "+ startTime);
    waitTime=this.period;
  }
  while (waitTime > 0) {
    long woke=-1;
    try {
      Thread.sleep(waitTime);
      woke=System.currentTimeMillis();
      long slept=woke - now;
      if (slept > (10 * this.period)) {
        LOG.warn("We slept " + slept + "ms, ten times longer than scheduled: "+ this.period);
      }
    }
 catch (    InterruptedException iex) {
      if (this.stop.get()) {
        return;
      }
    }
    woke=(woke == -1) ? System.currentTimeMillis() : woke;
    waitTime=this.period - (woke - startTime);
  }
}
