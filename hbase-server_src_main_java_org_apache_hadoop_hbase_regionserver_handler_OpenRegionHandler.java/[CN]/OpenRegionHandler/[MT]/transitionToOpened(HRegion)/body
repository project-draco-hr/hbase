{
  boolean result=false;
  HRegionInfo hri=r.getRegionInfo();
  final String name=hri.getRegionNameAsString();
  try {
    if (ZKAssign.transitionNodeOpened(this.server.getZooKeeper(),hri,this.server.getServerName(),this.version) == -1) {
      String warnMsg="Completed the OPEN of region " + name + " but when transitioning from "+ " OPENING to OPENED ";
      try {
        String node=ZKAssign.getNodeName(this.server.getZooKeeper(),hri.getEncodedName());
        if (ZKUtil.checkExists(this.server.getZooKeeper(),node) < 0) {
          rsServices.abort(warnMsg + "the znode disappeared",null);
        }
 else {
          LOG.warn(warnMsg + "got a version mismatch, someone else clashed; " + "so now unassigning -- closing region on server: "+ this.server.getServerName());
        }
      }
 catch (      KeeperException ke) {
        rsServices.abort(warnMsg,ke);
      }
    }
 else {
      LOG.debug("Transitioned " + r.getRegionInfo().getEncodedName() + " to OPENED in zk on "+ this.server.getServerName());
      result=true;
    }
  }
 catch (  KeeperException e) {
    LOG.error("Failed transitioning node " + name + " from OPENING to OPENED -- closing region",e);
  }
  return result;
}
