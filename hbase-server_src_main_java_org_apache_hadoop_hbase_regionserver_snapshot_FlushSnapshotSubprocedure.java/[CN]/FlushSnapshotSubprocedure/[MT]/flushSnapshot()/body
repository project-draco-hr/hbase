{
  if (regions.isEmpty()) {
    return;
  }
  monitor.rethrowException();
  for (  HRegion region : regions) {
    taskManager.submitTask(new RegionSnapshotTask(region));
    monitor.rethrowException();
  }
  LOG.debug("Flush Snapshot Tasks submitted for " + regions.size() + " regions");
  taskManager.waitForOutstandingTasks();
}
