{
  blockBuffer.mark();
  currKeyLen=blockBuffer.getInt();
  currValueLen=blockBuffer.getInt();
  blockBuffer.reset();
  if (this.reader.shouldIncludeMemstoreTS()) {
    try {
      ByteArrayInputStream byte_input=new ByteArrayInputStream(blockBuffer.array());
      byte_input.skip(blockBuffer.arrayOffset() + blockBuffer.position() + KEY_VALUE_LEN_SIZE+ currKeyLen+ currValueLen);
      DataInputStream data_input=new DataInputStream(byte_input);
      currMemstoreTS=WritableUtils.readVLong(data_input);
      currMemstoreTSLen=WritableUtils.getVIntSize(currMemstoreTS);
    }
 catch (    Exception e) {
      throw new RuntimeException("Error reading memstoreTS. " + e);
    }
  }
  if (currKeyLen < 0 || currValueLen < 0 || currKeyLen > blockBuffer.limit() || currValueLen > blockBuffer.limit()) {
    throw new IllegalStateException("Invalid currKeyLen " + currKeyLen + " or currValueLen "+ currValueLen+ ". Block offset: "+ block.getOffset()+ ", block length: "+ blockBuffer.limit()+ ", position: "+ blockBuffer.position()+ " (without header).");
  }
}
