{
  long lastDataBlockOffset=reader.getTrailer().getLastDataBlockOffset();
  if (block == null)   return null;
  HFileBlock curBlock=block;
  do {
    if (curBlock.getOffset() >= lastDataBlockOffset)     return null;
    if (curBlock.getOffset() < 0) {
      throw new IOException("Invalid block file offset: " + block);
    }
    curBlock=reader.readBlock(curBlock.getOffset() + curBlock.getOnDiskSizeWithHeader(),curBlock.getNextBlockOnDiskSizeWithHeader(),cacheBlocks,pread,isCompaction);
  }
 while (!curBlock.getBlockType().equals(BlockType.DATA));
  return curBlock;
}
