{
  super.doReconstructionLog(oldLogFile,minSeqId,maxSeqId,reporter);
  if (super.getTableDesc().getNameAsString().equals(HBaseBackedTransactionLogger.TABLE_NAME)) {
    return;
  }
  THLogRecoveryManager recoveryManager=new THLogRecoveryManager(this);
  Map<Long,List<WALEdit>> commitedTransactionsById=recoveryManager.getCommitsFromLog(oldLogFile,minSeqId,reporter);
  if (commitedTransactionsById != null && commitedTransactionsById.size() > 0) {
    LOG.debug("found " + commitedTransactionsById.size() + " COMMITED transactions to recover.");
    for (    Entry<Long,List<WALEdit>> entry : commitedTransactionsById.entrySet()) {
      LOG.debug("Writing " + entry.getValue().size() + " updates for transaction "+ entry.getKey());
      for (      WALEdit b : entry.getValue()) {
        Put put=null;
        for (        KeyValue kv : b.getKeyValues()) {
          if (put == null)           put=new Put(kv.getRow());
          put.add(kv);
        }
        super.put(put,true);
      }
    }
    LOG.debug("Flushing cache");
    if (!super.flushcache()) {
      LOG.warn("Did not flush cache");
    }
  }
}
