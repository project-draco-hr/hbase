{
  LOG.debug("Creating threads for each region server ");
  for (  Map.Entry<ServerName,List<HRegionInfo>> e : rsToRegions.entrySet()) {
    final List<HRegionInfo> hris=e.getValue();
    for (    HRegionInfo hri : hris) {
      RegionPlan reOpenPlan=new RegionPlan(hri,null,assignmentManager.getRegionServerOfRegion(hri));
      assignmentManager.addPlan(hri.getEncodedName(),reOpenPlan);
    }
    pool.execute(new Runnable(){
      public void run(){
        assignmentManager.unassign(hris);
      }
    }
);
  }
}
