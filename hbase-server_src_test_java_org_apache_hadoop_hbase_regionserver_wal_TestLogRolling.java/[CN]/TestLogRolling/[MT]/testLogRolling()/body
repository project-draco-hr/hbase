{
  this.tableName=getName();
  startAndWriteData();
  LOG.info("after writing there are " + ((FSHLog)log).getNumRolledLogFiles() + " log files");
  List<HRegion> regions=new ArrayList<HRegion>(server.getOnlineRegionsLocalContext());
  for (  HRegion r : regions) {
    r.flushcache();
  }
  log.rollWriter();
  int count=((FSHLog)log).getNumRolledLogFiles();
  LOG.info("after flushing all regions and rolling logs there are " + ((FSHLog)log).getNumRolledLogFiles() + " log files");
  assertTrue(("actual count: " + count),count <= 2);
}
