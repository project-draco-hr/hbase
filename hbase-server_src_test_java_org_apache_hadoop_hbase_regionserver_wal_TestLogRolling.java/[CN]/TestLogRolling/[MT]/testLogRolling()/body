{
  this.tableName=getName();
  startAndWriteData();
  final WAL log=server.getWAL(null);
  LOG.info("after writing there are " + DefaultWALProvider.getNumRolledLogFiles(log) + " log files");
  List<HRegion> regions=new ArrayList<HRegion>(server.getOnlineRegionsLocalContext());
  for (  HRegion r : regions) {
    r.flushcache();
  }
  log.rollWriter();
  int count=DefaultWALProvider.getNumRolledLogFiles(log);
  LOG.info("after flushing all regions and rolling logs there are " + count + " log files");
  assertTrue(("actual count: " + count),count <= 2);
}
