{
  if (this.queue.size() != 0) {
    if (LOG.isTraceEnabled()) {
      String filesize="N/A";
      try {
        FileStatus stat=this.fs.getFileStatus(this.currentPath);
        filesize=stat.getLen() + "";
      }
 catch (      IOException ex) {
      }
      LOG.trace("Reached the end of a log, stats: " + getStats() + ", and the length of the file is "+ filesize);
    }
    this.currentPath=null;
    this.repLogReader.finishCurrentFile();
    this.reader=null;
    return true;
  }
 else   if (this.replicationQueueInfo.isQueueRecovered()) {
    this.manager.closeRecoveredQueue(this);
    LOG.info("Finished recovering the queue with the following stats " + getStats());
    this.running=false;
    return true;
  }
  return false;
}
