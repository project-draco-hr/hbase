{
  this.currentPeers.clear();
  List<ServerName> addresses=this.zkHelper.getSlavesAddresses(this.peerId);
  Set<ServerName> setOfAddr=new HashSet<ServerName>();
  int nbPeers=(int)(Math.ceil(addresses.size() * ratio));
  LOG.debug("Getting " + nbPeers + " rs from peer cluster # "+ this.peerId);
  for (int i=0; i < nbPeers; i++) {
    ServerName sn;
    do {
      sn=addresses.get(this.random.nextInt(addresses.size()));
    }
 while (setOfAddr.contains(sn));
    LOG.info("Choosing peer " + sn);
    setOfAddr.add(sn);
  }
  this.currentPeers.addAll(setOfAddr);
}
