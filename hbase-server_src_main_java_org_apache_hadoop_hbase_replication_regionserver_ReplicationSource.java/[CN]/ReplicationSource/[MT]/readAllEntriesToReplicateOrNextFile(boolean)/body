{
  long seenEntries=0;
  if (this.position != 0) {
    this.reader.seek(this.position);
  }
  long startPosition=this.position;
  HLog.Entry entry=readNextAndSetPosition();
  while (entry != null) {
    WALEdit edit=entry.getEdit();
    this.metrics.incrLogEditsRead();
    seenEntries++;
    HLogKey logKey=entry.getKey();
    if (!logKey.getClusterId().equals(peerClusterId)) {
      removeNonReplicableEdits(edit);
      if (!(Bytes.equals(logKey.getTablename(),HConstants.ROOT_TABLE_NAME) || Bytes.equals(logKey.getTablename(),HConstants.META_TABLE_NAME)) && edit.size() != 0 && replicating.get()) {
        if (HConstants.DEFAULT_CLUSTER_ID == logKey.getClusterId()) {
          logKey.setClusterId(this.clusterId);
        }
        currentNbOperations+=countDistinctRowKeys(edit);
        currentNbEntries++;
      }
 else {
        this.metrics.incrLogEditsFiltered();
      }
    }
    if ((this.reader.getPosition() - startPosition) >= this.replicationQueueSizeCapacity || currentNbEntries >= this.replicationQueueNbCapacity) {
      break;
    }
    try {
      entry=readNextAndSetPosition();
    }
 catch (    IOException ie) {
      LOG.debug("Break on IOE: " + ie.getMessage());
      break;
    }
  }
  LOG.debug("currentNbOperations:" + currentNbOperations + " and seenEntries:"+ seenEntries+ " and size: "+ (this.reader.getPosition() - startPosition));
  if (currentWALisBeingWrittenTo) {
    return false;
  }
  return seenEntries == 0 && processEndOfFile();
}
