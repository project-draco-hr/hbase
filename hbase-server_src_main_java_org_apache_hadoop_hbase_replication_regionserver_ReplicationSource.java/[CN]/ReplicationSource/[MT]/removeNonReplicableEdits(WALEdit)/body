{
  NavigableMap<byte[],Integer> scopes=edit.getScopes();
  List<KeyValue> kvs=edit.getKeyValues();
  for (int i=edit.size() - 1; i >= 0; i--) {
    KeyValue kv=kvs.get(i);
    if (scopes == null || !scopes.containsKey(kv.getFamily())) {
      kvs.remove(i);
    }
  }
}
