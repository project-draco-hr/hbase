{
  if (cacheConf == null)   cacheConf=new CacheConfig(conf);
  for (  Compression.Algorithm compressAlgo : HBaseTestingUtility.COMPRESSION_ALGORITHMS) {
    Path mFile=new Path(ROOT_DIR,"nometa_" + compressAlgo + ".hfile");
    FSDataOutputStream fout=createFSOutput(mFile);
    HFileContext meta=new HFileContextBuilder().withCompressionAlgo(compressAlgo).withBlockSize(minBlockSize).build();
    Writer writer=HFile.getWriterFactory(conf,cacheConf).withOutputStream(fout).withFileContext(meta).create();
    writer.append("foo".getBytes(),"value".getBytes());
    writer.close();
    fout.close();
    Reader reader=HFile.createReader(fs,mFile,cacheConf);
    reader.loadFileInfo();
    assertNull(reader.getMetaBlock("non-existant",false));
  }
}
