{
  if (cacheConf == null)   cacheConf=new CacheConfig(conf);
  Path f=new Path(ROOT_DIR,getName());
  HFileContext context=new HFileContext();
  context.setIncludesTags(false);
  Writer w=HFile.getWriterFactory(conf,cacheConf).withPath(fs,f).withFileContext(context).create();
  w.close();
  Reader r=HFile.createReader(fs,f,cacheConf);
  r.loadFileInfo();
  assertNull(r.getFirstKey());
  assertNull(r.getLastKey());
}
