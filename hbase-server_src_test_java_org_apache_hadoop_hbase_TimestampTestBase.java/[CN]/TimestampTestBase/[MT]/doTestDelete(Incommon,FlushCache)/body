{
  put(incommon,T0);
  put(incommon,T1);
  put(incommon,T2);
  put(incommon);
  assertVersions(incommon,new long[]{HConstants.LATEST_TIMESTAMP,T2,T1});
  delete(incommon);
  assertVersions(incommon,new long[]{T2,T1,T0});
  flusher.flushcache();
  assertVersions(incommon,new long[]{T2,T1,T0});
  put(incommon);
  assertVersions(incommon,new long[]{HConstants.LATEST_TIMESTAMP,T2,T1});
  delete(incommon,T2);
  assertVersions(incommon,new long[]{HConstants.LATEST_TIMESTAMP,T1,T0});
  flusher.flushcache();
  assertVersions(incommon,new long[]{HConstants.LATEST_TIMESTAMP,T1,T0});
  put(incommon,T2);
  delete(incommon,T1);
  put(incommon,T1);
  Delete delete=new Delete(ROW);
  delete.deleteColumns(FAMILY_NAME,QUALIFIER_NAME,T2);
  incommon.delete(delete,null,true);
  assertOnlyLatest(incommon,HConstants.LATEST_TIMESTAMP);
  flusher.flushcache();
  assertOnlyLatest(incommon,HConstants.LATEST_TIMESTAMP);
}
