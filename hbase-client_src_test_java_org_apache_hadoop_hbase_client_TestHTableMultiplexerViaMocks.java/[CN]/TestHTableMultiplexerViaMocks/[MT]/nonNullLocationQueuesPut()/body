{
  final LinkedBlockingQueue<PutStatus> queue=new LinkedBlockingQueue<>();
  when(mockMultiplexer._put(any(TableName.class),any(Put.class),anyInt(),anyBoolean())).thenCallRealMethod();
  when(mockConnection.getRegionLocation(tableName,put.getRow(),false)).thenReturn(mockRegionLocation);
  when(mockMultiplexer.getQueue(mockRegionLocation)).thenReturn(queue);
  assertTrue("Put should have been queued",mockMultiplexer.put(tableName,put,NUM_RETRIES));
  assertEquals(1,queue.size());
  final PutStatus ps=queue.take();
  assertEquals(put,ps.put);
  assertEquals(mockRegionInfo,ps.regionInfo);
}
