{
  int res=0;
  try {
    if (copyType == Type.FULL) {
      SnapshotCopy snapshotCp=new SnapshotCopy(handler,handler.getBackupContext().getTableBySnapshot(options[1]));
      LOG.debug("Doing SNAPSHOT_COPY");
      snapshotCp.setConf(new Configuration(conf));
      res=snapshotCp.run(options);
    }
 else     if (copyType == Type.INCREMENTAL) {
      LOG.debug("Doing COPY_TYPE_DISTCP");
      setSubTaskPercntgInWholeTask(1f);
      BackupDistCp distcp=new BackupDistCp(new Configuration(conf),null,handler);
      LOG.debug("DistCp options: " + Arrays.toString(options));
      if (options.length == 2) {
        Path dest=new Path(options[1]);
        FileSystem destfs=dest.getFileSystem(conf);
        if (!destfs.exists(dest)) {
          destfs.mkdirs(dest);
        }
      }
      res=distcp.run(options);
    }
    return res;
  }
 catch (  Exception e) {
    throw new IOException(e);
  }
}
