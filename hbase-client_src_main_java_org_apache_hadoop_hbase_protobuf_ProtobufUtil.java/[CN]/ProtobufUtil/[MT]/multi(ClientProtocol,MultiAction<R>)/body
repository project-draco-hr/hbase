{
  MultiResponse response=new MultiResponse();
  for (  Map.Entry<byte[],List<Action<R>>> e : multi.actions.entrySet()) {
    byte[] regionName=e.getKey();
    int rowMutations=0;
    List<Action<R>> actions=e.getValue();
    for (    Action<R> action : actions) {
      Row row=action.getAction();
      if (row instanceof RowMutations) {
        try {
          MultiRequest request=RequestConverter.buildMultiRequest(regionName,(RowMutations)row);
          client.multi(null,request);
          response.add(regionName,action.getOriginalIndex(),new Result());
        }
 catch (        ServiceException se) {
          response.add(regionName,action.getOriginalIndex(),getRemoteException(se));
        }
        rowMutations++;
      }
    }
    if (actions.size() > rowMutations) {
      Exception ex=null;
      List<Object> results=null;
      try {
        MultiRequest request=RequestConverter.buildMultiRequest(regionName,actions);
        ClientProtos.MultiResponse proto=client.multi(null,request);
        results=ResponseConverter.getResults(proto);
      }
 catch (      ServiceException se) {
        ex=getRemoteException(se);
      }
      for (int i=0, n=actions.size(); i < n; i++) {
        int originalIndex=actions.get(i).getOriginalIndex();
        response.add(regionName,originalIndex,results == null ? ex : results.get(i));
      }
    }
  }
  return response;
}
