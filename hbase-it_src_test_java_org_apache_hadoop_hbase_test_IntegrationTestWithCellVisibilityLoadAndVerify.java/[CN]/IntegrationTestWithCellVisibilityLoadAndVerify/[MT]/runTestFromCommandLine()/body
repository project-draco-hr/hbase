{
  IntegrationTestingUtility.setUseDistributedCluster(getConf());
  int numPresplits=getConf().getInt("loadmapper.numPresplits",5);
  HTableDescriptor htd=new HTableDescriptor(getTablename());
  htd.addFamily(new HColumnDescriptor(TEST_FAMILY));
  Admin admin=new HBaseAdmin(getConf());
  try {
    admin.createTable(htd,Bytes.toBytes(0L),Bytes.toBytes(-1L),numPresplits);
  }
  finally {
    admin.close();
  }
  doLoad(getConf(),htd);
  doVerify(getConf(),htd);
  getTestingUtil(getConf()).deleteTable(htd.getName());
  return 0;
}
