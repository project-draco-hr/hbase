{
  if (!filesToArchive.isEmpty()) {
    if (LOG.isTraceEnabled()) {
      LOG.trace("Moving the files " + filesToArchive + " to archive");
    }
    this.fs.removeStoreFiles(this.getFamily().getNameAsString(),filesToArchive);
    try {
      lock.writeLock().lock();
      this.getStoreEngine().getStoreFileManager().removeCompactedFiles(filesToArchive);
    }
  finally {
      lock.writeLock().unlock();
    }
  }
}
