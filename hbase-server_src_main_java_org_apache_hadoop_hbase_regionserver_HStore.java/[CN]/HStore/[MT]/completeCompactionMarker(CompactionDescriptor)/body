{
  LOG.debug("Completing compaction from the WAL marker");
  List<String> compactionInputs=compaction.getCompactionInputList();
  String familyName=this.getColumnFamilyName();
  List<Path> inputPaths=new ArrayList<Path>(compactionInputs.size());
  for (  String compactionInput : compactionInputs) {
    Path inputPath=fs.getStoreFilePath(familyName,compactionInput);
    inputPaths.add(inputPath);
  }
  List<StoreFile> inputStoreFiles=new ArrayList<StoreFile>(compactionInputs.size());
  for (  StoreFile sf : this.getStorefiles()) {
    if (inputPaths.contains(sf.getQualifiedPath())) {
      inputStoreFiles.add(sf);
    }
  }
  this.replaceStoreFiles(inputStoreFiles,Collections.<StoreFile>emptyList());
  this.completeCompaction(inputStoreFiles);
}
