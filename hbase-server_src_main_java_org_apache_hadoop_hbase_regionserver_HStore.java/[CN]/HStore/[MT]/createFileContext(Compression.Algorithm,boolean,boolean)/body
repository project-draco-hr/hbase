{
  if (compression == null) {
    compression=HFile.DEFAULT_COMPRESSION_ALGORITHM;
  }
  HFileContext hFileContext=new HFileContextBuilder().withIncludesMvcc(includeMVCCReadpoint).withIncludesTags(includesTag).withCompressTags(family.shouldCompressTags()).withCompressionAlgo(compression).withChecksumType(checksumType).withBytesPerCheckSum(bytesPerChecksum).withBlockSize(blocksize).withHBaseCheckSum(true).withDataBlockEncodingOnDisk(family.getDataBlockEncodingOnDisk()).withDataBlockEncodingInCache(family.getDataBlockEncoding()).build();
  return hFileContext;
}
