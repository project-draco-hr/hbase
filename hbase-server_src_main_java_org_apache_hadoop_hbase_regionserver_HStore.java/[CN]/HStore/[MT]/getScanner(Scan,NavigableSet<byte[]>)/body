{
  lock.readLock().lock();
  try {
    KeyValueScanner scanner=null;
    if (this.region.getCoprocessorHost() != null) {
      scanner=this.region.getCoprocessorHost().preStoreScannerOpen(this,scan,targetCols);
    }
    if (scanner == null) {
      scanner=new StoreScanner(this,getScanInfo(),scan,targetCols);
    }
    return scanner;
  }
  finally {
    lock.readLock().unlock();
  }
}
