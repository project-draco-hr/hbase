{
  final List<HRegionInfo> regions=new ArrayList<HRegionInfo>();
  MetaScannerVisitor visitor=new MetaScannerVisitorBase(){
    @Override public boolean processRow(    Result result) throws IOException {
      if (result == null || result.isEmpty()) {
        return true;
      }
      RegionLocations locations=MetaTableAccessor.getRegionLocations(result);
      if (locations == null)       return true;
      for (      HRegionLocation loc : locations.getRegionLocations()) {
        if (loc != null) {
          HRegionInfo regionInfo=loc.getRegionInfo();
          if (regionInfo.isOffline() && !offlined)           continue;
          regions.add(regionInfo);
        }
      }
      return true;
    }
  }
;
  metaScan(connection,visitor);
  return regions;
}
