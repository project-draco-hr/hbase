{
  final NavigableMap<HRegionInfo,ServerName> regions=new TreeMap<HRegionInfo,ServerName>();
  MetaScannerVisitor visitor=new TableMetaScannerVisitor(tablename){
    @Override public boolean processRowInternal(    Result rowResult) throws IOException {
      HRegionInfo info=getHRegionInfo(rowResult);
      ServerName serverName=HRegionInfo.getServerName(rowResult);
      regions.put(new UnmodifyableHRegionInfo(info),serverName);
      return true;
    }
  }
;
  metaScan(conf,connection,visitor,tablename);
  return regions;
}
