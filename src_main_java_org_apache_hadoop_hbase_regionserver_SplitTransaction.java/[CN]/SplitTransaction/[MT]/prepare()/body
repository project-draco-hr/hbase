{
  boolean prepared=false;
  this.parent.lock.writeLock().lock();
  try {
    if (this.parent.isClosed() || this.parent.isClosing())     return prepared;
    HRegionInfo hri=this.parent.getRegionInfo();
    byte[] startKey=hri.getStartKey();
    byte[] endKey=hri.getEndKey();
    if (Bytes.equals(startKey,splitrow) || !this.parent.getRegionInfo().containsRow(splitrow)) {
      LOG.info("Split row is not inside region key range or is equal to " + "startkey: " + Bytes.toString(this.splitrow));
      return prepared;
    }
    long rid=getDaughterRegionIdTimestamp(hri);
    this.hri_a=new HRegionInfo(hri.getTableDesc(),startKey,this.splitrow,false,rid);
    this.hri_b=new HRegionInfo(hri.getTableDesc(),this.splitrow,endKey,false,rid);
    prepared=true;
  }
  finally {
    if (!prepared)     this.parent.lock.writeLock().unlock();
  }
  return prepared;
}
