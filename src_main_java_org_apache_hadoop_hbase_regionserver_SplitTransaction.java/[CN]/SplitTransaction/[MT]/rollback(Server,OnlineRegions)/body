{
  FileSystem fs=this.parent.getFilesystem();
  ListIterator<JournalEntry> iterator=this.journal.listIterator(this.journal.size());
  while (iterator.hasPrevious()) {
    JournalEntry je=iterator.previous();
switch (je) {
case SET_SPLITTING_IN_ZK:
      if (server != null && server.getZooKeeper() != null) {
        cleanZK(server,this.parent.getRegionInfo());
      }
    break;
case CREATE_SPLIT_DIR:
  cleanupSplitDir(fs,this.splitdir);
break;
case CLOSED_PARENT_REGION:
this.parent.initialize();
break;
case STARTED_REGION_A_CREATION:
cleanupDaughterRegion(fs,this.parent.getTableDir(),this.hri_a.getEncodedName());
break;
case STARTED_REGION_B_CREATION:
cleanupDaughterRegion(fs,this.parent.getTableDir(),this.hri_b.getEncodedName());
break;
case OFFLINED_PARENT:
if (or != null) or.addToOnlineRegions(this.parent);
break;
default :
throw new RuntimeException("Unhandled journal entry: " + je);
}
}
}
