{
  long regionSequenceId=WALKey.NO_SEQUENCE_ID;
  MultiVersionConcurrencyControl mvcc=getKey().getMvcc();
  MultiVersionConcurrencyControl.WriteEntry we=null;
  if (mvcc != null) {
    we=mvcc.begin();
    regionSequenceId=we.getWriteNumber();
  }
  if (!this.getEdit().isReplay() && inMemstore) {
    for (    Cell c : getEdit().getCells()) {
      CellUtil.setSequenceId(c,regionSequenceId);
    }
  }
  WALKey key=getKey();
  key.setLogSeqNum(regionSequenceId);
  key.setWriteEntry(we);
  return regionSequenceId;
}
