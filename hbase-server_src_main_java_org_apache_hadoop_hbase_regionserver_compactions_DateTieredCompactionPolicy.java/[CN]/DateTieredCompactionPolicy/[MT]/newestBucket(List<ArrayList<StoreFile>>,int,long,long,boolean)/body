{
  Window incomingWindow=getInitialWindow(now,baseWindowMillis);
  for (  ArrayList<StoreFile> bucket : buckets) {
    int minThreshold=incomingWindow.compareToTimestamp(bucket.get(0).getMaximumTimestamp()) <= 0 ? comConf.getIncomingWindowMin() : comConf.getMinFilesToCompact();
    compactionPolicyPerWindow.setMinThreshold(minThreshold);
    ArrayList<StoreFile> candidates=compactionPolicyPerWindow.applyCompactionPolicy(bucket,mayUseOffPeak,false);
    if (candidates != null && !candidates.isEmpty()) {
      return candidates;
    }
  }
  return null;
}
