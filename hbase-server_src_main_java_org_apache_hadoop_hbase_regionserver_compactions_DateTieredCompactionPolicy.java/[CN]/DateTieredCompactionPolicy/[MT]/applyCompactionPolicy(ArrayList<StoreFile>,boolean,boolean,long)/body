{
  Iterable<StoreFile> candidatesInWindow=filterOldStoreFiles(Lists.newArrayList(candidates),comConf.getMaxStoreFileAgeMillis(),now);
  List<ArrayList<StoreFile>> buckets=partitionFilesToBuckets(candidatesInWindow,comConf.getBaseWindowMillis(),comConf.getWindowsPerTier(),now);
  LOG.debug("Compaction buckets are: " + buckets);
  return newestBucket(buckets,comConf.getIncomingWindowMin(),now,comConf.getBaseWindowMillis(),mayUseOffPeak);
}
