{
  if (!super.needsCompaction(storeFiles,filesCompacting)) {
    return false;
  }
  ArrayList<StoreFile> candidates=new ArrayList<StoreFile>(storeFiles);
  candidates=filterBulk(candidates);
  candidates=skipLargeFiles(candidates,true);
  try {
    candidates=applyCompactionPolicy(candidates,true,false,now);
  }
 catch (  Exception e) {
    LOG.error("Can not check for compaction: ",e);
    return false;
  }
  return candidates != null && candidates.size() >= comConf.getMinFilesToCompact();
}
