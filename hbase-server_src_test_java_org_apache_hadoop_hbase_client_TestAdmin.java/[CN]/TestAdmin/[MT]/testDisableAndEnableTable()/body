{
  final byte[] row=Bytes.toBytes("row");
  final byte[] qualifier=Bytes.toBytes("qualifier");
  final byte[] value=Bytes.toBytes("value");
  final byte[] table=Bytes.toBytes("testDisableAndEnableTable");
  HTable ht=TEST_UTIL.createTable(table,HConstants.CATALOG_FAMILY);
  Put put=new Put(row);
  put.add(HConstants.CATALOG_FAMILY,qualifier,value);
  ht.put(put);
  Get get=new Get(row);
  get.addColumn(HConstants.CATALOG_FAMILY,qualifier);
  ht.get(get);
  this.admin.disableTable(ht.getName());
  assertTrue("Table must be disabled.",TEST_UTIL.getHBaseCluster().getMaster().getAssignmentManager().getTableStateManager().isTableState(ht.getName(),ZooKeeperProtos.Table.State.DISABLED));
  get=new Get(row);
  get.addColumn(HConstants.CATALOG_FAMILY,qualifier);
  boolean ok=false;
  try {
    ht.get(get);
  }
 catch (  org.apache.hadoop.hbase.DoNotRetryIOException e) {
    ok=true;
  }
  assertTrue(ok);
  this.admin.enableTable(table);
  assertTrue("Table must be enabled.",TEST_UTIL.getHBaseCluster().getMaster().getAssignmentManager().getTableStateManager().isTableState(ht.getName(),ZooKeeperProtos.Table.State.ENABLED));
  try {
    ht.get(get);
  }
 catch (  RetriesExhaustedException e) {
    ok=false;
  }
  assertTrue(ok);
  ht.close();
}
