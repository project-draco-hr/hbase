{
  Thread.sleep(2000);
  Set<HColumnDescriptor> descriptorSet=new HashSet<HColumnDescriptor>();
  final int MAX_POLLS=5;
  int numRegionsEncountered=0;
  for (int i=0; i < MAX_POLLS; i++) {
    for (    JVMClusterUtil.RegionServerThread rst : miniCluster.getRegionServerThreads()) {
      for (      HRegion hri : rst.getRegionServer().getOnlineRegions(tableName)) {
        numRegionsEncountered++;
        HColumnDescriptor hcd=hri.getTableDesc().getColumnFamilies()[0];
        descriptorSet.add(hcd);
      }
    }
    if (descriptorSet.size() == 1) {
      break;
    }
    Thread.sleep(2000);
  }
  if (descriptorSet.size() != 1) {
    System.out.println("FAIL: HColumnDescriptor definition did not settle. Here is the output:");
    Iterator<HColumnDescriptor> hcIter=descriptorSet.iterator();
    while (hcIter.hasNext()) {
      System.out.println("HCD entry: " + hcIter.next());
    }
    fail("HColumnDescription did not settle as expected.");
  }
  assertEquals("The number of regions did not match. Expected " + totalRegions + " but received "+ numRegionsEncountered,totalRegions,numRegionsEncountered);
  return descriptorSet.iterator().next();
}
