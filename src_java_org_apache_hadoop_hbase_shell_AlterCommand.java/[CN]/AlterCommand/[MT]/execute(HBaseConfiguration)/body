{
  try {
    HConnection conn=HConnectionManager.getConnection(conf);
    if (!conn.tableExists(new Text(this.tableName))) {
      return new ReturnMsg(0,"'" + this.tableName + "'"+ TABLE_NOT_FOUND);
    }
    HBaseAdmin admin=new HBaseAdmin(conf);
    Set<String> columns=null;
    HColumnDescriptor columnDesc=null;
switch (operationType) {
case ADD:
      disableTable(admin,tableName);
    columns=columnSpecMap.keySet();
  for (  String c : columns) {
    columnDesc=getColumnDescriptor(c,columnSpecMap.get(c));
    println("Adding " + c + " to "+ tableName+ "... Please wait.");
    admin.addColumn(new Text(tableName),columnDesc);
  }
enableTable(admin,tableName);
break;
case DROP:
disableTable(admin,tableName);
println("Dropping " + column + " from "+ tableName+ "... Please wait.");
column=appendDelimiter(column);
admin.deleteColumn(new Text(tableName),new Text(column));
enableTable(admin,tableName);
break;
case CHANGE:
return new ReturnMsg(0,"" + operationType + " is not yet supported.");
case NOOP:
return new ReturnMsg(0,"Invalid operation type.");
}
return new ReturnMsg(0,"Table altered successfully.");
}
 catch (Exception e) {
return new ReturnMsg(0,extractErrMsg(e));
}
}
