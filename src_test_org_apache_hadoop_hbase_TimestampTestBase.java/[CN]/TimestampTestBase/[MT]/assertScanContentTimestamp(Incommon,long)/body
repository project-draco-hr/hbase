{
  ScannerIncommon scanner=in.getScanner(COLUMNS,HConstants.EMPTY_START_ROW,ts);
  int count=0;
  try {
    HStoreKey key=new HStoreKey();
    TreeMap<byte[],byte[]> value=new TreeMap<byte[],byte[]>(Bytes.BYTES_COMPARATOR);
    while (scanner.next(key,value)) {
      assertTrue(key.getTimestamp() <= ts);
      long l=Bytes.toLong(value.get(COLUMN));
      assertTrue(key.getTimestamp() == l || HConstants.LATEST_TIMESTAMP == l);
      count++;
      value.clear();
    }
  }
  finally {
    scanner.close();
  }
  return count;
}
