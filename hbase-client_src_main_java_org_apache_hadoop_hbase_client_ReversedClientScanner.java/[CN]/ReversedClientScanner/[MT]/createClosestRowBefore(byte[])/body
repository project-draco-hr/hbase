{
  if (row == null) {
    throw new IllegalArgumentException("The passed row is empty");
  }
  if (Bytes.equals(row,HConstants.EMPTY_BYTE_ARRAY)) {
    return MAX_BYTE_ARRAY;
  }
  if (row[row.length - 1] == 0) {
    return Arrays.copyOf(row,row.length - 1);
  }
 else {
    byte[] closestFrontRow=Arrays.copyOf(row,row.length);
    closestFrontRow[row.length - 1]=(byte)((closestFrontRow[row.length - 1] & 0xff) - 1);
    closestFrontRow=Bytes.add(closestFrontRow,MAX_BYTE_ARRAY);
    return closestFrontRow;
  }
}
