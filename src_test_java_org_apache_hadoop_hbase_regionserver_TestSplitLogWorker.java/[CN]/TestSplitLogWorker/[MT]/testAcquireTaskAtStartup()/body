{
  LOG.info("testAcquireTaskAtStartup");
  ZKSplitLog.Counters.resetCounters();
  zkw.getRecoverableZooKeeper().create(ZKSplitLog.getEncodedNodeName(zkw,"tatas"),TaskState.TASK_UNASSIGNED.get("mgr"),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  SplitLogWorker slw=new SplitLogWorker(zkw,TEST_UTIL.getConfiguration(),"rs",neverEndingTask);
  slw.start();
  try {
    waitForCounter(tot_wkr_task_acquired,0,1,100);
    assertTrue(TaskState.TASK_OWNED.equals(ZKUtil.getData(zkw,ZKSplitLog.getEncodedNodeName(zkw,"tatas")),"rs"));
  }
  finally {
    stopSplitLogWorker(slw);
  }
}
