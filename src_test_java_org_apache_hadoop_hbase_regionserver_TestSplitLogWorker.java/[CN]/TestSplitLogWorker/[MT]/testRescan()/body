{
  LOG.info("testRescan");
  slw=new SplitLogWorker(zkw,TEST_UTIL.getConfiguration(),"svr",neverEndingTask);
  slw.start();
  Thread.yield();
  Thread.sleep(100);
  zkw.getZooKeeper().create(ZKSplitLog.getNodeName(zkw,"task"),TaskState.TASK_UNASSIGNED.get("manager"),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  waitForCounter(tot_wkr_task_acquired,0,1,1000);
  ZKUtil.setData(zkw,ZKSplitLog.getNodeName(zkw,"task"),TaskState.TASK_UNASSIGNED.get("manager"));
  waitForCounter(tot_wkr_preempt_task,0,1,1000);
  zkw.getZooKeeper().create(ZKSplitLog.getNodeName(zkw,"RESCAN"),TaskState.TASK_UNASSIGNED.get("manager"),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT_SEQUENTIAL);
  waitForCounter(tot_wkr_task_acquired,1,2,1000);
  ZKUtil.setData(zkw,ZKSplitLog.getNodeName(zkw,"task"),TaskState.TASK_UNASSIGNED.get("manager"));
  waitForCounter(tot_wkr_preempt_task,1,2,1000);
  waitForCounter(tot_wkr_task_acquired_rescan,0,1,1000);
  List<String> nodes=ZKUtil.listChildrenNoWatch(zkw,zkw.splitLogZNode);
  LOG.debug(nodes);
  int num=0;
  for (  String node : nodes) {
    num++;
    if (node.startsWith("RESCAN")) {
      assertTrue(TaskState.TASK_DONE.equals(ZKUtil.getData(zkw,ZKSplitLog.getNodeName(zkw,node)),"svr"));
    }
  }
  assertEquals(2,num);
}
