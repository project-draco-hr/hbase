{
  EventType type=event.getType();
  KeeperState state=event.getState();
  LOG.info("Got ZooKeeper event, state: " + state + ", type: "+ type+ ", path: "+ event.getPath());
  if (stopRequested.get()) {
    LOG.debug("Ignoring ZooKeeper event while shutting down");
    return;
  }
  if (state == KeeperState.Expired) {
    LOG.error("ZooKeeper session expired");
    boolean restart=this.conf.getBoolean("hbase.regionserver.restart.on.zk.expire",false);
    if (restart) {
      restart();
    }
 else {
      abort();
    }
  }
 else   if (type == EventType.NodeDeleted) {
    watchMasterAddress();
  }
 else   if (type == EventType.NodeCreated) {
    getMaster();
    watchMasterAddress();
  }
}
