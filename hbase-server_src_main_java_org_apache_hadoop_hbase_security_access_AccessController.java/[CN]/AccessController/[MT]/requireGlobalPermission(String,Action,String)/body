{
  User user=getActiveUser();
  if (authManager.authorize(user,perm) || (namespace != null && authManager.authorize(user,namespace,perm))) {
    logResult(AuthResult.allow(request,"Global check allowed",user,perm,namespace));
  }
 else {
    logResult(AuthResult.deny(request,"Global check failed",user,perm,namespace));
    throw new AccessDeniedException("Insufficient permissions for user '" + (user != null ? user.getShortName() : "null") + "' (global, action="+ perm.toString()+ ")");
  }
}
