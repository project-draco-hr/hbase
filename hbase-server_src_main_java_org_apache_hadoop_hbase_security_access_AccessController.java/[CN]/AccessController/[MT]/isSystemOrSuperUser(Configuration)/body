{
  User user=userProvider.getCurrent();
  if (user == null) {
    throw new IOException("Unable to obtain the current user, " + "authorization checks for internal operations will not work correctly!");
  }
  String currentUser=user.getShortName();
  List<String> superusers=Lists.asList(currentUser,conf.getStrings(AccessControlLists.SUPERUSER_CONF_KEY,new String[0]));
  User activeUser=getActiveUser();
  if (!(superusers.contains(activeUser.getShortName()))) {
    throw new AccessDeniedException("User '" + (user != null ? user.getShortName() : "null") + "is not system or super user.");
  }
}
