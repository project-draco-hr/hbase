{
  User user=getActiveUser();
  AuthResult result=permissionGranted(request,user,perm,env,families);
  logResult(result);
  if (!result.isAllowed()) {
    throw new AccessDeniedException("Insufficient permissions (table=" + env.getRegion().getTableDesc().getTableName() + ((families != null && families.size() > 0) ? ", family: " + result.toFamilyString() : "")+ ", action="+ perm.toString()+ ")");
  }
}
