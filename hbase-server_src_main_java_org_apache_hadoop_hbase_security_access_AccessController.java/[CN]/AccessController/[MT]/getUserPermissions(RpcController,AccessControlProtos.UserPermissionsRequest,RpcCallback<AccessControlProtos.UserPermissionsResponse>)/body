{
  AccessControlProtos.UserPermissionsResponse response=null;
  TableName table=null;
  if (request.hasTableName()) {
    table=ProtobufUtil.toTableName(request.getTableName());
  }
  try {
    if (aclRegion) {
      requirePermission("userPermissions",table,null,null,Action.ADMIN);
      List<UserPermission> perms=AccessControlLists.getUserPermissions(regionEnv.getConfiguration(),table);
      response=ResponseConverter.buildUserPermissionsResponse(perms);
    }
 else {
      throw new CoprocessorException(AccessController.class,"This method " + "can only execute at " + Bytes.toString(AccessControlLists.ACL_TABLE_NAME) + " table.");
    }
  }
 catch (  IOException ioe) {
    ResponseConverter.setControllerException(controller,ioe);
  }
  done.run(response);
}
