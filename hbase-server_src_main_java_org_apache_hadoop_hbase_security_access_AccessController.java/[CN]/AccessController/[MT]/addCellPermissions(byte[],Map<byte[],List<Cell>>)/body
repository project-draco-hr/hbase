{
  for (  Map.Entry<byte[],List<Cell>> e : familyMap.entrySet()) {
    List<Cell> newCells=Lists.newArrayList();
    for (    Cell cell : e.getValue()) {
      List<Tag> tags=Lists.newArrayList(new Tag(AccessControlLists.ACL_TAG_TYPE,perms));
      byte[] tagBytes=CellUtil.getTagArray(cell);
      Iterator<Tag> tagIterator=CellUtil.tagsIterator(tagBytes,0,tagBytes.length);
      while (tagIterator.hasNext()) {
        tags.add(tagIterator.next());
      }
      KeyValue kv=KeyValueUtil.ensureKeyValue(cell);
      byte[] bytes=kv.getBuffer();
      newCells.add(new KeyValue(bytes,kv.getRowOffset(),kv.getRowLength(),bytes,kv.getFamilyOffset(),kv.getFamilyLength(),bytes,kv.getQualifierOffset(),kv.getQualifierLength(),kv.getTimestamp(),KeyValue.Type.codeToType(kv.getTypeByte()),bytes,kv.getValueOffset(),kv.getValueLength(),tags));
    }
    e.setValue(newCells);
  }
}
