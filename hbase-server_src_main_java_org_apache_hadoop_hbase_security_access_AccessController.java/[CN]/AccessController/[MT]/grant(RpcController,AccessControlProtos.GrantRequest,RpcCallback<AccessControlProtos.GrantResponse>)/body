{
  UserPermission perm=ProtobufUtil.toUserPermission(request.getUserPermission());
  AccessControlProtos.GrantResponse response=null;
  try {
    if (aclRegion) {
      if (LOG.isDebugEnabled()) {
        LOG.debug("Received request to grant access permission " + perm.toString());
      }
switch (request.getUserPermission().getPermission().getType()) {
case Global:
case Table:
        requirePermission("grant",perm.getTable(),perm.getFamily(),perm.getQualifier(),Action.ADMIN);
      break;
case Namespace:
    requireGlobalPermission("grant",Action.ADMIN,perm.getNamespace());
}
AccessControlLists.addUserPermission(regionEnv.getConfiguration(),perm);
if (AUDITLOG.isTraceEnabled()) {
  AUDITLOG.trace("Granted permission " + perm.toString());
}
}
 else {
throw new CoprocessorException(AccessController.class,"This method " + "can only execute at " + AccessControlLists.ACL_TABLE_NAME + " table.");
}
response=AccessControlProtos.GrantResponse.getDefaultInstance();
}
 catch (IOException ioe) {
ResponseConverter.setControllerException(controller,ioe);
}
done.run(response);
}
