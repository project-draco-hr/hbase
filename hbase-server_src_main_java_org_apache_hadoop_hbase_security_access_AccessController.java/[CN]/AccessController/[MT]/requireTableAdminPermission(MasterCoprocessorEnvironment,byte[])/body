{
  User user=getActiveUser();
  AuthResult result=null;
  if (authManager.authorize(user,tableName,(byte[])null,TablePermission.Action.ADMIN)) {
    result=AuthResult.allow("Table permission granted",user,TablePermission.Action.ADMIN,tableName);
  }
 else   if (isActiveUserTableOwner(e,tableName)) {
    if (authManager.authorize(user,tableName,(byte[])null,TablePermission.Action.CREATE)) {
      result=AuthResult.allow("Owner has table permission",user,TablePermission.Action.CREATE,tableName);
    }
 else {
      result=AuthResult.deny("Insufficient permissions",user,TablePermission.Action.CREATE,tableName);
    }
  }
 else {
    result=AuthResult.deny("Insufficient permissions",user,TablePermission.Action.ADMIN,tableName);
  }
  logResult(result);
  if (!result.isAllowed()) {
    throw new AccessDeniedException("Insufficient permissions " + result.toContextString());
  }
}
