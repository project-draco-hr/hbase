{
  RegionCoprocessorEnvironment env=c.getEnvironment();
  Map<byte[],? extends Collection<Cell>> families=append.getFamilyCellMap();
  User user=getActiveUser();
  AuthResult authResult=permissionGranted(OpType.APPEND,user,env,families,Action.WRITE);
  if (!authResult.isAllowed() && cellFeaturesEnabled && !compatibleEarlyTermination) {
    authResult.setAllowed(checkCoveringPermission(OpType.APPEND,env,append.getRow(),families,HConstants.LATEST_TIMESTAMP,Action.WRITE));
    authResult.setReason("Covering cell set");
  }
  logResult(authResult);
  if (!authResult.isAllowed()) {
    throw new AccessDeniedException("Insufficient permissions " + authResult.toContextString());
  }
  byte[] bytes=append.getAttribute(AccessControlConstants.OP_ATTRIBUTE_ACL);
  if (bytes != null) {
    if (cellFeaturesEnabled) {
      addCellPermissions(bytes,append.getFamilyCellMap());
    }
 else {
      throw new DoNotRetryIOException("Cell ACLs cannot be persisted");
    }
  }
  return null;
}
