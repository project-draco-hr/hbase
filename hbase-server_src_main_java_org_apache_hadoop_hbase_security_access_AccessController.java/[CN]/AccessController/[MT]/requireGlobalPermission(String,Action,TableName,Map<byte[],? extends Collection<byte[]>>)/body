{
  User user=getActiveUser();
  if (authManager.authorize(user,perm) || (tableName != null && authManager.authorize(user,tableName.getNamespaceAsString(),perm))) {
    logResult(AuthResult.allow(request,"Global check allowed",user,perm,tableName,familyMap));
  }
 else {
    logResult(AuthResult.deny(request,"Global check failed",user,perm,tableName,familyMap));
    throw new AccessDeniedException("Insufficient permissions for user '" + (user != null ? user.getShortName() : "null") + "' (global, action="+ perm.toString()+ ")");
  }
}
