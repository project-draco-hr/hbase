{
  Map<byte[],Set<byte[]>> familyMap=Maps.newHashMap();
  for (  Map.Entry<byte[],List<? extends Cell>> entry : increment.getFamilyMap().entrySet()) {
    Set<byte[]> qualifiers=new HashSet<byte[]>(entry.getValue().size());
    for (    Cell cell : entry.getValue()) {
      KeyValue kv=KeyValueUtil.ensureKeyValue(cell);
      qualifiers.add(kv.getQualifier());
    }
    familyMap.put(entry.getKey(),qualifiers);
  }
  requirePermission("increment",Permission.Action.WRITE,c.getEnvironment(),familyMap);
  return null;
}
