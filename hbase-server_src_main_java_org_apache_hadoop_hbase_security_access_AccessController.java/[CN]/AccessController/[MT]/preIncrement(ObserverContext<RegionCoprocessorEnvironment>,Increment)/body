{
  Map<byte[],Set<byte[]>> familyMap=Maps.newTreeMap(Bytes.BYTES_COMPARATOR);
  for (  Map.Entry<byte[],List<Cell>> entry : increment.getFamilyCellMap().entrySet()) {
    Set<byte[]> qualifiers=Sets.newTreeSet(Bytes.BYTES_COMPARATOR);
    for (    Cell cell : entry.getValue()) {
      KeyValue kv=KeyValueUtil.ensureKeyValue(cell);
      qualifiers.add(kv.getQualifier());
    }
    familyMap.put(entry.getKey(),qualifiers);
  }
  requirePermission("increment",Permission.Action.WRITE,c.getEnvironment(),familyMap);
  return null;
}
