{
  final HRegion region=e.getRegion();
  canPersistCellACLs=HFile.getFormatVersion(e.getConfiguration()) >= HFile.MIN_FORMAT_VERSION_WITH_TAGS;
  if (!canPersistCellACLs) {
    LOG.info("A minimum HFile version of " + HFile.MIN_FORMAT_VERSION_WITH_TAGS + " is required to persist cell ACLs. Consider setting "+ HFile.FORMAT_VERSION_KEY+ " accordingly.");
  }
  Map<byte[],ListMultimap<String,TablePermission>> tables=AccessControlLists.loadAll(region);
  for (  Map.Entry<byte[],ListMultimap<String,TablePermission>> t : tables.entrySet()) {
    byte[] entry=t.getKey();
    ListMultimap<String,TablePermission> perms=t.getValue();
    byte[] serialized=AccessControlLists.writePermissionsAsBytes(perms,e.getConfiguration());
    this.authManager.getZKPermissionWatcher().writeToZookeeper(entry,serialized);
  }
}
