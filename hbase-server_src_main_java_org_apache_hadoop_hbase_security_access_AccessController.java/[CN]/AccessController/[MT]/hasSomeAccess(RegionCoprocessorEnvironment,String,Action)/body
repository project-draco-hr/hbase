{
  User requestUser=getActiveUser();
  final TableName tableName=e.getRegion().getTableDesc().getTableName();
  AuthResult authResult=permissionGranted(method,requestUser,action,e,Collections.EMPTY_MAP);
  if (!authResult.isAllowed()) {
    final Configuration conf=e.getConfiguration();
    List<UserPermission> perms=User.runAsLoginUser(new PrivilegedExceptionAction<List<UserPermission>>(){
      @Override public List<UserPermission> run() throws Exception {
        return AccessControlLists.getUserTablePermissions(conf,tableName);
      }
    }
);
    for (    UserPermission userPerm : perms) {
      for (      Action userAction : userPerm.getActions()) {
        if (userAction.equals(action)) {
          return AuthResult.allow(method,"Access allowed",requestUser,action,tableName,null,null);
        }
      }
    }
  }
  return authResult;
}
