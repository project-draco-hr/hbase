{
  Runnable runnable=new Runnable(){
    public void run(){
      try {
        HTable t=new HTable(conf,HConstants.META_TABLE_NAME);
        Scan scan=new Scan();
        scan.addFamily(HConstants.CATALOG_FAMILY);
        ResultScanner s=t.getScanner(scan);
        s.close();
      }
 catch (      IOException e) {
        LOG.fatal("could not re-open meta table because",e);
        fail();
      }
      ResultScanner scanner=null;
      try {
        Scan scan=new Scan();
        scan.addFamily(HConstants.CATALOG_FAMILY);
        scanner=table.getScanner(scan);
        LOG.info("Obtained scanner " + scanner);
        for (        Result r : scanner) {
          assertTrue(Bytes.equals(r.getRow(),row));
          assertEquals(1,r.size());
          byte[] bytes=r.getRowResult().get(HConstants.CATALOG_FAMILY).getValue();
          assertNotNull(bytes);
          assertTrue(tableName.equals(Bytes.toString(bytes)));
        }
        LOG.info("Success!");
      }
 catch (      Exception e) {
        e.printStackTrace();
        fail();
      }
 finally {
        if (scanner != null) {
          LOG.info("Closing scanner " + scanner);
          scanner.close();
        }
      }
    }
  }
;
  return new Thread(runnable);
}
