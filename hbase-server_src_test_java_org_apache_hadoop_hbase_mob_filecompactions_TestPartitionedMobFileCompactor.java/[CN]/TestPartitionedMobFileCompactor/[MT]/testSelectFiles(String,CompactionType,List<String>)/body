{
  PartitionedMobFileCompactor compactor=new PartitionedMobFileCompactor(conf,fs,TableName.valueOf(tableName),hcd,pool){
    @Override public List<Path> compact(    List<FileStatus> files) throws IOException {
      if (files == null || files.isEmpty()) {
        return null;
      }
      PartitionedMobFileCompactionRequest request=select(files);
      Assert.assertEquals(type,request.type);
      compareCompactedPartitions(expected,request.compactionPartitions);
      compareDelFiles(request.delFiles);
      return null;
    }
  }
;
  compactor.compact(allFiles);
}
