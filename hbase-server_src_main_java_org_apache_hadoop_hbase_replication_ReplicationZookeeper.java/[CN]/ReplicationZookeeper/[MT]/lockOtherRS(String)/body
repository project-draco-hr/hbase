{
  try {
    String parent=ZKUtil.joinZNode(this.rsZNode,znode);
    if (parent.equals(rsServerNameZnode)) {
      LOG.warn("Won't lock because this is us, we're dead!");
      return false;
    }
    String p=ZKUtil.joinZNode(parent,RS_LOCK_ZNODE);
    ZKUtil.createAndWatch(this.zookeeper,p,Bytes.toBytes(rsServerNameZnode));
  }
 catch (  KeeperException e) {
    if (e instanceof KeeperException.NoNodeException || e instanceof KeeperException.NodeExistsException) {
      LOG.info("Won't transfer the queue," + " another RS took care of it because of: " + e.getMessage());
    }
 else {
      LOG.info("Failed lock other rs",e);
    }
    return false;
  }
  return true;
}
