{
  if (timeout < 0)   throw new IllegalArgumentException();
  if (zkw == null)   throw new IllegalArgumentException();
  Stopwatch sw=new Stopwatch().start();
  ServerName sn=null;
  try {
    while (true) {
      sn=getMetaRegionLocation(zkw,replicaId);
      if (sn != null || sw.elapsedMillis() > timeout - HConstants.SOCKET_RETRY_WAIT_MS) {
        break;
      }
      Thread.sleep(HConstants.SOCKET_RETRY_WAIT_MS);
    }
  }
  finally {
    sw.stop();
  }
  return sn;
}
