{
  if (updateMustBeInProgress) {
    if (batch == null) {
      throw new IllegalStateException("no update in progress");
    }
  }
 else {
    if (batch != null) {
      throw new IllegalStateException("update in progress");
    }
  }
}
