{
  checkClosed();
  if (this.scannerId != -1L) {
    this.server.close(this.scannerId);
    this.scannerId=-1L;
  }
  if (this.currentRegionLocation != null) {
    LOG.debug("Advancing forward from region " + this.currentRegionLocation.getRegionInfo());
    if (this.currentRegionLocation.getRegionInfo().getEndKey() == null || this.currentRegionLocation.getRegionInfo().getEndKey().equals(EMPTY_TEXT)) {
      LOG.debug("We're at the end of the region, returning.");
      close();
      return false;
    }
  }
  HRegionLocation oldLocation=this.currentRegionLocation;
  Text localStartKey=oldLocation == null ? startRow : oldLocation.getRegionInfo().getEndKey();
  LOG.debug("Advancing internal scanner to startKey " + localStartKey);
  this.currentRegionLocation=getRegionLocation(localStartKey);
  LOG.debug("New region: " + this.currentRegionLocation);
  try {
    for (int tries=0; tries < numRetries; tries++) {
      server=connection.getHRegionConnection(this.currentRegionLocation.getServerAddress());
      try {
        scannerId=server.openScanner(this.currentRegionLocation.getRegionInfo().getRegionName(),this.columns,localStartKey,scanTime,filter);
        break;
      }
 catch (      IOException e) {
        if (e instanceof RemoteException) {
          e=RemoteExceptionHandler.decodeRemoteException((RemoteException)e);
        }
        if (tries == numRetries - 1) {
          throw e;
        }
        try {
          Thread.sleep(pause);
        }
 catch (        InterruptedException ie) {
        }
        if (LOG.isDebugEnabled()) {
          LOG.debug("reloading table servers because: " + e.getMessage());
        }
        currentRegionLocation=getRegionLocation(localStartKey,true);
      }
    }
  }
 catch (  IOException e) {
    close();
    if (e instanceof RemoteException) {
      e=RemoteExceptionHandler.decodeRemoteException((RemoteException)e);
    }
    throw e;
  }
  return true;
}
