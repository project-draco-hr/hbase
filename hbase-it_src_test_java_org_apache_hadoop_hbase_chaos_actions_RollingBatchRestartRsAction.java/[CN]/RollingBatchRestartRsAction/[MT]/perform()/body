{
  LOG.info(String.format("Performing action: Rolling batch restarting %d%% of region servers",(int)(ratio * 100)));
  List<ServerName> selectedServers=PolicyBasedChaosMonkey.selectRandomItems(getCurrentServers(),ratio);
  Queue<ServerName> serversToBeKilled=new LinkedList<ServerName>(selectedServers);
  Queue<ServerName> deadServers=new LinkedList<ServerName>();
  while (!serversToBeKilled.isEmpty() || !deadServers.isEmpty()) {
    boolean action=true;
    if (serversToBeKilled.isEmpty() || deadServers.isEmpty()) {
      action=deadServers.isEmpty();
    }
 else {
      action=RandomUtils.nextBoolean();
    }
    if (action) {
      ServerName server=serversToBeKilled.remove();
      killRs(server);
      deadServers.add(server);
    }
 else {
      ServerName server=deadServers.remove();
      startRs(server);
    }
    sleep(RandomUtils.nextInt((int)sleepTime));
  }
}
