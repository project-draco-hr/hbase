{
  HRegion r=createNewHRegion(TESTTABLEDESC,START_KEY,END_KEY,TEST_UTIL.getConfiguration());
  addContent(r,FAMILY,COL);
  r.flushcache();
  Scan scan=new Scan(Bytes.toBytes("aaa"),Bytes.toBytes("aaz"));
  scan.addColumn(FAMILY,COL);
  scan.setMaxVersions(1);
  InternalScanner s=r.getScanner(scan);
  List<KeyValue> results=new ArrayList<KeyValue>();
  while (s.next(results))   ;
  s.close();
  int expectResultSize='z' - 'a';
  Assert.assertEquals(expectResultSize,results.size());
  int kvPerBlock=(int)Math.ceil(BLOCK_SIZE / (double)results.get(0).getLength());
  Assert.assertEquals(2,kvPerBlock);
}
