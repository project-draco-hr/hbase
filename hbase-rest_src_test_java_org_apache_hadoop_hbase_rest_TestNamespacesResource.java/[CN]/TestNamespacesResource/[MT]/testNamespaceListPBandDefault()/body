{
  String schemaPath="/namespaces/";
  NamespacesModel model;
  Response response;
  Admin admin=TEST_UTIL.getHBaseAdmin();
  assertFalse(doesNamespaceExist(admin,NAMESPACE1));
  model=testNamespacesModel.buildTestModel();
  testNamespacesModel.checkModel(model);
  response=client.get(schemaPath,Constants.MIMETYPE_PROTOBUF);
  assertEquals(200,response.getCode());
  model.getObjectFromMessage(response.getBody());
  testNamespacesModel.checkModel(model,"hbase","default");
  response=client.get(schemaPath);
  assertEquals(200,response.getCode());
  createNamespaceViaAdmin(admin,NAMESPACE1);
  response=client.get(schemaPath,Constants.MIMETYPE_PROTOBUF);
  assertEquals(200,response.getCode());
  model.getObjectFromMessage(response.getBody());
  testNamespacesModel.checkModel(model,NAMESPACE1,"hbase","default");
  response=client.get(schemaPath);
  assertEquals(200,response.getCode());
  createNamespaceViaAdmin(admin,NAMESPACE2);
  response=client.get(schemaPath,Constants.MIMETYPE_PROTOBUF);
  assertEquals(200,response.getCode());
  model.getObjectFromMessage(response.getBody());
  testNamespacesModel.checkModel(model,NAMESPACE1,NAMESPACE2,"hbase","default");
  response=client.get(schemaPath);
  assertEquals(200,response.getCode());
  admin.deleteNamespace(NAMESPACE1);
  response=client.get(schemaPath,Constants.MIMETYPE_PROTOBUF);
  assertEquals(200,response.getCode());
  model.getObjectFromMessage(response.getBody());
  testNamespacesModel.checkModel(model,NAMESPACE2,"hbase","default");
  response=client.get(schemaPath);
  assertEquals(200,response.getCode());
  admin.deleteNamespace(NAMESPACE2);
}
