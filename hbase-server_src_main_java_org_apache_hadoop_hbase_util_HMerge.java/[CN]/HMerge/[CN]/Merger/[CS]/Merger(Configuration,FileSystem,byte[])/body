{
  this.conf=conf;
  this.fs=fs;
  this.maxFilesize=conf.getLong(HConstants.HREGION_MAX_FILESIZE,HConstants.DEFAULT_MAX_FILE_SIZE);
  this.tabledir=new Path(fs.makeQualified(new Path(conf.get(HConstants.HBASE_DIR))),Bytes.toString(tableName));
  this.htd=FSTableDescriptors.getTableDescriptor(this.fs,this.tabledir);
  String logname="merge_" + System.currentTimeMillis() + HConstants.HREGION_LOGDIR_NAME;
  this.hlog=HLogFactory.createHLog(fs,tabledir,logname,conf);
}
