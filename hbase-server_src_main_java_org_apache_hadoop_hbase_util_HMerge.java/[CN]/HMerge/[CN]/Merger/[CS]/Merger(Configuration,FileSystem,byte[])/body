{
  this.conf=conf;
  this.fs=fs;
  this.maxFilesize=conf.getLong(HConstants.HREGION_MAX_FILESIZE,HConstants.DEFAULT_MAX_FILE_SIZE);
  this.tabledir=new Path(fs.makeQualified(new Path(conf.get(HConstants.HBASE_DIR))),Bytes.toString(tableName));
  this.htd=FSTableDescriptors.getTableDescriptor(this.fs,this.tabledir);
  Path logdir=new Path(tabledir,"merge_" + EnvironmentEdgeManager.currentTimeMillis() + HConstants.HREGION_LOGDIR_NAME);
  Path oldLogDir=new Path(tabledir,HConstants.HREGION_OLDLOGDIR_NAME);
  this.hlog=new HLog(fs,logdir,oldLogDir,conf);
}
