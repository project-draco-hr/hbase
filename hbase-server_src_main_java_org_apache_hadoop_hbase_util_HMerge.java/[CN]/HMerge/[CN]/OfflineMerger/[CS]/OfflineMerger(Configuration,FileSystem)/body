{
  super(conf,fs,HConstants.META_TABLE_NAME);
  Path rootDir=FSUtils.getRootDir(conf);
  root=HRegion.openHRegion(conf,fs,rootDir,HRegionInfo.ROOT_REGIONINFO,HTableDescriptor.ROOT_TABLEDESC,hlog);
  Scan scan=new Scan();
  scan.addColumn(HConstants.CATALOG_FAMILY,HConstants.REGIONINFO_QUALIFIER);
  InternalScanner rootScanner=root.getScanner(scan);
  try {
    List<KeyValue> results=new ArrayList<KeyValue>();
    boolean hasMore;
    do {
      hasMore=rootScanner.next(results);
      for (      KeyValue kv : results) {
        HRegionInfo info=HRegionInfo.parseFromOrNull(kv.getValue());
        if (info != null) {
          metaRegions.add(info);
        }
      }
    }
 while (hasMore);
  }
  finally {
    rootScanner.close();
    try {
      root.close();
    }
 catch (    IOException e) {
      LOG.error(e);
    }
  }
}
