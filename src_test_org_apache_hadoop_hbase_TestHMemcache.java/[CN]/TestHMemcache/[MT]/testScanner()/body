{
  addRows(this.hmemcache);
  long timestamp=System.currentTimeMillis();
  Text[] cols=new Text[COLUMNS_COUNT * ROW_COUNT];
  for (int i=0; i < ROW_COUNT; i++) {
    for (int ii=0; ii < COLUMNS_COUNT; ii++) {
      cols[(ii + (i * COLUMNS_COUNT))]=getColumnName(i,ii);
    }
  }
  HInternalScannerInterface scanner=this.hmemcache.getScanner(timestamp,cols,new Text());
  HStoreKey key=new HStoreKey();
  TreeMap<Text,BytesWritable> results=new TreeMap<Text,BytesWritable>();
  for (int i=0; scanner.next(key,results); i++) {
    assertTrue("Row name",key.toString().startsWith(getRowName(i).toString()));
    assertEquals("Count of columns",COLUMNS_COUNT,results.size());
    TreeMap<Text,BytesWritable> row=new TreeMap<Text,BytesWritable>();
    for (Iterator<Map.Entry<Text,BytesWritable>> it=results.entrySet().iterator(); it.hasNext(); ) {
      Map.Entry<Text,BytesWritable> e=it.next();
      row.put(e.getKey(),e.getValue());
    }
    isExpectedRow(i,row);
    results.clear();
  }
}
