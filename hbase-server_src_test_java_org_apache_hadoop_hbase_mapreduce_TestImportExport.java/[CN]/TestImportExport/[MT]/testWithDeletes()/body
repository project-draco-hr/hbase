{
  String EXPORT_TABLE="exportWithDeletes";
  HTableDescriptor desc=new HTableDescriptor(EXPORT_TABLE);
  desc.addFamily(new HColumnDescriptor(FAMILYA).setMaxVersions(5).setKeepDeletedCells(true));
  UTIL.getHBaseAdmin().createTable(desc);
  HTable t=new HTable(UTIL.getConfiguration(),EXPORT_TABLE);
  Put p=new Put(ROW1);
  p.add(FAMILYA,QUAL,now,QUAL);
  p.add(FAMILYA,QUAL,now + 1,QUAL);
  p.add(FAMILYA,QUAL,now + 2,QUAL);
  p.add(FAMILYA,QUAL,now + 3,QUAL);
  p.add(FAMILYA,QUAL,now + 4,QUAL);
  t.put(p);
  Delete d=new Delete(ROW1,now + 3);
  t.delete(d);
  d=new Delete(ROW1);
  d.deleteColumns(FAMILYA,QUAL,now + 2);
  t.delete(d);
  String[] args=new String[]{"-D" + Export.RAW_SCAN + "=true",EXPORT_TABLE,FQ_OUTPUT_DIR,"1000"};
  assertTrue(runExport(args));
  String IMPORT_TABLE="importWithDeletes";
  desc=new HTableDescriptor(IMPORT_TABLE);
  desc.addFamily(new HColumnDescriptor(FAMILYA).setMaxVersions(5).setKeepDeletedCells(true));
  UTIL.getHBaseAdmin().createTable(desc);
  t.close();
  t=new HTable(UTIL.getConfiguration(),IMPORT_TABLE);
  args=new String[]{IMPORT_TABLE,FQ_OUTPUT_DIR};
  assertTrue(runImport(args));
  Scan s=new Scan();
  s.setMaxVersions();
  s.setRaw(true);
  ResultScanner scanner=t.getScanner(s);
  Result r=scanner.next();
  KeyValue[] res=r.raw();
  assertTrue(res[0].isDeleteFamily());
  assertEquals(now + 4,res[1].getTimestamp());
  assertEquals(now + 3,res[2].getTimestamp());
  assertTrue(res[3].isDelete());
  assertEquals(now + 2,res[4].getTimestamp());
  assertEquals(now + 1,res[5].getTimestamp());
  assertEquals(now,res[6].getTimestamp());
  t.close();
}
