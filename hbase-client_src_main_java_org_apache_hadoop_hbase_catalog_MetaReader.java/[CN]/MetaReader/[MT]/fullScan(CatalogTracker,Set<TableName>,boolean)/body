{
  final Map<HRegionInfo,ServerName> regions=new TreeMap<HRegionInfo,ServerName>();
  Visitor v=new Visitor(){
    @Override public boolean visit(    Result r) throws IOException {
      if (r == null || r.isEmpty())       return true;
      Pair<HRegionInfo,ServerName> region=HRegionInfo.getHRegionInfoAndServerName(r);
      HRegionInfo hri=region.getFirst();
      if (hri == null)       return true;
      if (hri.getTable() == null)       return true;
      if (disabledTables.contains(hri.getTable()))       return true;
      if (excludeOfflinedSplitParents && hri.isSplitParent())       return true;
      regions.put(hri,region.getSecond());
      return true;
    }
  }
;
  fullScan(catalogTracker,v);
  return regions;
}
