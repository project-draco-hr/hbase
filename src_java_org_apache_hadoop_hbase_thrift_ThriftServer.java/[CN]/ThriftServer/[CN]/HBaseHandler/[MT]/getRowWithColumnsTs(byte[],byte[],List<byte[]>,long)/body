{
  try {
    HTable table=getTable(tableName);
    if (columns == null) {
      Get get=new Get(row);
      get.setTimeStamp(timestamp);
      Result result=table.get(get);
      return ThriftUtilities.rowResultFromHBase(result.getRowResult());
    }
    byte[][] columnArr=columns.toArray(new byte[columns.size()][]);
    Get get=new Get(row);
    for (    byte[] column : columnArr) {
      byte[][] famAndQf=KeyValue.parseColumn(column);
      if (famAndQf[1] == null || famAndQf[1].length == 0) {
        get.addFamily(famAndQf[0]);
      }
 else {
        get.addColumn(famAndQf[0],famAndQf[1]);
      }
    }
    get.setTimeStamp(timestamp);
    Result result=table.get(get);
    return ThriftUtilities.rowResultFromHBase(result.getRowResult());
  }
 catch (  IOException e) {
    throw new IOError(e.getMessage());
  }
}
