{
  if (LOG.isDebugEnabled()) {
    LOG.debug("createTable: table=" + new String(tableName));
  }
  try {
    byte[] tableStr=getText(tableName);
    if (admin.tableExists(tableStr)) {
      throw new AlreadyExists("table name already in use");
    }
    HTableDescriptor desc=new HTableDescriptor(tableStr);
    for (    ColumnDescriptor col : columnFamilies) {
      HColumnDescriptor colDesc=ThriftUtilities.colDescFromThrift(col);
      desc.addFamily(colDesc);
      if (LOG.isDebugEnabled()) {
        LOG.debug("createTable:     col=" + new String(colDesc.getName()));
      }
    }
    admin.createTable(desc);
  }
 catch (  IOException e) {
    throw new IOError(e.getMessage());
  }
catch (  IllegalArgumentException e) {
    throw new IllegalArgument(e.getMessage());
  }
}
