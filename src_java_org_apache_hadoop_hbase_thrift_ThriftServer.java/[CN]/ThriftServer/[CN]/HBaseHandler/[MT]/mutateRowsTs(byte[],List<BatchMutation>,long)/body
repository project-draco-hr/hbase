{
  List<BatchUpdate> batchUpdates=new ArrayList<BatchUpdate>();
  if (LOG.isDebugEnabled()) {
    LOG.debug("mutateRowsTs: table=" + new String(tableName) + ", rows="+ rowBatches.size()+ ", ts="+ timestamp);
  }
  for (  BatchMutation batch : rowBatches) {
    byte[] row=batch.row;
    List<Mutation> mutations=batch.mutations;
    if (LOG.isDebugEnabled()) {
      LOG.debug("mutateRowsTs:    : row=" + new String(row) + " mutations="+ mutations.size());
      for (      Mutation m : mutations) {
        if (m.isDelete) {
          LOG.debug("mutateRowsTs:    : delete - " + new String(getText(m.column)));
        }
 else {
          LOG.debug("mutateRowsTs:    : put - " + new String(getText(m.column)) + " => "+ new String(m.value));
        }
      }
    }
    BatchUpdate batchUpdate=new BatchUpdate(getText(row),timestamp);
    for (    Mutation m : mutations) {
      if (m.isDelete) {
        batchUpdate.delete(getText(m.column));
      }
 else {
        batchUpdate.put(getText(m.column),m.value);
      }
    }
    batchUpdates.add(batchUpdate);
  }
  HTable table=null;
  try {
    table=getTable(tableName);
    table.commit(batchUpdates);
  }
 catch (  IOException e) {
    throw new IOError(e.getMessage());
  }
catch (  IllegalArgumentException e) {
    throw new IllegalArgument(e.getMessage());
  }
}
