{
  if (args.length < 1) {
    printUsageAndExit();
  }
  int port=9090;
  final String portArgKey="--port=";
  for (  String cmd : args) {
    if (cmd.startsWith(portArgKey)) {
      port=Integer.parseInt(cmd.substring(portArgKey.length()));
      continue;
    }
 else     if (cmd.equals("--help") || cmd.equals("-h")) {
      printUsageAndExit();
    }
 else     if (cmd.equals("start")) {
      continue;
    }
 else     if (cmd.equals("stop")) {
      printUsageAndExit("To shutdown the thrift server run " + "bin/hbase-daemon.sh stop thrift or send a kill signal to " + "the thrift server pid");
    }
    printUsageAndExit();
  }
  Log LOG=LogFactory.getLog("ThriftServer");
  LOG.info("starting HBase Thrift server on port " + Integer.toString(port));
  HBaseHandler handler=new HBaseHandler();
  Hbase.Processor processor=new Hbase.Processor(handler);
  TNonblockingServerTransport serverTransport=new TNonblockingServerSocket(port);
  TProtocolFactory protFactory=new TCompactProtocol.Factory();
  TServer server=new THsHaServer(processor,serverTransport,protFactory);
  server.serve();
}
