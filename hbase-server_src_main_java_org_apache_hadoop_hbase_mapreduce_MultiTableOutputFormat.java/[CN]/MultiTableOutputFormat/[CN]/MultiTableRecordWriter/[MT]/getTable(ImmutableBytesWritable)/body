{
  if (this.connection == null) {
    this.connection=ConnectionFactory.createConnection(conf);
  }
  if (!tables.containsKey(tableName)) {
    LOG.debug("Opening HTable \"" + Bytes.toString(tableName.get()) + "\" for writing");
    Table table=connection.getTable(TableName.valueOf(tableName.get()));
    table.setAutoFlushTo(false);
    tables.put(tableName,table);
  }
  return tables.get(tableName);
}
