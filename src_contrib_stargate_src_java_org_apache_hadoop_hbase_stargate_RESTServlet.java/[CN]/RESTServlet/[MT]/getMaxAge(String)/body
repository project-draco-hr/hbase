{
  Integer i=maxAgeMap.get(tableName);
  if (i != null) {
    return i.intValue();
  }
  HTable table=pool.getTable(tableName);
  try {
    int maxAge=DEFAULT_MAX_AGE;
    for (    HColumnDescriptor family : table.getTableDescriptor().getFamilies()) {
      int ttl=family.getTimeToLive();
      if (ttl < 0) {
        continue;
      }
      if (ttl < maxAge) {
        maxAge=ttl;
      }
    }
    maxAgeMap.put(tableName,maxAge);
    return maxAge;
  }
  finally {
    pool.putTable(table);
  }
}
