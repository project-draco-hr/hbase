{
  int version=in.readByte();
  if (version > (int)SCANMETRICS_VERSION) {
    throw new IOException("version " + version + " not supported");
  }
  int metricsCount=in.readInt();
  for (int i=0; i < metricsCount; i++) {
    String metricsName=in.readUTF();
    long v=in.readLong();
    MetricsBase mb=registry.get(metricsName);
    if (mb instanceof MetricsTimeVaryingLong) {
      ((MetricsTimeVaryingLong)mb).inc(v);
    }
 else {
      LOG.warn("unsupported metrics type. metrics name: " + mb.getName() + ", metrics description: "+ mb.getDescription());
    }
  }
}
