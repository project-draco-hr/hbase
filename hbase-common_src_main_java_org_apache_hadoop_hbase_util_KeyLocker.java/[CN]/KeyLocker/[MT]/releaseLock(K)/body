{
  Pair<KeyLock<K>,AtomicInteger> lock=locks.get(key);
  if (lock != null) {
    if (lock.getSecond().decrementAndGet() == 0) {
      locks.remove(key);
    }
  }
 else {
    String message="Can't release the lock for " + key + ", this key is not in the key list."+ " known keys are: "+ locks.keySet();
    LOG.error(message);
    throw new RuntimeException(message);
  }
}
