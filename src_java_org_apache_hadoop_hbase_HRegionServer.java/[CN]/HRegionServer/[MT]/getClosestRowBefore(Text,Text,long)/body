{
  checkOpen();
  requestCount.incrementAndGet();
  try {
    HRegion region=getRegion(regionName);
    HbaseMapWritable result=new HbaseMapWritable();
    Map<Text,byte[]> map=region.getClosestRowBefore(row,ts);
    if (map == null) {
      return null;
    }
    for (    Map.Entry<Text,byte[]> es : map.entrySet()) {
      result.put(new HStoreKey(row,es.getKey()),new ImmutableBytesWritable(es.getValue()));
    }
    return result;
  }
 catch (  IOException e) {
    checkFileSystem();
    throw e;
  }
}
