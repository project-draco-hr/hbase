{
  requestCount.incrementAndGet();
  try {
    HRegion r=getRegion(regionName);
    long scannerId=-1L;
    HInternalScannerInterface s=r.getScanner(cols,firstRow,timestamp,filter);
    scannerId=rand.nextLong();
    String scannerName=String.valueOf(scannerId);
synchronized (scanners) {
      scanners.put(scannerName,s);
    }
    leases.createLease(scannerId,scannerId,new ScannerListener(scannerName));
    return scannerId;
  }
 catch (  IOException e) {
    if (e instanceof RemoteException) {
      try {
        e=RemoteExceptionHandler.decodeRemoteException((RemoteException)e);
      }
 catch (      IOException x) {
        e=x;
      }
    }
    LOG.error("",e);
    checkFileSystem();
    throw e;
  }
}
