{
  for (int i=0; i < msgs.length; i++) {
switch (msgs[i].getMsg()) {
case HMsg.MSG_REGION_OPEN:
      openRegion(msgs[i].getRegionInfo());
    break;
case HMsg.MSG_REGION_CLOSE:
  closeRegion(msgs[i].getRegionInfo(),true);
break;
case HMsg.MSG_REGION_MERGE:
throw new IOException("TODO: need to figure out merge");
case HMsg.MSG_CALL_SERVER_STARTUP:
closeAllRegions();
return false;
case HMsg.MSG_REGIONSERVER_ALREADY_RUNNING:
stop();
return false;
case HMsg.MSG_REGION_CLOSE_WITHOUT_REPORT:
closeRegion(msgs[i].getRegionInfo(),false);
break;
case HMsg.MSG_REGION_CLOSE_AND_DELETE:
closeAndDeleteRegion(msgs[i].getRegionInfo());
break;
default :
throw new IOException("Impossible state during msg processing.  Instruction: " + msgs[i]);
}
}
return true;
}
