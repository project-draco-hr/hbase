{
  Text scannerName=new Text(String.valueOf(scannerId));
  HInternalScannerInterface s=scanners.get(scannerName);
  if (s == null) {
    throw new UnknownScannerException("Name: " + scannerName);
  }
  leases.renewLease(scannerName,scannerName);
  ArrayList<KeyedData> values=new ArrayList<KeyedData>();
  TreeMap<Text,BytesWritable> results=new TreeMap<Text,BytesWritable>();
  HStoreKey key=new HStoreKey();
  while (s.next(key,results)) {
    for (    Map.Entry<Text,BytesWritable> e : results.entrySet()) {
      HStoreKey k=new HStoreKey(key.getRow(),e.getKey(),key.getTimestamp());
      BytesWritable val=e.getValue();
      if (val.getSize() == DELETE_BYTES.getSize() && val.compareTo(DELETE_BYTES) == 0) {
        if (LOG.isDebugEnabled()) {
          LOG.debug("skipping deleted value for key: " + k.toString());
        }
        continue;
      }
      if (LOG.isDebugEnabled()) {
        LOG.debug("adding value for key: " + k.toString());
      }
      values.add(new KeyedData(k,val));
    }
    if (values.size() > 0) {
      break;
    }
    results.clear();
  }
  return values.toArray(new KeyedData[values.size()]);
}
