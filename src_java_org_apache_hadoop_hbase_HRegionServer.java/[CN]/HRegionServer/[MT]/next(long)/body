{
  String scannerName=String.valueOf(scannerId);
  HInternalScannerInterface s=scanners.get(scannerName);
  if (s == null) {
    throw new UnknownScannerException("Name: " + scannerName);
  }
  leases.renewLease(scannerId,scannerId);
  ArrayList<KeyedData> values=new ArrayList<KeyedData>();
  TreeMap<Text,byte[]> results=new TreeMap<Text,byte[]>();
  HStoreKey key=new HStoreKey();
  while (s.next(key,results)) {
    for (    Map.Entry<Text,byte[]> e : results.entrySet()) {
      HStoreKey k=new HStoreKey(key.getRow(),e.getKey(),key.getTimestamp());
      byte[] val=e.getValue();
      if (DELETE_BYTES.compareTo(val) == 0) {
        if (LOG.isDebugEnabled()) {
          LOG.debug("skipping deleted value for key: " + k.toString());
        }
        continue;
      }
      if (LOG.isDebugEnabled()) {
        LOG.debug("adding value for key: " + k.toString());
      }
      values.add(new KeyedData(k,val));
    }
    if (values.size() > 0) {
      break;
    }
    results.clear();
  }
  return values.toArray(new KeyedData[values.size()]);
}
