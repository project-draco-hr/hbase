{
  checkOpen();
  requestCount.incrementAndGet();
  try {
    String scannerName=String.valueOf(scannerId);
    HScannerInterface s=scanners.get(scannerName);
    if (s == null) {
      throw new UnknownScannerException("Name: " + scannerName);
    }
    this.leases.renewLease(scannerId,scannerId);
    HbaseMapWritable values=new HbaseMapWritable();
    HStoreKey key=new HStoreKey();
    TreeMap<Text,byte[]> results=new TreeMap<Text,byte[]>();
    while (s.next(key,results)) {
      for (      Map.Entry<Text,byte[]> e : results.entrySet()) {
        values.put(new HStoreKey(key.getRow(),e.getKey(),key.getTimestamp()),new ImmutableBytesWritable(e.getValue()));
      }
      if (values.size() > 0) {
        break;
      }
      results.clear();
    }
    return values;
  }
 catch (  IOException e) {
    checkFileSystem();
    throw e;
  }
}
