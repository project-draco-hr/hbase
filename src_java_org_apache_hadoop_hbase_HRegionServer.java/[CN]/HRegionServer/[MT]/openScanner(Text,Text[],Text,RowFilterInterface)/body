{
  HRegion r=getRegion(regionName);
  long scannerId=-1L;
  try {
    HInternalScannerInterface s=r.getScanner(cols,firstRow,filter);
    scannerId=rand.nextLong();
    String scannerName=String.valueOf(scannerId);
synchronized (scanners) {
      scanners.put(scannerName,s);
    }
    leases.createLease(scannerId,scannerId,new ScannerListener(scannerName));
  }
 catch (  IOException e) {
    LOG.error(e);
    throw e;
  }
  return scannerId;
}
