{
  List<HRegion> nonClosedRegionsToFlush=getRegionsToCheck();
  for (  HRegion cur : nonClosedRegionsToFlush) {
    try {
      cur.optionallyFlush();
    }
 catch (    DroppedSnapshotException e) {
      LOG.fatal("Replay of hlog required. Forcing server restart",e);
      if (!checkFileSystem()) {
        break;
      }
      HRegionServer.this.stop();
    }
catch (    IOException iex) {
      LOG.error("Cache flush failed",RemoteExceptionHandler.checkIOException(iex));
      if (!checkFileSystem()) {
        break;
      }
    }
  }
}
