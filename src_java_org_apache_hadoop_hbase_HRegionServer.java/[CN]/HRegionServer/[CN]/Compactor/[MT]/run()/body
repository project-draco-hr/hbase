{
  while (!stopRequested.get()) {
    QueueEntry e=null;
    try {
      e=compactionQueue.poll(threadWakeFrequency,TimeUnit.MILLISECONDS);
      if (e == null) {
        continue;
      }
      if (e.getRegion().compactIfNeeded()) {
        splitter.splitRequested(e);
      }
    }
 catch (    InterruptedException ex) {
      continue;
    }
catch (    IOException ex) {
      LOG.error("Compaction failed" + (e != null ? (" for region " + e.getRegion().getRegionName()) : ""),RemoteExceptionHandler.checkIOException(ex));
      if (!checkFileSystem()) {
        break;
      }
    }
catch (    Exception ex) {
      LOG.error("Compaction failed" + (e != null ? (" for region " + e.getRegion().getRegionName()) : ""),ex);
      if (!checkFileSystem()) {
        break;
      }
    }
  }
  LOG.info(getName() + " exiting");
}
