{
  List<HRegion> nonClosedRegionsToCheck=getRegionsToCheck();
  for (  HRegion cur : nonClosedRegionsToCheck) {
    try {
      if (cur.needsCompaction()) {
        cur.compactStores();
      }
      Text midKey=new Text();
      if (cur.needsSplit(midKey)) {
        split(cur,midKey);
      }
    }
 catch (    IOException e) {
      LOG.error("Split or compaction failed",e);
      if (!checkFileSystem()) {
        break;
      }
    }
  }
}
