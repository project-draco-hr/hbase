{
  HRegionInterface rs=HConnectionManager.getConnection(conf).getHRegionConnection(server);
  rs.closeRegion(region,false);
  long timeout=conf.getLong("hbase.hbck.close.timeout",120000);
  long expiration=timeout + System.currentTimeMillis();
  while (System.currentTimeMillis() < expiration) {
    try {
      HRegionInfo rsRegion=rs.getRegionInfo(region.getRegionName());
      if (rsRegion == null)       throw new NotServingRegionException();
    }
 catch (    Exception e) {
      return;
    }
    Thread.sleep(1000);
  }
  throw new IOException("Region " + region + " failed to close within"+ " timeout "+ timeout);
}
