{
  if (filesToCompact == null || filesToCompact.size() == 0)   return null;
  ArrayList<StoreFile> expiredStoreFiles=null;
  boolean hasExpiredStoreFiles=false;
  CompactSelection expiredSFSelection=null;
  for (  StoreFile storeFile : this.filesToCompact) {
    if (storeFile.getReader().getMaxTimestamp() < maxExpiredTimeStamp) {
      LOG.info("Deleting the expired store file by compaction: " + storeFile.getPath() + " whose maxTimeStamp is "+ storeFile.getReader().getMaxTimestamp()+ " while the max expired timestamp is "+ maxExpiredTimeStamp);
      if (!hasExpiredStoreFiles) {
        expiredStoreFiles=new ArrayList<StoreFile>();
        hasExpiredStoreFiles=true;
      }
      expiredStoreFiles.add(storeFile);
    }
  }
  if (hasExpiredStoreFiles) {
    expiredSFSelection=new CompactSelection(expiredStoreFiles);
  }
  return expiredSFSelection;
}
