{
  LOG.info("Starting WAL Procedure Store lease recovery");
  FileStatus[] oldLogs=getLogFiles();
  while (running.get()) {
    flushLogId=initOldLogs(oldLogs) + 1;
    if (!rollWriter(flushLogId)) {
      if (LOG.isDebugEnabled()) {
        LOG.debug("Someone else has already created log: " + flushLogId);
      }
      continue;
    }
    oldLogs=getLogFiles();
    if (getMaxLogId(oldLogs) > flushLogId) {
      if (LOG.isDebugEnabled()) {
        LOG.debug("Someone else created new logs. Expected maxLogId < " + flushLogId);
      }
      logs.getLast().removeFile();
      continue;
    }
    LOG.info("Lease acquired for flushLogId: " + flushLogId);
    break;
  }
}
