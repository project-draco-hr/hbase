{
  int retry=0;
  long totalSynced=0;
  do {
    try {
      totalSynced=syncSlots(stream,slots,0,slotIndex);
      break;
    }
 catch (    Throwable e) {
      if (++retry == MAX_RETRIES_BEFORE_ABORT) {
        LOG.error("sync slot failed, abort.",e);
        sendAbortProcessSignal();
      }
    }
  }
 while (running.get());
  return totalSynced;
}
