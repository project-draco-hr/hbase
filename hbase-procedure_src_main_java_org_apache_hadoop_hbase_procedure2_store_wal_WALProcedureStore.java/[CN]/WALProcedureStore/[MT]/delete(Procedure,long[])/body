{
  if (LOG.isTraceEnabled()) {
    LOG.trace("Update " + proc + " and Delete "+ Arrays.toString(subProcIds));
  }
  ByteSlot slot=acquireSlot();
  try {
    ProcedureWALFormat.writeDelete(slot,proc,subProcIds);
    pushData(PushType.DELETE,slot,proc.getProcId(),subProcIds);
  }
 catch (  IOException e) {
    LOG.fatal("Unable to serialize the procedure: " + proc,e);
    throw new RuntimeException(e);
  }
 finally {
    releaseSlot(slot);
  }
}
