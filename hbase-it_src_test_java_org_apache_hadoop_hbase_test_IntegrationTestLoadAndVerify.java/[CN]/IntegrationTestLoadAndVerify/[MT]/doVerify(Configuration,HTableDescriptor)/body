{
  Path outputDir=getTestDir(TEST_NAME,"verify-output");
  Job job=new Job(conf);
  job.setJarByClass(this.getClass());
  job.setJobName(TEST_NAME + " Verification for " + htd.getTableName());
  Scan scan=new Scan();
  TableMapReduceUtil.initTableMapperJob(htd.getTableName().getNameAsString(),scan,VerifyMapper.class,BytesWritable.class,BytesWritable.class,job);
  int scannerCaching=conf.getInt("verify.scannercaching",SCANNER_CACHING);
  TableMapReduceUtil.setScannerCaching(job,scannerCaching);
  job.setReducerClass(VerifyReducer.class);
  job.setNumReduceTasks(conf.getInt(NUM_REDUCE_TASKS_KEY,NUM_REDUCE_TASKS_DEFAULT));
  FileOutputFormat.setOutputPath(job,outputDir);
  assertTrue(job.waitForCompletion(true));
  long numOutputRecords=job.getCounters().findCounter(Counters.ROWS_WRITTEN).getValue();
  assertEquals(0,numOutputRecords);
}
