{
  if (argv.length < 1 || argv.length > 1) {
    usage();
    return 1;
  }
  IntegrationTestingUtility.setUseDistributedCluster(getConf());
  boolean doLoad=false;
  boolean doVerify=false;
  boolean doDelete=getConf().getBoolean("loadmapper.deleteAfter",true);
  int numPresplits=getConf().getInt("loadmapper.numPresplits",40);
  if (argv[0].equals("load")) {
    doLoad=true;
  }
 else   if (argv[0].equals("verify")) {
    doVerify=true;
  }
 else   if (argv[0].equals("loadAndVerify")) {
    doLoad=true;
    doVerify=true;
  }
 else {
    System.err.println("Invalid argument " + argv[0]);
    usage();
    return 1;
  }
  String table=getConf().get(TABLE_NAME_KEY,TEST_NAME);
  HTableDescriptor htd=new HTableDescriptor(TableName.valueOf(table));
  htd.addFamily(new HColumnDescriptor(TEST_FAMILY));
  HBaseAdmin admin=new HBaseAdmin(getConf());
  if (doLoad) {
    admin.createTable(htd,Bytes.toBytes(0L),Bytes.toBytes(-1L),numPresplits);
    doLoad(getConf(),htd);
  }
  if (doVerify) {
    doVerify(getConf(),htd);
    if (doDelete) {
      deleteTable(admin,htd);
    }
  }
  return 0;
}
