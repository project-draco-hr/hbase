{
  IntegrationTestingUtility.setUseDistributedCluster(getConf());
  boolean doLoad=false;
  boolean doVerify=false;
  boolean doDelete=getConf().getBoolean("loadmapper.deleteAfter",true);
  int numPresplits=getConf().getInt("loadmapper.numPresplits",40);
  if (toRun.equals("load")) {
    doLoad=true;
  }
 else   if (toRun.equals("verify")) {
    doVerify=true;
  }
 else   if (toRun.equals("loadAndVerify")) {
    doLoad=true;
    doVerify=true;
  }
 else {
    System.err.println("Invalid argument " + toRun);
    usage();
    return 1;
  }
  String table=getTablename();
  HTableDescriptor htd=new HTableDescriptor(TableName.valueOf(table));
  htd.addFamily(new HColumnDescriptor(TEST_FAMILY));
  HBaseAdmin admin=new HBaseAdmin(getConf());
  if (doLoad) {
    admin.createTable(htd,Bytes.toBytes(0L),Bytes.toBytes(-1L),numPresplits);
    doLoad(getConf(),htd);
  }
  if (doVerify) {
    doVerify(getConf(),htd);
    if (doDelete) {
      deleteTable(admin,htd);
    }
  }
  return 0;
}
