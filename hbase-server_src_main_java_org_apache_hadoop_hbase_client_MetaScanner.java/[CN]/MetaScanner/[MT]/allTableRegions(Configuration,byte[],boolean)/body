{
  final NavigableMap<HRegionInfo,ServerName> regions=new TreeMap<HRegionInfo,ServerName>();
  MetaScannerVisitor visitor=new TableMetaScannerVisitor(conf,tablename){
    @Override public boolean processRowInternal(    Result rowResult) throws IOException {
      HRegionInfo info=getHRegionInfo(rowResult);
      ServerName serverName=HRegionInfo.getServerName(rowResult);
      if (!(info.isOffline() || info.isSplit())) {
        regions.put(new UnmodifyableHRegionInfo(info),serverName);
      }
      return true;
    }
  }
;
  metaScan(conf,visitor,tablename);
  return regions;
}
