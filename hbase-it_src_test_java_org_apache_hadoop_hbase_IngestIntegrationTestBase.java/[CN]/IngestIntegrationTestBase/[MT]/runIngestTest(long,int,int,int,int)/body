{
  LOG.info("Running ingest");
  LOG.info("Cluster size:" + util.getHBaseClusterInterface().getClusterStatus().getServersSize());
  long start=System.currentTimeMillis();
  String runtimeKey=String.format(RUN_TIME_KEY,this.getClass().getSimpleName());
  long runtime=util.getConfiguration().getLong(runtimeKey,defaultRunTime);
  long startKey=0;
  long numKeys=getNumKeys(keysPerServerPerIter);
  while (System.currentTimeMillis() - start < 0.9 * runtime) {
    LOG.info("Intended run time: " + (runtime / 60000) + " min, left:"+ ((runtime - (System.currentTimeMillis() - start)) / 60000)+ " min");
    int ret=loadTool.run(new String[]{"-tn",tableName,"-write",String.format("%d:%d:%d",colsPerKey,recordSize,writeThreads),"-start_key",String.valueOf(startKey),"-num_keys",String.valueOf(numKeys),"-skip_init"});
    if (0 != ret) {
      String errorMsg="Load failed with error code " + ret;
      LOG.error(errorMsg);
      Assert.fail(errorMsg);
    }
    ret=loadTool.run(new String[]{"-tn",tableName,"-read","100:20","-start_key",String.valueOf(startKey),"-num_keys",String.valueOf(numKeys),"-skip_init"});
    if (0 != ret) {
      String errorMsg="Verification failed with error code " + ret;
      LOG.error(errorMsg);
      Assert.fail(errorMsg);
    }
    startKey+=numKeys;
  }
}
