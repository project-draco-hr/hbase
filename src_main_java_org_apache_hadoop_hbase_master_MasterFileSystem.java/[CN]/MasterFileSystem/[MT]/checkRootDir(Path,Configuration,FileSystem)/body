{
  FSUtils.waitOnSafeMode(c,c.getInt(HConstants.THREAD_WAKE_FREQUENCY,10 * 1000));
  if (!fs.exists(rd)) {
    fs.mkdirs(rd);
    FSUtils.setVersion(fs,rd,c.getInt(HConstants.THREAD_WAKE_FREQUENCY,10 * 1000));
  }
 else {
    FSUtils.checkVersion(fs,rd,true,c.getInt(HConstants.THREAD_WAKE_FREQUENCY,10 * 1000));
  }
  if (!FSUtils.checkClusterIdExists(fs,rd,c.getInt(HConstants.THREAD_WAKE_FREQUENCY,10 * 1000))) {
    FSUtils.setClusterId(fs,rd,UUID.randomUUID().toString(),c.getInt(HConstants.THREAD_WAKE_FREQUENCY,10 * 1000));
  }
  clusterId=FSUtils.getClusterId(fs,rd);
  if (!FSUtils.rootRegionExists(fs,rd)) {
    bootstrap(rd,c);
  }
  createRootTableInfo(rd);
  return rd;
}
