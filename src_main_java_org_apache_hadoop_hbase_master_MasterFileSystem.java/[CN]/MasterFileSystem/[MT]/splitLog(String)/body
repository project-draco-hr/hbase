{
  this.splitLogLock.lock();
  long splitTime=0, splitLogSize=0;
  Path logDir=new Path(this.rootdir,HLog.getHLogDirectoryName(serverName));
  try {
    HLogSplitter splitter=HLogSplitter.createLogSplitter(conf,rootdir,logDir,oldLogDir,this.fs);
    try {
      splitter.splitLog();
    }
 catch (    OrphanHLogAfterSplitException e) {
      LOG.warn("Retrying splitting because of:",e);
      splitter=HLogSplitter.createLogSplitter(conf,rootdir,logDir,oldLogDir,this.fs);
      splitter.splitLog();
    }
    splitTime=splitter.getTime();
    splitLogSize=splitter.getSize();
  }
 catch (  IOException e) {
    LOG.error("Failed splitting " + logDir.toString(),e);
  }
 finally {
    this.splitLogLock.unlock();
  }
  if (this.metrics != null) {
    this.metrics.addSplit(splitTime,splitLogSize);
  }
}
