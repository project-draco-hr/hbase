{
  HTable table=null;
  try {
    table=(HTable)connection.getTable(tableName);
    Pair<byte[][],byte[][]> keys=table.getRegionLocator().getStartEndKeys();
    verifyStartEndKeys(keys);
    Set<HRegionInfo> regions=new TreeSet<HRegionInfo>();
    for (    HRegionLocation loc : table.getRegionLocator().getAllRegionLocations()) {
      regions.add(loc.getRegionInfo());
    }
    verifyTableRegions(regions);
  }
  finally {
    IOUtils.closeQuietly(table);
  }
}
