{
  final Configuration conf=HBaseConfiguration.create();
  ServerManager sm=new ServerManager(new Server(){
    @Override public CatalogTracker getCatalogTracker(){
      return null;
    }
    @Override public Configuration getConfiguration(){
      return conf;
    }
    @Override public ServerName getServerName(){
      return null;
    }
    @Override public ZooKeeperWatcher getZooKeeper(){
      return null;
    }
    @Override public void abort(    String why,    Throwable e){
    }
    @Override public boolean isStopped(){
      return false;
    }
    @Override public void stop(    String why){
    }
  }
,null);
  LOG.debug("regionServerStartup 1");
  InetAddress ia1=InetAddress.getLocalHost();
  sm.regionServerStartup(ia1,1234,-1,System.currentTimeMillis());
  long maxSkew=30000;
  try {
    LOG.debug("regionServerStartup 2");
    InetAddress ia2=InetAddress.getLocalHost();
    sm.regionServerStartup(ia2,1235,-1,System.currentTimeMillis() - maxSkew * 2);
    Assert.assertTrue("HMaster should have thrown an ClockOutOfSyncException " + "but didn't.",false);
  }
 catch (  ClockOutOfSyncException e) {
    LOG.info("Recieved expected exception: " + e);
  }
}
