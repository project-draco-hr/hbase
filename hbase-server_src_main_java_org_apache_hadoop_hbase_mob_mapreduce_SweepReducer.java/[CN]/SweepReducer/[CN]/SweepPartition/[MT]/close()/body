{
  if (null == id) {
    return;
  }
  if (memstoreUpdated) {
    memstore.flushMemStore();
  }
  List<StoreFile> storeFiles=new ArrayList<StoreFile>(toBeDeleted.size());
  for (  Path path : toBeDeleted) {
    LOG.info("[In Partition close] Delete the file " + path + " in partition close");
    storeFiles.add(new StoreFile(fs,path,conf,cacheConfig,BloomType.NONE));
  }
  if (!storeFiles.isEmpty()) {
    try {
      MobUtils.removeMobFiles(conf,fs,table.getName(),mobTableDir,family.getName(),storeFiles);
      context.getCounter(SweepCounter.FILE_TO_BE_MERGE_OR_CLEAN).increment(storeFiles.size());
    }
 catch (    IOException e) {
      LOG.error("Fail to archive the store files " + storeFiles,e);
    }
    storeFiles.clear();
  }
  fileStatusMap.clear();
}
