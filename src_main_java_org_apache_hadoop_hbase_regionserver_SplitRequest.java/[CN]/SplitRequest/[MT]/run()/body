{
  try {
    final long startTime=System.currentTimeMillis();
    SplitTransaction st=new SplitTransaction(parent,midKey);
    if (!st.prepare())     return;
    try {
      st.execute(this.server,this.server);
    }
 catch (    Exception e) {
      try {
        LOG.info("Running rollback of failed split of " + parent + "; "+ e.getMessage());
        st.rollback(this.server,this.server);
        LOG.info("Successful rollback of failed split of " + parent);
      }
 catch (      RuntimeException ee) {
        LOG.info("Failed rollback of failed split of " + parent.getRegionNameAsString() + " -- aborting server",ee);
        this.server.abort("Failed split");
      }
      return;
    }
    LOG.info("Region split, META updated, and report to master. Parent=" + parent.getRegionInfo().getRegionNameAsString() + ", new regions: "+ st.getFirstDaughter().getRegionNameAsString()+ ", "+ st.getSecondDaughter().getRegionNameAsString()+ ". Split took "+ StringUtils.formatTimeDiff(System.currentTimeMillis(),startTime));
  }
 catch (  IOException ex) {
    LOG.error("Split failed " + this,RemoteExceptionHandler.checkIOException(ex));
    server.checkFileSystem();
  }
}
