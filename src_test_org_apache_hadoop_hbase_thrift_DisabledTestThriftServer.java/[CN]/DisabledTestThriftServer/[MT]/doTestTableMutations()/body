{
  ThriftServer.HBaseHandler handler=new ThriftServer.HBaseHandler();
  handler.createTable(tableAname,getColumnDescriptors());
  handler.mutateRow(tableAname,rowAname,getMutations());
  assertTrue(Bytes.equals(valueAname,handler.get(tableAname,rowAname,columnAname).value));
  TRowResult rowResult1=handler.getRow(tableAname,rowAname);
  assertTrue(Bytes.equals(rowAname,rowResult1.row));
  assertTrue(Bytes.equals(valueBname,rowResult1.columns.get(columnBname).value));
  handler.mutateRows(tableAname,getBatchMutations());
  boolean failed1=false;
  try {
    handler.get(tableAname,rowAname,columnAname);
  }
 catch (  NotFound nf) {
    failed1=true;
  }
  assertTrue(failed1);
  assertTrue(Bytes.equals(valueCname,handler.get(tableAname,rowAname,columnBname).value));
  List<TCell> versions=handler.getVer(tableAname,rowAname,columnBname,MAXVERSIONS);
  assertTrue(Bytes.equals(valueCname,versions.get(0).value));
  assertTrue(Bytes.equals(valueBname,versions.get(1).value));
  TRowResult rowResult2=handler.getRow(tableAname,rowBname);
  assertTrue(Bytes.equals(rowBname,rowResult2.row));
  assertTrue(Bytes.equals(valueCname,rowResult2.columns.get(columnAname).value));
  assertTrue(Bytes.equals(valueDname,rowResult2.columns.get(columnBname).value));
  handler.deleteAll(tableAname,rowAname,columnBname);
  handler.deleteAllRow(tableAname,rowBname);
  boolean failed2=false;
  try {
    handler.get(tableAname,rowAname,columnBname);
  }
 catch (  NotFound nf) {
    failed2=true;
  }
  assertTrue(failed2);
  assertNull(handler.getRow(tableAname,rowBname));
  handler.disableTable(tableAname);
  handler.deleteTable(tableAname);
}
