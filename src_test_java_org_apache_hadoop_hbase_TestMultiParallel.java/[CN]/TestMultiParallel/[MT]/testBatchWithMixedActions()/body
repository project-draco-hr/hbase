{
  HTable table=new HTable(conf,TEST_TABLE);
  Result[] results=table.batch(constructPutRequests());
  validateSizeAndEmpty(results,keys.size());
  List<Row> actions=new ArrayList<Row>();
  byte[] qual2=Bytes.toBytes("qual2");
  byte[] val2=Bytes.toBytes("putvalue2");
  Get get=new Get(keys.get(10));
  get.addColumn(BYTES_FAMILY,QUALIFIER);
  actions.add(get);
  get=new Get(keys.get(11));
  get.addColumn(BYTES_FAMILY,QUALIFIER);
  actions.add(get);
  Put put=new Put(keys.get(10));
  put.add(BYTES_FAMILY,qual2,val2);
  actions.add(put);
  Delete delete=new Delete(keys.get(20));
  delete.deleteFamily(BYTES_FAMILY);
  actions.add(delete);
  get=new Get(keys.get(30));
  get.addColumn(BYTES_FAMILY,QUALIFIER);
  actions.add(get);
  get=new Get(keys.get(10));
  get.addFamily(BYTES_FAMILY);
  actions.add(get);
  get=new Get(keys.get(20));
  get.addColumn(BYTES_FAMILY,QUALIFIER);
  actions.add(get);
  put=new Put(keys.get(40));
  put.add(BYTES_FAMILY,qual2,val2);
  actions.add(put);
  results=table.batch(actions);
  validateResult(results[0]);
  validateResult(results[1]);
  validateEmpty(results[2]);
  validateEmpty(results[3]);
  validateResult(results[4]);
  validateResult(results[5]);
  validateResult(results[5],qual2,val2);
  validateEmpty(results[6]);
  validateEmpty(results[7]);
  get=new Get(keys.get(40));
  get.addColumn(BYTES_FAMILY,qual2);
  Result r=table.get(get);
  validateResult(r,qual2,val2);
}
