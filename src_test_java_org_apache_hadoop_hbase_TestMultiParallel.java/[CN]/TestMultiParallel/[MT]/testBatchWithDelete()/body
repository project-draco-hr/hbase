{
  HTable table=new HTable(conf,TEST_TABLE);
  List<Row> puts=constructPutRequests();
  Result[] results=table.batch(puts);
  validateSizeAndEmpty(results,keys.size());
  List<Row> deletes=new ArrayList<Row>();
  for (int i=0; i < keys.size(); i++) {
    Delete delete=new Delete(keys.get(i));
    delete.deleteFamily(BYTES_FAMILY);
    deletes.add(delete);
  }
  results=table.batch(deletes);
  validateSizeAndEmpty(results,keys.size());
  for (  byte[] k : keys) {
    Get get=new Get(k);
    get.addColumn(BYTES_FAMILY,QUALIFIER);
    assertFalse(table.exists(get));
  }
}
