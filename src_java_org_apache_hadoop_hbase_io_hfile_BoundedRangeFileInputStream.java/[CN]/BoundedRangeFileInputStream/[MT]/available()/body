{
  int avail=in.available();
  if (pos + avail > end) {
    avail=(int)(end - pos);
  }
  return avail;
}
