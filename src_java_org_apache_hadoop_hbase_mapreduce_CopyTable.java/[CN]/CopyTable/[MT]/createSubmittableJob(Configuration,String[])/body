{
  if (!doCommandLine(args)) {
    return null;
  }
  Cluster mrCluster=new Cluster(conf);
  Job job=Job.getInstance(mrCluster,conf);
  job.setJobName(NAME + "_" + tableName);
  job.setJarByClass(CopyTable.class);
  Scan scan=new Scan();
  if (startTime != 0) {
    scan.setTimeRange(startTime,endTime == 0 ? HConstants.LATEST_TIMESTAMP : endTime);
  }
  if (families != null) {
    String[] fams=families.split(",");
    for (    String fam : fams) {
      scan.addFamily(Bytes.toBytes(fam));
    }
  }
  TableMapReduceUtil.initTableMapperJob(tableName,scan,Import.Importer.class,null,null,job);
  TableMapReduceUtil.initTableReducerJob(newTableName == null ? tableName : newTableName,null,job,null,peerAddress,rsClass,rsImpl);
  job.setNumReduceTasks(0);
  return job;
}
