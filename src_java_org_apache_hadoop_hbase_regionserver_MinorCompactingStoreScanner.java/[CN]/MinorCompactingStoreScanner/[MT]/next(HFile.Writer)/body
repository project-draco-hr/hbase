{
  KeyValue row=heap.peek();
  if (row == null) {
    close();
    return false;
  }
  deleteTracker.reset();
  KeyValue kv;
  while ((kv=heap.peek()) != null) {
    if (comparator.compareRows(row,kv) != 0) {
      return true;
    }
    if (kv.getType() != KeyValue.Type.Put.getCode()) {
      deleteTracker.add(kv.getBuffer(),kv.getQualifierOffset(),kv.getQualifierLength(),kv.getTimestamp(),kv.getType());
      writer.append(heap.next());
      continue;
    }
    if (deleteTracker.isDeleted(kv.getBuffer(),kv.getQualifierOffset(),kv.getQualifierLength(),kv.getTimestamp())) {
      heap.next();
      continue;
    }
    writer.append(heap.next());
  }
  close();
  return false;
}
