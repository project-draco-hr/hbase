{
  KeyValue peeked=heap.peek();
  if (peeked == null) {
    close();
    return false;
  }
  matcher.setRow(peeked.getRow());
  KeyValue kv;
  while ((kv=heap.peek()) != null) {
    if (kv.getType() != KeyValue.Type.Put.getCode())     results.add(kv);
switch (matcher.match(kv)) {
case INCLUDE:
      results.add(heap.next());
    continue;
case DONE:
  if (results.isEmpty()) {
    matcher.setRow(heap.peek().getRow());
    continue;
  }
return true;
}
heap.next();
}
close();
return false;
}
