{
  if (request.hasScannerId()) {
    if (!slept && this.tableScannerId == request.getScannerId() && seqNoToSleepOn == request.getNextCallSeq()) {
      try {
        Thread.sleep(rpcTimeout + 500);
      }
 catch (      InterruptedException e) {
      }
      slept=true;
    }
    return super.scan(controller,request);
  }
 else {
    ScanResponse scanRes=super.scan(controller,request);
    String regionName=Bytes.toString(request.getRegion().getValue().toByteArray());
    if (!regionName.contains("-ROOT-") && !regionName.contains(".META.")) {
      tableScannerId=scanRes.getScannerId();
    }
    return scanRes;
  }
}
