{
  HTableDescriptor htd=hris.get(0).getTableDesc();
  if (!htd.hasFamily(familyName)) {
    throw new InvalidFamilyOperationException("Family '" + Bytes.toString(familyName) + "' does not exist so "+ "cannot be deleted");
  }
  for (  HRegionInfo hri : hris) {
    hri.getTableDesc().removeFamily(familyName);
    MetaEditor.updateRegionInfo(this.server.getCatalogTracker(),hri);
    MasterFileSystem mfs=this.masterServices.getMasterFileSystem();
    mfs.updateRegionInfo(hri);
    mfs.deleteFamily(hri,familyName);
    this.masterServices.getMasterFileSystem().updateRegionInfo(hri);
  }
}
