{
  this.userProvider=UserProvider.instantiate(conf);
  stoppable=new Stoppable(){
    private volatile boolean isStopped=false;
    @Override public void stop(    String why){
      isStopped=true;
    }
    @Override public boolean isStopped(){
      return isStopped;
    }
  }
;
  int cleanInterval=conf.getInt(CLEANUP_INTERVAL,10 * 1000);
  int maxIdleTime=conf.getInt(MAX_IDLETIME,10 * 60 * 1000);
  connectionCleaner=new ConnectionCleaner(cleanInterval,maxIdleTime);
  Threads.setDaemonThreadRunning(connectionCleaner.getThread());
  this.realUser=realUser;
  this.conf=conf;
}
