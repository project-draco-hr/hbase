{
  byte[] TEST_TABLE=Bytes.toBytes("observed_table");
  byte[] TEST_FAMILY=Bytes.toBytes("aaa");
  HTable table=TEST_UTIL.createTable(TEST_TABLE,TEST_FAMILY);
  TEST_UTIL.createMultiRegions(table,TEST_FAMILY);
  HRegionServer regionServer=TEST_UTIL.getRSForFirstRegionInTable(TEST_TABLE);
  try {
    final byte[] ROW=Bytes.toBytes("aaa");
    Put put=new Put(ROW);
    put.add(TEST_FAMILY,ROW,ROW);
    table.put(put);
  }
 catch (  IOException e) {
    fail("put() failed: " + e);
  }
  boolean regionServerAborted=false;
  for (int i=0; i < 30; i++) {
    if (regionServer.isAborted()) {
      regionServerAborted=true;
      break;
    }
    try {
      Thread.sleep(1000);
    }
 catch (    InterruptedException e) {
      fail("InterruptedException while waiting for regionserver " + "zk node to be deleted.");
    }
  }
  assertTrue("RegionServer aborted on coprocessor exception, as expected.",regionServerAborted);
}
