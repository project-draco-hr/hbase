{
  if (getState() != State.RUNNING || packet == null) {
    return -1L;
  }
  if (!(packet instanceof WritableWithSize)) {
    return -1L;
  }
  return ((WritableWithSize)packet).getWritableSize();
}
