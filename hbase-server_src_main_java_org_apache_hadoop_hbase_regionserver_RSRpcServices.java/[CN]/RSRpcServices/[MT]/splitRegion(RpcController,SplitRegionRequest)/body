{
  try {
    checkOpen();
    requestCount.increment();
    HRegion region=getRegion(request.getRegion());
    region.startRegionOperation(Operation.SPLIT_REGION);
    if (region.getRegionInfo().getReplicaId() != HRegionInfo.DEFAULT_REPLICA_ID) {
      throw new IOException("Can't split replicas directly. " + "Replicas are auto-split when their primary is split.");
    }
    LOG.info("Splitting " + region.getRegionNameAsString());
    long startTime=EnvironmentEdgeManager.currentTime();
    HRegion.FlushResult flushResult=region.flushcache();
    if (flushResult.isFlushSucceeded()) {
      long endTime=EnvironmentEdgeManager.currentTime();
      regionServer.metricsRegionServer.updateFlushTime(endTime - startTime);
    }
    byte[] splitPoint=null;
    if (request.hasSplitPoint()) {
      splitPoint=request.getSplitPoint().toByteArray();
    }
    region.forceSplit(splitPoint);
    regionServer.compactSplitThread.requestSplit(region,region.checkSplit());
    return SplitRegionResponse.newBuilder().build();
  }
 catch (  IOException ie) {
    throw new ServiceException(ie);
  }
}
