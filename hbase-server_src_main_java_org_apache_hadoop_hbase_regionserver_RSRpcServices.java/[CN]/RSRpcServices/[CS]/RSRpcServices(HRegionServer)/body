{
  RpcSchedulerFactory rpcSchedulerFactory;
  try {
    Class<?> rpcSchedulerFactoryClass=rs.conf.getClass(REGION_SERVER_RPC_SCHEDULER_FACTORY_CLASS,SimpleRpcSchedulerFactory.class);
    rpcSchedulerFactory=((RpcSchedulerFactory)rpcSchedulerFactoryClass.newInstance());
  }
 catch (  InstantiationException e) {
    throw new IllegalArgumentException(e);
  }
catch (  IllegalAccessException e) {
    throw new IllegalArgumentException(e);
  }
  String hostname=rs.conf.get("hbase.regionserver.ipc.address",Strings.domainNamePointerToHostName(DNS.getDefaultHost(rs.conf.get("hbase.regionserver.dns.interface","default"),rs.conf.get("hbase.regionserver.dns.nameserver","default"))));
  int port=rs.conf.getInt(HConstants.REGIONSERVER_PORT,HConstants.DEFAULT_REGIONSERVER_PORT);
  InetSocketAddress initialIsa=new InetSocketAddress(hostname,port);
  if (initialIsa.getAddress() == null) {
    throw new IllegalArgumentException("Failed resolve of " + initialIsa);
  }
  priority=new AnnotationReadingPriorityFunction(this);
  String name=rs.getProcessName() + "/" + initialIsa.toString();
  ConnectionUtils.setServerSideHConnectionRetriesConfig(rs.conf,name,LOG);
  rpcServer=new RpcServer(rs,name,getServices(),initialIsa,rs.conf,rpcSchedulerFactory.create(rs.conf,this));
  rpcServer.start();
  scannerLeaseTimeoutPeriod=rs.conf.getInt(HConstants.HBASE_CLIENT_SCANNER_TIMEOUT_PERIOD,HConstants.DEFAULT_HBASE_CLIENT_SCANNER_TIMEOUT_PERIOD);
  maxScannerResultSize=rs.conf.getLong(HConstants.HBASE_CLIENT_SCANNER_MAX_RESULT_SIZE_KEY,HConstants.DEFAULT_HBASE_CLIENT_SCANNER_MAX_RESULT_SIZE);
  isa=rpcServer.getListenerAddress();
  rpcServer.setErrorHandler(this);
  regionServer=rs;
  rs.setName(name);
}
