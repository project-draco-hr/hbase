{
  byte[] attribute=put.getAttribute("visibility");
  byte[] cf=null;
  List<Cell> updatedCells=new ArrayList<Cell>();
  if (attribute != null) {
    for (    List<? extends Cell> edits : put.getFamilyCellMap().values()) {
      for (      Cell cell : edits) {
        KeyValue kv=KeyValueUtil.ensureKeyValue(cell);
        if (cf == null) {
          cf=kv.getFamily();
        }
        Tag tag=new Tag(TAG_TYPE,attribute);
        List<Tag> tagList=new ArrayList<Tag>();
        tagList.add(tag);
        KeyValue newKV=new KeyValue(kv.getRow(),0,kv.getRowLength(),kv.getFamily(),0,kv.getFamilyLength(),kv.getQualifier(),0,kv.getQualifierLength(),kv.getTimestamp(),KeyValue.Type.codeToType(kv.getType()),kv.getValue(),0,kv.getValueLength(),tagList);
        ((List<Cell>)updatedCells).add(newKV);
      }
    }
    put.getFamilyCellMap().remove(cf);
    put.getFamilyCellMap().put(cf,updatedCells);
  }
}
