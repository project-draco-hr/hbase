{
  long start=System.currentTimeMillis();
  log("Running TestHLogBench with " + numThreads + " threads each doing "+ numIterationsPerThread+ " HLog appends "+ (appendNoSync ? "nosync" : "sync")+ " at rootDir "+ regionRootDir);
  byte[] tableName=Bytes.toBytes("table");
  byte[][] familyNames=new byte[][]{FAMILY};
  HTableDescriptor htd=new HTableDescriptor();
  htd.addFamily(new HColumnDescriptor(Bytes.toBytes("f1")));
  HRegion region=mockRegion(tableName,familyNames,regionRootDir);
  HLog hlog=region.getLog();
  LogWriter[] incrementors=new LogWriter[numThreads];
  for (int i=0; i < numThreads; i++) {
    incrementors[i]=new LogWriter(region,tableName,hlog,i,numIterationsPerThread,appendNoSync);
    incrementors[i].start();
  }
  for (int i=0; i < numThreads; i++) {
    incrementors[i].join();
  }
  long totalOps=numThreads * numIterationsPerThread;
  log("Operations per second " + ((totalOps * 1000L) / totalTime));
  log("Average latency in ms " + ((totalTime * 1000L) / totalOps));
}
