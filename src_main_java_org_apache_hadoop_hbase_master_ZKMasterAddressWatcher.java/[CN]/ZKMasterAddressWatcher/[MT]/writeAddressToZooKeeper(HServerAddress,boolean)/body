{
  do {
    waitForMasterAddressAvailability();
    if (this.requestShutdown.get()) {
      LOG.debug("Won't start Master because cluster is shuting down");
      return false;
    }
    if (this.zookeeper.writeMasterAddress(address)) {
      this.zookeeper.setClusterState(true);
      this.zookeeper.setClusterStateWatch();
      this.zookeeper.readMasterAddress(this);
      return true;
    }
  }
 while (retry);
  return false;
}
