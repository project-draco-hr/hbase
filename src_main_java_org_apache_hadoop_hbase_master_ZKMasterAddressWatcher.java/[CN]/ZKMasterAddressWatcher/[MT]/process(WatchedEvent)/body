{
  EventType type=event.getType();
  LOG.debug(("Got event " + type + " with path "+ event.getPath()));
  if (type.equals(EventType.NodeDeleted)) {
    if (event.getPath().equals(this.zookeeper.clusterStateZNode)) {
      LOG.info("Cluster shutdown while waiting, shutting down" + " this master.");
      this.requestShutdown.set(true);
    }
 else {
      LOG.debug("Master address ZNode deleted, notifying waiting masters");
      notifyAll();
    }
  }
 else   if (type.equals(EventType.NodeCreated) && event.getPath().equals(this.zookeeper.clusterStateZNode)) {
    LOG.debug("Resetting watch on cluster state node.");
    this.zookeeper.setClusterStateWatch();
  }
}
