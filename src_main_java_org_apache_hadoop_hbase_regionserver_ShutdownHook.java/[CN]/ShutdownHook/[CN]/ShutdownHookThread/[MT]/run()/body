{
  boolean b=this.conf.getBoolean(RUN_SHUTDOWN_HOOK,true);
  LOG.info("Shutdown hook starting; " + RUN_SHUTDOWN_HOOK + "="+ b+ "; fsShutdownHook="+ this.fsShutdownHook);
  if (b) {
    this.stop.stop("Shutdown hook");
    Threads.shutdown(this.threadToJoin);
    if (this.fsShutdownHook != null) {
      LOG.info("Starting fs shutdown hook thread.");
      this.fsShutdownHook.start();
      Threads.shutdown(this.fsShutdownHook,this.conf.getLong(FS_SHUTDOWN_HOOK_WAIT,30000));
    }
  }
  LOG.info("Shutdown hook finished.");
}
