{
  store.forceMajor=forcemajor;
  CompactSelection result=store.compactionPolicy.selectCompaction(candidates,false,isOffPeak,forcemajor);
  List<StoreFile> actual=result.getFilesToCompact();
  if (isOffPeak && !forcemajor) {
    assertTrue(result.isOffPeakCompaction());
  }
  assertEquals(Arrays.toString(expected),Arrays.toString(getSizes(actual)));
  store.forceMajor=false;
}
