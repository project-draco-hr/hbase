{
  final TableName name=TableName.valueOf("testDisabled");
  Abortable abortable=new Abortable(){
    @Override public void abort(    String why,    Throwable e){
      LOG.info(why,e);
    }
    @Override public boolean isAborted(){
      return false;
    }
  }
;
  ZooKeeperWatcher zkw=new ZooKeeperWatcher(TEST_UTIL.getConfiguration(),name.getNameAsString(),abortable,true);
  TableStateManager zkt=new ZKTableStateManager(zkw);
  assertFalse(zkt.isTableState(name,Table.State.ENABLED));
  assertFalse(zkt.isTableState(name,Table.State.DISABLING));
  assertFalse(zkt.isTableState(name,Table.State.DISABLED));
  assertFalse(zkt.isTableState(name,Table.State.ENABLING));
  assertFalse(zkt.isTableState(name,Table.State.DISABLED,Table.State.DISABLING));
  assertFalse(zkt.isTableState(name,Table.State.DISABLED,Table.State.ENABLING));
  assertFalse(zkt.isTablePresent(name));
  zkt.setTableState(name,Table.State.DISABLING);
  assertTrue(zkt.isTableState(name,Table.State.DISABLING));
  assertTrue(zkt.isTableState(name,Table.State.DISABLED,Table.State.DISABLING));
  assertFalse(zkt.getTablesInStates(Table.State.DISABLED).contains(name));
  assertTrue(zkt.isTablePresent(name));
  zkt.setTableState(name,Table.State.DISABLED);
  assertTrue(zkt.isTableState(name,Table.State.DISABLED));
  assertTrue(zkt.isTableState(name,Table.State.DISABLED,Table.State.DISABLING));
  assertFalse(zkt.isTableState(name,Table.State.DISABLING));
  assertTrue(zkt.getTablesInStates(Table.State.DISABLED).contains(name));
  assertTrue(zkt.isTablePresent(name));
  zkt.setTableState(name,Table.State.ENABLING);
  assertTrue(zkt.isTableState(name,Table.State.ENABLING));
  assertTrue(zkt.isTableState(name,Table.State.DISABLED,Table.State.ENABLING));
  assertFalse(zkt.isTableState(name,Table.State.DISABLED));
  assertFalse(zkt.getTablesInStates(Table.State.DISABLED).contains(name));
  assertTrue(zkt.isTablePresent(name));
  zkt.setTableState(name,Table.State.ENABLED);
  assertTrue(zkt.isTableState(name,Table.State.ENABLED));
  assertFalse(zkt.isTableState(name,Table.State.ENABLING));
  assertTrue(zkt.isTablePresent(name));
  zkt.setDeletedTable(name);
  assertFalse(zkt.isTableState(name,Table.State.ENABLED));
  assertFalse(zkt.isTableState(name,Table.State.DISABLING));
  assertFalse(zkt.isTableState(name,Table.State.DISABLED));
  assertFalse(zkt.isTableState(name,Table.State.ENABLING));
  assertFalse(zkt.isTableState(name,Table.State.DISABLED,Table.State.DISABLING));
  assertFalse(zkt.isTableState(name,Table.State.DISABLED,Table.State.ENABLING));
  assertFalse(zkt.isTablePresent(name));
}
