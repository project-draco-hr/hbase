{
  LOG.info("testSmallBatch");
  Put put;
  htable1.setAutoFlushTo(false);
  for (int i=0; i < NB_ROWS_IN_BATCH; i++) {
    put=new Put(Bytes.toBytes(i));
    put.add(famName,row,row);
    htable1.put(put);
  }
  htable1.flushCommits();
  Scan scan=new Scan();
  ResultScanner scanner1=htable1.getScanner(scan);
  Result[] res1=scanner1.next(NB_ROWS_IN_BATCH);
  scanner1.close();
  assertEquals(NB_ROWS_IN_BATCH,res1.length);
  for (int i=0; i < NB_RETRIES; i++) {
    scan=new Scan();
    if (i == NB_RETRIES - 1) {
      fail("Waited too much time for normal batch replication");
    }
    ResultScanner scanner=htable2.getScanner(scan);
    Result[] res=scanner.next(NB_ROWS_IN_BATCH);
    scanner.close();
    if (res.length != NB_ROWS_IN_BATCH) {
      LOG.info("Only got " + res.length + " rows");
      Thread.sleep(SLEEP_TIME);
    }
 else {
      break;
    }
  }
}
