{
  if (printThreadInfoMethod == null) {
    try {
      printThreadInfoMethod=ReflectionUtils.class.getMethod("printThreadInfo",PrintStream.class,String.class);
    }
 catch (    NoSuchMethodException e) {
      printThreadInfoMethodWithPrintStream=false;
      try {
        printThreadInfoMethod=ReflectionUtils.class.getMethod("printThreadInfo",PrintWriter.class,String.class);
      }
 catch (      NoSuchMethodException e1) {
        throw new RuntimeException("Cannot find method. Check hadoop jars linked",e1);
      }
    }
    printThreadInfoMethod.setAccessible(true);
  }
  try {
    if (printThreadInfoMethodWithPrintStream) {
      printThreadInfoMethod.invoke(null,stream,title);
    }
 else {
      printThreadInfoMethod.invoke(null,new PrintWriter(stream),title);
    }
  }
 catch (  IllegalAccessException|IllegalArgumentException|InvocationTargetException e) {
    throw new RuntimeException(e.getCause());
  }
}
