{
  long ret=comConf.getMajorCompactionPeriod();
  String strCompactionTime=store.getFamily().getValue(HConstants.MAJOR_COMPACTION_PERIOD);
  if (strCompactionTime != null) {
    ret=(new Long(strCompactionTime)).longValue();
  }
  if (ret > 0) {
    double jitterPct=comConf.getMajorCompactionJitter();
    if (jitterPct > 0) {
      long jitter=Math.round(ret * jitterPct);
      Integer seed=store.getDeterministicRandomSeed();
      if (seed != null) {
        double rnd=(new Random(seed)).nextDouble();
        ret+=jitter - Math.round(2L * jitter * rnd);
      }
 else {
        ret=0;
      }
    }
  }
  return ret;
}
