{
  super.setConf(conf);
  maxSteps=conf.getInt(MAX_STEPS_KEY,maxSteps);
  stepsPerRegion=conf.getInt(STEPS_PER_REGION_KEY,stepsPerRegion);
  maxRunningTime=conf.getLong(MAX_RUNNING_TIME_KEY,maxRunningTime);
  numRegionLoadsToRemember=conf.getInt(KEEP_REGION_LOADS,numRegionLoadsToRemember);
  localityCandidateGenerator=new LocalityBasedCandidateGenerator(services);
  localityCost=new LocalityCostFunction(conf,services);
  candidateGenerators=new CandidateGenerator[]{new RandomCandidateGenerator(),new LoadCandidateGenerator(),localityCandidateGenerator,new RegionReplicaCandidateGenerator()};
  regionLoadFunctions=new CostFromRegionLoadFunction[]{new ReadRequestCostFunction(conf),new WriteRequestCostFunction(conf),new MemstoreSizeCostFunction(conf),new StoreFileCostFunction(conf)};
  costFunctions=new CostFunction[]{new RegionCountSkewCostFunction(conf,activeMasterWeight,backupMasterWeight),new MoveCostFunction(conf),localityCost,new TableSkewCostFunction(conf),new RegionReplicaHostCostFunction(conf),new RegionReplicaRackCostFunction(conf),regionLoadFunctions[0],regionLoadFunctions[1],regionLoadFunctions[2],regionLoadFunctions[3]};
}
