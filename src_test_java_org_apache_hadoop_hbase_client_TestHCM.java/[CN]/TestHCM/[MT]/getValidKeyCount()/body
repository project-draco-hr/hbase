{
  Field cacheField=HConnectionManager.class.getDeclaredField("HBASE_INSTANCES");
  cacheField.setAccessible(true);
  Map<?,?> cache=(Map<?,?>)cacheField.get(null);
  List<Object> keys=new ArrayList<Object>(cache.keySet());
  Set<Object> values=new HashSet<Object>();
  for (  Object key : keys) {
    values.add(cache.get(key));
  }
  return values.size();
}
