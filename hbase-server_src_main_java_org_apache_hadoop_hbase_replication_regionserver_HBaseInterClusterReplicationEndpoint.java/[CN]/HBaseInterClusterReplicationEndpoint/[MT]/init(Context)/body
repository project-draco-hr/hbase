{
  super.init(context);
  this.conf=HBaseConfiguration.create(ctx.getConfiguration());
  decorateConf();
  this.maxRetriesMultiplier=this.conf.getInt("replication.source.maxretriesmultiplier",300);
  this.socketTimeoutMultiplier=this.conf.getInt("replication.source.socketTimeoutMultiplier",maxRetriesMultiplier);
  this.conn=(HConnection)ConnectionFactory.createConnection(this.conf);
  this.sleepForRetries=this.conf.getLong("replication.source.sleepforretries",1000);
  this.metrics=context.getMetrics();
  this.replicationSinkMgr=new ReplicationSinkManager(conn,ctx.getPeerId(),this,this.conf);
  this.maxThreads=this.conf.getInt(HConstants.REPLICATION_SOURCE_MAXTHREADS_KEY,HConstants.REPLICATION_SOURCE_MAXTHREADS_DEFAULT);
  this.exec=new ThreadPoolExecutor(1,maxThreads,60,TimeUnit.SECONDS,new SynchronousQueue<Runnable>());
}
