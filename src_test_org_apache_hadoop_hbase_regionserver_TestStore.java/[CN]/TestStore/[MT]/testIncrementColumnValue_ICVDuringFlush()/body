{
  init(this.getName());
  long value=1L;
  long amount=3L;
  this.store.add(new KeyValue(row,family,qf1,System.currentTimeMillis(),Bytes.toBytes(value)));
  this.store.snapshot();
  Store.ICVResult vas=this.store.incrementColumnValue(row,family,qf1,amount);
  this.store.flushCache(id++);
  assertEquals(1,this.store.getStorefiles().size());
  assertEquals(0,this.store.memstore.kvset.size());
  Get get=new Get(row);
  get.addColumn(family,qf1);
  get.setMaxVersions();
  List<KeyValue> results=new ArrayList<KeyValue>();
  NavigableSet<byte[]> cols=new TreeSet<byte[]>();
  cols.add(qf1);
  this.store.get(get,cols,results);
  assertEquals(1,results.size());
  long icvTs=vas.kv.getTimestamp();
  long storeTs=results.get(0).getTimestamp();
  assertTrue(icvTs != storeTs);
}
