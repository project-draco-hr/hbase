{
  int pos=0;
  while (pos < candidates.getFilesToCompact().size() && candidates.getFilesToCompact().get(pos).getReader().length() > comConf.getMaxCompactSize() && !candidates.getFilesToCompact().get(pos).isReference()) {
    ++pos;
  }
  if (pos > 0) {
    LOG.debug("Some files are too large. Excluding " + pos + " files from compaction candidates");
    candidates.clearSubList(0,pos);
  }
  return candidates;
}
