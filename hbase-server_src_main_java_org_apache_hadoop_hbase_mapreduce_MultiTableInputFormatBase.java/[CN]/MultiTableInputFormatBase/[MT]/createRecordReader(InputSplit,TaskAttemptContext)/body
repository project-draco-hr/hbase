{
  TableSplit tSplit=(TableSplit)split;
  LOG.info(MessageFormat.format("Input split length: {0} bytes.",tSplit.getLength()));
  if (tSplit.getTable() == null) {
    throw new IOException("Cannot create a record reader because of a" + " previous error. Please look at the previous logs lines from" + " the task's full log for more details.");
  }
  Connection connection=ConnectionFactory.createConnection(context.getConfiguration());
  Table table=connection.getTable(tSplit.getTable());
  TableRecordReader trr=this.tableRecordReader;
  try {
    if (trr == null) {
      trr=new TableRecordReader();
    }
    Scan sc=tSplit.getScan();
    sc.setStartRow(tSplit.getStartRow());
    sc.setStopRow(tSplit.getEndRow());
    trr.setScan(sc);
    trr.setTable(table);
  }
 catch (  IOException ioe) {
    connection.close();
    table.close();
    trr.close();
    throw ioe;
  }
  return trr;
}
