{
  Scan scan=new Scan(startRow);
  scan.setCaching(caching);
  scan.setReversed(reversed);
  scan.setSmall(small);
  scan.setConsistency(consistency);
  ResultScanner scanner=table.getScanner(scan);
  Iterator<Result> iter=scanner.iterator();
  HashMap<String,Boolean> map=new HashMap<String,Boolean>();
  int count=0;
  int countOfStale=0;
  while (iter.hasNext()) {
    count++;
    Result r=iter.next();
    if (map.containsKey(new String(r.getRow()))) {
      throw new Exception("Unexpected scan result. Repeated row " + Bytes.toString(r.getRow()));
    }
    map.put(new String(r.getRow()),true);
    if (!slowNext)     Assert.assertTrue(r.isStale() == staleExpected);
    if (r.isStale())     countOfStale++;
  }
  LOG.debug("Count of rows " + count + " num rows expected "+ numRows);
  Assert.assertTrue(count == numRows);
  if (slowNext) {
    LOG.debug("Count of Stale " + countOfStale);
    Assert.assertTrue(countOfStale > 1 && countOfStale < numRows);
  }
}
