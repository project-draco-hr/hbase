{
  Scan scan=null;
  if ((endRow != null) && (endRow.length > 0)) {
    if (trrRowFilter != null) {
      final Set<RowFilterInterface> rowFiltersSet=new HashSet<RowFilterInterface>();
      rowFiltersSet.add(new WhileMatchRowFilter(new StopRowFilter(endRow)));
      rowFiltersSet.add(trrRowFilter);
      scan=new Scan(startRow);
      this.scanner=this.htable.getScanner(scan);
    }
 else {
      scan=new Scan(firstRow,endRow);
    }
  }
 else {
    scan=new Scan(firstRow);
  }
  scan.addColumns(trrInputColumns);
  if (minStamp != 0 && maxStamp != 0) {
    scan.setTimeRange(minStamp,maxStamp);
    scan.setMaxVersions();
  }
  this.scanner=this.htable.getScanner(scan);
}
