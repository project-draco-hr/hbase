{
  HConnectionManager.HConnectionImplementation mockConnection=Mockito.mock(HConnectionManager.HConnectionImplementation.class);
  Configuration conf=HBaseConfiguration.create();
  Mockito.when(mockConnection.getConfiguration()).thenReturn(conf);
  HBaseAdmin admin=new HBaseAdmin(mockConnection);
  SnapshotDescription.Builder builder=SnapshotDescription.newBuilder();
  failSnapshotStart(admin,builder.setName(".snapshot").build());
  failSnapshotStart(admin,builder.setName("-snapshot").build());
  failSnapshotStart(admin,builder.setName("snapshot fails").build());
  failSnapshotStart(admin,builder.setName("snap$hot").build());
  failSnapshotStart(admin,builder.setName("snapshot").setTable(".table").build());
  failSnapshotStart(admin,builder.setName("snapshot").setTable("-table").build());
  failSnapshotStart(admin,builder.setName("snapshot").setTable("table fails").build());
  failSnapshotStart(admin,builder.setName("snapshot").setTable("tab%le").build());
}
