{
  if ((codec instanceof GzipCodec) && !NativeCodeLoader.isNativeCodeLoaded() && !ZlibFactory.isNativeZlibLoaded(conf)) {
    throw new IllegalArgumentException("SequenceFile doesn't work with " + "GzipCodec without native-hadoop code!");
  }
  Writer writer=null;
  if (compressionType == CompressionType.NONE) {
    writer=new Writer(fs,conf,name,keyClass,valClass,bufferSize,replication,blockSize,progress,metadata);
  }
 else   if (compressionType == CompressionType.RECORD) {
    writer=new RecordCompressWriter(fs,conf,name,keyClass,valClass,bufferSize,replication,blockSize,codec,progress,metadata);
  }
 else   if (compressionType == CompressionType.BLOCK) {
    writer=new BlockCompressWriter(fs,conf,name,keyClass,valClass,bufferSize,replication,blockSize,codec,progress,metadata);
  }
  return writer;
}
