{
  if ((codec instanceof GzipCodec) && !NativeCodeLoader.isNativeCodeLoaded() && !ZlibFactory.isNativeZlibLoaded(conf)) {
    throw new IllegalArgumentException("SequenceFile doesn't work with " + "GzipCodec without native-hadoop code!");
  }
  Writer writer=null;
  if (compressionType == CompressionType.NONE) {
    writer=new Writer(conf,out,keyClass,valClass,metadata);
  }
 else   if (compressionType == CompressionType.RECORD) {
    writer=new RecordCompressWriter(conf,out,keyClass,valClass,codec,metadata);
  }
 else   if (compressionType == CompressionType.BLOCK) {
    writer=new BlockCompressWriter(conf,out,keyClass,valClass,codec,metadata);
  }
  return writer;
}
