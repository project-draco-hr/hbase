{
  if (key.getClass() != getKeyClass())   throw new IOException("wrong key class: " + key.getClass().getName() + " is not "+ keyClass);
  if (!blockCompressed) {
    outBuf.reset();
    keyLength=next(outBuf);
    if (keyLength < 0)     return false;
    valBuffer.reset(outBuf.getData(),outBuf.getLength());
    key.readFields(valBuffer);
    valBuffer.mark(0);
    if (valBuffer.getPosition() != keyLength)     throw new IOException(key + " read " + valBuffer.getPosition()+ " bytes, should read "+ keyLength);
  }
 else {
    syncSeen=false;
    if (noBufferedKeys == 0) {
      try {
        readBlock();
      }
 catch (      EOFException eof) {
        return false;
      }
    }
    int keyLength=WritableUtils.readVInt(keyLenIn);
    if (keyLength < 0) {
      return false;
    }
    key.readFields(keyIn);
    --noBufferedKeys;
  }
  return true;
}
