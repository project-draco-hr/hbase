{
  if (passNo > 1 || numSegments <= factor || factor == 1)   return factor;
  int mod=(numSegments - 1) % (factor - 1);
  if (mod == 0)   return factor;
  return mod + 1;
}
