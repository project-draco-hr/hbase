{
  if (in == null) {
    int bufferSize=conf.getInt("io.file.buffer.size",4096);
    if (fs.getUri().getScheme().startsWith("ramfs")) {
      bufferSize=conf.getInt("io.bytes.per.checksum",512);
    }
    Reader reader=new Reader(fs,segmentPathName,bufferSize,segmentOffset,segmentLength,conf,false);
    if (ignoreSync)     reader.sync=null;
    if (reader.getKeyClass() != keyClass)     throw new IOException("wrong key class: " + reader.getKeyClass() + " is not "+ keyClass);
    if (reader.getValueClass() != valClass)     throw new IOException("wrong value class: " + reader.getValueClass() + " is not "+ valClass);
    this.in=reader;
    rawKey=new DataOutputBuffer();
  }
  rawKey.reset();
  int keyLength=in.nextRawKey(rawKey);
  return (keyLength >= 0);
}
