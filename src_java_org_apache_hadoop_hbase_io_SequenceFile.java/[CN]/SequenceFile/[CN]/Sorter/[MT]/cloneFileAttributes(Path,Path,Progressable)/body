{
  FileSystem srcFileSys=inputFile.getFileSystem(conf);
  Reader reader=new Reader(srcFileSys,inputFile,4096,conf,true);
  boolean compress=reader.isCompressed();
  boolean blockCompress=reader.isBlockCompressed();
  CompressionCodec codec=reader.getCompressionCodec();
  reader.close();
  Writer writer=createWriter(outputFile.getFileSystem(conf),conf,outputFile,keyClass,valClass,compress,blockCompress,codec,prog,new Metadata());
  return writer;
}
