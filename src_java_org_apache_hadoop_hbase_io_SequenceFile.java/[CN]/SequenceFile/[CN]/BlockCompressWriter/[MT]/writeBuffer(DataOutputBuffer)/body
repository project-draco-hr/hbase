{
  deflateFilter.resetState();
  buffer.reset();
  deflateOut.write(uncompressedDataBuffer.getData(),0,uncompressedDataBuffer.getLength());
  deflateOut.flush();
  deflateFilter.finish();
  WritableUtils.writeVInt(out,buffer.getLength());
  out.write(buffer.getData(),0,buffer.getLength());
}
