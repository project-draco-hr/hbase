{
  try {
    SplitLogTask slt=new SplitLogTask.Owned(this.serverName);
    Stat stat=this.watcher.getRecoverableZooKeeper().setData(currentTask,slt.toByteArray(),currentVersion);
    if (stat == null) {
      LOG.warn("zk.setData() returned null for path " + currentTask);
      SplitLogCounters.tot_wkr_task_heartbeat_failed.incrementAndGet();
      return (false);
    }
    currentVersion=stat.getVersion();
    SplitLogCounters.tot_wkr_task_heartbeat.incrementAndGet();
    return (true);
  }
 catch (  KeeperException e) {
    if (!isFirstTime) {
      if (e.code().equals(KeeperException.Code.NONODE)) {
        LOG.warn("NONODE failed to assert ownership for " + currentTask,e);
      }
 else       if (e.code().equals(KeeperException.Code.BADVERSION)) {
        LOG.warn("BADVERSION failed to assert ownership for " + currentTask,e);
      }
 else {
        LOG.warn("failed to assert ownership for " + currentTask,e);
      }
    }
  }
catch (  InterruptedException e1) {
    LOG.warn("Interrupted while trying to assert ownership of " + currentTask + " "+ StringUtils.stringifyException(e1));
    Thread.currentThread().interrupt();
  }
  SplitLogCounters.tot_wkr_task_heartbeat_failed.incrementAndGet();
  return (false);
}
