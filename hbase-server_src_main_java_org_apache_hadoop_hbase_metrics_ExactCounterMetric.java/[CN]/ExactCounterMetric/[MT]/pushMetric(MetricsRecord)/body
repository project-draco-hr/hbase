{
  final List<Pair<String,Long>> topKeys=getTop(Integer.MAX_VALUE);
  int sum=0;
  int counter=0;
  for (  Pair<String,Long> keyCount : topKeys) {
    counter++;
    if (counter <= this.topN) {
      mr.setMetric(getName() + "_" + keyCount.getFirst(),keyCount.getSecond());
    }
    sum+=keyCount.getSecond();
  }
  mr.setMetric(getName() + "_map_size",this.counts.size());
  mr.setMetric(getName() + "_total_count",sum);
}
