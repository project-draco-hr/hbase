{
  MemStoreLAB tmpAllocator=null;
  if (this.snapshot != ss) {
    throw new UnexpectedException("Current snapshot is " + this.snapshot + ", was passed "+ ss);
  }
  if (!ss.isEmpty()) {
    this.snapshot=new KeyValueSkipListSet(this.comparator);
    this.snapshotTimeRangeTracker=new TimeRangeTracker();
  }
  this.snapshotSize=0;
  if (this.snapshotAllocator != null) {
    tmpAllocator=this.snapshotAllocator;
    this.snapshotAllocator=null;
  }
  if (tmpAllocator != null) {
    tmpAllocator.close();
  }
}
