{
  this.lock.readLock().lock();
  try {
    KeyValue found=this.snapshot.get(kv);
    if (found != null && found.getMemstoreTS() == kv.getMemstoreTS()) {
      this.snapshot.remove(kv);
    }
    found=this.kvset.get(kv);
    if (found != null && found.getMemstoreTS() == kv.getMemstoreTS()) {
      removeFromKVSet(kv);
      long s=heapSizeChange(kv,true);
      this.size.addAndGet(-s);
    }
  }
  finally {
    this.lock.readLock().unlock();
  }
}
