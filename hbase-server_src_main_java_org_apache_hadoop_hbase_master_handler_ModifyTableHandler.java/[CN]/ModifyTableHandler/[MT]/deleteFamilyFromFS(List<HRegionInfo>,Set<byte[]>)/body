{
  try {
    Set<byte[]> newFamilies=this.htd.getFamiliesKeys();
    MasterFileSystem mfs=this.masterServices.getMasterFileSystem();
    for (    byte[] familyName : oldFamilies) {
      if (!newFamilies.contains(familyName)) {
        LOG.debug("Removing family=" + Bytes.toString(familyName) + " from table="+ Bytes.toString(this.tableName));
        for (        HRegionInfo hri : hris) {
          mfs.deleteFamilyFromFS(hri,familyName);
        }
      }
    }
  }
 catch (  IOException e) {
    LOG.warn("Unable to remove on-disk directories for the removed families",e);
  }
}
