{
  MasterCoprocessorHost cpHost=((HMaster)this.server).getMasterCoprocessorHost();
  if (cpHost != null) {
    cpHost.preModifyTableHandler(this.tableName,this.htd);
  }
  HTableDescriptor oldDescriptor=this.masterServices.getTableDescriptors().get(this.tableName);
  this.masterServices.getTableDescriptors().add(htd);
  deleteFamilyFromFS(hris,oldDescriptor.getFamiliesKeys());
  removeReplicaColumnsIfNeeded(this.htd.getRegionReplication(),oldDescriptor.getRegionReplication(),this.htd.getTableName());
  if (htd.getRegionReplication() > 1 && oldDescriptor.getRegionReplication() <= 1) {
    ServerRegionReplicaUtil.setupRegionReplicaReplication(server.getConfiguration());
  }
  if (cpHost != null) {
    cpHost.postModifyTableHandler(this.tableName,this.htd);
  }
}
