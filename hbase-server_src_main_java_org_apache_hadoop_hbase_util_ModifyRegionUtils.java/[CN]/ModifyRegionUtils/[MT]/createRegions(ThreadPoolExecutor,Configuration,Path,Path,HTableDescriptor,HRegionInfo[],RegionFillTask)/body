{
  if (newRegions == null)   return null;
  int regionNumber=newRegions.length;
  CompletionService<HRegionInfo> completionService=new ExecutorCompletionService<HRegionInfo>(exec);
  List<HRegionInfo> regionInfos=new ArrayList<HRegionInfo>();
  int defaultReplicas=0;
  for (  final HRegionInfo newRegion : newRegions) {
    regionInfos.add(newRegion);
    if (!RegionReplicaUtil.isDefaultReplica(newRegion)) {
      continue;
    }
    defaultReplicas++;
    completionService.submit(new Callable<HRegionInfo>(){
      @Override public HRegionInfo call() throws IOException {
        return createRegion(conf,rootDir,tableDir,hTableDescriptor,newRegion,task);
      }
    }
);
  }
  try {
    for (int i=0; i < defaultReplicas; i++) {
      completionService.take().get();
    }
  }
 catch (  InterruptedException e) {
    LOG.error("Caught " + e + " during region creation");
    throw new InterruptedIOException(e.getMessage());
  }
catch (  ExecutionException e) {
    throw new IOException(e);
  }
  return regionInfos;
}
