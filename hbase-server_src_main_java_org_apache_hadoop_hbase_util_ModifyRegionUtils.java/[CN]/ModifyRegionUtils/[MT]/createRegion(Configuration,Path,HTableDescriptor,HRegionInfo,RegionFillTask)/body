{
  Configuration confForWAL=new Configuration(conf);
  confForWAL.set(HConstants.HBASE_DIR,rootDir.toString());
  WAL wal=(new WALFactory(confForWAL,Collections.<WALActionsListener>singletonList(new MetricsWAL()),"hregion-" + RandomStringUtils.randomNumeric(8))).getWAL(newRegion.getEncodedNameAsBytes());
  HRegion region=HRegion.createHRegion(newRegion,rootDir,conf,hTableDescriptor,wal,false);
  try {
    if (task != null) {
      task.fillRegion(region);
    }
  }
  finally {
    region.close();
    wal.close();
  }
  return region.getRegionInfo();
}
