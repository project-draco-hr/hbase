{
  HRegion region=null;
  try {
    HTableDescriptor htd=createTableDescriptor(getName());
    region=createNewHRegion(htd,null,null);
    byte[] column=COLUMNS[0];
    for (int i=0; i < 100; i++) {
      addToRow(region,T00,column,i,T00.getBytes());
    }
    checkVersions(region,T00,column);
    region.flushcache();
    checkVersions(region,T00,column);
    region.deleteAll(Bytes.toBytes(T00),System.currentTimeMillis(),null);
    Cell[] cells=Cell.createSingleCellArray(region.get(Bytes.toBytes(T00),column,-1,HColumnDescriptor.DEFAULT_VERSIONS));
    assertTrue(cells == null);
    region.flushcache();
    cells=Cell.createSingleCellArray(region.get(Bytes.toBytes(T00),column,-1,HColumnDescriptor.DEFAULT_VERSIONS));
    assertTrue(cells == null);
    for (int i=0; i < 100; i++) {
      addToRow(region,T00,column,i,T00.getBytes());
    }
    checkVersions(region,T00,column);
    region.flushcache();
    checkVersions(region,T00,column);
  }
  finally {
    if (region != null) {
      try {
        region.close();
      }
 catch (      Exception e) {
        e.printStackTrace();
      }
      region.getLog().closeAndDelete();
    }
  }
}
