{
  HRegion region=null;
  HScannerInterface scanner=null;
  try {
    HTableDescriptor htd=createTableDescriptor(getName());
    region=createNewHRegion(htd,null,null);
    for (int i=0; i < COLUMNS.length; i++) {
      addContent(region,COLUMNS[i].toString());
    }
    final Text arbitraryStartRow=new Text("b");
    Text actualStartRow=null;
    final Text arbitraryStopRow=new Text("c");
    Text actualStopRow=null;
    Text[] columns=new Text[]{new Text(COLFAMILY_NAME1)};
    scanner=region.getScanner(columns,arbitraryStartRow,HConstants.LATEST_TIMESTAMP,new WhileMatchRowFilter(new StopRowFilter(arbitraryStopRow)));
    HStoreKey key=new HStoreKey();
    TreeMap<Text,byte[]> value=new TreeMap<Text,byte[]>();
    while (scanner.next(key,value)) {
      if (actualStartRow == null) {
        actualStartRow=new Text(key.getRow());
      }
 else {
        actualStopRow=key.getRow();
      }
    }
    assertColumnsPresent(region,actualStartRow);
    assertColumnsPresent(region,actualStopRow);
    region.flushcache();
    assertColumnsPresent(region,actualStartRow);
    assertColumnsPresent(region,actualStopRow);
  }
  finally {
    if (scanner != null) {
      scanner.close();
    }
    if (region != null) {
      try {
        region.close();
      }
 catch (      Exception e) {
        e.printStackTrace();
      }
      region.getLog().closeAndDelete();
    }
  }
}
