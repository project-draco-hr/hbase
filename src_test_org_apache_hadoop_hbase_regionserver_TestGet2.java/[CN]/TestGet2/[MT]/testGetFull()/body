{
  HRegion region=null;
  InternalScanner scanner=null;
  try {
    HTableDescriptor htd=createTableDescriptor(getName());
    region=createNewHRegion(htd,null,null);
    for (int i=0; i < COLUMNS.length; i++) {
      addContent(region,COLUMNS[i]);
    }
    final byte[] arbitraryStartRow=Bytes.toBytes("b");
    byte[] actualStartRow=null;
    final byte[] arbitraryStopRow=Bytes.toBytes("c");
    byte[] actualStopRow=null;
    byte[][] columns={COLFAMILY_NAME1};
    scanner=region.getScanner(columns,arbitraryStartRow,HConstants.LATEST_TIMESTAMP,new WhileMatchRowFilter(new StopRowFilter(arbitraryStopRow)));
    HStoreKey key=new HStoreKey();
    TreeMap<byte[],Cell> value=new TreeMap<byte[],Cell>(Bytes.BYTES_COMPARATOR);
    while (scanner.next(key,value)) {
      if (actualStartRow == null) {
        actualStartRow=key.getRow();
      }
 else {
        actualStopRow=key.getRow();
      }
    }
    assertColumnsPresent(region,actualStartRow);
    assertColumnsPresent(region,actualStopRow);
    region.flushcache();
    assertColumnsPresent(region,actualStartRow);
    assertColumnsPresent(region,actualStopRow);
  }
  finally {
    if (scanner != null) {
      scanner.close();
    }
    if (region != null) {
      try {
        region.close();
      }
 catch (      Exception e) {
        e.printStackTrace();
      }
      region.getLog().closeAndDelete();
    }
  }
}
