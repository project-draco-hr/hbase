{
  SortedMap<Long,HRegion> sortedRegions=new TreeMap<Long,HRegion>(new Comparator<Long>(){
    public int compare(    Long a,    Long b){
      return -1 * a.compareTo(b);
    }
  }
);
  for (  HRegion region : server.onlineRegions.values()) {
    sortedRegions.put(region.memcacheSize.get(),region);
  }
  while (server.getGlobalMemcacheSize() >= globalMemcacheLimitLowMark) {
    HRegion biggestMemcacheRegion=sortedRegions.remove(sortedRegions.firstKey());
    if (!flushRegion(biggestMemcacheRegion,true)) {
      break;
    }
  }
}
