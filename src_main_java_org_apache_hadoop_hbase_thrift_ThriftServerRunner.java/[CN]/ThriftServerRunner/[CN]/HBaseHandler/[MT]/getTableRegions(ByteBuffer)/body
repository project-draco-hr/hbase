{
  try {
    List<HRegionInfo> hris=this.getHBaseAdmin().getTableRegions(getBytes(tableName));
    List<TRegionInfo> regions=new ArrayList<TRegionInfo>();
    if (hris != null) {
      for (      HRegionInfo regionInfo : hris) {
        TRegionInfo region=new TRegionInfo();
        region.startKey=ByteBuffer.wrap(regionInfo.getStartKey());
        region.endKey=ByteBuffer.wrap(regionInfo.getEndKey());
        region.id=regionInfo.getRegionId();
        region.name=ByteBuffer.wrap(regionInfo.getRegionName());
        region.version=regionInfo.getVersion();
        regions.add(region);
      }
    }
    return regions;
  }
 catch (  IOException e) {
    LOG.warn(e.getMessage(),e);
    throw new IOError(e.getMessage());
  }
}
