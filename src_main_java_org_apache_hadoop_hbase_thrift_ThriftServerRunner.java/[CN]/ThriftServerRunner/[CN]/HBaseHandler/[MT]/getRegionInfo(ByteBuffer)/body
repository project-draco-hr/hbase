{
  try {
    HTable table=getTable(HConstants.META_TABLE_NAME);
    byte[] row=toBytes(searchRow);
    Result startRowResult=table.getRowOrBefore(row,HConstants.CATALOG_FAMILY);
    if (startRowResult == null) {
      throw new IOException("Cannot find row in .META., row=" + Bytes.toStringBinary(row));
    }
    byte[] value=startRowResult.getValue(HConstants.CATALOG_FAMILY,HConstants.REGIONINFO_QUALIFIER);
    if (value == null || value.length == 0) {
      throw new IOException("HRegionInfo REGIONINFO was null or " + " empty in Meta for row=" + Bytes.toStringBinary(row));
    }
    HRegionInfo regionInfo=Writables.getHRegionInfo(value);
    TRegionInfo region=new TRegionInfo();
    region.setStartKey(regionInfo.getStartKey());
    region.setEndKey(regionInfo.getEndKey());
    region.id=regionInfo.getRegionId();
    region.setName(regionInfo.getRegionName());
    region.version=regionInfo.getVersion();
    value=startRowResult.getValue(HConstants.CATALOG_FAMILY,HConstants.SERVER_QUALIFIER);
    if (value != null && value.length > 0) {
      String hostAndPort=Bytes.toString(value);
      region.setServerName(Bytes.toBytes(Addressing.parseHostname(hostAndPort)));
      region.port=Addressing.parsePort(hostAndPort);
    }
    return region;
  }
 catch (  IOException e) {
    LOG.warn(e.getMessage(),e);
    throw new IOError(e.getMessage());
  }
}
