{
  GenericOptionsParser opts=new GenericOptionsParser(TEST_UTIL.getConfiguration(),args);
  Configuration conf=opts.getConfiguration();
  args=opts.getRemainingArgs();
  Job job=RowCounter.createSubmittableJob(conf,args);
  BackgroundSchemaChangeThread schemaChangeThread=new BackgroundSchemaChangeThread(TEST_UTIL.getHBaseAdmin(),TableName.valueOf(TABLE_NAME),NUM_ONLINE_CHANGES);
  schemaChangeThread.start();
  job.waitForCompletion(true);
  String trackingURL=job.getHistoryUrl();
  String trackingURL2=job.getTrackingURL();
  System.out.println("Tracking URL is: " + trackingURL2);
  schemaChangeThread.join();
  assertTrue(job.isSuccessful());
  Counter counter=job.getCounters().findCounter(RowCounterMapper.Counters.ROWS);
  assertEquals(expectedCount,counter.getValue());
}
