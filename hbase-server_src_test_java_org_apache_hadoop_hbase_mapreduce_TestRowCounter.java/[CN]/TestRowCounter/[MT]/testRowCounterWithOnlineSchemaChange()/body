{
  String[] args=new String[]{TABLE_NAME};
  final TableName tableName=TableName.valueOf(TABLE_NAME);
  HTableDescriptor htd=TEST_UTIL.getHBaseAdmin().getTableDescriptor(tableName);
  final int INITAL_MAX_VERSIONS=htd.getFamilies().iterator().next().getMaxVersions();
  final int EXPECTED_NUM_REGIONS=TEST_UTIL.getHBaseAdmin().getTableRegions(tableName).size();
  runRowCounterWithOnlineSchemaChange(args,TOTAL_ROWS);
  final int FINAL_MAX_VERSIONS=TestAdmin.waitForColumnSchemasToSettle(TEST_UTIL.getMiniHBaseCluster(),tableName,EXPECTED_NUM_REGIONS).getMaxVersions();
  assertEquals("There was a mismatch in the number of online schema modifications that were created",FINAL_MAX_VERSIONS,INITAL_MAX_VERSIONS + NUM_ONLINE_CHANGES);
}
