{
  Path tablePath=new Path(hbaseRootDir,"foo");
  FileStatus[] regionsDir=fs.listStatus(tablePath);
  if (regionsDir == null)   throw new IOException("No Regions found for table " + "foo");
  Path columnFamilyDir=null;
  Path targetRegion=null;
  for (  FileStatus s : regionsDir) {
    if (fs.exists(new Path(s.getPath(),HRegionFileSystem.REGION_INFO_FILE))) {
      targetRegion=s.getPath();
      break;
    }
  }
  FileStatus[] cfs=fs.listStatus(targetRegion);
  for (  FileStatus f : cfs) {
    if (f.isDir()) {
      columnFamilyDir=f.getPath();
      break;
    }
  }
  LOG.debug("target columnFamilyDir: " + columnFamilyDir);
  Path corruptFile=new Path(columnFamilyDir,"corrupt_file");
  if (!fs.createNewFile(corruptFile))   throw new IOException("Couldn't create corrupt file: " + corruptFile);
  assertEquals(1,ToolRunner.run(TEST_UTIL.getConfiguration(),new HFileV1Detector(),null));
  FileSystem.get(TEST_UTIL.getConfiguration()).delete(corruptFile,false);
}
