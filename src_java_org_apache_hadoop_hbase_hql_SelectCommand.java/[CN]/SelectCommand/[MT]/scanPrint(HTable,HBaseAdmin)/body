{
  int count=0;
  Scanner scan=null;
  try {
    ParsedColumns parsedColumns=getColumns(admin,true);
    Text[] cols=parsedColumns.getColumns().toArray(new Text[]{});
    if (timestamp == 0) {
      scan=table.getScanner(cols,rowKey);
    }
 else {
      scan=table.getScanner(Bytes.toByteArrays(cols),rowKey.getBytes(),timestamp);
    }
    if (this.stopRow.toString().length() > 0) {
      RowFilterInterface filter=new WhileMatchRowFilter(new StopRowFilter(stopRow.getBytes()));
      scan=table.getScanner(Bytes.toByteArrays(cols),rowKey.getBytes(),filter);
    }
    RowResult results=scan.next();
    while (results != null && checkLimit(count)) {
      if (count == 0 && !countFunction) {
        formatter.header((parsedColumns.isMultiple()) ? HEADER : HEADER_ROW_CELL);
      }
      byte[] r=results.getRow();
      if (!countFunction) {
        for (        byte[] columnKey : results.keySet()) {
          String cellData=toString(columnKey,results.get(columnKey));
          if (parsedColumns.isMultiple()) {
            formatter.row(new String[]{r.toString(),columnKey.toString(),cellData});
          }
 else {
            formatter.row(new String[]{r.toString(),cellData});
          }
          if (limit > 0 && count >= limit) {
            break;
          }
        }
      }
      count++;
      results=scan.next();
    }
    if (count == 0 && Shell.HTML_OPTION != null && !countFunction) {
      formatter.header((parsedColumns.isMultiple()) ? HEADER : HEADER_ROW_CELL);
    }
    formatter.footer();
    scan.close();
  }
 catch (  IOException e) {
    e.printStackTrace();
  }
  return count;
}
