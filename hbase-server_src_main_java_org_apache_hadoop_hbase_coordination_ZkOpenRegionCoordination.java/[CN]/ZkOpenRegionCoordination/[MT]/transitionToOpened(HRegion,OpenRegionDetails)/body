{
  ZkOpenRegionDetails zkOrd=(ZkOpenRegionDetails)ord;
  boolean result=false;
  HRegionInfo hri=r.getRegionInfo();
  final String name=hri.getRegionNameAsString();
  try {
    if (ZKAssign.transitionNodeOpened(watcher,hri,zkOrd.getServerName(),zkOrd.getVersion()) == -1) {
      String warnMsg="Completed the OPEN of region " + name + " but when transitioning from "+ " OPENING to OPENED ";
      try {
        String node=ZKAssign.getNodeName(watcher,hri.getEncodedName());
        if (ZKUtil.checkExists(watcher,node) < 0) {
          coordination.getServer().abort(warnMsg + "the znode disappeared",null);
        }
 else {
          LOG.warn(warnMsg + "got a version mismatch, someone else clashed; " + "so now unassigning -- closing region on server: "+ zkOrd.getServerName());
        }
      }
 catch (      KeeperException ke) {
        coordination.getServer().abort(warnMsg,ke);
      }
    }
 else {
      LOG.debug("Transitioned " + r.getRegionInfo().getEncodedName() + " to OPENED in zk on "+ zkOrd.getServerName());
      result=true;
    }
  }
 catch (  KeeperException e) {
    LOG.error("Failed transitioning node " + name + " from OPENING to OPENED -- closing region",e);
  }
  return result;
}
