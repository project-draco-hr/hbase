{
  try {
    if (maxWaitForSeqId < 0) {
      this.seqNumAssignedLatch.await();
    }
 else     if (!this.seqNumAssignedLatch.await(maxWaitForSeqId,TimeUnit.MILLISECONDS)) {
      throw new TimeoutIOException("Failed to get sequenceid after " + maxWaitForSeqId + "ms; WAL system stuck or has gone away?");
    }
  }
 catch (  InterruptedException ie) {
    LOG.warn("Thread interrupted waiting for next log sequence number");
    InterruptedIOException iie=new InterruptedIOException();
    iie.initCause(ie);
    throw iie;
  }
  return this.logSeqNum;
}
