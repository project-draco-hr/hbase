{
  try {
    LOG.debug("Commiting [" + transactionState.getTransactionId() + "]");
    transactionLogger.setStatusForTransaction(transactionState.getTransactionId(),TransactionLogger.TransactionStatus.COMMITTED);
    for (    HRegionLocation location : transactionState.getParticipatingRegions()) {
      TransactionalRegionInterface transactionalRegionServer=(TransactionalRegionInterface)connection.getHRegionConnection(location.getServerAddress());
      transactionalRegionServer.commit(location.getRegionInfo().getRegionName(),transactionState.getTransactionId());
    }
  }
 catch (  Exception e) {
    LOG.debug("Commit of transaction [" + transactionState.getTransactionId() + "] was unsucsessful",e);
    try {
      abort(transactionState);
    }
 catch (    Exception abortException) {
      LOG.warn("Exeption durring abort",abortException);
    }
    throw new CommitUnsuccessfulException(e);
  }
}
