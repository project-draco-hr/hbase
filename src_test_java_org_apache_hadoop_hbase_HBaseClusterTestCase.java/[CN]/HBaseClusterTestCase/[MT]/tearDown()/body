{
  if (!openMetaTable) {
    new HTable(conf,HConstants.META_TABLE_NAME);
  }
  super.tearDown();
  try {
    HConnectionManager.deleteConnection(conf,true);
    if (this.cluster != null) {
      try {
        this.cluster.shutdown();
      }
 catch (      Exception e) {
        LOG.warn("Closing mini dfs",e);
      }
      try {
        this.zooKeeperCluster.shutdown();
      }
 catch (      IOException e) {
        LOG.warn("Shutting down ZooKeeper cluster",e);
      }
    }
    if (startDfs) {
      shutdownDfs(dfsCluster);
    }
  }
 catch (  Exception e) {
    LOG.error(e);
  }
}
