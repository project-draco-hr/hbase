{
  Byte code=CLASS_TO_CODE.get(c);
  if (code == null) {
    if (List.class.isAssignableFrom(c)) {
      code=CLASS_TO_CODE.get(List.class);
    }
 else     if (Writable.class.isAssignableFrom(c)) {
      code=CLASS_TO_CODE.get(Writable.class);
    }
  }
  if (code == null) {
    LOG.error("Unsupported type " + c);
    StackTraceElement[] els=new Exception().getStackTrace();
    for (    StackTraceElement elem : els) {
      LOG.error(elem.getMethodName());
    }
    throw new UnsupportedOperationException("No code for unexpected " + c);
  }
  out.writeByte(code);
}
