{
  boolean result;
  int block=index.rootBlockContainingKey(key,keyOffset,keyLength);
  if (block < 0) {
    result=false;
  }
 else {
    HFileBlock bloomBlock;
    try {
      bloomBlock=reader.readBlock(index.getRootBlockOffset(block),index.getRootBlockDataSize(block),true,true,false);
    }
 catch (    IOException ex) {
      throw new IllegalArgumentException("Failed to load Bloom block for key " + Bytes.toStringBinary(key,keyOffset,keyLength),ex);
    }
    ByteBuffer bloomBuf=bloomBlock.getBufferReadOnly();
    result=ByteBloomFilter.contains(key,keyOffset,keyLength,bloomBuf.array(),bloomBuf.arrayOffset() + HFileBlock.HEADER_SIZE,bloomBlock.getUncompressedSizeWithoutHeader(),hash,hashCount);
  }
  if (numQueriesPerChunk != null && block >= 0) {
    ++numQueriesPerChunk[block];
    if (result)     ++numPositivesPerChunk[block];
  }
  return result;
}
