{
synchronized (this.updateLock) {
    if (this.closed)     return;
    if (this.unflushedEntries.get() == 0)     return;
    if (force || this.unflushedEntries.get() > this.flushlogentries) {
      try {
        lastLogFlushTime=System.currentTimeMillis();
        if (this.append && syncfs != null) {
          try {
            this.syncfs.invoke(this.writer,NO_ARGS);
          }
 catch (          Exception e) {
            throw new IOException("Reflection",e);
          }
        }
 else {
          this.writer.sync();
          if (this.writer_out != null)           this.writer_out.sync();
        }
        this.unflushedEntries.set(0);
      }
 catch (      IOException e) {
        LOG.fatal("Could not append. Requesting close of hlog",e);
        requestLogRoll();
        throw e;
      }
    }
  }
}
