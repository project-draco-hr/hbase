{
synchronized (this.updateLock) {
    if (this.closed) {
      return;
    }
    if (this.forceSync || this.unflushedEntries.get() >= this.flushlogentries) {
      try {
        long now=System.currentTimeMillis();
        this.writer.sync();
        syncTime+=System.currentTimeMillis() - now;
        syncOps++;
        this.forceSync=false;
        this.unflushedEntries.set(0);
      }
 catch (      IOException e) {
        LOG.fatal("Could not append. Requesting close of hlog",e);
        requestLogRoll();
        throw e;
      }
    }
  }
}
