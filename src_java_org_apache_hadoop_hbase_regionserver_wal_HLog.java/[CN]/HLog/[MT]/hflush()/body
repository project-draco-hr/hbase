{
synchronized (this.updateLock) {
    if (this.closed)     return;
    if (this.forceSync.get() || this.unflushedEntries.get() > this.flushlogentries) {
      try {
        this.writer.sync();
        if (this.writer_out != null) {
          this.writer_out.sync();
        }
        this.forceSync.compareAndSet(true,false);
        this.unflushedEntries.set(0);
      }
 catch (      IOException e) {
        LOG.fatal("Could not append. Requesting close of hlog",e);
        requestLogRoll();
        throw e;
      }
    }
  }
}
