{
  String tableNameString="testCheckAndPutCount";
  byte[] tableName=Bytes.toBytes(tableNameString);
  byte[] cf=Bytes.toBytes("d");
  byte[] row=Bytes.toBytes("rk");
  byte[] qualifier=Bytes.toBytes("qual");
  byte[] valOne=Bytes.toBytes("Value");
  byte[] valTwo=Bytes.toBytes("ValueTwo");
  byte[] valThree=Bytes.toBytes("ValueThree");
  TEST_UTIL.createTable(tableName,cf);
  Table t=new HTable(conf,tableName);
  Put p=new Put(row);
  p.add(cf,qualifier,valOne);
  t.put(p);
  t.flushCommits();
  Put pTwo=new Put(row);
  pTwo.add(cf,qualifier,valTwo);
  t.checkAndPut(row,cf,qualifier,valOne,pTwo);
  t.flushCommits();
  Put pThree=new Put(row);
  pThree.add(cf,qualifier,valThree);
  t.checkAndPut(row,cf,qualifier,valOne,pThree);
  t.flushCommits();
  metricsRegionServer.getRegionServerWrapper().forceRecompute();
  metricsHelper.assertCounter("checkMutateFailedCount",1,serverSource);
  metricsHelper.assertCounter("checkMutatePassedCount",1,serverSource);
  t.close();
}
