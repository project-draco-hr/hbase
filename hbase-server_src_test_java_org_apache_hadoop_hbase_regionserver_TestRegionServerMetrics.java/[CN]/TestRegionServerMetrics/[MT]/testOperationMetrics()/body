{
  String cf="OPCF";
  String otherCf="otherCF";
  String rk="testRK";
  String icvCol="icvCol";
  String appendCol="appendCol";
  String regionName=null;
  HTable hTable=TEST_UTIL.createTable(TABLE_NAME.getBytes(),new byte[][]{cf.getBytes(),otherCf.getBytes()});
  Set<HRegionInfo> regionInfos=hTable.getRegionLocations().keySet();
  regionName=regionInfos.toArray(new HRegionInfo[regionInfos.size()])[0].getEncodedName();
  Put pOne=new Put(rk.getBytes());
  pOne.add(cf.getBytes(),icvCol.getBytes(),Bytes.toBytes(0L));
  Put pTwo=new Put("ignored1RK".getBytes());
  pTwo.add(cf.getBytes(),"ignored".getBytes(),Bytes.toBytes(0L));
  hTable.put(Arrays.asList(new Put[]{pOne,pTwo}));
  Put pThree=new Put("ignored2RK".getBytes());
  pThree.add(cf.getBytes(),"ignored".getBytes(),Bytes.toBytes("TEST1"));
  Put pFour=new Put("ignored3RK".getBytes());
  pFour.add(otherCf.getBytes(),"ignored".getBytes(),Bytes.toBytes(0L));
  hTable.put(Arrays.asList(new Put[]{pThree,pFour}));
  hTable.incrementColumnValue(rk.getBytes(),cf.getBytes(),icvCol.getBytes(),1L);
  Get g=new Get(rk.getBytes());
  g.addColumn(cf.getBytes(),appendCol.getBytes());
  hTable.get(g);
  Append a=new Append(rk.getBytes());
  a.add(cf.getBytes(),appendCol.getBytes(),Bytes.toBytes("-APPEND"));
  hTable.append(a);
  Delete dOne=new Delete(rk.getBytes());
  dOne.deleteFamily(cf.getBytes());
  hTable.delete(dOne);
  Delete dTwo=new Delete(rk.getBytes());
  hTable.delete(dTwo);
  assertTimeVaryingMetricCount(1,TABLE_NAME,cf,null,"multiput_");
  assertTimeVaryingMetricCount(2,TABLE_NAME,null,regionName,"multiput_");
  assertTimeVaryingMetricCount(1,TABLE_NAME,"__unknown",null,"multiput_");
  assertTimeVaryingMetricCount(1,TABLE_NAME,cf,regionName,"increment_");
  assertTimeVaryingMetricCount(1,TABLE_NAME,cf,regionName,"append_");
  assertTimeVaryingMetricCount(1,TABLE_NAME,cf,null,"multidelete_");
  assertTimeVaryingMetricCount(2,TABLE_NAME,null,regionName,"multidelete_");
  assertTimeVaryingMetricCount(3,TABLE_NAME,cf,regionName,"get_");
}
