{
  HTableDescriptor hdt=TEST_UTIL.createTableDescriptor("HCM-testOperationTimeout");
  hdt.addCoprocessor(SleepAndFailFirstTime.class.getName());
  Table t=TEST_UTIL.createTable(hdt,new byte[][]{FAM_NAM});
  if (t instanceof HTable) {
    HTable table=(HTable)t;
    table.setRpcTimeout(Integer.MAX_VALUE);
    table.setOperationTimeout(120 * 1000);
    table.get(new Get(FAM_NAM));
    SleepAndFailFirstTime.ct.set(0);
    try {
      table.setOperationTimeout(30 * 1000);
      table.get(new Get(FAM_NAM));
      Assert.fail("We expect an exception here");
    }
 catch (    SocketTimeoutException e) {
      LOG.info("We received an exception, as expected ",e);
    }
catch (    IOException e) {
      Assert.fail("Wrong exception:" + e.getMessage());
    }
 finally {
      table.close();
    }
  }
}
