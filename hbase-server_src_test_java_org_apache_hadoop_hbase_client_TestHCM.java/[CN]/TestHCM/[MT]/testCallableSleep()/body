{
  long pauseTime;
  long baseTime=100;
  TableName tableName=TableName.valueOf("HCM-testCallableSleep");
  HTable table=TEST_UTIL.createTable(tableName,FAM_NAM);
  RegionServerCallable<Object> regionServerCallable=new RegionServerCallable<Object>(TEST_UTIL.getConnection(),tableName,ROW){
    public Object call(    int timeout) throws IOException {
      return null;
    }
  }
;
  regionServerCallable.prepare(false);
  for (int i=0; i < HConstants.RETRY_BACKOFF.length; i++) {
    pauseTime=regionServerCallable.sleep(baseTime,i);
    assertTrue(pauseTime >= (baseTime * HConstants.RETRY_BACKOFF[i]));
    assertTrue(pauseTime <= (baseTime * HConstants.RETRY_BACKOFF[i] * 1.01f));
  }
  RegionAdminServiceCallable<Object> regionAdminServiceCallable=new RegionAdminServiceCallable<Object>((ClusterConnection)TEST_UTIL.getConnection(),new RpcControllerFactory(TEST_UTIL.getConfiguration()),tableName,ROW){
    public Object call(    int timeout) throws IOException {
      return null;
    }
  }
;
  regionAdminServiceCallable.prepare(false);
  for (int i=0; i < HConstants.RETRY_BACKOFF.length; i++) {
    pauseTime=regionAdminServiceCallable.sleep(baseTime,i);
    assertTrue(pauseTime >= (baseTime * HConstants.RETRY_BACKOFF[i]));
    assertTrue(pauseTime <= (baseTime * HConstants.RETRY_BACKOFF[i] * 1.01f));
  }
  MasterCallable masterCallable=new MasterCallable(TEST_UTIL.getConnection()){
    public Object call(    int timeout) throws IOException {
      return null;
    }
  }
;
  for (int i=0; i < HConstants.RETRY_BACKOFF.length; i++) {
    pauseTime=masterCallable.sleep(baseTime,i);
    assertTrue(pauseTime >= (baseTime * HConstants.RETRY_BACKOFF[i]));
    assertTrue(pauseTime <= (baseTime * HConstants.RETRY_BACKOFF[i] * 1.01f));
  }
}
