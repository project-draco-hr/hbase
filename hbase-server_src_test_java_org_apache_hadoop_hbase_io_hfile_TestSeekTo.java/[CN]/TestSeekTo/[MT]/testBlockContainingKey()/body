{
  Path p=makeNewFile();
  HFile.Reader reader=HFile.createReader(fs,p,new CacheConfig(conf));
  reader.loadFileInfo();
  HFileBlockIndex.BlockIndexReader blockIndexReader=reader.getDataBlockIndexReader();
  System.out.println(blockIndexReader.toString());
  int klen=toKV("a").getKey().length;
  assertEquals(-1,blockIndexReader.rootBlockContainingKey(toKV("a").getKey(),0,klen));
  assertEquals(0,blockIndexReader.rootBlockContainingKey(toKV("c").getKey(),0,klen));
  assertEquals(0,blockIndexReader.rootBlockContainingKey(toKV("d").getKey(),0,klen));
  assertEquals(0,blockIndexReader.rootBlockContainingKey(toKV("e").getKey(),0,klen));
  assertEquals(0,blockIndexReader.rootBlockContainingKey(toKV("g").getKey(),0,klen));
  assertEquals(0,blockIndexReader.rootBlockContainingKey(toKV("h").getKey(),0,klen));
  assertEquals(1,blockIndexReader.rootBlockContainingKey(toKV("i").getKey(),0,klen));
  assertEquals(1,blockIndexReader.rootBlockContainingKey(toKV("j").getKey(),0,klen));
  assertEquals(1,blockIndexReader.rootBlockContainingKey(toKV("k").getKey(),0,klen));
  assertEquals(1,blockIndexReader.rootBlockContainingKey(toKV("l").getKey(),0,klen));
  reader.close();
}
