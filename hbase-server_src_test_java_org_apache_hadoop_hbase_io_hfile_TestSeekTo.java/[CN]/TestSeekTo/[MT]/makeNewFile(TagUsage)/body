{
  Path ncTFile=new Path(this.testDir,"basic.hfile");
  if (tagUsage != TagUsage.NO_TAG) {
    conf.setInt("hfile.format.version",3);
  }
 else {
    conf.setInt("hfile.format.version",2);
  }
  FSDataOutputStream fout=this.fs.create(ncTFile);
  int blocksize=toKV("a",tagUsage).getLength() * 3;
  HFileContext context=new HFileContextBuilder().withBlockSize(blocksize).withIncludesTags(true).build();
  HFile.Writer writer=HFile.getWriterFactoryNoCache(conf).withOutputStream(fout).withFileContext(context).withComparator(KeyValue.COMPARATOR).create();
  writer.append(toKV("c",tagUsage));
  writer.append(toKV("e",tagUsage));
  writer.append(toKV("g",tagUsage));
  writer.append(toKV("i",tagUsage));
  writer.append(toKV("k",tagUsage));
  writer.close();
  fout.close();
  return ncTFile;
}
