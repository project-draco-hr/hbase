{
  Path p=makeNewFile(tagUsage);
  HFile.Reader reader=HFile.createReader(fs,p,new CacheConfig(conf),conf);
  reader.loadFileInfo();
  HFileScanner scanner=reader.getScanner(false,true);
  assertEquals(false,scanner.seekBefore(toKV("a",tagUsage).getKey()));
  assertEquals(false,scanner.seekBefore(toKV("b",tagUsage).getKey()));
  assertEquals(false,scanner.seekBefore(toKV("c",tagUsage).getKey()));
  assertEquals(true,scanner.seekBefore(toKV("d",tagUsage).getKey()));
  assertEquals("c",toRowStr(scanner.getKeyValue()));
  assertEquals(0,scanner.reseekTo(toKV("c",tagUsage).getKey()));
  assertEquals("c",toRowStr(scanner.getKeyValue()));
  assertEquals(0,scanner.reseekTo(toKV("g",tagUsage).getKey()));
  assertEquals("g",toRowStr(scanner.getKeyValue()));
  assertEquals(true,scanner.seekBefore(toKV("e",tagUsage).getKey()));
  assertEquals("c",toRowStr(scanner.getKeyValue()));
  assertEquals(0,scanner.reseekTo(toKV("e",tagUsage).getKey()));
  assertEquals("e",toRowStr(scanner.getKeyValue()));
  assertEquals(0,scanner.reseekTo(toKV("g",tagUsage).getKey()));
  assertEquals("g",toRowStr(scanner.getKeyValue()));
  assertEquals(true,scanner.seekBefore(toKV("f",tagUsage).getKey()));
  assertEquals("e",toRowStr(scanner.getKeyValue()));
  assertEquals(0,scanner.reseekTo(toKV("e",tagUsage).getKey()));
  assertEquals("e",toRowStr(scanner.getKeyValue()));
  assertEquals(0,scanner.reseekTo(toKV("g",tagUsage).getKey()));
  assertEquals("g",toRowStr(scanner.getKeyValue()));
  assertEquals(true,scanner.seekBefore(toKV("g",tagUsage).getKey()));
  assertEquals("e",toRowStr(scanner.getKeyValue()));
  assertEquals(0,scanner.reseekTo(toKV("e",tagUsage).getKey()));
  assertEquals("e",toRowStr(scanner.getKeyValue()));
  assertEquals(0,scanner.reseekTo(toKV("g",tagUsage).getKey()));
  assertEquals("g",toRowStr(scanner.getKeyValue()));
  assertEquals(true,scanner.seekBefore(toKV("h",tagUsage).getKey()));
  assertEquals("g",toRowStr(scanner.getKeyValue()));
  assertEquals(0,scanner.reseekTo(toKV("g",tagUsage).getKey()));
  assertEquals("g",toRowStr(scanner.getKeyValue()));
  assertEquals(true,scanner.seekBefore(toKV("i",tagUsage).getKey()));
  assertEquals("g",toRowStr(scanner.getKeyValue()));
  assertEquals(0,scanner.reseekTo(toKV("g",tagUsage).getKey()));
  assertEquals("g",toRowStr(scanner.getKeyValue()));
  assertEquals(true,scanner.seekBefore(toKV("j",tagUsage).getKey()));
  assertEquals("i",toRowStr(scanner.getKeyValue()));
  assertEquals(0,scanner.reseekTo(toKV("i",tagUsage).getKey()));
  assertEquals("i",toRowStr(scanner.getKeyValue()));
  assertEquals(true,scanner.seekBefore(toKV("k",tagUsage).getKey()));
  assertEquals("i",toRowStr(scanner.getKeyValue()));
  assertEquals(0,scanner.reseekTo(toKV("i",tagUsage).getKey()));
  assertEquals("i",toRowStr(scanner.getKeyValue()));
  assertEquals(0,scanner.reseekTo(toKV("k",tagUsage).getKey()));
  assertEquals("k",toRowStr(scanner.getKeyValue()));
  assertEquals(true,scanner.seekBefore(toKV("l",tagUsage).getKey()));
  assertEquals("k",toRowStr(scanner.getKeyValue()));
  assertEquals(0,scanner.reseekTo(toKV("k",tagUsage).getKey()));
  assertEquals("k",toRowStr(scanner.getKeyValue()));
}
