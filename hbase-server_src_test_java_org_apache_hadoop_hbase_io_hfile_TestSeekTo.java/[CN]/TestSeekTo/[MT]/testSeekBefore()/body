{
  Path p=makeNewFile();
  HFile.Reader reader=HFile.createReader(fs,p,new CacheConfig(conf));
  reader.loadFileInfo();
  HFileScanner scanner=reader.getScanner(false,true);
  assertEquals(false,scanner.seekBefore(toKV("a").getKey()));
  assertEquals(false,scanner.seekBefore(toKV("c").getKey()));
  assertEquals(true,scanner.seekBefore(toKV("d").getKey()));
  assertEquals("c",toRowStr(scanner.getKeyValue()));
  assertEquals(true,scanner.seekBefore(toKV("e").getKey()));
  assertEquals("c",toRowStr(scanner.getKeyValue()));
  assertEquals(true,scanner.seekBefore(toKV("f").getKey()));
  assertEquals("e",toRowStr(scanner.getKeyValue()));
  assertEquals(true,scanner.seekBefore(toKV("g").getKey()));
  assertEquals("e",toRowStr(scanner.getKeyValue()));
  assertEquals(true,scanner.seekBefore(toKV("h").getKey()));
  assertEquals("g",toRowStr(scanner.getKeyValue()));
  assertEquals(true,scanner.seekBefore(toKV("i").getKey()));
  assertEquals("g",toRowStr(scanner.getKeyValue()));
  assertEquals(true,scanner.seekBefore(toKV("j").getKey()));
  assertEquals("i",toRowStr(scanner.getKeyValue()));
  assertEquals(true,scanner.seekBefore(toKV("k").getKey()));
  assertEquals("i",toRowStr(scanner.getKeyValue()));
  assertEquals(true,scanner.seekBefore(toKV("l").getKey()));
  assertEquals("k",toRowStr(scanner.getKeyValue()));
  reader.close();
}
