{
  LOG.info("create full backup image for all tables");
  String tablesetFull=table1.getNameAsString() + BackupRestoreConstants.TABLENAME_DELIMITER_IN_COMMAND + table2.getNameAsString()+ BackupRestoreConstants.TABLENAME_DELIMITER_IN_COMMAND+ table3.getNameAsString()+ BackupRestoreConstants.TABLENAME_DELIMITER_IN_COMMAND+ table4.getNameAsString();
  BackupSystemTable systemTable=BackupSystemTable.getTable(TEST_UTIL.getConfiguration());
  assertFalse(systemTable.hasBackupSessions());
  List<FileStatus> walFiles=getListOfWALFiles(TEST_UTIL.getConfiguration());
  List<String> swalFiles=convert(walFiles);
  BackupLogCleaner cleaner=new BackupLogCleaner();
  cleaner.setConf(TEST_UTIL.getConfiguration());
  Iterable<FileStatus> deletable=cleaner.getDeletableFiles(walFiles);
  assertTrue(Iterables.size(deletable) == walFiles.size());
  systemTable.addWALFiles(swalFiles,"backup");
  String backupIdFull=BackupClient.create("full",BACKUP_ROOT_DIR,tablesetFull,null);
  assertTrue(checkSucceeded(backupIdFull));
  deletable=cleaner.getDeletableFiles(walFiles);
  int size=Iterables.size(deletable);
  assertTrue(size == walFiles.size());
  List<FileStatus> newWalFiles=getListOfWALFiles(TEST_UTIL.getConfiguration());
  LOG.debug("WAL list after full backup");
  convert(newWalFiles);
  assertTrue(walFiles.size() < newWalFiles.size());
  Connection conn=ConnectionFactory.createConnection(conf1);
  HTable t1=(HTable)conn.getTable(table1);
  Put p1;
  for (int i=0; i < NB_ROWS_IN_BATCH; i++) {
    p1=new Put(Bytes.toBytes("row-t1" + i));
    p1.addColumn(famName,qualName,Bytes.toBytes("val" + i));
    t1.put(p1);
  }
  t1.close();
  HTable t2=(HTable)conn.getTable(table2);
  Put p2;
  for (int i=0; i < 5; i++) {
    p2=new Put(Bytes.toBytes("row-t2" + i));
    p2.addColumn(famName,qualName,Bytes.toBytes("val" + i));
    t2.put(p2);
  }
  t2.close();
  String tablesetIncMultiple=table1.getNameAsString() + BackupRestoreConstants.TABLENAME_DELIMITER_IN_COMMAND + table2.getNameAsString()+ BackupRestoreConstants.TABLENAME_DELIMITER_IN_COMMAND+ table3.getNameAsString();
  String backupIdIncMultiple=BackupClient.create("incremental",BACKUP_ROOT_DIR,tablesetIncMultiple,null);
  assertTrue(checkSucceeded(backupIdIncMultiple));
  deletable=cleaner.getDeletableFiles(newWalFiles);
  assertTrue(Iterables.size(deletable) == newWalFiles.size());
  conn.close();
}
