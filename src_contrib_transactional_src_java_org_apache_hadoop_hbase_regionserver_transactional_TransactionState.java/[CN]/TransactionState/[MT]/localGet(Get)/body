{
  List<KeyValue> localKVs=new ArrayList<KeyValue>();
  List<Put> reversedPuts=new ArrayList<Put>(puts);
  Collections.reverse(reversedPuts);
  for (  Put put : reversedPuts) {
    if (!Bytes.equals(get.getRow(),put.getRow())) {
      continue;
    }
    if (put.getTimeStamp() > get.getTimeRange().getMax()) {
      continue;
    }
    if (put.getTimeStamp() < get.getTimeRange().getMin()) {
      continue;
    }
    for (    Entry<byte[],NavigableSet<byte[]>> getFamilyEntry : get.getFamilyMap().entrySet()) {
      List<KeyValue> familyPuts=put.getFamilyMap().get(getFamilyEntry.getKey());
      if (familyPuts == null) {
        continue;
      }
      if (getFamilyEntry.getValue() == null) {
        localKVs.addAll(familyPuts);
      }
 else {
        for (        KeyValue kv : familyPuts) {
          if (getFamilyEntry.getValue().contains(kv.getQualifier())) {
            localKVs.add(kv);
          }
        }
      }
    }
  }
  if (localKVs.isEmpty()) {
    return null;
  }
  return new Result(localKVs);
}
