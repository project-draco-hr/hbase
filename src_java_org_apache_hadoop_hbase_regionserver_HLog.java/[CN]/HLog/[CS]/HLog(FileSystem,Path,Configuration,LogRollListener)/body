{
  super();
  this.fs=fs;
  this.dir=dir;
  this.conf=conf;
  this.listener=listener;
  this.maxlogentries=conf.getInt("hbase.regionserver.maxlogentries",100000);
  this.flushlogentries=conf.getInt("hbase.regionserver.flushlogentries",100);
  this.blocksize=conf.getLong("hbase.regionserver.hlog.blocksize",1024L * 1024L);
  this.optionalFlushInterval=conf.getLong("hbase.regionserver.optionallogflushinterval",10 * 1000);
  this.threadWakeFrequency=conf.getLong(THREAD_WAKE_FREQUENCY,10 * 1000);
  this.lastLogFlushTime=System.currentTimeMillis();
  if (fs.exists(dir)) {
    throw new IOException("Target HLog directory already exists: " + dir);
  }
  fs.mkdirs(dir);
  this.maxLogs=conf.getInt("hbase.regionserver.maxlogs",64);
  rollWriter();
}
