{
  try {
    long now=System.currentTimeMillis();
    this.writer.append(logKey,logEdit);
    if (sync || this.unflushedEntries.incrementAndGet() >= flushlogentries) {
      sync();
    }
    long took=System.currentTimeMillis() - now;
    if (took > 1000) {
      LOG.warn(Thread.currentThread().getName() + " took " + took+ "ms appending an edit to HLog; editcount="+ this.numEntries.get());
    }
  }
 catch (  IOException e) {
    LOG.fatal("Could not append. Requesting close of log",e);
    requestLogRoll();
    throw e;
  }
}
