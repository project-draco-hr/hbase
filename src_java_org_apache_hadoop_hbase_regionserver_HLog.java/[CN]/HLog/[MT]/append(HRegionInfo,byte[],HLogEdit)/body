{
  if (closed) {
    throw new IOException("Cannot append; log is closed");
  }
  byte[] regionName=regionInfo.getRegionName();
  byte[] tableName=regionInfo.getTableDesc().getName();
synchronized (updateLock) {
    long seqNum=obtainSeqNum();
    if (!this.lastSeqWritten.containsKey(regionName)) {
      this.lastSeqWritten.put(regionName,Long.valueOf(seqNum));
    }
    HLogKey logKey=new HLogKey(regionName,tableName,row,seqNum);
    boolean sync=regionInfo.isMetaRegion() || regionInfo.isRootRegion();
    doWrite(logKey,logEdit,sync);
    this.numEntries++;
    updateLock.notifyAll();
  }
  if (this.numEntries > this.maxlogentries) {
    if (listener != null) {
      listener.logRollRequested();
    }
  }
}
