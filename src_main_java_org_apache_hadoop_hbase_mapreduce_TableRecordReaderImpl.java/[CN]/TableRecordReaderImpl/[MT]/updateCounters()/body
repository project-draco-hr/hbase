{
  if (this.getCounter == null) {
    return;
  }
  byte[] serializedMetrics=currentScan.getAttribute(Scan.SCAN_ATTRIBUTES_METRICS_DATA);
  if (serializedMetrics == null || serializedMetrics.length == 0) {
    return;
  }
  DataInputBuffer in=new DataInputBuffer();
  in.reset(serializedMetrics,0,serializedMetrics.length);
  ScanMetrics scanMetrics=new ScanMetrics();
  scanMetrics.readFields(in);
  MetricsTimeVaryingLong[] mlvs=scanMetrics.getMetricsTimeVaryingLongArray();
  try {
    for (    MetricsTimeVaryingLong mlv : mlvs) {
      Counter ct=(Counter)this.getCounter.invoke(context,HBASE_COUNTER_GROUP_NAME,mlv.getName());
      ct.increment(mlv.getCurrentIntervalValue());
    }
    ((Counter)this.getCounter.invoke(context,HBASE_COUNTER_GROUP_NAME,"NUM_SCANNER_RESTARTS")).increment(numRestarts);
  }
 catch (  Exception e) {
    LOG.debug("can't update counter." + StringUtils.stringifyException(e));
  }
}
