{
  if (cell instanceof Streamable) {
    ((Streamable)cell).write(out,withTags);
  }
 else {
    short rlen=cell.getRowLength();
    byte flen=cell.getFamilyLength();
    int qlen=cell.getQualifierLength();
    int vlen=cell.getValueLength();
    int tlen=cell.getTagsLength();
    ByteBufferUtils.putInt(out,length(rlen,flen,qlen,vlen,tlen,withTags));
    ByteBufferUtils.putInt(out,keyLength(rlen,flen,qlen));
    ByteBufferUtils.putInt(out,vlen);
    StreamUtils.writeShort(out,rlen);
    out.write(cell.getRowArray(),cell.getRowOffset(),rlen);
    out.write(flen);
    out.write(cell.getFamilyArray(),cell.getFamilyOffset(),flen);
    out.write(cell.getQualifierArray(),cell.getQualifierOffset(),qlen);
    StreamUtils.writeLong(out,cell.getTimestamp());
    out.write(cell.getTypeByte());
    out.write(cell.getValueArray(),cell.getValueOffset(),vlen);
    if (withTags && tlen > 0) {
      out.write((byte)(0xff & (tlen >> 8)));
      out.write((byte)(0xff & tlen));
      out.write(cell.getTagsArray(),cell.getTagsOffset(),tlen);
    }
  }
}
