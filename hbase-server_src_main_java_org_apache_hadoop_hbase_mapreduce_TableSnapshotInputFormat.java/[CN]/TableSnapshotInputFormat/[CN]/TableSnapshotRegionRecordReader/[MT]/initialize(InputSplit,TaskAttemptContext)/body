{
  Configuration conf=context.getConfiguration();
  this.split=(TableSnapshotRegionSplit)split;
  String regionName=this.split.regionName;
  String snapshotName=getSnapshotName(conf);
  Path rootDir=new Path(conf.get(HConstants.HBASE_DIR));
  FileSystem fs=rootDir.getFileSystem(conf);
  Path tmpRootDir=new Path(conf.get(TABLE_DIR_KEY));
  Path snapshotDir=SnapshotDescriptionUtils.getCompletedSnapshotDir(snapshotName,rootDir);
  HTableDescriptor htd=FSTableDescriptors.getTableDescriptorFromFs(fs,snapshotDir);
  Path regionDir=new Path(snapshotDir,regionName);
  HRegionInfo hri=HRegionFileSystem.loadRegionInfoFileContent(fs,regionDir);
  String scanStr=conf.get(TableInputFormat.SCAN);
  if (scanStr == null) {
    throw new IllegalArgumentException("A Scan is not configured for this job");
  }
  scan=TableMapReduceUtil.convertStringToScan(scanStr);
  scan.setIsolationLevel(IsolationLevel.READ_UNCOMMITTED);
  scan.setCacheBlocks(false);
  scanner=new ClientSideRegionScanner(conf,fs,tmpRootDir,htd,hri,scan,null);
  if (context != null) {
    this.context=context;
    getCounter=TableRecordReaderImpl.retrieveGetCounterWithStringsParams(context);
  }
}
