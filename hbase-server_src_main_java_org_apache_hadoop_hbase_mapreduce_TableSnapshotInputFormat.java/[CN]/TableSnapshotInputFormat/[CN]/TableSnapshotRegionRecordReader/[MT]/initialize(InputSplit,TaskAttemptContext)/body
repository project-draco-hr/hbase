{
  Configuration conf=context.getConfiguration();
  this.split=(TableSnapshotRegionSplit)split;
  HTableDescriptor htd=this.split.htd;
  HRegionInfo hri=this.split.regionInfo;
  FileSystem fs=FSUtils.getCurrentFileSystem(conf);
  Path tmpRootDir=new Path(conf.get(TABLE_DIR_KEY));
  String scanStr=conf.get(TableInputFormat.SCAN);
  if (scanStr == null) {
    throw new IllegalArgumentException("A Scan is not configured for this job");
  }
  scan=TableMapReduceUtil.convertStringToScan(scanStr);
  scan.setIsolationLevel(IsolationLevel.READ_UNCOMMITTED);
  scan.setCacheBlocks(false);
  scanner=new ClientSideRegionScanner(conf,fs,tmpRootDir,htd,hri,scan,null);
  this.context=context;
  getCounter=TableRecordReaderImpl.retrieveGetCounterWithStringsParams(context);
}
