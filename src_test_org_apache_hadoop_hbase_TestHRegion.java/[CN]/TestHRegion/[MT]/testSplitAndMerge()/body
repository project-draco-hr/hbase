{
  if (!initialized || failures) {
    throw new IllegalStateException();
  }
  try {
    Text midKey=new Text();
    if (region.needsSplit(midKey)) {
      System.out.println("Needs split");
    }
    Text midkey=new Text("row_" + (Environment.debugging ? (N_ROWS / 2) : (NUM_VALS / 2)));
    Path oldRegionPath=region.getRegionDir();
    long startTime=System.currentTimeMillis();
    HRegion subregions[]=region.closeAndSplit(midkey);
    System.out.println("Split region elapsed time: " + ((System.currentTimeMillis() - startTime) / 1000.0));
    assertEquals("Number of subregions",subregions.length,2);
    Path oldRegion1=subregions[0].getRegionDir();
    Path oldRegion2=subregions[1].getRegionDir();
    startTime=System.currentTimeMillis();
    region=HRegion.closeAndMerge(subregions[0],subregions[1]);
    System.out.println("Merge regions elapsed time: " + ((System.currentTimeMillis() - startTime) / 1000.0));
    fs.delete(oldRegionPath);
    fs.delete(oldRegion1);
    fs.delete(oldRegion2);
  }
 catch (  IOException e) {
    failures=true;
    throw e;
  }
}
