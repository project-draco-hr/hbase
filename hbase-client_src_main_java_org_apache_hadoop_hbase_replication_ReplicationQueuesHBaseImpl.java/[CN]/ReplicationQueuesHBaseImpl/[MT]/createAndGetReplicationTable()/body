{
  if (!replicationTableExists()) {
    createReplicationTable();
  }
  int maxRetries=conf.getInt("replication.queues.createtable.retries.number",100);
  RetryCounterFactory counterFactory=new RetryCounterFactory(maxRetries,100);
  RetryCounter retryCounter=counterFactory.create();
  while (!replicationTableExists()) {
    try {
      retryCounter.sleepUntilNextRetry();
      if (!retryCounter.shouldRetry()) {
        throw new IOException("Unable to acquire the Replication Table");
      }
    }
 catch (    InterruptedException e) {
      return null;
    }
  }
  return connection.getTable(REPLICATION_TABLE_NAME);
}
