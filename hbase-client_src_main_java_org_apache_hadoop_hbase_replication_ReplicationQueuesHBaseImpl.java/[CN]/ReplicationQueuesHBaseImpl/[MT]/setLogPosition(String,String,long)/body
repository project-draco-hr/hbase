{
  try {
    byte[] rowKey=this.queueIdToRowKey(queueId);
    if (rowKey == null) {
      String errMsg="Could not set position of log from non-existent queueId=" + queueId + ", filename="+ filename;
      abortable.abort(errMsg,new ReplicationException(errMsg));
      return;
    }
    Get checkLogExists=new Get(rowKey);
    checkLogExists.addColumn(CF,Bytes.toBytes(filename));
    if (!replicationTable.exists(checkLogExists)) {
      String errMsg="Could not set position of non-existent log from queueId=" + queueId + ", filename="+ filename;
      abortable.abort(errMsg,new ReplicationException(errMsg));
      return;
    }
    Put walAndOffset=new Put(rowKey);
    walAndOffset.addColumn(CF,Bytes.toBytes(filename),Bytes.toBytes(position));
    safeQueueUpdate(walAndOffset);
  }
 catch (  IOException e) {
    abortable.abort("Failed to write replication wal position (filename=" + filename + ", position="+ position+ ")",e);
  }
}
