{
  Map<String,Integer> labels=new HashMap<String,Integer>();
  Map<String,List<Integer>> userAuths=new HashMap<String,List<Integer>>();
  for (  List<Cell> cells : labelDetails) {
    for (    Cell cell : cells) {
      if (Bytes.equals(cell.getQualifierArray(),cell.getQualifierOffset(),cell.getQualifierLength(),LABEL_QUALIFIER,0,LABEL_QUALIFIER.length)) {
        labels.put(Bytes.toString(cell.getValueArray(),cell.getValueOffset(),cell.getValueLength()),Bytes.toInt(cell.getRowArray(),cell.getRowOffset()));
      }
 else {
        String user=Bytes.toString(cell.getQualifierArray(),cell.getQualifierOffset(),cell.getQualifierLength());
        List<Integer> auths=userAuths.get(user);
        if (auths == null) {
          auths=new ArrayList<Integer>();
          userAuths.put(user,auths);
        }
        auths.add(Bytes.toInt(cell.getRowArray(),cell.getRowOffset()));
      }
    }
  }
  return new Pair<Map<String,Integer>,Map<String,List<Integer>>>(labels,userAuths);
}
