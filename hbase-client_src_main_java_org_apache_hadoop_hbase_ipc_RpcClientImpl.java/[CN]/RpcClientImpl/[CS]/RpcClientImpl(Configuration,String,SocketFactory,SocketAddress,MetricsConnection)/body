{
  super(conf,clusterId,localAddr,metrics);
  this.socketFactory=factory;
  this.connections=new PoolMap<ConnectionId,Connection>(getPoolType(conf),getPoolSize(conf));
  this.failedServers=new FailedServers(conf);
}
