{
  String[] files=SnapshotTestingUtils.listHFileNames(fs,FSUtils.getTableDir(rootDir,htdClone.getTableName()));
  assertEquals(12,files.length);
  for (int i=0; i < files.length; i+=2) {
    String linkFile=files[i];
    String refFile=files[i + 1];
    assertTrue(linkFile + " should be a HFileLink",HFileLink.isHFileLink(linkFile));
    assertTrue(refFile + " should be a Referene",StoreFileInfo.isReference(refFile));
    assertEquals(sourceHtd.getTableName(),HFileLink.getReferencedTableName(linkFile));
    Path refPath=getReferredToFile(refFile);
    LOG.debug("get reference name for file " + refFile + " = "+ refPath);
    assertTrue(refPath.getName() + " should be a HFileLink",HFileLink.isHFileLink(refPath.getName()));
    assertEquals(linkFile,refPath.getName());
  }
}
