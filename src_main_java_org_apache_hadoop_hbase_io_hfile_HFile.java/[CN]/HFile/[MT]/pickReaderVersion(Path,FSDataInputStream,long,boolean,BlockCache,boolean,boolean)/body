{
  FixedFileTrailer trailer=FixedFileTrailer.readFromStream(fsdis,size);
switch (trailer.getVersion()) {
case 1:
    return new HFileReaderV1(path,trailer,fsdis,size,closeIStream,blockCache,inMemory,evictOnClose);
case 2:
  return new HFileReaderV2(path,trailer,fsdis,size,closeIStream,blockCache,inMemory,evictOnClose);
default :
throw new IOException("Cannot instantiate reader for HFile version " + trailer.getVersion());
}
}
