{
  final boolean closeIStream=true;
  HFileSystem hfs=null;
  FSDataInputStream fsdis=fs.open(path);
  FSDataInputStream fsdisNoFsChecksum=fsdis;
  if (!(fs instanceof HFileSystem)) {
    hfs=new HFileSystem(fs);
  }
 else {
    hfs=(HFileSystem)fs;
    if (hfs != null) {
      fsdisNoFsChecksum=hfs.getNoChecksumFs().open(path);
    }
  }
  return pickReaderVersion(path,fsdis,fsdisNoFsChecksum,fs.getFileStatus(path).getLen(),closeIStream,cacheConf,preferredEncodingInCache,hfs);
}
