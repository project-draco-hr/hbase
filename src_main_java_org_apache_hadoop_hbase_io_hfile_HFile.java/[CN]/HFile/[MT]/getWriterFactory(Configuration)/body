{
  int version=getFormatVersion(conf);
  LOG.debug("Using HFile format version " + version);
switch (version) {
case 1:
    return new HFileWriterV1.WriterFactoryV1(conf);
case 2:
  return new HFileWriterV2.WriterFactoryV2(conf);
default :
throw new IllegalArgumentException("Cannot create writer for HFile " + "format version " + version);
}
}
