{
  Decompressor decompressor=null;
  ByteBuffer buf=null;
  try {
    decompressor=this.compressAlgo.getDecompressor();
    InputStream is=this.compressAlgo.createDecompressionStream(new BufferedInputStream(new BoundedRangeFileInputStream(this.istream,offset,compressedSize,pread),Math.min(DEFAULT_BLOCKSIZE,compressedSize)),decompressor,0);
    buf=ByteBuffer.allocate(decompressedSize);
    IOUtils.readFully(is,buf.array(),0,buf.capacity());
    is.close();
  }
  finally {
    if (null != decompressor) {
      this.compressAlgo.returnDecompressor(decompressor);
    }
  }
  return buf;
}
