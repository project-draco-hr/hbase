{
  this.conf=conf;
  this.ttlCleaner=new TimeToLiveLogCleaner();
  this.ttlCleaner.setConf(conf);
  try {
    this.zkHelper=new ReplicationZookeeperWrapper(ZooKeeperWrapper.createInstance(this.conf,HMaster.class.getName()),this.conf,new AtomicBoolean(true),null);
  }
 catch (  IOException e) {
    LOG.error(e);
  }
  refreshHLogsAndSearch(null);
}
