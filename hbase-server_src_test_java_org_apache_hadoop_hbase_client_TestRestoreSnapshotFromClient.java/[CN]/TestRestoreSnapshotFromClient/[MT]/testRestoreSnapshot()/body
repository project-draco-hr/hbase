{
  SnapshotTestingUtils.verifyRowCount(TEST_UTIL,tableName,snapshot1Rows);
  admin.disableTable(tableName);
  admin.snapshot(snapshotName1,tableName);
  admin.restoreSnapshot(snapshotName0);
  admin.enableTable(tableName);
  SnapshotTestingUtils.verifyRowCount(TEST_UTIL,tableName,snapshot0Rows);
  SnapshotTestingUtils.verifyReplicasCameOnline(tableName,admin,getNumReplicas());
  admin.disableTable(tableName);
  admin.restoreSnapshot(emptySnapshot);
  admin.enableTable(tableName);
  SnapshotTestingUtils.verifyRowCount(TEST_UTIL,tableName,0);
  SnapshotTestingUtils.verifyReplicasCameOnline(tableName,admin,getNumReplicas());
  admin.disableTable(tableName);
  admin.restoreSnapshot(snapshotName1);
  admin.enableTable(tableName);
  SnapshotTestingUtils.verifyRowCount(TEST_UTIL,tableName,snapshot1Rows);
  SnapshotTestingUtils.verifyReplicasCameOnline(tableName,admin,getNumReplicas());
  TEST_UTIL.deleteTable(tableName);
  admin.restoreSnapshot(snapshotName1);
  SnapshotTestingUtils.verifyRowCount(TEST_UTIL,tableName,snapshot1Rows);
  SnapshotTestingUtils.verifyReplicasCameOnline(tableName,admin,getNumReplicas());
}
