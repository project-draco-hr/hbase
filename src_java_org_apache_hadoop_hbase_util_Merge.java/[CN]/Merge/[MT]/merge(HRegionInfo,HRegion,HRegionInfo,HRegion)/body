{
  if (info1 == null) {
    throw new IOException("Could not find " + region1 + " in "+ meta1.getRegionName());
  }
  if (info2 == null) {
    throw new IOException("Cound not find " + region2 + " in "+ meta2.getRegionName());
  }
  HRegion merged=null;
  HLog log=utils.getLog();
  HRegion region1=HRegion.openHRegion(info1,this.rootdir,log,this.conf);
  try {
    HRegion region2=HRegion.openHRegion(info2,this.rootdir,log,this.conf);
    try {
      merged=HRegion.merge(region1,region2);
    }
  finally {
      if (!region2.isClosed()) {
        region2.close();
      }
    }
  }
  finally {
    if (!region1.isClosed()) {
      region1.close();
    }
  }
  removeRegionFromMeta(meta1,info1);
  removeRegionFromMeta(meta2,info2);
  this.mergeInfo=merged.getRegionInfo();
  return merged;
}
