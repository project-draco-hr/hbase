{
  Configuration conf=context.getConfiguration();
  Path inputDir=new Path(conf.get("mapred.input.dir"));
  long startTime=conf.getLong(START_TIME_KEY,Long.MIN_VALUE);
  long endTime=conf.getLong(END_TIME_KEY,Long.MAX_VALUE);
  FileSystem fs=inputDir.getFileSystem(conf);
  List<FileStatus> files=getFiles(fs,inputDir,startTime,endTime);
  List<InputSplit> splits=new ArrayList<InputSplit>(files.size());
  for (  FileStatus file : files) {
    splits.add(new HLogSplit(file.getPath().toString(),file.getLen(),startTime,endTime));
  }
  return splits;
}
