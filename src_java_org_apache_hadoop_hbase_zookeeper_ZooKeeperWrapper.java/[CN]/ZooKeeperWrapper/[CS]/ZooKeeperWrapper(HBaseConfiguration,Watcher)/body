{
  if (quorumServers == null) {
    throw new IOException("Could not read quorum servers from " + ZOOKEEPER_CONFIG_NAME);
  }
  int sessionTimeout=conf.getInt(ZOOKEEPER_SESSION_TIMEOUT,DEFAULT_ZOOKEEPER_SESSION_TIMEOUT);
  this.watcher=new WatcherWrapper(watcher);
  try {
    zooKeeper=new ZooKeeper(quorumServers,sessionTimeout,this.watcher);
  }
 catch (  IOException e) {
    LOG.error("Failed to create ZooKeeper object: " + e);
    throw new IOException(e);
  }
  parentZNode=conf.get(ZOOKEEPER_PARENT_ZNODE,DEFAULT_ZOOKEEPER_PARENT_ZNODE);
  String rootServerZNodeName=conf.get(ZOOKEEPER_ROOT_SERVER_ZNODE,DEFAULT_ZOOKEEPER_ROOT_SERVER_ZNODE);
  String outOfSafeModeZNodeName=conf.get(ZOOKEEPER_SAFE_MODE_ZNODE,DEFAULT_ZOOKEEPER_SAFE_MODE_ZNODE);
  String rsZNodeName=conf.get(ZOOKEEPER_RS_ZNODE,DEFAULT_ZOOKEEPER_RS_ZNODE);
  rootRegionZNode=getZNode(rootServerZNodeName);
  outOfSafeModeZNode=getZNode(outOfSafeModeZNodeName);
  rsZNode=getZNode(rsZNodeName);
}
