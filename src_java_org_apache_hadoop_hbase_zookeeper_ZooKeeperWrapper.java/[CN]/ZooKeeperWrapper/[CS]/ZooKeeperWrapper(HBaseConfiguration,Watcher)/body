{
  if (quorumServers == null) {
    throw new IOException("Could not read quorum servers from " + ZOOKEEPER_CONFIG_NAME);
  }
  int sessionTimeout=conf.getInt("zookeeper.session.timeout",10 * 1000);
  this.watcher=new WatcherWrapper(watcher);
  try {
    zooKeeper=new ZooKeeper(quorumServers,sessionTimeout,this.watcher);
  }
 catch (  IOException e) {
    LOG.error("Failed to create ZooKeeper object: " + e);
    throw new IOException(e);
  }
  String parentZNode=conf.get("zookeeper.znode.parent","/hbase");
  String rootServerZNodeName=conf.get("zookeeper.znode.rootserver","root-region-server");
  String outOfSafeModeZNodeName=conf.get("zookeeper.znode.safemode","safe-mode");
  String rsZNodeName=conf.get("zookeeper.znode.rs","rs");
  String masterAddressZNodeName=conf.get("zookeeper.znode.master","master");
  String stateZNodeName=conf.get("zookeeper.znode.state","shutdown");
  rootRegionZNode=getZNode(parentZNode,rootServerZNodeName);
  outOfSafeModeZNode=getZNode(parentZNode,outOfSafeModeZNodeName);
  rsZNode=getZNode(parentZNode,rsZNodeName);
  masterElectionZNode=getZNode(parentZNode,masterAddressZNodeName);
  clusterStateZNode=getZNode(parentZNode,stateZNodeName);
}
