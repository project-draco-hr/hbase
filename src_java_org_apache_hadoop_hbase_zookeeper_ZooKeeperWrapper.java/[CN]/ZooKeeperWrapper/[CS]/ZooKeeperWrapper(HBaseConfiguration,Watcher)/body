{
  if (quorumServers == null) {
    throw new IOException("Could not read quorum servers from " + ZOOKEEPER_CONFIG_NAME);
  }
  int sessionTimeout=conf.getInt(ZOOKEEPER_SESSION_TIMEOUT,DEFAULT_ZOOKEEPER_SESSION_TIMEOUT);
  this.watcher=new WatcherWrapper(watcher);
  try {
    zooKeeper=new ZooKeeper(quorumServers,sessionTimeout,this.watcher);
  }
 catch (  IOException e) {
    LOG.error("Failed to create ZooKeeper object: " + e);
    throw new IOException(e);
  }
  parentZNode=conf.get(ZOOKEEPER_PARENT_ZNODE,DEFAULT_ZOOKEEPER_PARENT_ZNODE);
  String rootServerZNodeName=conf.get(ZOOKEEPER_ROOT_SERVER_ZNODE,DEFAULT_ZOOKEEPER_ROOT_SERVER_ZNODE);
  if (rootServerZNodeName.startsWith(ZNODE_PATH_SEPARATOR)) {
    rootRegionZNode=rootServerZNodeName;
  }
 else {
    rootRegionZNode=parentZNode + ZNODE_PATH_SEPARATOR + rootServerZNodeName;
  }
  String outOfSafeModeZNodeName=conf.get(ZOOKEEPER_SAFE_MODE_ZNODE,DEFAULT_ZOOKEEPER_SAFE_MODE_ZNODE);
  if (outOfSafeModeZNodeName.startsWith(ZNODE_PATH_SEPARATOR)) {
    outOfSafeModeZNode=outOfSafeModeZNodeName;
  }
 else {
    outOfSafeModeZNode=parentZNode + ZNODE_PATH_SEPARATOR + outOfSafeModeZNodeName;
  }
}
