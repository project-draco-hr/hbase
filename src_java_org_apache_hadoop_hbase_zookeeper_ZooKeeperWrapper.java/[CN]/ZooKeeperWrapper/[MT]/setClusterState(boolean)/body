{
  if (!ensureParentExists(clusterStateZNode)) {
    return false;
  }
  try {
    if (up) {
      byte[] data=Bytes.toBytes("up");
      zooKeeper.create(clusterStateZNode,data,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
      LOG.debug("State node wrote in ZooKeeper");
    }
 else {
      zooKeeper.delete(clusterStateZNode,-1);
      LOG.debug("State node deleted in ZooKeeper");
    }
    return true;
  }
 catch (  InterruptedException e) {
    LOG.warn("Failed to set state node in ZooKeeper",e);
  }
catch (  KeeperException e) {
    LOG.warn("Failed to set state node in ZooKeeper",e);
  }
  return false;
}
