{
  Properties properties=null;
  try {
    properties=HQuorumPeer.parseZooKeeperConfig();
  }
 catch (  IOException e) {
    LOG.fatal("Fail to read properties from " + ZOOKEEPER_CONFIG_NAME,e);
    System.exit(-1);
  }
  String clientPort=null;
  List<String> servers=new ArrayList<String>();
  boolean anyValid=false;
  for (  Entry<Object,Object> property : properties.entrySet()) {
    String key=property.getKey().toString().trim();
    String value=property.getValue().toString().trim();
    if (key.equals("clientPort")) {
      clientPort=value;
    }
 else     if (key.startsWith("server.")) {
      String host=value.substring(0,value.indexOf(':'));
      servers.add(host);
      try {
        InetAddress.getByName(host);
        anyValid=true;
      }
 catch (      UnknownHostException e) {
        LOG.warn(StringUtils.stringifyException(e));
      }
    }
  }
  if (!anyValid) {
    LOG.error("no valid quorum servers found in " + ZOOKEEPER_CONFIG_NAME);
    return;
  }
  if (clientPort == null) {
    LOG.error("no clientPort found in " + ZOOKEEPER_CONFIG_NAME);
    return;
  }
  if (servers.isEmpty()) {
    LOG.fatal("No server.X lines found in conf/zoo.cfg. HBase must have a " + "ZooKeeper cluster configured for its operation.");
    System.exit(-1);
  }
  StringBuilder hostPortBuilder=new StringBuilder();
  for (int i=0; i < servers.size(); ++i) {
    String host=servers.get(i);
    if (i > 0) {
      hostPortBuilder.append(',');
    }
    hostPortBuilder.append(host);
    hostPortBuilder.append(':');
    hostPortBuilder.append(clientPort);
  }
  quorumServers=hostPortBuilder.toString();
  LOG.info("Quorum servers: " + quorumServers);
}
