{
  ConcurrentMap<byte[],RegionLocations> tableLocations=getTableLocations(tableName);
  boolean removed=false;
  RegionLocations regionLocations=getCachedLocation(tableName,row);
  if (regionLocations != null) {
    HRegionLocation toBeRemoved=regionLocations.getRegionLocation(replicaId);
    RegionLocations updatedLocations=regionLocations.remove(replicaId);
    if (updatedLocations != regionLocations) {
      byte[] startKey=regionLocations.getRegionLocation().getRegionInfo().getStartKey();
      if (updatedLocations.isEmpty()) {
        removed=tableLocations.remove(startKey,regionLocations);
      }
 else {
        removed=tableLocations.replace(startKey,regionLocations,updatedLocations);
      }
    }
    if (removed && LOG.isTraceEnabled() && toBeRemoved != null) {
      LOG.trace("Removed " + toBeRemoved + " from cache");
    }
  }
}
