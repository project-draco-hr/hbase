{
  if (e instanceof IOException) {
    throw (IOException)e;
  }
  if (env.getConfiguration().getBoolean("hbase.coprocessor.abortonerror",false)) {
    abortServer(env,e);
  }
 else {
    LOG.error("Removing coprocessor '" + env.toString() + "' from "+ "environment because it threw:  "+ e,e);
    coprocessors.remove(env);
    throw new DoNotRetryIOException("Coprocessor: '" + env.toString() + "' threw: '"+ e+ "' and has been removed"+ "from the active "+ "coprocessor set.",e);
  }
}
