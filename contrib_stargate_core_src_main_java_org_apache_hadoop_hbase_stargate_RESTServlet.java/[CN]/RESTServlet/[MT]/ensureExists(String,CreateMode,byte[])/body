{
  try {
    ZooKeeper zk=wrapper.getZooKeeper();
    Stat stat=zk.exists(znode,false);
    if (stat != null) {
      zk.setData(znode,data,-1);
      return true;
    }
    zk.create(znode,data,Ids.OPEN_ACL_UNSAFE,mode);
    LOG.info("Created ZNode " + znode);
    return true;
  }
 catch (  KeeperException.NodeExistsException e) {
    return true;
  }
catch (  KeeperException.NoNodeException e) {
    return ensureParentExists(znode,CreateMode.PERSISTENT,new byte[]{}) && ensureExists(znode,mode,data);
  }
catch (  KeeperException e) {
    LOG.warn(StringUtils.stringifyException(e));
  }
catch (  InterruptedException e) {
    LOG.warn(StringUtils.stringifyException(e));
  }
  return false;
}
