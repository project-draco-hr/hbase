{
  Server server=new MockServer(HTU);
  RegionServerServices rsServices=HTU.createMockRegionServerService();
  ZKAssign.createNodeOffline(server.getZooKeeper(),TEST_HRI,server.getServerName());
  OpenRegionHandler handler=new OpenRegionHandler(server,rsServices,TEST_HRI,TEST_HTD){
    @Override HRegion openRegion(){
      return null;
    }
  }
;
  rsServices.getRegionsInTransitionInRS().put(TEST_HRI.getEncodedNameAsBytes(),Boolean.TRUE);
  handler.process();
  RegionTransition rt=RegionTransition.parseFrom(ZKAssign.getData(server.getZooKeeper(),TEST_HRI.getEncodedName()));
  assertEquals(EventType.RS_ZK_REGION_FAILED_OPEN,rt.getEventType());
}
