{
  HConnection hc=createHConnection();
  AsyncProcess ap=new MyAsyncProcess<Object>(hc,null,conf);
  List<Put> puts=new ArrayList<Put>();
  puts.add(createPut(true,true));
  ap.incTaskCounters(Arrays.asList(hri1.getRegionName()));
  ap.submit(puts,false);
  Assert.assertEquals(puts.size(),1);
  ap.decTaskCounters(Arrays.asList(hri1.getRegionName()));
  ap.submit(puts,false);
  Assert.assertTrue(puts.isEmpty());
}
