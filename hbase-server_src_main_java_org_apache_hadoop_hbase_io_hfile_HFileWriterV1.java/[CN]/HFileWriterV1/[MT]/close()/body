{
  if (this.outputStream == null) {
    return;
  }
  finishBlock();
  FixedFileTrailer trailer=new FixedFileTrailer(1,HFileBlock.MINOR_VERSION_NO_CHECKSUM);
  ArrayList<Long> metaOffsets=null;
  ArrayList<Integer> metaDataSizes=null;
  if (metaNames.size() > 0) {
    metaOffsets=new ArrayList<Long>(metaNames.size());
    metaDataSizes=new ArrayList<Integer>(metaNames.size());
    for (int i=0; i < metaNames.size(); ++i) {
      long curPos=outputStream.getPos();
      metaOffsets.add(curPos);
      DataOutputStream dos=getCompressingStream();
      BlockType.META.write(dos);
      metaData.get(i).write(dos);
      int size=releaseCompressingStream(dos);
      metaDataSizes.add(size);
    }
  }
  writeFileInfo(trailer,outputStream);
  trailer.setLoadOnOpenOffset(writeBlockIndex(this.outputStream,this.blockKeys,this.blockOffsets,this.blockDataSizes));
  LOG.info("Wrote a version 1 block index with " + this.blockKeys.size() + " keys");
  if (metaNames.size() > 0) {
    writeBlockIndex(this.outputStream,metaNames,metaOffsets,metaDataSizes);
  }
  trailer.setDataIndexCount(blockKeys.size());
  finishClose(trailer);
}
