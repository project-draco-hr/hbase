{
  this.name=name;
  this.quorum=ZKConfig.getZKQuorumServersString(conf);
  this.zooKeeper=ZKUtil.connect(conf,quorum,this);
  this.abortable=abortable;
  info("Connected to ZooKeeper");
  setNodeNames(conf);
  try {
    ZKUtil.createAndFailSilent(this,baseZNode);
    ZKUtil.createAndFailSilent(this,assignmentZNode);
    ZKUtil.createAndFailSilent(this,rsZNode);
    ZKUtil.createAndFailSilent(this,tableZNode);
  }
 catch (  KeeperException e) {
    error("Unexpected KeeperException creating base node",e);
    error("Message: " + e.getMessage());
    throw new IOException(e);
  }
}
