{
  this.store=store;
  this.cacheBlocks=scan.getCacheBlocks();
  matcher=new ScanQueryMatcher(scan,store.getFamily().getName(),columns,store.ttl,store.comparator.getRawComparator(),store.versionsToReturn(scan.getMaxVersions()));
  this.isGet=scan.isGetScan();
  List<KeyValueScanner> scanners=getScanners(scan,columns);
  for (  KeyValueScanner scanner : scanners) {
    scanner.seek(matcher.getStartKey());
  }
  heap=new KeyValueHeap(scanners,store.comparator);
  this.store.addChangedReaderObserver(this);
}
