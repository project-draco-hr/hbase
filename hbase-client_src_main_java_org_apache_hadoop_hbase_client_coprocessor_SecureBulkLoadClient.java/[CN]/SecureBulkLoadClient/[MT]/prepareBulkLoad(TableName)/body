{
  try {
    CoprocessorRpcChannel channel=table.coprocessorService(HConstants.EMPTY_START_ROW);
    SecureBulkLoadProtos.SecureBulkLoadService instance=ProtobufUtil.newServiceStub(SecureBulkLoadProtos.SecureBulkLoadService.class,channel);
    ServerRpcController controller=new ServerRpcController();
    BlockingRpcCallback<SecureBulkLoadProtos.PrepareBulkLoadResponse> rpcCallback=new BlockingRpcCallback<SecureBulkLoadProtos.PrepareBulkLoadResponse>();
    SecureBulkLoadProtos.PrepareBulkLoadRequest request=SecureBulkLoadProtos.PrepareBulkLoadRequest.newBuilder().setTableName(ProtobufUtil.toProtoTableName(tableName)).build();
    instance.prepareBulkLoad(controller,request,rpcCallback);
    SecureBulkLoadProtos.PrepareBulkLoadResponse response=rpcCallback.get();
    if (controller.failedOnException()) {
      throw controller.getFailedOn();
    }
    return response.getBulkToken();
  }
 catch (  Throwable throwable) {
    throw new IOException(throwable);
  }
}
