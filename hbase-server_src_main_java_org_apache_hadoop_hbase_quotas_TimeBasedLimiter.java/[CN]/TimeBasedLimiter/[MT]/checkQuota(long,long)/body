{
  long now=EnvironmentEdgeManager.currentTime();
  long lastTs=Math.max(readLastTs,writeLastTs);
  if (!reqsLimiter.canExecute(now,lastTs)) {
    ThrottlingException.throwNumRequestsExceeded(reqsLimiter.waitInterval());
  }
  if (!reqSizeLimiter.canExecute(now,lastTs,writeSize + readSize)) {
    ThrottlingException.throwNumRequestsExceeded(reqSizeLimiter.waitInterval(writeSize + readSize));
  }
  if (writeSize > 0) {
    if (!writeReqsLimiter.canExecute(now,writeLastTs)) {
      ThrottlingException.throwNumWriteRequestsExceeded(writeReqsLimiter.waitInterval());
    }
    if (!writeSizeLimiter.canExecute(now,writeLastTs,writeSize)) {
      ThrottlingException.throwWriteSizeExceeded(writeSizeLimiter.waitInterval(writeSize));
    }
  }
  if (readSize > 0) {
    if (!readReqsLimiter.canExecute(now,readLastTs)) {
      ThrottlingException.throwNumReadRequestsExceeded(readReqsLimiter.waitInterval());
    }
    if (!readSizeLimiter.canExecute(now,readLastTs,readSize)) {
      ThrottlingException.throwReadSizeExceeded(readSizeLimiter.waitInterval(readSize));
    }
  }
}
