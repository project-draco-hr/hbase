{
  String encodedName=state.getRegion().getEncodedName();
  RegionPlan plan;
synchronized (regionPlans) {
    plan=regionPlans.get(encodedName);
    if (plan == null) {
      LOG.debug("No previous transition plan for " + state.getRegion().getRegionNameAsString() + " so generating a random one; "+ serverManager.countOfRegionServers()+ " (online="+ serverManager.getOnlineServers().size()+ ") available servers");
      plan=new RegionPlan(state.getRegion(),null,LoadBalancer.randomAssignment(serverManager.getOnlineServersList()));
      regionPlans.put(encodedName,plan);
    }
 else {
      LOG.debug("Using preexisting plan=" + plan);
    }
  }
  return plan;
}
