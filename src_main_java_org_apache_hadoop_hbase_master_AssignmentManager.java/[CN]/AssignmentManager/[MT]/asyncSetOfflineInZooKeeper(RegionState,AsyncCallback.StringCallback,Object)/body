{
  if (!state.isClosed() && !state.isOffline()) {
    new RuntimeException("Unexpected state trying to OFFLINE; " + state);
    this.master.abort("Unexpected state trying to OFFLINE; " + state,new IllegalStateException());
    return false;
  }
  state.update(RegionState.State.OFFLINE);
  try {
    ZKAssign.asyncCreateNodeOffline(master.getZooKeeper(),state.getRegion(),this.master.getServerName(),cb,ctx);
  }
 catch (  KeeperException e) {
    master.abort("Unexpected ZK exception creating/setting node OFFLINE",e);
    return false;
  }
  return true;
}
