{
  long startTime=System.currentTimeMillis();
  long remaining=timeout;
  boolean stillInTransition=true;
synchronized (regionsInTransition) {
    while (regionsInTransition.size() > 0 && !this.master.isStopped() && remaining > 0 && stillInTransition) {
      int count=0;
      for (      RegionState rs : regionsInTransition.values()) {
        if (regions.contains(rs.getRegion())) {
          count++;
          break;
        }
      }
      if (count == 0) {
        stillInTransition=false;
        break;
      }
      regionsInTransition.wait(remaining);
      remaining=timeout - (System.currentTimeMillis() - startTime);
    }
  }
  return stillInTransition;
}
