{
  SequenceFile.Reader reader=new SequenceFile.Reader(fs,p,conf);
  ArrayList<K> parts=new ArrayList<K>();
  K key=ReflectionUtils.newInstance(keyClass,conf);
  NullWritable value=NullWritable.get();
  while (reader.next(key,value)) {
    parts.add(key);
    key=ReflectionUtils.newInstance(keyClass,conf);
  }
  reader.close();
  return parts.toArray((K[])Array.newInstance(keyClass,parts.size()));
}
