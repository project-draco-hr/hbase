{
  boolean done=false;
  while (!done) {
    Thread.sleep(1);
    ZKAssign.blockUntilNoRIT(TEST_UTIL.getZooKeeperWatcher());
    if (!isAllRegionsOnline())     continue;
    if (TEST_UTIL.getMiniHBaseCluster().getMaster().getAssignmentManager().getRegionStates().isRegionsInTransition())     continue;
    done=true;
    for (    JVMClusterUtil.RegionServerThread rs : TEST_UTIL.getMiniHBaseCluster().getLiveRegionServerThreads()) {
      if (!rs.getRegionServer().getRegionsInTransitionInRS().isEmpty()) {
        done=false;
      }
      Threads.sleep(10);
    }
  }
}
