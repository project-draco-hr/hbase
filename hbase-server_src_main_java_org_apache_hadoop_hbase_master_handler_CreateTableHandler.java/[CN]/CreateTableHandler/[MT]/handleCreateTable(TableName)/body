{
  Path tempdir=fileSystemManager.getTempDir();
  FileSystem fs=fileSystemManager.getFileSystem();
  TableDescriptor underConstruction=new TableDescriptor(this.hTableDescriptor,TableState.State.ENABLING);
  Path tempTableDir=FSUtils.getTableDir(tempdir,tableName);
  new FSTableDescriptors(this.conf).createTableDescriptorForTableDirectory(tempTableDir,underConstruction,false);
  Path tableDir=FSUtils.getTableDir(fileSystemManager.getRootDir(),tableName);
  List<HRegionInfo> regionInfos=handleCreateHdfsRegions(tempdir,tableName);
  if (!fs.rename(tempTableDir,tableDir)) {
    throw new IOException("Unable to move table from temp=" + tempTableDir + " to hbase root="+ tableDir);
  }
  if (regionInfos != null && regionInfos.size() > 0) {
    addRegionsToMeta(regionInfos,hTableDescriptor.getRegionReplication());
    regionInfos=addReplicas(hTableDescriptor,regionInfos);
    if (hTableDescriptor.getRegionReplication() > 1) {
      ServerRegionReplicaUtil.setupRegionReplicaReplication(conf);
    }
    ModifyRegionUtils.assignRegions(assignmentManager,regionInfos);
  }
  assignmentManager.getTableStateManager().setTableState(tableName,TableState.State.ENABLED);
  ((HMaster)this.server).getTableDescriptors().get(tableName);
}
