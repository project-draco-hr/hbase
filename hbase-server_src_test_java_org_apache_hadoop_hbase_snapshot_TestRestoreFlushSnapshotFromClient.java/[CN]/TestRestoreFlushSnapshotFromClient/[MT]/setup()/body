{
  this.admin=UTIL.getHBaseAdmin();
  long tid=System.currentTimeMillis();
  tableName=Bytes.toBytes("testtb-" + tid);
  snapshotName0=Bytes.toBytes("snaptb0-" + tid);
  snapshotName1=Bytes.toBytes("snaptb1-" + tid);
  snapshotName2=Bytes.toBytes("snaptb2-" + tid);
  SnapshotTestingUtils.createTable(UTIL,tableName,FAMILY);
  HTable table=new HTable(UTIL.getConfiguration(),tableName);
  try {
    SnapshotTestingUtils.loadData(UTIL,table,500,FAMILY);
    snapshot0Rows=UTIL.countRows(table);
    LOG.info("=== before snapshot with 500 rows");
    logFSTree();
    admin.snapshot(Bytes.toString(snapshotName0),Bytes.toString(tableName),SnapshotDescription.Type.FLUSH);
    LOG.info("=== after snapshot with 500 rows");
    logFSTree();
    SnapshotTestingUtils.loadData(UTIL,table,500,FAMILY);
    snapshot1Rows=UTIL.countRows(table);
    LOG.info("=== before snapshot with 1000 rows");
    logFSTree();
    admin.snapshot(Bytes.toString(snapshotName1),Bytes.toString(tableName),SnapshotDescription.Type.FLUSH);
    LOG.info("=== after snapshot with 1000 rows");
    logFSTree();
  }
  finally {
    table.close();
  }
}
