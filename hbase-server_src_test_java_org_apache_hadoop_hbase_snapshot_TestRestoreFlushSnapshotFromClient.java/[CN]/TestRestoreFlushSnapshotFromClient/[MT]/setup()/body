{
  this.admin=TEST_UTIL.getHBaseAdmin();
  long tid=System.currentTimeMillis();
  tableName=Bytes.toBytes("testtb-" + tid);
  snapshotName0=Bytes.toBytes("snaptb0-" + tid);
  snapshotName1=Bytes.toBytes("snaptb1-" + tid);
  snapshotName2=Bytes.toBytes("snaptb2-" + tid);
  createTable(tableName,FAMILY);
  HTable table=new HTable(TEST_UTIL.getConfiguration(),tableName);
  loadData(table,500,FAMILY);
  snapshot0Rows=TEST_UTIL.countRows(table);
  LOG.info("=== before snapshot with 500 rows");
  logFSTree(FSUtils.getRootDir(TEST_UTIL.getConfiguration()));
  admin.snapshot(Bytes.toString(snapshotName0),Bytes.toString(tableName),SnapshotDescription.Type.FLUSH);
  LOG.info("=== after snapshot with 500 rows");
  logFSTree(FSUtils.getRootDir(TEST_UTIL.getConfiguration()));
  loadData(table,500,FAMILY);
  snapshot1Rows=TEST_UTIL.countRows(table);
  LOG.info("=== before snapshot with 1000 rows");
  logFSTree(FSUtils.getRootDir(TEST_UTIL.getConfiguration()));
  admin.snapshot(Bytes.toString(snapshotName1),Bytes.toString(tableName),SnapshotDescription.Type.FLUSH);
  LOG.info("=== after snapshot with 1000 rows");
  logFSTree(FSUtils.getRootDir(TEST_UTIL.getConfiguration()));
}
