{
  try {
    long rowKey;
    while ((rowKey=nextKeyToInsert.getAndIncrement()) < endKey) {
      long numColumns=minColumnsPerKey + Math.abs(random.nextLong()) % (maxColumnsPerKey - minColumnsPerKey);
      numKeys.addAndGet(1);
      if (isMultiPut) {
        multiPutInsertKey(rowKey,0,numColumns);
      }
 else {
        for (long col=0; col < numColumns; ++col) {
          insert(rowKey,col);
        }
      }
      if (trackInsertedKeys) {
        insertedKeys.add(rowKey);
      }
    }
  }
  finally {
    try {
      table.close();
    }
 catch (    IOException e) {
      LOG.error("Error closing table",e);
    }
    numThreadsWorking.decrementAndGet();
  }
}
