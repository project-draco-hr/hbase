{
  RegionScannerHolder rsh=scanners.remove(this.scannerName);
  if (rsh != null) {
    RegionScanner s=rsh.s;
    LOG.info("Scanner " + this.scannerName + " lease expired on region "+ s.getRegionInfo().getRegionNameAsString());
    try {
      HRegion region=getRegion(s.getRegionInfo().getRegionName());
      if (region != null && region.getCoprocessorHost() != null) {
        region.getCoprocessorHost().preScannerClose(s);
      }
      s.close();
      if (region != null && region.getCoprocessorHost() != null) {
        region.getCoprocessorHost().postScannerClose(s);
      }
    }
 catch (    IOException e) {
      LOG.error("Closing scanner for " + s.getRegionInfo().getRegionNameAsString(),e);
    }
  }
 else {
    LOG.info("Scanner " + this.scannerName + " lease expired");
  }
}
