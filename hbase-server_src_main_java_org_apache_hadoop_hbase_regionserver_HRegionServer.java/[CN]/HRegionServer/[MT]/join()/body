{
  Threads.shutdown(this.compactionChecker.getThread());
  Threads.shutdown(this.periodicFlusher.getThread());
  this.cacheFlusher.join();
  if (this.healthCheckChore != null) {
    Threads.shutdown(this.healthCheckChore.getThread());
  }
  if (this.spanReceiverHost != null) {
    this.spanReceiverHost.closeReceivers();
  }
  if (this.hlogRoller != null) {
    Threads.shutdown(this.hlogRoller.getThread());
  }
  if (this.metaHLogRoller != null) {
    Threads.shutdown(this.metaHLogRoller.getThread());
  }
  if (this.compactSplitThread != null) {
    this.compactSplitThread.join();
  }
  if (this.service != null)   this.service.shutdown();
  if (this.replicationSourceHandler != null && this.replicationSourceHandler == this.replicationSinkHandler) {
    this.replicationSourceHandler.stopReplicationService();
  }
 else   if (this.replicationSourceHandler != null) {
    this.replicationSourceHandler.stopReplicationService();
  }
 else   if (this.replicationSinkHandler != null) {
    this.replicationSinkHandler.stopReplicationService();
  }
}
