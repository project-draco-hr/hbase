{
  try {
    if (request.getRowCount() != 1) {
      throw new DoNotRetryIOException("lockRow supports only one row now, not " + request.getRowCount() + " rows");
    }
    requestCount.increment();
    HRegion region=getRegion(request.getRegion());
    byte[] row=request.getRow(0).toByteArray();
    try {
      Integer r=region.obtainRowLock(row);
      long lockId=addRowLock(r,region);
      LOG.debug("Row lock " + lockId + " explicitly acquired by client");
      LockRowResponse.Builder builder=LockRowResponse.newBuilder();
      builder.setLockId(lockId);
      return builder.build();
    }
 catch (    Throwable t) {
      throw convertThrowableToIOE(cleanup(t,"Error obtaining row lock (fsOk: " + this.fsOk + ")"));
    }
  }
 catch (  IOException ie) {
    throw new ServiceException(ie);
  }
}
