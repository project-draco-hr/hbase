{
  WAL wal;
  LogRoller roller=walRoller;
  if (regionInfo != null && regionInfo.isMetaTable()) {
    roller=ensureMetaWALRoller();
    wal=walFactory.getMetaWAL(regionInfo.getEncodedNameAsBytes());
  }
 else   if (regionInfo == null) {
    wal=walFactory.getWAL(UNSPECIFIED_REGION);
  }
 else {
    wal=walFactory.getWAL(regionInfo.getEncodedNameAsBytes());
  }
  roller.addWAL(wal);
  return wal;
}
