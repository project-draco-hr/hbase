{
  RegionServerStartupResponse result=null;
  ServerName masterServerName=getMaster();
  if (masterServerName == null)   return result;
  try {
    this.requestCount.set(0);
    LOG.info("Telling master at " + masterServerName + " that we are up "+ "with port="+ this.isa.getPort()+ ", startcode="+ this.startcode);
    long now=EnvironmentEdgeManager.currentTimeMillis();
    int port=this.isa.getPort();
    RegionServerStartupRequest.Builder request=RegionServerStartupRequest.newBuilder();
    request.setPort(port);
    request.setServerStartCode(this.startcode);
    request.setServerCurrentTime(now);
    result=this.hbaseMaster.regionServerStartup(null,request.build());
  }
 catch (  ServiceException se) {
    IOException ioe=ProtobufUtil.getRemoteException(se);
    if (ioe instanceof ClockOutOfSyncException) {
      LOG.fatal("Master rejected startup because clock is out of sync",ioe);
      throw ioe;
    }
 else {
      LOG.warn("error telling master we are up",se);
    }
  }
  return result;
}
