{
  if (this.nonceManagerChore != null) {
    Threads.shutdown(this.nonceManagerChore.getThread());
  }
  if (this.compactionChecker != null) {
    Threads.shutdown(this.compactionChecker.getThread());
  }
  if (this.periodicFlusher != null) {
    Threads.shutdown(this.periodicFlusher.getThread());
  }
  if (this.cacheFlusher != null) {
    this.cacheFlusher.join();
  }
  if (this.healthCheckChore != null) {
    Threads.shutdown(this.healthCheckChore.getThread());
  }
  if (this.spanReceiverHost != null) {
    this.spanReceiverHost.closeReceivers();
  }
  if (this.walRoller != null) {
    Threads.shutdown(this.walRoller.getThread());
  }
  final LogRoller metawalRoller=this.metawalRoller.get();
  if (metawalRoller != null) {
    Threads.shutdown(metawalRoller.getThread());
  }
  if (this.compactSplitThread != null) {
    this.compactSplitThread.join();
  }
  if (this.service != null)   this.service.shutdown();
  if (this.replicationSourceHandler != null && this.replicationSourceHandler == this.replicationSinkHandler) {
    this.replicationSourceHandler.stopReplicationService();
  }
 else {
    if (this.replicationSourceHandler != null) {
      this.replicationSourceHandler.stopReplicationService();
    }
    if (this.replicationSinkHandler != null) {
      this.replicationSinkHandler.stopReplicationService();
    }
  }
  if (this.storefileRefresher != null) {
    Threads.shutdown(this.storefileRefresher.getThread());
  }
}
