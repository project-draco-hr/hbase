{
  if (!region.getRegionInfo().isMetaTable()) {
    cacheFlusher.reclaimMemStoreMemory();
  }
  RowMutations rm=null;
  for (  ClientProtos.Action action : actions) {
    if (action.hasGet()) {
      throw new DoNotRetryIOException("Atomic put and/or delete only, not a Get=" + action.getGet());
    }
    MutationType type=action.getMutation().getMutateType();
    if (rm == null) {
      rm=new RowMutations(action.getMutation().getRow().toByteArray());
    }
switch (type) {
case PUT:
      rm.add(ProtobufUtil.toPut(action.getMutation(),cellScanner));
    break;
case DELETE:
  rm.add(ProtobufUtil.toDelete(action.getMutation(),cellScanner));
break;
default :
throw new DoNotRetryIOException("Atomic put and/or delete only, not " + type.name());
}
}
region.mutateRow(rm);
}
