{
  try {
    checkOpen();
    requestCount.increment();
    HRegion region=getRegion(request.getRegion());
    ServerRpcController execController=new ServerRpcController();
    Message result=region.execService(execController,request.getCall());
    if (execController.getFailedOn() != null) {
      throw execController.getFailedOn();
    }
    CoprocessorServiceResponse.Builder builder=CoprocessorServiceResponse.newBuilder();
    builder.setRegion(RequestConverter.buildRegionSpecifier(RegionSpecifierType.REGION_NAME,region.getRegionName()));
    builder.setValue(builder.getValueBuilder().setName(result.getClass().getName()).setValue(result.toByteString()));
    return builder.build();
  }
 catch (  IOException ie) {
    throw new ServiceException(ie);
  }
}
