{
  byte[] value="value".getBytes(UTF8_ENCODING);
  try {
    new HTable(conf,nosuchTable);
  }
 catch (  TableNotFoundException e) {
  }
catch (  IOException e) {
    e.printStackTrace();
    fail();
  }
  HTableDescriptor tableAdesc=new HTableDescriptor(tableAname.toString());
  tableAdesc.addFamily(column);
  HTableDescriptor tableBdesc=new HTableDescriptor(tableBname.toString());
  tableBdesc.addFamily(column);
  HBaseAdmin admin=new HBaseAdmin(conf);
  admin.createTable(tableAdesc);
  admin.createTable(tableBdesc);
  HTable a=new HTable(conf,tableAname);
  HTableDescriptor meta=a.getMetadata();
  assertTrue(meta.equals(tableAdesc));
  BatchUpdate batchUpdate=new BatchUpdate(row);
  batchUpdate.put(COLUMN_FAMILY,value);
  a.commit(batchUpdate);
  HTable newA=new HTable(conf,tableAname);
  HTable b=new HTable(conf,tableBname);
  Scanner s=newA.getScanner(COLUMN_FAMILY_ARRAY,EMPTY_START_ROW);
  try {
    for (    RowResult r : s) {
      batchUpdate=new BatchUpdate(r.getRow());
      for (      Map.Entry<Text,Cell> e : r.entrySet()) {
        batchUpdate.put(e.getKey(),e.getValue().getValue());
      }
      b.commit(batchUpdate);
    }
  }
  finally {
    s.close();
  }
  try {
    HTable anotherA=new HTable(conf,tableAname);
    anotherA.get(row,COLUMN_FAMILY);
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail();
  }
}
