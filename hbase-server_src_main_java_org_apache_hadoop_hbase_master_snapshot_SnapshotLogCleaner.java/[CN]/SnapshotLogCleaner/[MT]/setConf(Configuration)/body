{
  super.setConf(conf);
  try {
    long cacheRefreshPeriod=conf.getLong(HLOG_CACHE_REFRESH_PERIOD_CONF_KEY,DEFAULT_HLOG_CACHE_REFRESH_PERIOD);
    final FileSystem fs=FSUtils.getCurrentFileSystem(conf);
    Path rootDir=FSUtils.getRootDir(conf);
    cache=new SnapshotFileCache(fs,rootDir,cacheRefreshPeriod,cacheRefreshPeriod,"snapshot-log-cleaner-cache-refresher",new PathFilter(){
      @Override public boolean accept(      Path path){
        if (path.getName().equals(HConstants.HREGION_LOGDIR_NAME)) {
          try {
            if (!fs.isFile(path))             return true;
          }
 catch (          IOException e) {
            LOG.error("Couldn't reach fs to check:" + path + " is a directory, stopping!");
            SnapshotLogCleaner.this.stop("Couldn't reach FS to check if " + path + " was a directory");
          }
        }
        return false;
      }
    }
);
  }
 catch (  IOException e) {
    LOG.error("Failed to create snapshot log cleaner",e);
  }
}
