{
  super.setConf(conf);
  try {
    long cacheRefreshPeriod=conf.getLong(WAL_CACHE_REFRESH_PERIOD_CONF_KEY,DEFAULT_WAL_CACHE_REFRESH_PERIOD);
    final FileSystem fs=FSUtils.getCurrentFileSystem(conf);
    Path rootDir=FSUtils.getRootDir(conf);
    cache=new SnapshotFileCache(fs,rootDir,cacheRefreshPeriod,cacheRefreshPeriod,"snapshot-log-cleaner-cache-refresher",new SnapshotFileCache.SnapshotFileInspector(){
      public Collection<String> filesUnderSnapshot(      final Path snapshotDir) throws IOException {
        return SnapshotReferenceUtil.getWALNames(fs,snapshotDir);
      }
    }
);
  }
 catch (  IOException e) {
    LOG.error("Failed to create snapshot log cleaner",e);
  }
}
