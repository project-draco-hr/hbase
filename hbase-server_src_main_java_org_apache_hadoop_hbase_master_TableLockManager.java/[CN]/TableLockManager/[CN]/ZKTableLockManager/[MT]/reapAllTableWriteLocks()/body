{
  try {
    List<String> tableNames;
    try {
      tableNames=ZKUtil.listChildrenNoWatch(zkWatcher,zkWatcher.tableLockZNode);
    }
 catch (    KeeperException e) {
      LOG.error("Unexpected ZooKeeper error when listing children",e);
      throw new IOException("Unexpected ZooKeeper exception",e);
    }
    for (    String tableName : tableNames) {
      String tableLockZNode=ZKUtil.joinZNode(zkWatcher.tableLockZNode,tableName);
      ZKInterProcessReadWriteLock lock=new ZKInterProcessReadWriteLock(zkWatcher,tableLockZNode,null);
      lock.writeLock(null).reapAllLocks();
    }
  }
 catch (  IOException ex) {
    throw ex;
  }
catch (  Exception ex) {
    LOG.warn("Caught exception while reaping table write locks",ex);
  }
}
