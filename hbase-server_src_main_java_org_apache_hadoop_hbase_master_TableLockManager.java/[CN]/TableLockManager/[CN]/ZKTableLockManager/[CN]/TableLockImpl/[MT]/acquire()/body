{
  if (LOG.isDebugEnabled()) {
    LOG.debug("Attempt to acquire table " + (isShared ? "read" : "write") + " lock on :"+ tableNameStr+ " for:"+ purpose);
  }
  lock=createTableLock();
  try {
    if (lockTimeoutMs == -1) {
      lock.acquire();
    }
 else {
      if (!lock.tryAcquire(lockTimeoutMs)) {
        throw new LockTimeoutException("Timed out acquiring " + (isShared ? "read" : "write") + "lock for table:"+ tableNameStr+ "for:"+ purpose+ " after "+ lockTimeoutMs+ " ms.");
      }
    }
  }
 catch (  InterruptedException e) {
    LOG.warn("Interrupted acquiring a lock for " + tableNameStr,e);
    Thread.currentThread().interrupt();
    throw new InterruptedIOException("Interrupted acquiring a lock");
  }
  LOG.debug("Acquired table " + (isShared ? "read" : "write") + " lock on :"+ tableNameStr+ " for:"+ purpose);
}
