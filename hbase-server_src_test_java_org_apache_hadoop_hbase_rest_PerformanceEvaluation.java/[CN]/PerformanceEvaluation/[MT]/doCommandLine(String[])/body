{
  int errCode=-1;
  if (args.length < 1) {
    printUsage();
    return errCode;
  }
  try {
    for (int i=0; i < args.length; i++) {
      String cmd=args[i];
      if (cmd.equals("-h")) {
        printUsage();
        errCode=0;
        break;
      }
      final String nmr="--nomapred";
      if (cmd.startsWith(nmr)) {
        nomapred=true;
        continue;
      }
      final String rows="--rows=";
      if (cmd.startsWith(rows)) {
        R=Integer.parseInt(cmd.substring(rows.length()));
        continue;
      }
      final String rowsPerPut="--rowsPerPut=";
      if (cmd.startsWith(rowsPerPut)) {
        this.B=Integer.parseInt(cmd.substring(rowsPerPut.length()));
        continue;
      }
      final String host="--host=";
      if (cmd.startsWith(host)) {
        cluster.add(cmd.substring(host.length()));
        continue;
      }
      Class<? extends Test> cmdClass=determineCommandClass(cmd);
      if (cmdClass != null) {
        getArgs(i + 1,args);
        if (cluster.isEmpty()) {
          String s=conf.get("stargate.hostname","localhost");
          if (s.contains(":")) {
            cluster.add(s);
          }
 else {
            cluster.add(s,conf.getInt("stargate.port",8080));
          }
        }
        runTest(cmdClass);
        errCode=0;
        break;
      }
      printUsage();
      break;
    }
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
  return errCode;
}
