{
  String backupId=BackupRestoreConstants.BACKUPID_PREFIX + EnvironmentEdgeManager.currentTime();
  boolean isTargetExist=false;
  try {
    isTargetExist=HBackupFileSystem.checkPathExist(backupRootPath,conf);
  }
 catch (  IOException e) {
    String expMsg=e.getMessage();
    String newMsg=null;
    if (expMsg.contains("No FileSystem for scheme")) {
      newMsg="Unsupported filesystem scheme found in the backup target url. Error Message: " + newMsg;
      LOG.error(newMsg);
      throw new IOException(newMsg);
    }
 else {
      throw e;
    }
  }
catch (  RuntimeException e) {
    LOG.error(e.getMessage());
    throw e;
  }
  if (isTargetExist) {
    LOG.info("Using existing backup root dir: " + backupRootPath);
  }
 else {
    LOG.info("Backup root dir " + backupRootPath + " does not exist. Will be created.");
  }
  String tableList=tableListStr;
  try {
    requestBackup(backupId,backupType,tableList,backupRootPath,snapshot);
  }
 catch (  RuntimeException e) {
    String errMsg=e.getMessage();
    if (errMsg != null && (errMsg.startsWith("Non-existing tables found") || errMsg.startsWith("Snapshot is not found"))) {
      LOG.error(errMsg + ", please check your command");
      throw e;
    }
 else {
      throw e;
    }
  }
  return backupId;
}
