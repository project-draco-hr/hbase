{
  if (r == null || r.isEmpty())   return true;
  byte[] hriBytes=getBytes(r,HConstants.REGIONINFO_QUALIFIER);
  if (isMigrated(hriBytes))   return true;
  HRegionInfo090x hri090=getHRegionInfo090x(hriBytes);
  HTableDescriptor htd=hri090.getTableDesc();
  if (htd == null) {
    LOG.warn("A 090 HRI has null HTD? Continuing; " + hri090.toString());
    return true;
  }
  if (!this.htds.contains(htd)) {
    this.services.getMasterFileSystem().createTableDescriptor(htd);
    this.htds.add(htd);
  }
  HRegionInfo hri=new HRegionInfo(hri090);
  Put p=new Put(hri.getRegionName());
  p.add(HConstants.CATALOG_FAMILY,HConstants.REGIONINFO_QUALIFIER,Writables.getBytes(hri));
  checkSplit(r,p,HConstants.SPLITA_QUALIFIER);
  checkSplit(r,p,HConstants.SPLITB_QUALIFIER);
  MetaEditor.putToCatalogTable(this.services.getCatalogTracker(),p);
  LOG.info("Migrated " + Bytes.toString(p.getRow()));
  return true;
}
