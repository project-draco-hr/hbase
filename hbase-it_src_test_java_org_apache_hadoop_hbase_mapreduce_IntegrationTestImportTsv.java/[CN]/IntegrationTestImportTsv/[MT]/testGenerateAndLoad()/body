{
  LOG.info("Running test testGenerateAndLoad.");
  TableName table=TableName.valueOf(NAME + "-" + UUID.randomUUID());
  String cf="d";
  Path hfiles=new Path(util.getDataTestDirOnTestFS(table.getNameAsString()),"hfiles");
  String[] args={format("-D%s=%s",ImportTsv.BULK_OUTPUT_CONF_KEY,hfiles),format("-D%s=HBASE_ROW_KEY,HBASE_TS_KEY,%s:c1,%s:c2",ImportTsv.COLUMNS_CONF_KEY,cf,cf),format("-D%s=false",TestImportTsv.DELETE_AFTER_LOAD_CONF),table.getNameAsString()};
  util.createTable(table,new String[]{cf});
  Tool t=TestImportTsv.doMROnTableTest(util,cf,simple_tsv,args);
  doLoadIncrementalHFiles(hfiles,table);
  validateDeletedPartitionsFile(t.getConf());
  util.deleteTable(table);
  util.cleanupDataTestDirOnTestFS(table.getNameAsString());
  LOG.info("testGenerateAndLoad completed successfully.");
}
