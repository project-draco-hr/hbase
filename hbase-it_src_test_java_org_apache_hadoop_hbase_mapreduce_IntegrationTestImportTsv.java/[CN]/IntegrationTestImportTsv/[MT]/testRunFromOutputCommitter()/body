{
  LOG.info("Running test testRunFromOutputCommitter.");
  FileSystem fs=FileSystem.get(getConf());
  Path inputPath=new Path(util.getDataTestDirOnTestFS("parent"),"input.txt");
  Path outputPath=new Path(util.getDataTestDirOnTestFS("parent"),"output");
  FSDataOutputStream fout=null;
  try {
    fout=fs.create(inputPath,true);
    fout.write(Bytes.toBytes("testRunFromOutputCommitter\n"));
    LOG.debug(format("Wrote test data to file: %s",inputPath));
  }
  finally {
    if (fout != null) {
      fout.close();
    }
  }
  Job job=new Job(getConf(),NAME + ".testRunFromOutputCommitter - parent");
  job.setJarByClass(IntegrationTestImportTsv.class);
  job.setInputFormatClass(TextInputFormat.class);
  job.setOutputFormatClass(JobLaunchingOutputFormat.class);
  TextInputFormat.addInputPath(job,inputPath);
  JobLaunchingOutputFormat.setOutputPath(job,outputPath);
  TableMapReduceUtil.addDependencyJars(job);
  addTestDependencyJars(job.getConfiguration());
  LOG.info("testRunFromOutputCommitter: launching parent job.");
  assertTrue(job.waitForCompletion(true));
  LOG.info("testRunFromOutputCommitter completed successfully.");
}
