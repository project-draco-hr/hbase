{
  this.fs=fs;
  this.dir=dir;
  this.conf=conf;
  this.logSeqNum=0;
  if (fs.exists(dir)) {
    throw new IOException("Target HLog directory already exists: " + dir);
  }
  fs.mkdirs(dir);
  rollWriter();
}
