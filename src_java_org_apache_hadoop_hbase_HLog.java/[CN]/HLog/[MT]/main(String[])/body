{
  if (args.length < 1) {
    System.err.println("Usage: java org.apache.hbase.HLog <logfile>");
    System.exit(-1);
  }
  Configuration conf=new HBaseConfiguration();
  FileSystem fs=FileSystem.get(conf);
  Path logfile=new Path(args[0]);
  if (!fs.exists(logfile)) {
    throw new FileNotFoundException(args[0] + " does not exist");
  }
  if (!fs.isFile(logfile)) {
    throw new IOException(args[0] + " is not a file");
  }
  Reader log=new SequenceFile.Reader(fs,logfile,conf);
  try {
    HLogKey key=new HLogKey();
    HLogEdit val=new HLogEdit();
    while (log.next(key,val)) {
      System.out.println(key.toString() + " " + val.toString());
    }
  }
  finally {
    log.close();
  }
}
