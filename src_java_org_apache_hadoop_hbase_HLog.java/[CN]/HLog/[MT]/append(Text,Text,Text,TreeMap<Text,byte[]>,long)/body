{
  if (closed) {
    throw new IOException("Cannot append; log is closed");
  }
  long seqNum[]=obtainSeqNum(columns.size());
  if (regionToLastFlush.get(regionName) == null) {
    regionToLastFlush.put(regionName,seqNum[0]);
  }
  int counter=0;
  for (Iterator<Text> it=columns.keySet().iterator(); it.hasNext(); ) {
    Text column=it.next();
    byte[] val=columns.get(column);
    HLogKey logKey=new HLogKey(regionName,tableName,row,seqNum[counter++]);
    HLogEdit logEdit=new HLogEdit(column,val,timestamp);
    writer.append(logKey,logEdit);
    numEntries++;
  }
}
