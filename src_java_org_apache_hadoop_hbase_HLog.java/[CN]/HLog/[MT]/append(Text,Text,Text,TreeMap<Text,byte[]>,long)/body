{
  if (closed) {
    throw new IOException("Cannot append; log is closed");
  }
  long seqNum[]=obtainSeqNum(columns.size());
  lastSeqWritten.put(regionName,seqNum[seqNum.length - 1]);
  int counter=0;
  for (  Map.Entry<Text,byte[]> es : columns.entrySet()) {
    HLogKey logKey=new HLogKey(regionName,tableName,row,seqNum[counter++]);
    HLogEdit logEdit=new HLogEdit(es.getKey(),es.getValue(),timestamp);
    writer.append(logKey,logEdit);
    numEntries.getAndIncrement();
  }
}
