{
  if (closed) {
    return;
  }
  if (!this.insideCacheFlush) {
    throw new IOException("Impossible situation: inside " + "completeCacheFlush(), but 'insideCacheFlush' flag is false");
  }
  writer.append(new HLogKey(regionName,tableName,HLog.METAROW,logSeqId),new HLogEdit(HLog.METACOLUMN,HGlobals.completeCacheFlush.get(),System.currentTimeMillis()));
  numEntries.getAndIncrement();
  regionToLastFlush.put(regionName,logSeqId);
  insideCacheFlush=false;
  notifyAll();
}
