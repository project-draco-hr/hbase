{
  if (closed) {
    throw new IOException("Cannot append; log is closed");
  }
  long seqNum[]=obtainSeqNum(edits.size());
  if (!this.lastSeqWritten.containsKey(regionName)) {
    this.lastSeqWritten.put(regionName,Long.valueOf(seqNum[0]));
  }
  int counter=0;
  for (  Map.Entry<HStoreKey,byte[]> es : edits.entrySet()) {
    HStoreKey key=es.getKey();
    HLogKey logKey=new HLogKey(regionName,tableName,key.getRow(),seqNum[counter++]);
    HLogEdit logEdit=new HLogEdit(key.getColumn(),es.getValue(),key.getTimestamp());
    this.writer.append(logKey,logEdit);
    this.numEntries++;
  }
}
