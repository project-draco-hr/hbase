{
  this.encodingAlgo=encoding;
  Compression.Algorithm compressionAlgorithm=fileContext.getCompression() == null ? NONE : fileContext.getCompression();
  this.fileContext=fileContext;
  if (compressionAlgorithm != NONE) {
    compressor=compressionAlgorithm.getCompressor();
    compressedByteStream=new ByteArrayOutputStream();
    try {
      compressionStream=compressionAlgorithm.createPlainCompressionStream(compressedByteStream,compressor);
    }
 catch (    IOException e) {
      throw new RuntimeException("Could not create compression stream for algorithm " + compressionAlgorithm,e);
    }
  }
  dummyHeader=Preconditions.checkNotNull(headerBytes,"Please pass HConstants.HFILEBLOCK_DUMMY_HEADER instead of null for param headerBytes");
}
