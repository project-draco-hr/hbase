{
  try {
    checkOpen();
    requestCount.incrementAndGet();
    HRegion region=getRegion(request.getRegion());
    LOG.info("Flushing " + region.getRegionNameAsString());
    boolean shouldFlush=true;
    if (request.hasIfOlderThanTs()) {
      shouldFlush=region.getLastFlushTime() < request.getIfOlderThanTs();
    }
    FlushRegionResponse.Builder builder=FlushRegionResponse.newBuilder();
    if (shouldFlush) {
      builder.setFlushed(region.flushcache());
    }
    builder.setLastFlushTime(region.getLastFlushTime());
    return builder.build();
  }
 catch (  IOException ie) {
    throw new ServiceException(ie);
  }
}
