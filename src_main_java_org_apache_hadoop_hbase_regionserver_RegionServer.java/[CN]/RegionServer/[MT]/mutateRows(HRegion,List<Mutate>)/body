{
  Mutate firstMutate=mutates.get(0);
  if (!region.getRegionInfo().isMetaTable()) {
    cacheFlusher.reclaimMemStoreMemory();
  }
  byte[] row=firstMutate.getRow().toByteArray();
  RowMutations rm=new RowMutations(row);
  for (  Mutate mutate : mutates) {
    MutateType type=mutate.getMutateType();
switch (mutate.getMutateType()) {
case PUT:
      rm.add(ProtobufUtil.toPut(mutate));
    break;
case DELETE:
  rm.add(ProtobufUtil.toDelete(mutate));
break;
default :
throw new DoNotRetryIOException("mutate supports atomic put and/or delete, not " + type.name());
}
}
region.mutateRow(rm);
}
