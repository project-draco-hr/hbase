{
  LOG.debug("Deleting regions from META");
  MetaTableAccessor.deleteRegions(this.server.getShortCircuitConnection(),regions);
  MasterFileSystem mfs=this.masterServices.getMasterFileSystem();
  Path tempTableDir=mfs.moveTableToTemp(tableName);
  FileSystem fs=mfs.getFileSystem();
  for (  HRegionInfo hri : regions) {
    LOG.debug("Archiving region " + hri.getRegionNameAsString() + " from FS");
    HFileArchiver.archiveRegion(fs,mfs.getRootDir(),tempTableDir,HRegion.getRegionDir(tempTableDir,hri.getEncodedName()));
  }
  if (!fs.delete(tempTableDir,true)) {
    LOG.error("Couldn't delete " + tempTableDir);
  }
  LOG.debug("Table '" + tableName + "' archived!");
}
