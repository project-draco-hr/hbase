{
  MasterCoprocessorHost cpHost=((HMaster)this.server).getMasterCoprocessorHost();
  if (cpHost != null) {
    cpHost.preDeleteTableHandler(this.tableName);
  }
  waitRegionInTransition(regions);
  try {
    removeTableData(regions);
  }
  finally {
    LOG.debug("Removing '" + tableName + "' descriptor.");
    this.masterServices.getTableDescriptors().remove(tableName);
    AssignmentManager am=this.masterServices.getAssignmentManager();
    LOG.debug("Removing '" + tableName + "' from region states.");
    am.getRegionStates().tableDeleted(tableName);
    LOG.debug("Marking '" + tableName + "' as deleted.");
    am.getZKTable().setDeletedTable(tableName);
  }
  if (cpHost != null) {
    cpHost.postDeleteTableHandler(this.tableName);
  }
}
