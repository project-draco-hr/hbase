{
  byte[] left=l.getRowArray();
  int loffset=l.getRowOffset();
  int llength=l.getRowLength();
  byte[] right=r.getRowArray();
  int roffset=r.getRowOffset();
  int rlength=r.getRowLength();
  int leftDelimiter=getDelimiter(left,loffset,llength,HConstants.DELIMITER);
  int rightDelimiter=getDelimiter(right,roffset,rlength,HConstants.DELIMITER);
  if (leftDelimiter < 0 && rightDelimiter >= 0) {
    return -1;
  }
 else   if (rightDelimiter < 0 && leftDelimiter >= 0) {
    return 1;
  }
 else   if (leftDelimiter < 0 && rightDelimiter < 0) {
    return 0;
  }
  int result=Bytes.compareTo(left,loffset,leftDelimiter - loffset,right,roffset,rightDelimiter - roffset);
  if (result != 0) {
    return result;
  }
  leftDelimiter++;
  rightDelimiter++;
  int leftFarDelimiter=getRequiredDelimiterInReverse(left,leftDelimiter,llength - (leftDelimiter - loffset),HConstants.DELIMITER);
  int rightFarDelimiter=getRequiredDelimiterInReverse(right,rightDelimiter,rlength - (rightDelimiter - roffset),HConstants.DELIMITER);
  result=Bytes.compareTo(left,leftDelimiter,leftFarDelimiter - leftDelimiter,right,rightDelimiter,rightFarDelimiter - rightDelimiter);
  if (result != 0) {
    return result;
  }
  leftFarDelimiter++;
  rightFarDelimiter++;
  result=Bytes.compareTo(left,leftFarDelimiter,llength - (leftFarDelimiter - loffset),right,rightFarDelimiter,rlength - (rightFarDelimiter - roffset));
  return result;
}
