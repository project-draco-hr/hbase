{
  String mcAddress=conf.get(HConstants.STATUS_MULTICAST_ADDRESS,HConstants.DEFAULT_STATUS_MULTICAST_ADDRESS);
  int port=conf.getInt(HConstants.STATUS_MULTICAST_PORT,HConstants.DEFAULT_STATUS_MULTICAST_PORT);
  DatagramChannelFactory f=new OioDatagramChannelFactory(service);
  ConnectionlessBootstrap b=new ConnectionlessBootstrap(f);
  b.setPipeline(Channels.pipeline(new ProtobufEncoder()));
  channel=(DatagramChannel)b.bind(new InetSocketAddress(0));
  channel.getConfig().setReuseAddress(true);
  InetAddress ina;
  try {
    ina=InetAddress.getByName(mcAddress);
  }
 catch (  UnknownHostException e) {
    throw new IOException("Can't connect to " + mcAddress,e);
  }
  channel.joinGroup(ina);
  channel.connect(new InetSocketAddress(mcAddress,port));
}
