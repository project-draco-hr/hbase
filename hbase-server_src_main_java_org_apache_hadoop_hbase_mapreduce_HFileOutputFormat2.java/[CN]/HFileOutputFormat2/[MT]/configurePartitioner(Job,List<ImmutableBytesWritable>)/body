{
  FileSystem fs=FileSystem.get(job.getConfiguration());
  Path partitionsPath=new Path("/tmp","partitions_" + UUID.randomUUID());
  fs.makeQualified(partitionsPath);
  fs.deleteOnExit(partitionsPath);
  writePartitions(job.getConfiguration(),partitionsPath,splitPoints);
  job.setPartitionerClass(TotalOrderPartitioner.class);
  TotalOrderPartitioner.setPartitionFile(job.getConfiguration(),partitionsPath);
}
