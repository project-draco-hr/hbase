{
  final MasterCoprocessorHost cpHost=env.getMasterCoprocessorHost();
  if (cpHost != null) {
    user.doAs(new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
switch (state) {
case ADD_COLUMN_FAMILY_PRE_OPERATION:
          cpHost.preAddColumnHandler(tableName,cfDescriptor);
        break;
case ADD_COLUMN_FAMILY_POST_OPERATION:
      cpHost.postAddColumnHandler(tableName,cfDescriptor);
    break;
default :
  throw new UnsupportedOperationException(this + " unhandled state=" + state);
}
return null;
}
}
);
}
}
