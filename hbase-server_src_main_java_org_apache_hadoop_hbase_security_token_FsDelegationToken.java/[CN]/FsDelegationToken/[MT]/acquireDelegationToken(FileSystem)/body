{
  if (userProvider.isHadoopSecurityEnabled()) {
    this.fs=fs;
    userToken=userProvider.getCurrent().getToken("HDFS_DELEGATION_TOKEN",fs.getCanonicalServiceName());
    if (userToken == null) {
      hasForwardedToken=false;
      userToken=fs.getDelegationToken(renewer);
    }
 else {
      hasForwardedToken=true;
      LOG.info("Use the existing token: " + userToken);
    }
  }
}
