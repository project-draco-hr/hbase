{
  Call call=new Call(md,param,cells,returnType);
  Connection connection=getConnection(ticket,call,addr,rpcTimeout,this.codec,this.compressor);
  connection.writeRequest(call,priority);
synchronized (call) {
    while (!call.done) {
      if (connection.shouldCloseConnection.get()) {
        throw new IOException("Unexpected closed connection");
      }
      call.wait(1000);
    }
    if (call.error != null) {
      if (call.error instanceof RemoteException) {
        call.error.fillInStackTrace();
        throw call.error;
      }
      throw wrapException(addr,call.error);
    }
    return new Pair<Message,CellScanner>(call.response,call.cells);
  }
}
