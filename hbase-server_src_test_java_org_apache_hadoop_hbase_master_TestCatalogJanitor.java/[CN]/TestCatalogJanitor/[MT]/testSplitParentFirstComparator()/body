{
  SplitParentFirstComparator comp=new SplitParentFirstComparator();
  final HTableDescriptor htd=createHTableDescriptor();
  HRegionInfo rootRegion=new HRegionInfo(htd.getTableName(),HConstants.EMPTY_START_ROW,HConstants.EMPTY_END_ROW,true);
  HRegionInfo firstRegion=new HRegionInfo(htd.getTableName(),HConstants.EMPTY_START_ROW,Bytes.toBytes("bbb"),true);
  HRegionInfo lastRegion=new HRegionInfo(htd.getTableName(),Bytes.toBytes("bbb"),HConstants.EMPTY_END_ROW,true);
  assertTrue(comp.compare(rootRegion,rootRegion) == 0);
  assertTrue(comp.compare(firstRegion,firstRegion) == 0);
  assertTrue(comp.compare(lastRegion,lastRegion) == 0);
  assertTrue(comp.compare(rootRegion,firstRegion) < 0);
  assertTrue(comp.compare(rootRegion,lastRegion) < 0);
  assertTrue(comp.compare(firstRegion,lastRegion) < 0);
  HRegionInfo firstRegiona=new HRegionInfo(htd.getTableName(),HConstants.EMPTY_START_ROW,Bytes.toBytes("aaa"),true);
  HRegionInfo firstRegionb=new HRegionInfo(htd.getTableName(),Bytes.toBytes("aaa"),Bytes.toBytes("bbb"),true);
  HRegionInfo lastRegiona=new HRegionInfo(htd.getTableName(),Bytes.toBytes("bbb"),Bytes.toBytes("ddd"),true);
  HRegionInfo lastRegionb=new HRegionInfo(htd.getTableName(),Bytes.toBytes("ddd"),HConstants.EMPTY_END_ROW,true);
  assertTrue(comp.compare(firstRegiona,firstRegiona) == 0);
  assertTrue(comp.compare(firstRegionb,firstRegionb) == 0);
  assertTrue(comp.compare(rootRegion,firstRegiona) < 0);
  assertTrue(comp.compare(rootRegion,firstRegionb) < 0);
  assertTrue(comp.compare(firstRegion,firstRegiona) < 0);
  assertTrue(comp.compare(firstRegion,firstRegionb) < 0);
  assertTrue(comp.compare(firstRegiona,firstRegionb) < 0);
  assertTrue(comp.compare(lastRegiona,lastRegiona) == 0);
  assertTrue(comp.compare(lastRegionb,lastRegionb) == 0);
  assertTrue(comp.compare(rootRegion,lastRegiona) < 0);
  assertTrue(comp.compare(rootRegion,lastRegionb) < 0);
  assertTrue(comp.compare(lastRegion,lastRegiona) < 0);
  assertTrue(comp.compare(lastRegion,lastRegionb) < 0);
  assertTrue(comp.compare(lastRegiona,lastRegionb) < 0);
  assertTrue(comp.compare(firstRegiona,lastRegiona) < 0);
  assertTrue(comp.compare(firstRegiona,lastRegionb) < 0);
  assertTrue(comp.compare(firstRegionb,lastRegiona) < 0);
  assertTrue(comp.compare(firstRegionb,lastRegionb) < 0);
  HRegionInfo lastRegionaa=new HRegionInfo(htd.getTableName(),Bytes.toBytes("bbb"),Bytes.toBytes("ccc"),false);
  HRegionInfo lastRegionab=new HRegionInfo(htd.getTableName(),Bytes.toBytes("ccc"),Bytes.toBytes("ddd"),false);
  assertTrue(comp.compare(lastRegiona,lastRegionaa) < 0);
  assertTrue(comp.compare(lastRegiona,lastRegionab) < 0);
  assertTrue(comp.compare(lastRegionaa,lastRegionab) < 0);
}
