{
  LOG.info("Snapshot copy is starting.");
  backupContext.setPhase(BACKUPPHASE.SNAPSHOTCOPY);
  if (backupContext.isCancelled()) {
    return;
  }
  BackupCopyService copyService=BackupRestoreServiceFactory.getBackupCopyService(conf);
  float numOfSnapshots=backupContext.getSnapshotNames().size();
  LOG.debug("There are " + (int)numOfSnapshots + " snapshots to be copied.");
  for (  String table : backupContext.getTables()) {
    int res=0;
    String[] args=new String[4];
    args[0]="-snapshot";
    args[1]=backupContext.getSnapshotName(table);
    args[2]="-copy-to";
    args[3]=backupContext.getBackupStatus(table).getTargetDir();
    LOG.debug("Copy snapshot " + args[1] + " to "+ args[3]);
    res=copyService.copy(this,conf,BackupCopyService.Type.FULL,args);
    if (res != 0) {
      LOG.error("Exporting Snapshot " + args[1] + " failed with return code: "+ res+ ".");
      throw new IOException("Failed of exporting snapshot " + args[1] + " to "+ args[3]+ " with reason code "+ res);
    }
    LOG.info("Snapshot copy " + args[1] + " finished.");
  }
}
