{
  LOG.info("Incremental copy is starting.");
  backupContext.setPhase(BACKUPPHASE.INCREMENTAL_COPY);
  if (backupContext.isCancelled()) {
    return;
  }
  List<String> incrBackupFileList=backupContext.getIncrBackupFileList();
  String[] strArr=incrBackupFileList.toArray(new String[incrBackupFileList.size() + 1]);
  strArr[strArr.length - 1]=backupContext.getHLogTargetDir();
  BackupCopyService copyService=BackupRestoreServiceFactory.getBackupCopyService(conf);
  int res=copyService.copy(this,conf,BackupCopyService.Type.INCREMENTAL,strArr);
  if (res != 0) {
    LOG.error("Copy incremental log files failed with return code: " + res + ".");
    throw new IOException("Failed of Hadoop Distributed Copy from " + incrBackupFileList + " to "+ backupContext.getHLogTargetDir());
  }
  LOG.info("Incremental copy from " + incrBackupFileList + " to "+ backupContext.getHLogTargetDir()+ " finished.");
}
