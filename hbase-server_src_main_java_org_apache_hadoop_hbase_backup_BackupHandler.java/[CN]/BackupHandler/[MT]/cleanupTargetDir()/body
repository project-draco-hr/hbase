{
  try {
    LOG.debug("Trying to cleanup up target dir. Current backup phase: " + backupContext.getPhase());
    if (backupContext.getPhase().equals(BACKUPPHASE.SNAPSHOTCOPY) || backupContext.getPhase().equals(BACKUPPHASE.INCREMENTAL_COPY) || backupContext.getPhase().equals(BACKUPPHASE.STORE_MANIFEST)) {
      FileSystem outputFs=FileSystem.get(new Path(backupContext.getTargetRootDir()).toUri(),conf);
      for (      String table : backupContext.getTables()) {
        Path targetDirPath=new Path(HBackupFileSystem.getTableBackupDir(backupContext.getTargetRootDir(),backupContext.getBackupId(),table));
        if (outputFs.delete(targetDirPath,true)) {
          LOG.info("Cleaning up uncompleted backup data at " + targetDirPath.toString() + " done.");
        }
 else {
          LOG.info("No data has been copied to " + targetDirPath.toString() + ".");
        }
        Path tableDir=targetDirPath.getParent();
        FileStatus[] backups=FSUtils.listStatus(outputFs,tableDir);
        if (backups == null || backups.length == 0) {
          outputFs.delete(tableDir,true);
          LOG.debug(tableDir.toString() + " is empty, remove it.");
        }
      }
    }
  }
 catch (  IOException e1) {
    LOG.error("Cleaning up uncompleted backup data of " + backupContext.getBackupId() + " at "+ backupContext.getTargetRootDir()+ " failed due to "+ e1.getMessage()+ ".");
  }
}
