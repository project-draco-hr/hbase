{
  LOG.debug("Trying to delete snapshot for full backup.");
  Connection conn=null;
  Admin admin=null;
  try {
    conn=ConnectionFactory.createConnection(conf);
    admin=conn.getAdmin();
    for (    String snapshotName : backupCtx.getSnapshotNames()) {
      if (snapshotName == null) {
        continue;
      }
      LOG.debug("Trying to delete snapshot: " + snapshotName);
      admin.deleteSnapshot(snapshotName);
      LOG.debug("Deleting the snapshot " + snapshotName + " for backup "+ backupCtx.getBackupId()+ " succeeded.");
    }
  }
  finally {
    if (admin != null) {
      admin.close();
    }
    if (conn != null) {
      conn.close();
    }
  }
}
