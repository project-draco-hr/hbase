{
  DocumentBuilderFactory docBuilderFactory=DocumentBuilderFactory.newInstance();
  docBuilderFactory.setIgnoringComments(true);
  DocumentBuilder builder=null;
  Document doc=null;
  String timestamp=pathSegments.length >= 4 ? pathSegments[3] : null;
  try {
    builder=docBuilderFactory.newDocumentBuilder();
    doc=builder.parse(request.getInputStream());
  }
 catch (  javax.xml.parsers.ParserConfigurationException e) {
    throw new ServletException(e);
  }
catch (  org.xml.sax.SAXException e) {
    throw new ServletException(e);
  }
  BatchUpdate batchUpdate;
  try {
    Text key=new Text(row);
    batchUpdate=timestamp == null ? new BatchUpdate(key) : new BatchUpdate(key,Long.parseLong(timestamp));
    NodeList columns=doc.getElementsByTagName("column");
    for (int i=0; i < columns.getLength(); i++) {
      Element column=(Element)columns.item(i);
      Node name_node=column.getElementsByTagName("name").item(0);
      Text name=new Text(name_node.getFirstChild().getNodeValue());
      Node value_node=column.getElementsByTagName("value").item(0);
      byte[] value=new byte[0];
      if (value_node.getFirstChild() != null && value_node.getFirstChild().getNodeValue() != null) {
        value=org.apache.hadoop.hbase.util.Base64.decode(value_node.getFirstChild().getNodeValue());
      }
      batchUpdate.put(name,value);
    }
    table.commit(batchUpdate);
    response.setStatus(200);
  }
 catch (  Exception e) {
    throw new ServletException(e);
  }
}
