{
  HTableDescriptor[] tables=this.admin.listTables();
  HTableDescriptor descriptor=null;
  for (int i=0; i < tables.length; i++) {
    if (tables[i].getName().toString().equals(tableName)) {
      descriptor=tables[i];
      break;
    }
  }
  if (descriptor == null) {
    doNotFound(response,"Table not found!");
  }
 else {
    ContentType type=ContentType.getContentType(request.getHeader(ACCEPT));
switch (type) {
case XML:
      setResponseHeader(response,200,ContentType.XML.toString());
    XMLOutputter outputter=getXMLOutputter(response.getWriter());
  outputter.startTag("table");
doElement(outputter,"name",descriptor.getName().toString());
outputter.startTag("columnfamilies");
for (HColumnDescriptor e : descriptor.getFamilies()) {
outputter.startTag("columnfamily");
doElement(outputter,"name",Bytes.toString(e.getName()));
doElement(outputter,"compression",e.getCompression().toString());
doElement(outputter,"bloomfilter",Boolean.toString(e.isBloomfilter()));
doElement(outputter,"max-versions",Integer.toString(e.getMaxVersions()));
doElement(outputter,"maximum-cell-size",Integer.toString(e.getMaxValueLength()));
outputter.endTag();
}
outputter.endTag();
outputter.endTag();
outputter.endDocument();
outputter.getWriter().close();
break;
case PLAIN:
setResponseHeader(response,200,ContentType.PLAIN.toString());
PrintWriter out=response.getWriter();
out.print(descriptor.toString());
out.close();
break;
case MIME:
default :
doNotAcceptable(response,"Unsupported Accept Header Content: " + request.getHeader(CONTENT_TYPE));
}
}
}
