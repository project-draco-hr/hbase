{
  HConnection c=Mockito.mock(HConnection.class);
  Mockito.when(c.getConfiguration()).thenReturn(conf);
  Mockito.doNothing().when(c).close();
  final HRegionLocation loc=new HRegionLocation(HRegionInfo.FIRST_META_REGIONINFO,new ServerName("example.org",1234,0));
  Mockito.when(c.getRegionLocation((byte[])Mockito.any(),(byte[])Mockito.any(),Mockito.anyBoolean())).thenReturn(loc);
  Mockito.when(c.locateRegion((byte[])Mockito.any(),(byte[])Mockito.any())).thenReturn(loc);
  ClientProtos.ClientService.BlockingInterface hri=Mockito.mock(ClientProtos.ClientService.BlockingInterface.class);
  Mockito.when(hri.bulkLoadHFile((RpcController)Mockito.any(),(BulkLoadHFileRequest)Mockito.any())).thenThrow(new ServiceException(new IOException("injecting bulk load error")));
  Mockito.when(c.getClient(Mockito.any(ServerName.class))).thenReturn(hri);
  return c;
}
