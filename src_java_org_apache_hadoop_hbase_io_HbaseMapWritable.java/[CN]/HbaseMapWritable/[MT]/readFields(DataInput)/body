{
  this.instance.clear();
  int entries=in.readInt();
  for (int i=0; i < entries; i++) {
    byte[] key=Bytes.readByteArray(in);
    byte id=in.readByte();
    Class clazz=getClass(id);
    V value=null;
    if (clazz.equals(byte[].class)) {
      byte[] bytes=Bytes.readByteArray(in);
      value=(V)bytes;
    }
 else {
      Writable w=(Writable)ReflectionUtils.newInstance(clazz,getConf());
      w.readFields(in);
      value=(V)w;
    }
    this.instance.put(key,value);
  }
}
