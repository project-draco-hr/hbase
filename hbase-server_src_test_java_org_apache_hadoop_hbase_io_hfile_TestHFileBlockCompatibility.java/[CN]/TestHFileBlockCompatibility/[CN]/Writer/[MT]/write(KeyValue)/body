{
  expectState(State.WRITING);
  this.dataBlockEncoder.encode(kv,dataBlockEncodingCtx,this.userDataStream);
  this.unencodedDataSizeWritten+=kv.getLength();
  if (dataBlockEncodingCtx.getHFileContext().isIncludesMvcc()) {
    this.unencodedDataSizeWritten+=WritableUtils.getVIntSize(kv.getMvccVersion());
  }
}
