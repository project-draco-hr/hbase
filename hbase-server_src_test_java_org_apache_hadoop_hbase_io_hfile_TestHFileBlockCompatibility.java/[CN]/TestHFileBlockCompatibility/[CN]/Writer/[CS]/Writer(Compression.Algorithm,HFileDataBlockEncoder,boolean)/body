{
  compressAlgo=compressionAlgorithm == null ? NONE : compressionAlgorithm;
  this.dataBlockEncoder=dataBlockEncoder != null ? dataBlockEncoder : NoOpDataBlockEncoder.INSTANCE;
  defaultBlockEncodingCtx=new HFileBlockDefaultEncodingContext(compressionAlgorithm,null,DUMMY_HEADER);
  dataBlockEncodingCtx=this.dataBlockEncoder.newOnDiskDataBlockEncodingContext(compressionAlgorithm,DUMMY_HEADER);
  baosInMemory=new ByteArrayOutputStream();
  prevOffsetByType=new long[BlockType.values().length];
  for (int i=0; i < prevOffsetByType.length; ++i)   prevOffsetByType[i]=-1;
  this.includesMemstoreTS=includesMemstoreTS;
}
