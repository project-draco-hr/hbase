{
  super(dataBlockEncoder,meta);
  compressAlgo=meta.getCompression() == null ? NONE : meta.getCompression();
  this.dataBlockEncoder=dataBlockEncoder != null ? dataBlockEncoder : NoOpDataBlockEncoder.INSTANCE;
  defaultBlockEncodingCtx=new HFileBlockDefaultEncodingContext(null,DUMMY_HEADER,meta);
  dataBlockEncodingCtx=this.dataBlockEncoder.newDataBlockEncodingContext(DUMMY_HEADER,meta);
  baosInMemory=new ByteArrayOutputStream();
  prevOffsetByType=new long[BlockType.values().length];
  for (int i=0; i < prevOffsetByType.length; ++i)   prevOffsetByType[i]=-1;
}
