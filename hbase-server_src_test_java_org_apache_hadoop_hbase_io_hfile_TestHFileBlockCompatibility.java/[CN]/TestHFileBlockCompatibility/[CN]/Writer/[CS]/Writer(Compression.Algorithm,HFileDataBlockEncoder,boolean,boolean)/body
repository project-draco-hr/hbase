{
  compressAlgo=compressionAlgorithm == null ? NONE : compressionAlgorithm;
  this.dataBlockEncoder=dataBlockEncoder != null ? dataBlockEncoder : NoOpDataBlockEncoder.INSTANCE;
  meta=new HFileContextBuilder().withHBaseCheckSum(false).withIncludesMvcc(includesMemstoreTS).withIncludesTags(includesTag).withCompression(compressionAlgorithm).build();
  defaultBlockEncodingCtx=new HFileBlockDefaultEncodingContext(null,DUMMY_HEADER,meta);
  dataBlockEncodingCtx=this.dataBlockEncoder.newOnDiskDataBlockEncodingContext(DUMMY_HEADER,meta);
  baosInMemory=new ByteArrayOutputStream();
  prevOffsetByType=new long[BlockType.values().length];
  for (int i=0; i < prevOffsetByType.length; ++i)   prevOffsetByType[i]=-1;
}
