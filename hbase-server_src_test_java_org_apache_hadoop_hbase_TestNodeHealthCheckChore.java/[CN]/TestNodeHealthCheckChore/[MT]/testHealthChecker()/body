{
  Configuration config=getConfForNodeHealthScript();
  config.addResource(healthScriptFile.getName());
  String location=healthScriptFile.getAbsolutePath();
  long timeout=config.getLong(HConstants.HEALTH_SCRIPT_TIMEOUT,2000);
  HealthChecker checker=new HealthChecker();
  checker.init(location,timeout);
  String normalScript="echo \"I am all fine\"";
  createScript(normalScript,true);
  HealthReport report=checker.checkHealth();
  LOG.info("Health Status:" + report.getHealthReport());
  assertEquals(HealthCheckerExitStatus.SUCCESS,report.getStatus());
  String errorScript="echo ERROR" + eol + "echo \"Server not healthy\"";
  createScript(errorScript,true);
  report=checker.checkHealth();
  LOG.info("Health Status:" + report.getHealthReport());
  assertEquals(HealthCheckerExitStatus.FAILED,report.getStatus());
  String timeOutScript="sleep 4" + eol + "echo \"I am fine\"";
  createScript(timeOutScript,true);
  report=checker.checkHealth();
  LOG.info("Health Status:" + report.getHealthReport());
  assertEquals(HealthCheckerExitStatus.TIMED_OUT,report.getStatus());
  this.healthScriptFile.delete();
}
