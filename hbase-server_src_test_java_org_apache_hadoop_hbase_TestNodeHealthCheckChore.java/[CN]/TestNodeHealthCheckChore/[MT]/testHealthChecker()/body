{
  Configuration config=getConfForNodeHealthScript();
  config.addResource(healthScriptFile.getName());
  String location=healthScriptFile.getAbsolutePath();
  long timeout=config.getLong(HConstants.HEALTH_SCRIPT_TIMEOUT,100);
  String normalScript="echo \"I am all fine\"";
  createScript(normalScript,true);
  HealthChecker checker=new HealthChecker();
  checker.init(location,timeout);
  HealthReport report=checker.checkHealth();
  assertTrue(report.getStatus() == HealthCheckerExitStatus.SUCCESS);
  LOG.info("Health Status:" + checker);
  String errorScript="echo ERROR\n echo \"Server not healthy\"";
  createScript(errorScript,true);
  report=checker.checkHealth();
  assertTrue(report.getStatus() == HealthCheckerExitStatus.FAILED);
  LOG.info("Health Status:" + report.getHealthReport());
  String timeOutScript="sleep 4\n echo\"I am fine\"";
  createScript(timeOutScript,true);
  report=checker.checkHealth();
  assertTrue(report.getStatus() == HealthCheckerExitStatus.TIMED_OUT);
  LOG.info("Health Status:" + report.getHealthReport());
  healthScriptFile.delete();
}
