{
  Configuration config=getConfForNodeHealthScript();
  config.addResource(healthScriptFile.getName());
  String location=healthScriptFile.getAbsolutePath();
  long timeout=config.getLong(HConstants.HEALTH_SCRIPT_TIMEOUT,200);
  HealthChecker checker=new HealthChecker();
  checker.init(location,timeout);
  String normalScript="echo \"I am all fine\"";
  createScript(normalScript,true);
  HealthReport report=checker.checkHealth();
  assertEquals(HealthCheckerExitStatus.SUCCESS,report.getStatus());
  LOG.info("Health Status:" + checker);
  String errorScript="echo ERROR\n echo \"Server not healthy\"";
  createScript(errorScript,true);
  report=checker.checkHealth();
  assertEquals(HealthCheckerExitStatus.FAILED,report.getStatus());
  LOG.info("Health Status:" + report.getHealthReport());
  String timeOutScript="sleep 4\n echo\"I am fine\"";
  createScript(timeOutScript,true);
  report=checker.checkHealth();
  assertEquals(HealthCheckerExitStatus.TIMED_OUT,report.getStatus());
  LOG.info("Health Status:" + report.getHealthReport());
  healthScriptFile.delete();
}
