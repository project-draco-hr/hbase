{
  if ((path != null ? 1 : 0) + (ostream != null ? 1 : 0) != 1) {
    throw new AssertionError("Please specify exactly one of " + "filesystem/path or path");
  }
  if (path != null) {
    ostream=AbstractHFileWriter.createOutputStream(conf,fs,path,favoredNodes);
  }
  return createWriter(fs,path,ostream,blockSize,compression,encoder,comparator,checksumType,bytesPerChecksum,includeMVCCReadpoint);
}
