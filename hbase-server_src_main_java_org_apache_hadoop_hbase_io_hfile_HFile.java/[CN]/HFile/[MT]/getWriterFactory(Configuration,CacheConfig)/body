{
  SchemaMetrics.configureGlobally(conf);
  int version=getFormatVersion(conf);
switch (version) {
case 1:
    return new HFileWriterV1.WriterFactoryV1(conf,cacheConf);
case 2:
  return new HFileWriterV2.WriterFactoryV2(conf,cacheConf);
default :
throw new IllegalArgumentException("Cannot create writer for HFile " + "format version " + version);
}
}
