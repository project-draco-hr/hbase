{
  int version=getFormatVersion(conf);
switch (version) {
case 2:
    return new HFileWriterV2.WriterFactoryV2(conf,cacheConf);
case 3:
  return new HFileWriterV3.WriterFactoryV3(conf,cacheConf);
default :
throw new IllegalArgumentException("Cannot create writer for HFile " + "format version " + version);
}
}
