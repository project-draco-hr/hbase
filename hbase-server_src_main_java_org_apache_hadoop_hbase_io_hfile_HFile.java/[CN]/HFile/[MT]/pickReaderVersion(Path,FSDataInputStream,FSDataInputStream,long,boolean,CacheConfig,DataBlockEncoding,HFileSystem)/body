{
  FixedFileTrailer trailer=FixedFileTrailer.readFromStream(fsdis,size);
switch (trailer.getMajorVersion()) {
case 1:
    return new HFileReaderV1(path,trailer,fsdis,size,closeIStream,cacheConf);
case 2:
  return new HFileReaderV2(path,trailer,fsdis,fsdisNoFsChecksum,size,closeIStream,cacheConf,preferredEncodingInCache,hfs);
default :
throw new IOException("Cannot instantiate reader for HFile version " + trailer.getMajorVersion());
}
}
