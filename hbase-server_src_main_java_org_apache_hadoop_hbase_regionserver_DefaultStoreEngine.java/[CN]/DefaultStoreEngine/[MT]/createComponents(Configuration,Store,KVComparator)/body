{
  storeFileManager=new DefaultStoreFileManager(kvComparator,conf);
  String className=conf.get(DEFAULT_COMPACTOR_CLASS_KEY,DEFAULT_COMPACTOR_CLASS.getName());
  try {
    compactor=ReflectionUtils.instantiateWithCustomCtor(className,new Class[]{Configuration.class,Store.class},new Object[]{conf,store});
  }
 catch (  Exception e) {
    throw new IOException("Unable to load configured compactor '" + className + "'",e);
  }
  className=conf.get(DEFAULT_COMPACTION_POLICY_CLASS_KEY,DEFAULT_COMPACTION_POLICY_CLASS.getName());
  try {
    compactionPolicy=ReflectionUtils.instantiateWithCustomCtor(className,new Class[]{Configuration.class,StoreConfigInformation.class},new Object[]{conf,store});
  }
 catch (  Exception e) {
    throw new IOException("Unable to load configured compaction policy '" + className + "'",e);
  }
  className=conf.get(DEFAULT_STORE_FLUSHER_CLASS_KEY,DEFAULT_STORE_FLUSHER_CLASS.getName());
  try {
    storeFlusher=ReflectionUtils.instantiateWithCustomCtor(className,new Class[]{Configuration.class,Store.class},new Object[]{conf,store});
  }
 catch (  Exception e) {
    throw new IOException("Unable to load configured store flusher '" + className + "'",e);
  }
}
