{
  ManualEnvironmentEdge timeMachine=new ManualEnvironmentEdge();
  EnvironmentEdgeManager.injectEdge(timeMachine);
  timeMachine.setValue(now);
  DateTieredCompactionRequest request;
  if (isMajor) {
    for (    StoreFile file : candidates) {
      ((MockStoreFile)file).setIsMajor(true);
    }
    Assert.assertEquals(toCompact,((DateTieredCompactionPolicy)store.storeEngine.getCompactionPolicy()).shouldPerformMajorCompaction(candidates));
    request=(DateTieredCompactionRequest)((DateTieredCompactionPolicy)store.storeEngine.getCompactionPolicy()).selectMajorCompaction(candidates);
  }
 else {
    Assert.assertEquals(toCompact,((DateTieredCompactionPolicy)store.storeEngine.getCompactionPolicy()).needsCompaction(candidates,ImmutableList.<StoreFile>of()));
    request=(DateTieredCompactionRequest)((DateTieredCompactionPolicy)store.storeEngine.getCompactionPolicy()).selectMinorCompaction(candidates,false,false);
  }
  List<StoreFile> actual=Lists.newArrayList(request.getFiles());
  Assert.assertEquals(Arrays.toString(expectedFileSizes),Arrays.toString(getSizes(actual)));
  Assert.assertEquals(Arrays.toString(expectedBoundaries),Arrays.toString(request.getBoundaries().toArray()));
}
