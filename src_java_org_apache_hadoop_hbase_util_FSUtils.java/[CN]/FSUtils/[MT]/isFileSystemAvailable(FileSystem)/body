{
  boolean available=false;
  if (fs instanceof DistributedFileSystem) {
    try {
      if (((DistributedFileSystem)fs).getDataNodeStats().length > 0) {
        available=true;
      }
 else {
        LOG.fatal("file system unavailable: no data nodes");
      }
    }
 catch (    IOException e) {
      LOG.fatal("file system unavailable because: ",e);
    }
    try {
      if (!available) {
        fs.close();
      }
    }
 catch (    IOException e) {
      LOG.error("file system close",e);
    }
  }
 else {
    available=true;
  }
  return available;
}
