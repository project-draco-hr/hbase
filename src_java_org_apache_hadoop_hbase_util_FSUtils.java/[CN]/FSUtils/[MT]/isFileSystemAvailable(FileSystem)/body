{
  if (!(fs instanceof DistributedFileSystem)) {
    return true;
  }
  boolean available=false;
  DistributedFileSystem dfs=(DistributedFileSystem)fs;
  int maxTries=dfs.getConf().getInt("hbase.client.retries.number",3);
  Path root=new Path(dfs.getConf().get("hbase.dir","/"));
  for (int i=0; i < maxTries; i++) {
    IOException ex=null;
    try {
      if (dfs.exists(root)) {
        available=true;
        break;
      }
    }
 catch (    IOException e) {
      ex=e;
    }
    String exception="";
    if (ex != null) {
      exception=": " + ex.getMessage();
    }
    LOG.info("Failed exists test on " + root + " (Attempt "+ i+ ")"+ exception);
  }
  try {
    if (!available) {
      fs.close();
    }
  }
 catch (  IOException e) {
    LOG.error("file system close failed: ",e);
  }
  return available;
}
