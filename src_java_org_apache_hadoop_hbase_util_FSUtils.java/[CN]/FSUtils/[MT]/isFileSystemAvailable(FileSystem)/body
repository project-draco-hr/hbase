{
  if (!(fs instanceof DistributedFileSystem)) {
    return true;
  }
  String exception="";
  boolean available=false;
  DistributedFileSystem dfs=(DistributedFileSystem)fs;
  try {
    if (dfs.exists(new Path("/"))) {
      available=true;
    }
  }
 catch (  IOException e) {
    exception=e.getMessage();
  }
  try {
    if (!available) {
      LOG.info("Failed file system available test. Thread: " + Thread.currentThread().getName() + ": "+ exception);
      fs.close();
    }
  }
 catch (  Exception e) {
    LOG.error("file system close failed: ",e);
  }
  return available;
}
