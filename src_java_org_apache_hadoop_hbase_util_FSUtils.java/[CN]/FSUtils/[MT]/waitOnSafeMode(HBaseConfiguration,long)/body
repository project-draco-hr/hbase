{
  FileSystem fs=FileSystem.get(conf);
  if (!(fs instanceof DistributedFileSystem))   return;
  DistributedFileSystem dfs=(DistributedFileSystem)fs;
  while (dfs.getDataNodeStats().length == 0) {
    LOG.info("Waiting for dfs to come up...");
    try {
      Thread.sleep(wait);
    }
 catch (    InterruptedException e) {
    }
  }
  while (dfs.setSafeMode(FSConstants.SafeModeAction.SAFEMODE_GET)) {
    LOG.info("Waiting for dfs to exit safe mode...");
    try {
      Thread.sleep(wait);
    }
 catch (    InterruptedException e) {
    }
  }
}
