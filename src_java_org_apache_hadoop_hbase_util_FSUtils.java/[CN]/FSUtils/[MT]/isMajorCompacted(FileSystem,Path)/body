{
  FileStatus[] directories=fs.listStatus(hbaseRootDir,new DirFilter(fs));
  for (int i=0; i < directories.length; i++) {
    Path d=directories[i].getPath();
    if (d.getName().equals(HConstants.HREGION_LOGDIR_NAME))     continue;
    FileStatus[] tablesubdirectories=fs.listStatus(d,new DirFilter(fs));
    for (int j=0; j < tablesubdirectories.length; j++) {
      Path dd=tablesubdirectories[j].getPath();
      if (dd.equals(HConstants.HREGION_COMPACTIONDIR_NAME))       continue;
      FileStatus[] familydirectories=fs.listStatus(dd,new DirFilter(fs));
      for (int k=0; k < familydirectories.length; k++) {
        Path family=familydirectories[k].getPath();
        FileStatus[] familyStatus=fs.listStatus(family);
        if (familyStatus.length > 1) {
          LOG.debug(family.toString() + " has " + familyStatus.length+ " files.");
          return false;
        }
      }
    }
  }
  return true;
}
