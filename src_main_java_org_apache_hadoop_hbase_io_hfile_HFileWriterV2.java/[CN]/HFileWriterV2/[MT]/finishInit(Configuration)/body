{
  if (fsBlockWriter != null)   throw new IllegalStateException("finishInit called twice");
  fsBlockWriter=new HFileBlock.Writer(compressAlgo,blockEncoder,includeMemstoreTS,checksumType,bytesPerChecksum);
  boolean cacheIndexesOnWrite=cacheConf.shouldCacheIndexesOnWrite();
  dataBlockIndexWriter=new HFileBlockIndex.BlockIndexWriter(fsBlockWriter,cacheIndexesOnWrite ? cacheConf.getBlockCache() : null,cacheIndexesOnWrite ? name : null);
  dataBlockIndexWriter.setMaxChunkSize(HFileBlockIndex.getMaxChunkSize(conf));
  inlineBlockWriters.add(dataBlockIndexWriter);
  metaBlockIndexWriter=new HFileBlockIndex.BlockIndexWriter();
  LOG.debug("Initialized with " + cacheConf);
  if (isSchemaConfigured()) {
    schemaConfigurationChanged();
  }
}
