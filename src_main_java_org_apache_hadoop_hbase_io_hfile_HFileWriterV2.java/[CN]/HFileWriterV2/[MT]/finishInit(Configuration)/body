{
  if (fsBlockWriter != null)   throw new IllegalStateException("finishInit called twice");
  fsBlockWriter=new HFileBlock.Writer(compressAlgo);
  dataBlockIndexWriter=new HFileBlockIndex.BlockIndexWriter(fsBlockWriter,cacheIndexBlocksOnWrite ? blockCache : null,cacheIndexBlocksOnWrite ? name : null);
  dataBlockIndexWriter.setMaxChunkSize(HFileBlockIndex.getMaxChunkSize(conf));
  inlineBlockWriters.add(dataBlockIndexWriter);
  metaBlockIndexWriter=new HFileBlockIndex.BlockIndexWriter();
}
