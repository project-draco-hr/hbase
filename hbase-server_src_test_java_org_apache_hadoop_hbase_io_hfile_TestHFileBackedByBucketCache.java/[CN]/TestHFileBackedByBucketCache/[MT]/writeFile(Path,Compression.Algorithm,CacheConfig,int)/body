{
  List<Cell> cells=new ArrayList<Cell>(count);
  HFileContext context=new HFileContextBuilder().withBlockSize(BLOCKSIZE).withCompression(compressAlgo).build();
  try (HFile.Writer writer=new HFile.WriterFactory(conf,cacheConfig).withPath(fs,hfilePath).withFileContext(context).withComparator(CellComparator.COMPARATOR).create()){
    byte[] valueBytes=new byte[VALUE_SIZE];
    for (int i=0; i < valueBytes.length; i++)     valueBytes[i]='0';
    for (int i=0; i < count; ++i) {
      byte[] keyBytes=format(i);
      KeyValue keyValue=new KeyValue(keyBytes,HConstants.CATALOG_FAMILY,keyBytes,HConstants.LATEST_TIMESTAMP,valueBytes);
      writer.append(keyValue);
      cells.add(keyValue);
    }
  }
   return cells;
}
