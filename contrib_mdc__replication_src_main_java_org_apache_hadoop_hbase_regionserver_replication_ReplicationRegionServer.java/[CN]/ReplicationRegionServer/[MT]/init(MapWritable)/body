{
  super.init(c);
  String n=Thread.currentThread().getName();
  String repLogPathStr=ReplicationSink.getRepLogPath(getHServerInfo().getServerName());
  Path repLogPath=new Path(getRootDir(),repLogPathStr);
  Thread.UncaughtExceptionHandler handler=new Thread.UncaughtExceptionHandler(){
    public void uncaughtException(    final Thread t,    final Throwable e){
      abort();
      LOG.fatal("Set stop flag in " + t.getName(),e);
    }
  }
;
  if (this.isMaster) {
    Threads.setDaemonThreadRunning(this.replicationSource,n + ".replicationSource",handler);
  }
 else {
    this.replicationSink=new ReplicationSink(conf,super.stopRequested,repLogPath,getFileSystem(),getThreadWakeFrequency());
    Threads.setDaemonThreadRunning(this.replicationSink,n + ".replicationSink",handler);
  }
}
