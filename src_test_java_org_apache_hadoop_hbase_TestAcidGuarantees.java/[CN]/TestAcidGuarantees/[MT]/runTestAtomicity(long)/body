{
  createTableIfMissing();
  TestContext ctx=new TestContext(util.getConfiguration());
  byte row[]=Bytes.toBytes("test_row");
  List<AtomicityWriter> writers=Lists.newArrayList();
  for (int i=0; i < 5; i++) {
    AtomicityWriter writer=new AtomicityWriter(ctx,row,FAMILIES);
    writers.add(writer);
    ctx.addThread(writer);
  }
  List<AtomicityReader> readers=Lists.newArrayList();
  for (int i=0; i < 5; i++) {
    AtomicityReader reader=new AtomicityReader(ctx,row,FAMILIES);
    readers.add(reader);
    ctx.addThread(reader);
  }
  ctx.startThreads();
  ctx.waitFor(millisToRun);
  ctx.stop();
  LOG.info("Finished test. Writers:");
  for (  AtomicityWriter writer : writers) {
    LOG.info("  wrote " + writer.numWritten.get());
  }
  LOG.info("Readers:");
  for (  AtomicityReader reader : readers) {
    LOG.info("  read " + reader.numRead.get());
  }
}
