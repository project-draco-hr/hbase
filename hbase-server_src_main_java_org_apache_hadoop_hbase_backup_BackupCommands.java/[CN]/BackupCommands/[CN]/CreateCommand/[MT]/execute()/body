{
  if (cmdline == null || cmdline.getArgs() == null) {
    System.out.println("ERROR: missing arguments");
    System.out.println(CREATE_CMD_USAGE);
    System.exit(-1);
  }
  String[] args=cmdline.getArgs();
  if (args.length < 2 || args.length > 3) {
    System.out.println("ERROR: wrong number of arguments");
    System.out.println(CREATE_CMD_USAGE);
    System.exit(-1);
  }
  if (!BackupRestoreConstants.BACKUP_TYPE_FULL.equalsIgnoreCase(args[0]) && !BackupRestoreConstants.BACKUP_TYPE_INCR.equalsIgnoreCase(args[0])) {
    System.out.println("ERROR: invalid backup type");
    System.out.println(CREATE_CMD_USAGE);
    System.exit(-1);
  }
  String snapshot=cmdline.hasOption('s') ? cmdline.getOptionValue('s') : null;
  String tables=(args.length == 3) ? args[2] : null;
  try {
    BackupClient.create(args[0],args[1],tables,snapshot);
  }
 catch (  RuntimeException e) {
    System.out.println("ERROR: " + e.getMessage());
    System.exit(-1);
  }
}
