{
  String table="NoHdfsTable";
  setupTable(table);
  assertEquals(ROWKEYS.length,countRows());
  TEST_UTIL.getHBaseAdmin().flush(table);
  deleteRegion(conf,tbl.getTableDescriptor(),Bytes.toBytes(""),Bytes.toBytes("A"),false,false,true);
  deleteRegion(conf,tbl.getTableDescriptor(),Bytes.toBytes("A"),Bytes.toBytes("B"),false,false,true);
  deleteRegion(conf,tbl.getTableDescriptor(),Bytes.toBytes("B"),Bytes.toBytes("C"),false,false,true);
  deleteRegion(conf,tbl.getTableDescriptor(),Bytes.toBytes("C"),Bytes.toBytes(""),false,false,true);
  HBaseFsck hbck=doFsck(conf,false);
  assertErrors(hbck,new ERROR_CODE[]{ERROR_CODE.NOT_IN_HDFS,ERROR_CODE.NOT_IN_HDFS,ERROR_CODE.NOT_IN_HDFS,ERROR_CODE.NOT_IN_HDFS});
  assertEquals(0,hbck.getOverlapGroups(table).size());
  doFsck(conf,true);
  assertNoErrors(doFsck(conf,false));
  try {
    assertEquals(0,countRows());
  }
 catch (  IOException ioe) {
    return;
  }
  fail("Should have failed with IOException");
}
