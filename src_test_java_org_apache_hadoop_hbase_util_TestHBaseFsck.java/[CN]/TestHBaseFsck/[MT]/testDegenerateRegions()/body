{
  String table="tableDegenerateRegions";
  try {
    setupTable(table);
    assertNoErrors(doFsck(conf,false));
    HRegionInfo hriDupe=createRegion(conf,tbl.getTableDescriptor(),Bytes.toBytes("B"),Bytes.toBytes("B"));
    TEST_UTIL.getHBaseCluster().getMaster().assignRegion(hriDupe);
    TEST_UTIL.getHBaseCluster().getMaster().getAssignmentManager().waitForAssignment(hriDupe);
    HBaseFsck hbck=doFsck(conf,false);
    assertErrors(hbck,new ERROR_CODE[]{ERROR_CODE.DEGENERATE_REGION,ERROR_CODE.DUPE_STARTKEYS,ERROR_CODE.DUPE_STARTKEYS});
    assertEquals(2,hbck.getOverlapGroups(table).size());
  }
  finally {
    deleteTable(table);
  }
}
