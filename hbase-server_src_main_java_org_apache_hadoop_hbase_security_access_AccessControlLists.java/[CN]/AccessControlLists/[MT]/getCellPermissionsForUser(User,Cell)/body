{
  List<Permission> results=Lists.newArrayList();
  byte[] tags=CellUtil.getTagArray(cell);
  Iterator<Tag> tagsIterator=CellUtil.tagsIterator(tags,0,tags.length);
  while (tagsIterator.hasNext()) {
    Tag tag=tagsIterator.next();
    if (tag.getType() == ACL_TAG_TYPE) {
      ListMultimap<String,Permission> kvPerms=ProtobufUtil.toUsersAndPermissions(AccessControlProtos.UsersAndPermissions.newBuilder().mergeFrom(tag.getBuffer(),tag.getTagOffset(),tag.getTagLength()).build());
      List<Permission> userPerms=kvPerms.get(user.getShortName());
      if (userPerms != null) {
        results.addAll(userPerms);
      }
      String groupNames[]=user.getGroupNames();
      if (groupNames != null) {
        for (        String group : groupNames) {
          List<Permission> groupPerms=kvPerms.get(GROUP_PREFIX + group);
          if (results != null) {
            results.addAll(groupPerms);
          }
        }
      }
    }
  }
  return results;
}
