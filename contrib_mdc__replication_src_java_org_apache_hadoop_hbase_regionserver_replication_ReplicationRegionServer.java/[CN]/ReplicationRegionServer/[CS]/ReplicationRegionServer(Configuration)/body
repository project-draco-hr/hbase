{
  super(conf);
  this.zkHelper=new ReplicationZookeeperHelper(this.getZooKeeperWrapper(),this.conf,this.isReplicating);
  this.isMaster=zkHelper.isMaster();
  this.replicationSink=null;
  this.replicationSource=this.isMaster ? new ReplicationSource(this,super.stopRequested,this.isReplicating) : null;
}
