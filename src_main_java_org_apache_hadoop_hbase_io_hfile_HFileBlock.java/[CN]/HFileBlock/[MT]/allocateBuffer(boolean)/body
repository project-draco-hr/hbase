{
  int cksumBytes=totalChecksumBytes();
  int capacityNeeded=headerSize() + uncompressedSizeWithoutHeader + cksumBytes+ (extraBytes ? headerSize() : 0);
  ByteBuffer newBuf=ByteBuffer.allocate(capacityNeeded);
  System.arraycopy(buf.array(),buf.arrayOffset(),newBuf.array(),newBuf.arrayOffset(),headerSize());
  buf=newBuf;
  buf.limit(headerSize() + uncompressedSizeWithoutHeader + cksumBytes);
}
