{
  buf.rewind();
{
    BlockType blockTypeFromBuf=BlockType.read(buf);
    if (blockTypeFromBuf != blockType) {
      throw new IOException("Block type stored in the buffer: " + blockTypeFromBuf + ", block type field: "+ blockType);
    }
  }
  sanityCheckAssertion(buf.getInt(),onDiskSizeWithoutHeader,"onDiskSizeWithoutHeader");
  sanityCheckAssertion(buf.getInt(),uncompressedSizeWithoutHeader,"uncompressedSizeWithoutHeader");
  sanityCheckAssertion(buf.getLong(),prevBlockOffset,"prevBlocKOffset");
  int expectedBufLimit=uncompressedSizeWithoutHeader + HEADER_SIZE;
  if (buf.limit() != expectedBufLimit) {
    throw new AssertionError("Expected buffer limit " + expectedBufLimit + ", got "+ buf.limit());
  }
  if (buf.capacity() != uncompressedSizeWithoutHeader + HEADER_SIZE && buf.capacity() != uncompressedSizeWithoutHeader + 2 * HEADER_SIZE) {
    throw new AssertionError("Invalid buffer capacity: " + buf.capacity() + ", expected "+ (uncompressedSizeWithoutHeader + HEADER_SIZE)+ " or "+ (uncompressedSizeWithoutHeader + 2 * HEADER_SIZE));
  }
}
