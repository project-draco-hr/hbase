{
  if (compressAlgo != NONE) {
    ByteArrayOutputStream baos=new ByteArrayOutputStream();
    baos.write(DUMMY_HEADER);
    OutputStream compressingOutputStream=compressAlgo.createCompressionStream(baos,compressor,0);
    compressingOutputStream.write(uncompressedBytesWithHeader,HEADER_SIZE,uncompressedBytesWithHeader.length - HEADER_SIZE);
    compressingOutputStream.flush();
    onDiskBytesWithHeader=baos.toByteArray();
    putHeader(onDiskBytesWithHeader,0,onDiskBytesWithHeader.length,uncompressedBytesWithHeader.length);
  }
 else {
    onDiskBytesWithHeader=uncompressedBytesWithHeader;
  }
}
