{
  compressAlgo=compressionAlgorithm == null ? NONE : compressionAlgorithm;
  this.dataBlockEncoder=dataBlockEncoder != null ? dataBlockEncoder : new NoOpDataBlockEncoder();
  baosInMemory=new ByteArrayOutputStream();
  if (compressAlgo != NONE)   compressor=compressionAlgorithm.getCompressor();
  prevOffsetByType=new long[BlockType.values().length];
  for (int i=0; i < prevOffsetByType.length; ++i)   prevOffsetByType[i]=-1;
  this.includesMemstoreTS=includesMemstoreTS;
}
