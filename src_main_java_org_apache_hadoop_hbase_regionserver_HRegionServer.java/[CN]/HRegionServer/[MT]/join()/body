{
  Threads.shutdown(this.compactionChecker);
  Threads.shutdown(this.cacheFlusher);
  Threads.shutdown(this.hlogRoller);
  if (this.compactSplitThread != null) {
    this.compactSplitThread.join();
  }
  if (this.service != null)   this.service.shutdown();
  if (this.replicationSourceHandler != null && this.replicationSourceHandler == this.replicationSinkHandler) {
    this.replicationSourceHandler.stopReplicationService();
  }
 else   if (this.replicationSourceHandler != null) {
    this.replicationSourceHandler.stopReplicationService();
  }
 else   if (this.replicationSinkHandler != null) {
    this.replicationSinkHandler.stopReplicationService();
  }
}
