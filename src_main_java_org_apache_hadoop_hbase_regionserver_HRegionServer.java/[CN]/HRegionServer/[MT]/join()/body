{
  Threads.shutdown(this.compactionChecker.getThread());
  Threads.shutdown(this.cacheFlusher.getThread());
  if (this.hlogRoller != null) {
    Threads.shutdown(this.hlogRoller.getThread());
  }
  if (this.compactSplitThread != null) {
    this.compactSplitThread.join();
  }
  if (this.service != null)   this.service.shutdown();
  if (this.replicationSourceHandler != null && this.replicationSourceHandler == this.replicationSinkHandler) {
    this.replicationSourceHandler.stopReplicationService();
  }
 else   if (this.replicationSourceHandler != null) {
    this.replicationSourceHandler.stopReplicationService();
  }
 else   if (this.replicationSinkHandler != null) {
    this.replicationSinkHandler.stopReplicationService();
  }
}
