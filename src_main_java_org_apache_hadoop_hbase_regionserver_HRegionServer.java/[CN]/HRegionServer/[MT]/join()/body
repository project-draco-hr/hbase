{
  Threads.shutdown(this.majorCompactionChecker);
  Threads.shutdown(this.cacheFlusher);
  Threads.shutdown(this.hlogRoller);
  if (this.compactSplitThread != null) {
    this.compactSplitThread.join();
  }
  if (this.service != null)   this.service.shutdown();
  if (this.replicationHandler != null) {
    this.replicationHandler.join();
  }
}
