{
  checkOpen();
  int i=0;
  HRegion region=null;
  try {
    region=getRegion(regionName);
    if (!region.getRegionInfo().isMetaTable()) {
      this.cacheFlusher.reclaimMemStoreMemory();
    }
    int size=deletes.size();
    Integer[] locks=new Integer[size];
    for (    Delete delete : deletes) {
      final long startTime=System.nanoTime();
      this.requestCount.incrementAndGet();
      locks[i]=getLockFromId(delete.getLockId());
      region.delete(delete,locks[i],delete.getWriteToWAL());
      i++;
      this.metrics.deleteLatencies.update(System.nanoTime() - startTime);
    }
  }
 catch (  WrongRegionException ex) {
    LOG.debug("Batch deletes: " + i,ex);
    return i;
  }
catch (  NotServingRegionException ex) {
    return i;
  }
catch (  Throwable t) {
    throw convertThrowableToIOE(cleanup(t));
  }
  return -1;
}
