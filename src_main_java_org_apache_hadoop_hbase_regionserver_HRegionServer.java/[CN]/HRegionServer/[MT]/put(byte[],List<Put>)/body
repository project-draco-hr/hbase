{
  checkOpen();
  HRegion region=null;
  int i=0;
  final long startTime=System.nanoTime();
  try {
    region=getRegion(regionName);
    if (!region.getRegionInfo().isMetaTable()) {
      this.cacheFlusher.reclaimMemStoreMemory();
    }
    @SuppressWarnings("unchecked") Pair<Put,Integer>[] putsWithLocks=new Pair[puts.size()];
    for (    Put p : puts) {
      Integer lock=getLockFromId(p.getLockId());
      putsWithLocks[i++]=new Pair<Put,Integer>(p,lock);
    }
    this.requestCount.addAndGet(puts.size());
    OperationStatus codes[]=region.put(putsWithLocks);
    for (i=0; i < codes.length; i++) {
      if (codes[i].getOperationStatusCode() != OperationStatusCode.SUCCESS) {
        return i;
      }
    }
    return -1;
  }
 catch (  Throwable t) {
    throw convertThrowableToIOE(cleanup(t));
  }
 finally {
    final long totalTime=System.nanoTime() - startTime;
    final long putCount=i;
    final long perPutTime=totalTime / putCount;
    for (int request=0; request < putCount; request++) {
      this.metrics.putLatencies.update(perPutTime);
    }
  }
}
