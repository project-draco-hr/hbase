{
  ServerName masterServerName=null;
  long previousLogTime=0;
  while ((masterServerName=this.masterAddressManager.getMasterAddress()) == null) {
    if (!keepLooping())     return null;
    if (System.currentTimeMillis() > (previousLogTime + 1000)) {
      LOG.debug("No master found; retry");
      previousLogTime=System.currentTimeMillis();
    }
    try {
      Thread.sleep(100);
    }
 catch (    InterruptedException ignored) {
    }
  }
  InetSocketAddress isa=new InetSocketAddress(masterServerName.getHostname(),masterServerName.getPort());
  HMasterRegionInterface master=null;
  while (keepLooping() && master == null) {
    LOG.info("Attempting connect to Master server at " + this.masterAddressManager.getMasterAddress());
    try {
      master=(HMasterRegionInterface)HBaseRPC.waitForProxy(HMasterRegionInterface.class,HMasterRegionInterface.VERSION,isa,this.conf,-1,this.rpcTimeout,this.rpcTimeout);
    }
 catch (    IOException e) {
      e=e instanceof RemoteException ? ((RemoteException)e).unwrapRemoteException() : e;
      if (e instanceof ServerNotRunningYetException) {
        if (System.currentTimeMillis() > (previousLogTime + 1000)) {
          LOG.info("Master isn't available yet, retrying");
          previousLogTime=System.currentTimeMillis();
        }
      }
 else {
        if (System.currentTimeMillis() > (previousLogTime + 1000)) {
          LOG.warn("Unable to connect to master. Retrying. Error was:",e);
          previousLogTime=System.currentTimeMillis();
        }
      }
      try {
        Thread.sleep(200);
      }
 catch (      InterruptedException ignored) {
      }
    }
  }
  LOG.info("Connected to master at " + isa);
  this.hbaseMaster=master;
  return masterServerName;
}
