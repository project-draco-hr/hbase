{
  HServerAddress masterAddress=null;
  while ((masterAddress=masterAddressManager.getMasterAddress()) == null) {
    if (stopped) {
      return null;
    }
    LOG.debug("No master found, will retry");
    sleeper.sleep();
  }
  HMasterRegionInterface master=null;
  while (!stopped && master == null) {
    try {
      master=(HMasterRegionInterface)HBaseRPC.waitForProxy(HMasterRegionInterface.class,HMasterRegionInterface.VERSION,masterAddress.getInetSocketAddress(),this.conf,-1,this.rpcTimeout,this.rpcTimeout);
    }
 catch (    IOException e) {
      e=e instanceof RemoteException ? ((RemoteException)e).unwrapRemoteException() : e;
      if (e instanceof ServerNotRunningException) {
        LOG.info("Master isn't available yet, retrying");
      }
 else {
        LOG.warn("Unable to connect to master. Retrying. Error was:",e);
      }
      sleeper.sleep();
    }
  }
  LOG.info("Connected to master at " + masterAddress);
  this.hbaseMaster=master;
  return masterAddress;
}
