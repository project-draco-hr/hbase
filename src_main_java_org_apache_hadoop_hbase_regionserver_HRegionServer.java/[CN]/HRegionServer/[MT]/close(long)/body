{
  try {
    checkOpen();
    requestCount.incrementAndGet();
    String scannerName=String.valueOf(scannerId);
    RegionScanner s=scanners.get(scannerName);
    HRegion region=null;
    if (s != null) {
      region=getRegion(s.getRegionInfo().getRegionName());
      if (region != null && region.getCoprocessorHost() != null) {
        if (region.getCoprocessorHost().preScannerClose(s)) {
          return;
        }
      }
    }
    s=scanners.remove(scannerName);
    if (s != null) {
      s.close();
      this.leases.cancelLease(scannerName);
      if (region != null && region.getCoprocessorHost() != null) {
        region.getCoprocessorHost().postScannerClose(s);
      }
    }
  }
 catch (  Throwable t) {
    throw convertThrowableToIOE(cleanup(t));
  }
}
