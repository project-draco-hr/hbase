{
  this.zooKeeper=new ZooKeeperWatcher(conf,REGIONSERVER + ":" + this.isa.getPort(),this);
  this.masterAddressManager=new MasterAddressTracker(this.zooKeeper,this);
  this.masterAddressManager.start();
  blockAndCheckIfStopped(this.masterAddressManager);
  this.clusterStatusTracker=new ClusterStatusTracker(this.zooKeeper,this);
  this.clusterStatusTracker.start();
  blockAndCheckIfStopped(this.clusterStatusTracker);
  this.catalogTracker=new CatalogTracker(this.zooKeeper,this.connection,this,this.conf.getInt("hbase.regionserver.catalog.timeout",Integer.MAX_VALUE));
  catalogTracker.start();
  this.splitLogWorker=new SplitLogWorker(this.zooKeeper,this.getConfiguration(),this.getServerName().toString());
  splitLogWorker.start();
}
