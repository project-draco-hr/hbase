{
  checkOpen();
  checkIfRegionInTransition(region,OPEN);
  HRegion onlineRegion=this.getFromOnlineRegions(region.getEncodedName());
  if (null != onlineRegion) {
    Pair<HRegionInfo,ServerName> p=MetaReader.getRegion(this.catalogTracker,region.getRegionName());
    if (this.getServerName().equals(p.getSecond())) {
      LOG.warn("Attempted open of " + region.getEncodedName() + " but already online on this server");
      return RegionOpeningState.ALREADY_OPENED;
    }
 else {
      LOG.warn("The region " + region.getEncodedName() + " is online on this server but META does not have this server.");
      this.removeFromOnlineRegions(region.getEncodedName());
    }
  }
  LOG.info("Received request to open region: " + region.getRegionNameAsString());
  this.regionsInTransitionInRS.putIfAbsent(region.getEncodedNameAsBytes(),true);
  HTableDescriptor htd=this.tableDescriptors.get(region.getTableName());
  if (region.isRootRegion()) {
    this.service.submit(new OpenRootHandler(this,this,region,htd,versionOfOfflineNode));
  }
 else   if (region.isMetaRegion()) {
    this.service.submit(new OpenMetaHandler(this,this,region,htd,versionOfOfflineNode));
  }
 else {
    this.service.submit(new OpenRegionHandler(this,this,region,htd,versionOfOfflineNode));
  }
  return RegionOpeningState.OPENED;
}
