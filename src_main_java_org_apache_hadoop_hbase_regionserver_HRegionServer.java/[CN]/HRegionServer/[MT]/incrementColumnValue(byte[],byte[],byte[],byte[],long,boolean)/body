{
  checkOpen();
  if (regionName == null) {
    throw new IOException("Invalid arguments to incrementColumnValue " + "regionName is null");
  }
  requestCount.incrementAndGet();
  try {
    HRegion region=getRegion(regionName);
    if (region.getCoprocessorHost() != null) {
      Long amountVal=region.getCoprocessorHost().preIncrementColumnValue(row,family,qualifier,amount,writeToWAL);
      if (amountVal != null) {
        return amountVal.longValue();
      }
    }
    long retval=region.incrementColumnValue(row,family,qualifier,amount,writeToWAL);
    if (region.getCoprocessorHost() != null) {
      retval=region.getCoprocessorHost().postIncrementColumnValue(row,family,qualifier,amount,writeToWAL,retval);
    }
    return retval;
  }
 catch (  IOException e) {
    checkFileSystem();
    throw e;
  }
}
