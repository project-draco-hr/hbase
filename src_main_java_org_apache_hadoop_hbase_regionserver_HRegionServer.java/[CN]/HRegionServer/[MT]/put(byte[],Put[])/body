{
  int i=0;
  checkOpen();
  HRegion region=null;
  boolean writeToWAL=true;
  try {
    region=getRegion(regionName);
    if (!region.getRegionInfo().isMetaTable()) {
      this.cacheFlusher.reclaimMemStoreMemory();
    }
    for (i=0; i < puts.length; i++) {
      this.requestCount.incrementAndGet();
      Integer lock=getLockFromId(puts[i].getLockId());
      writeToWAL&=puts[i].getWriteToWAL();
      region.put(puts[i],lock);
    }
  }
 catch (  WrongRegionException ex) {
    LOG.debug("Batch puts: " + i,ex);
    return i;
  }
catch (  NotServingRegionException ex) {
    LOG.debug("Batch puts interrupted at index=" + i + " because:"+ ex.getMessage());
    return i;
  }
catch (  Throwable t) {
    throw convertThrowableToIOE(cleanup(t));
  }
  return -1;
}
