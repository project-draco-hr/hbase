{
  TimeoutBlockingQueue<TestObject> queue=new TimeoutBlockingQueue<TestObject>(8,new TestObjectTimeoutRetriever());
  long[] timeouts=new long[]{500,200,700,300,600,600,200,800,500};
  for (int i=0; i < timeouts.length; ++i) {
    for (int j=0; j <= i; ++j) {
      queue.add(new TestObject(j,timeouts[j]));
      queue.dump();
    }
    long prev=0;
    for (int j=0; j <= i; ++j) {
      TestObject obj=queue.poll();
      assertTrue(obj.getTimeout() >= prev);
      prev=obj.getTimeout();
      queue.dump();
    }
  }
}
