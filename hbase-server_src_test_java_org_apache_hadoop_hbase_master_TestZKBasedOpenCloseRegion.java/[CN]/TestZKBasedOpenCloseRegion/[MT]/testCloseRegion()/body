{
  LOG.info("Running testCloseRegion");
  MiniHBaseCluster cluster=TEST_UTIL.getHBaseCluster();
  LOG.info("Number of region servers = " + cluster.getLiveRegionServerThreads().size());
  int rsIdx=0;
  HRegionServer regionServer=TEST_UTIL.getHBaseCluster().getRegionServer(rsIdx);
  HRegionInfo hri=getNonMetaRegion(ProtobufUtil.getOnlineRegions(regionServer.getRSRpcServices()));
  LOG.debug("Asking RS to close region " + hri.getRegionNameAsString());
  cluster.getMaster().assignmentManager.unassign(hri);
  while (!cluster.getMaster().assignmentManager.wasClosedHandlerCalled(hri)) {
    Threads.sleep(100);
  }
  LOG.info("Done with testCloseRegion");
}
