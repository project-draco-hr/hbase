{
  int maxThreads=conf.getInt("hbase.htable.threads.max",Integer.MAX_VALUE);
  if (maxThreads == 0) {
    maxThreads=1;
  }
  long keepAliveTime=conf.getLong("hbase.htable.threads.keepalivetime",60);
  ThreadPoolExecutor pool=new ThreadPoolExecutor(1,maxThreads,keepAliveTime,TimeUnit.SECONDS,new SynchronousQueue<Runnable>(),Threads.newDaemonThreadFactory("htable"));
  ((ThreadPoolExecutor)pool).allowCoreThreadTimeOut(true);
  return pool;
}
