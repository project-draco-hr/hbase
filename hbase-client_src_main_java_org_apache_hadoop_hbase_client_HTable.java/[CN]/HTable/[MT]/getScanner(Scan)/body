{
  if (scan.getBatch() > 0 && scan.isSmall()) {
    throw new IllegalArgumentException("Small scan should not be used with batching");
  }
  if (scan.getCaching() <= 0) {
    scan.setCaching(getScannerCaching());
  }
  if (scan.isReversed()) {
    if (scan.isSmall()) {
      return new ClientSmallReversedScanner(getConfiguration(),scan,getName(),this.connection,this.rpcCallerFactory,this.rpcControllerFactory,pool,tableConfiguration.getReplicaCallTimeoutMicroSecondScan());
    }
 else {
      return new ReversedClientScanner(getConfiguration(),scan,getName(),this.connection,this.rpcCallerFactory,this.rpcControllerFactory,pool,tableConfiguration.getReplicaCallTimeoutMicroSecondScan());
    }
  }
  if (scan.isSmall()) {
    return new ClientSmallScanner(getConfiguration(),scan,getName(),this.connection,this.rpcCallerFactory,this.rpcControllerFactory,pool,tableConfiguration.getReplicaCallTimeoutMicroSecondScan());
  }
 else {
    return new ClientScanner(getConfiguration(),scan,getName(),this.connection,this.rpcCallerFactory,this.rpcControllerFactory,pool,tableConfiguration.getReplicaCallTimeoutMicroSecondScan());
  }
}
