{
  final RetryingTimeTracker tracker=new RetryingTimeTracker();
  PayloadCarryingServerCallable<MultiResponse> callable=new PayloadCarryingServerCallable<MultiResponse>(connection,getName(),rm.getRow(),rpcControllerFactory){
    @Override public MultiResponse call(    int callTimeout) throws IOException {
      tracker.start();
      controller.setPriority(tableName);
      int remainingTime=tracker.getRemainingTime(callTimeout);
      if (remainingTime == 0) {
        throw new DoNotRetryIOException("Timeout for mutate row");
      }
      controller.setCallTimeout(remainingTime);
      try {
        CompareType compareType=CompareType.valueOf(compareOp.name());
        MultiRequest request=RequestConverter.buildMutateRequest(getLocation().getRegionInfo().getRegionName(),row,family,qualifier,new BinaryComparator(value),compareType,rm);
        ClientProtos.MultiResponse response=getStub().multi(controller,request);
        ClientProtos.RegionActionResult res=response.getRegionActionResultList().get(0);
        if (res.hasException()) {
          Throwable ex=ProtobufUtil.toException(res.getException());
          if (ex instanceof IOException) {
            throw (IOException)ex;
          }
          throw new IOException("Failed to checkAndMutate row: " + Bytes.toStringBinary(rm.getRow()),ex);
        }
        return ResponseConverter.getResults(request,response,controller.cellScanner());
      }
 catch (      ServiceException se) {
        throw ProtobufUtil.getRemoteException(se);
      }
    }
  }
;
  Object[] results=new Object[rm.getMutations().size()];
  AsyncRequestFuture ars=multiAp.submitAll(pool,tableName,rm.getMutations(),null,results,callable,operationTimeout);
  ars.waitUntilDone();
  if (ars.hasError()) {
    throw ars.getErrors();
  }
  return ((Result)results[0]).getExists();
}
