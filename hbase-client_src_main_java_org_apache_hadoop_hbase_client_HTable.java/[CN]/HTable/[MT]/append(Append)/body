{
  if (append.numFamilies() == 0) {
    throw new IOException("Invalid arguments to append, no columns specified");
  }
  NonceGenerator ng=this.connection.getNonceGenerator();
  final long nonceGroup=ng.getNonceGroup(), nonce=ng.newNonce();
  RegionServerCallable<Result> callable=new RegionServerCallable<Result>(this.connection,getName(),append.getRow()){
    public Result call(    int callTimeout) throws IOException {
      PayloadCarryingRpcController controller=rpcControllerFactory.newController();
      controller.setPriority(getTableName());
      controller.setCallTimeout(callTimeout);
      try {
        MutateRequest request=RequestConverter.buildMutateRequest(getLocation().getRegionInfo().getRegionName(),append,nonceGroup,nonce);
        MutateResponse response=getStub().mutate(controller,request);
        if (!response.hasResult())         return null;
        return ProtobufUtil.toResult(response.getResult(),controller.cellScanner());
      }
 catch (      ServiceException se) {
        throw ProtobufUtil.getRemoteException(se);
      }
    }
  }
;
  return rpcCallerFactory.<Result>newCaller().callWithRetries(callable,this.operationTimeout);
}
