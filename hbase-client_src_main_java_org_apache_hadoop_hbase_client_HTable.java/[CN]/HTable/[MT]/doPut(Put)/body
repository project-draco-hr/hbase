{
  if (ap.hasError()) {
    backgroundFlushCommits(true);
  }
  validatePut(put);
  currentWriteBufferSize+=put.heapSize();
  writeAsyncBuffer.add(put);
  while (currentWriteBufferSize > writeBufferSize) {
    backgroundFlushCommits(false);
  }
}
