{
  TableName tableName=TableName.NAMESPACE_TABLE_NAME;
  try {
    if (!MetaReader.tableExists(masterServices.getCatalogTracker(),tableName)) {
      LOG.info("Namespace table not found. Creating...");
      createNamespaceTable(masterServices);
    }
  }
 catch (  InterruptedException e) {
    throw new IOException("Wait for namespace table assignment interrupted",e);
  }
  table=new HTable(conf,tableName);
  zkNamespaceManager=new ZKNamespaceManager(masterServices.getZooKeeper());
  zkNamespaceManager.start();
  if (get(NamespaceDescriptor.DEFAULT_NAMESPACE.getName()) == null) {
    create(NamespaceDescriptor.DEFAULT_NAMESPACE);
  }
  if (get(NamespaceDescriptor.SYSTEM_NAMESPACE.getName()) == null) {
    create(NamespaceDescriptor.SYSTEM_NAMESPACE);
  }
  ResultScanner scanner=table.getScanner(HTableDescriptor.NAMESPACE_FAMILY_INFO_BYTES);
  try {
    for (    Result result : scanner) {
      byte[] val=CellUtil.cloneValue(result.getColumnLatest(HTableDescriptor.NAMESPACE_FAMILY_INFO_BYTES,HTableDescriptor.NAMESPACE_COL_DESC_BYTES));
      NamespaceDescriptor ns=ProtobufUtil.toNamespaceDescriptor(HBaseProtos.NamespaceDescriptor.parseFrom(val));
      zkNamespaceManager.update(ns);
    }
  }
  finally {
    scanner.close();
  }
}
