{
  final String encoded=getNodeName(zkw,region.getEncodedName());
  zkw.sync(encoded);
  Stat stat=new Stat();
  byte[] existingBytes=ZKUtil.getDataNoWatch(zkw,encoded,stat);
  if (existingBytes == null) {
    LOG.warn(zkw.prefix("Attempt to check the " + "closing node for " + encoded + ". The node does not exist"));
    return false;
  }
  if (expectedVersion != -1 && stat.getVersion() != expectedVersion) {
    LOG.warn(zkw.prefix("Attempt to check the " + "closing node for " + encoded + ". The node existed but was version "+ stat.getVersion()+ " not the expected version "+ expectedVersion));
    return false;
  }
  RegionTransition rt=getRegionTransition(existingBytes);
  if (!EventType.M_ZK_REGION_CLOSING.equals(rt.getEventType())) {
    LOG.warn(zkw.prefix("Attempt to check the " + "closing node for " + encoded + ". The node existed but was in an unexpected state: "+ rt.getEventType()));
    return false;
  }
  return true;
}
